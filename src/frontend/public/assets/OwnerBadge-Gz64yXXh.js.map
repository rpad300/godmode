{"version":3,"file":"OwnerBadge-Gz64yXXh.js","sources":["../../src/components/sot/OwnerBadge.tsx"],"sourcesContent":["import { useContacts } from '../../hooks/useGodMode';\nimport { cn, isValidAvatarUrl, getInitials } from '../../lib/utils';\n\ninterface OwnerBadgeProps {\n  name: string;\n  role?: string;\n  size?: 'sm' | 'md';\n}\n\nconst GRADIENTS = [\n  'from-blue-500 to-cyan-400',\n  'from-purple-500 to-pink-400',\n  'from-amber-500 to-orange-400',\n  'from-emerald-500 to-teal-400',\n  'from-rose-500 to-red-400',\n  'from-indigo-500 to-violet-400',\n];\n\nfunction hashGradient(name: string) {\n  let h = 0;\n  for (let i = 0; i < name.length; i++) h = ((h << 5) - h + name.charCodeAt(i)) | 0;\n  return GRADIENTS[Math.abs(h) % GRADIENTS.length];\n}\n\nfunction hasPhoto(c: Record<string, unknown>) {\n  return isValidAvatarUrl(c.avatarUrl) || isValidAvatarUrl(c.avatar) || isValidAvatarUrl(c.photo_url);\n}\n\nfunction findContact(contacts: Array<Record<string, unknown>>, name: string) {\n  const q = name.toLowerCase().trim();\n\n  const candidates: Record<string, unknown>[] = [];\n\n  for (const c of contacts) {\n    const cName = (c.name as string)?.toLowerCase() ?? '';\n    const cEmail = (c.email as string)?.toLowerCase() ?? '';\n    const aliases = ((c.aliases as string[]) ?? []).map(a => a.toLowerCase());\n\n    // exact name or email\n    if (cName === q || cEmail === q) { candidates.push(c); continue; }\n    // exact alias\n    if (aliases.includes(q)) { candidates.push(c); continue; }\n    // name starts with query or query starts with name\n    if (cName.startsWith(q + ' ') || q.startsWith(cName + ' ')) { candidates.push(c); continue; }\n    // first-name match (min 3 chars)\n    const first = cName.split(' ')[0];\n    if (first && first.length >= 3 && q === first) { candidates.push(c); continue; }\n    // partial alias\n    if (aliases.some(a => a.length >= 3 && (q.includes(a) || a.includes(q)))) { candidates.push(c); continue; }\n  }\n\n  if (candidates.length === 0) return undefined;\n  // prefer candidate with a photo\n  return candidates.find(hasPhoto) ?? candidates[0];\n}\n\nconst OwnerBadge = ({ name, role: roleProp, size = 'sm' }: OwnerBadgeProps) => {\n  const { data: contactsData } = useContacts();\n  const contacts = ((contactsData as Record<string, unknown>)?.contacts ?? []) as Array<Record<string, unknown>>;\n\n  const match = findContact(contacts, name);\n\n  const displayName = (match?.name as string) || name;\n  const avatarRaw = match?.avatarUrl || match?.avatar || match?.photo_url;\n  const avatar = (typeof avatarRaw === 'string' && avatarRaw.length > 0 && avatarRaw !== 'undefined' && avatarRaw !== 'null') ? avatarRaw : undefined;\n  const contactRole = (match?.cargo || match?.role || roleProp || '') as string;\n  const org = (match?.empresa || match?.organization || '') as string;\n  const subtitle = [contactRole, org].filter(Boolean).join(' Â· ');\n\n  const avatarDim = size === 'sm' ? 'w-7 h-7' : 'w-9 h-9';\n  const textSize = size === 'sm' ? 'text-[9px]' : 'text-[11px]';\n  const nameSize = size === 'sm' ? 'text-[11px]' : 'text-xs';\n  const subSize = size === 'sm' ? 'text-[9px]' : 'text-[10px]';\n\n  return (\n    <div className=\"flex items-center gap-2 min-w-0\">\n      {avatar ? (\n        <img src={avatar} alt={displayName} className={cn(avatarDim, 'rounded-full object-cover shrink-0')} />\n      ) : (\n        <div className={cn(avatarDim, 'rounded-full bg-gradient-to-br flex items-center justify-center shrink-0', hashGradient(displayName))}>\n          <span className={cn(textSize, 'font-bold text-white')}>{getInitials(displayName)}</span>\n        </div>\n      )}\n      <div className=\"min-w-0 flex-1\">\n        <p className={cn('font-medium text-[var(--gm-text-primary)] truncate', nameSize)}>{displayName}</p>\n        {subtitle && (\n          <p className={cn('text-[var(--gm-text-tertiary)] truncate', subSize)}>{subtitle}</p>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default OwnerBadge;\n"],"names":["GRADIENTS","hashGradient","name","h","i","hasPhoto","c","isValidAvatarUrl","findContact","contacts","q","candidates","cName","cEmail","aliases","a","first","OwnerBadge","roleProp","size","contactsData","useContacts","match","displayName","avatarRaw","avatar","contactRole","org","subtitle","avatarDim","textSize","nameSize","subSize","jsxs","jsx","cn","getInitials"],"mappings":"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"}
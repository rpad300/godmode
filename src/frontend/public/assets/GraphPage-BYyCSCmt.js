import{c as Qe,R as la,r as M,j as o,ce as un,b1 as dn,cf as Ln,cg as zn,ch as ua,G as da,ci as fs,O as ee,cj as fa,ck as ha,N as J,a as ae,C as yr,cl as ma,cm as ga,cn as pa,co as xa,U as ya,Y as ba,cp as wa,cq as va,cr as Na,cs as Sa,ct as ja,cu as _a,cv as Ea,cw as Ca,cx as ka,cy as Ma,cz as Ia,cA as Pa,cB as Aa,cC as Ta,cD as Da,cE as Ra,cF as La,cG as za,cH as Oa,cI as $a,cJ as Ha,ad as Ae,cK as Lt,T as ct,J as zt,cL as Fa,a2 as br,a1 as Va,cM as Ba,cN as Ga,cO as Ya,cP as Xa,cQ as Wa,cR as Za,cS as qa,cT as Qa,cU as Ua,cV as Ka,cW as Ja,cX as ec,cY as tc,cZ as nc,Z as sc,ab as rc,bD as hs,a3 as oc,ae as ms}from"./main-fI1tvvj5.js";import{a as Ie,c as gs,b as ps,d as ic,i as fn,u as ac}from"./value-BP22s02U.js";import{C as xs}from"./chevron-up-CmBp8Ii2.js";import{C as ys}from"./chevron-down-Cv_bzBMP.js";import{S as Te}from"./sparkles-BVZ2_1k0.js";import{P as cc}from"./play-BrIJzO2k.js";import{C as lc}from"./copy-D7s8Px_A.js";import{C as On}from"./cpu-7Vu7FY3P.js";import{L as Nn}from"./link-2-pRFXINl4.js";import{C as $n}from"./chart-column-CKQUCa41.js";import{T as uc}from"./trending-up-D650dmXO.js";import{L as Hn}from"./layers-Bivflnsq.js";import{H as bs}from"./history-D2IPEHm9.js";import{P as ws}from"./plus-B5uVkXEF.js";import{B as dc}from"./brain-D2kr9R_L.js";import{W as fc}from"./wand-sparkles-BoTQarA0.js";import{C as wr}from"./circle-check-big-00qMcaeM.js";import{C as hc}from"./circle-x-ClEi8u6i.js";import{S as mc}from"./send-DbUBalGk.js";import{D as Nt}from"./database-DuLEfmYc.js";import{T as gc}from"./test-tube-94vwolZK.js";import{F as pc}from"./funnel-Bc0_F7zy.js";const xc=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],Ot=Qe("code",xc);const yc=[["path",{d:"M12 3v14",key:"7cf3v8"}],["path",{d:"M5 10h14",key:"elsbfy"}],["path",{d:"M5 21h14",key:"11awu3"}]],bc=Qe("diff",yc);const wc=[["path",{d:"M15 6a9 9 0 0 0-9 9V3",key:"1cii5b"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}]],Sn=Qe("git-branch",wc);const vc=[["path",{d:"M12 22v-5",key:"1ega77"}],["path",{d:"M15 8V2",key:"18g5xt"}],["path",{d:"M17 8a1 1 0 0 1 1 1v4a4 4 0 0 1-4 4h-4a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1z",key:"1xoxul"}],["path",{d:"M9 8V2",key:"14iosj"}]],vs=Qe("plug",vc);const Nc=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],hn=Qe("server",Nc);const Sc=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],jc=Qe("table",Sc);var Ns=180/Math.PI,jn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function vr(e,t,n,s,r,i){var a,c,f;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(f=e*n+t*s)&&(n-=e*f,s-=t*f),(c=Math.sqrt(n*n+s*s))&&(n/=c,s/=c,f/=c),e*s<t*n&&(e=-e,t=-t,f=-f,a=-a),{translateX:r,translateY:i,rotate:Math.atan2(t,e)*Ns,skewX:Math.atan(f)*Ns,scaleX:a,scaleY:c}}var St;function _c(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?jn:vr(t.a,t.b,t.c,t.d,t.e,t.f)}function Ec(e){return e==null||(St||(St=document.createElementNS("http://www.w3.org/2000/svg","g")),St.setAttribute("transform",e),!(e=St.transform.baseVal.consolidate()))?jn:(e=e.matrix,vr(e.a,e.b,e.c,e.d,e.e,e.f))}function Nr(e,t,n,s){function r(l){return l.length?l.pop()+" ":""}function i(l,d,h,u,m,g){if(l!==h||d!==u){var w=m.push("translate(",null,t,null,n);g.push({i:w-4,x:Ie(l,h)},{i:w-2,x:Ie(d,u)})}else(h||u)&&m.push("translate("+h+t+u+n)}function a(l,d,h,u){l!==d?(l-d>180?d+=360:d-l>180&&(l+=360),u.push({i:h.push(r(h)+"rotate(",null,s)-2,x:Ie(l,d)})):d&&h.push(r(h)+"rotate("+d+s)}function c(l,d,h,u){l!==d?u.push({i:h.push(r(h)+"skewX(",null,s)-2,x:Ie(l,d)}):d&&h.push(r(h)+"skewX("+d+s)}function f(l,d,h,u,m,g){if(l!==h||d!==u){var w=m.push(r(m)+"scale(",null,",",null,")");g.push({i:w-4,x:Ie(l,h)},{i:w-2,x:Ie(d,u)})}else(h!==1||u!==1)&&m.push(r(m)+"scale("+h+","+u+")")}return function(l,d){var h=[],u=[];return l=e(l),d=e(d),i(l.translateX,l.translateY,d.translateX,d.translateY,h,u),a(l.rotate,d.rotate,h,u),c(l.skewX,d.skewX,h,u),f(l.scaleX,l.scaleY,d.scaleX,d.scaleY,h,u),l=d=null,function(m){for(var g=-1,w=u.length,v;++g<w;)h[(v=u[g]).i]=v.x(m);return h.join("")}}}var Cc=Nr(_c,"px, ","px)","deg)"),kc=Nr(Ec,", ",")",")"),Mc=1e-12;function Ss(e){return((e=Math.exp(e))+1/e)/2}function Ic(e){return((e=Math.exp(e))-1/e)/2}function Pc(e){return((e=Math.exp(2*e))-1)/(e+1)}const Pt=(function e(t,n,s){function r(i,a){var c=i[0],f=i[1],l=i[2],d=a[0],h=a[1],u=a[2],m=d-c,g=h-f,w=m*m+g*g,v,x;if(w<Mc)x=Math.log(u/l)/t,v=function(k){return[c+k*m,f+k*g,l*Math.exp(t*k*x)]};else{var S=Math.sqrt(w),p=(u*u-l*l+s*w)/(2*l*n*S),b=(u*u-l*l-s*w)/(2*u*n*S),E=Math.log(Math.sqrt(p*p+1)-p),j=Math.log(Math.sqrt(b*b+1)-b);x=(j-E)/t,v=function(k){var T=k*x,D=Ss(E),F=l/(n*S)*(D*Pc(t*T+E)-Ic(E));return[c+F*m,f+F*g,l*D/Ss(t*T+E)]}}return v.duration=x*1e3*t/Math.SQRT2,v}return r.rho=function(i){var a=Math.max(.001,+i),c=a*a,f=c*c;return e(a,c,f)},r})(Math.SQRT2,2,4);function ce(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,s;n<e.length;n++)(s=ce(e[n]))!==""&&(t+=(t&&" ")+s);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var Ac={value:()=>{}};function Zt(){for(var e=0,t=arguments.length,n={},s;e<t;++e){if(!(s=arguments[e]+"")||s in n||/[\s.]/.test(s))throw new Error("illegal type: "+s);n[s]=[]}return new At(n)}function At(e){this._=e}function Tc(e,t){return e.trim().split(/^|\s+/).map(function(n){var s="",r=n.indexOf(".");if(r>=0&&(s=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:s}})}At.prototype=Zt.prototype={constructor:At,on:function(e,t){var n=this._,s=Tc(e+"",n),r,i=-1,a=s.length;if(arguments.length<2){for(;++i<a;)if((r=(e=s[i]).type)&&(r=Dc(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<a;)if(r=(e=s[i]).type)n[r]=js(n[r],e.name,t);else if(t==null)for(r in n)n[r]=js(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new At(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),s=0,r,i;s<r;++s)n[s]=arguments[s+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],s=0,r=i.length;s<r;++s)i[s].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var s=this._[e],r=0,i=s.length;r<i;++r)s[r].value.apply(t,n)}};function Dc(e,t){for(var n=0,s=e.length,r;n<s;++n)if((r=e[n]).name===t)return r.value}function js(e,t,n){for(var s=0,r=e.length;s<r;++s)if(e[s].name===t){e[s]=Ac,e=e.slice(0,s).concat(e.slice(s+1));break}return n!=null&&e.push({name:t,value:n}),e}var _n="http://www.w3.org/1999/xhtml";const _s={svg:"http://www.w3.org/2000/svg",xhtml:_n,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function qt(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),_s.hasOwnProperty(t)?{space:_s[t],local:e}:e}function Rc(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===_n&&t.documentElement.namespaceURI===_n?t.createElement(e):t.createElementNS(n,e)}}function Lc(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Sr(e){var t=qt(e);return(t.local?Lc:Rc)(t)}function zc(){}function Fn(e){return e==null?zc:function(){return this.querySelector(e)}}function Oc(e){typeof e!="function"&&(e=Fn(e));for(var t=this._groups,n=t.length,s=new Array(n),r=0;r<n;++r)for(var i=t[r],a=i.length,c=s[r]=new Array(a),f,l,d=0;d<a;++d)(f=i[d])&&(l=e.call(f,f.__data__,d,i))&&("__data__"in f&&(l.__data__=f.__data__),c[d]=l);return new de(s,this._parents)}function $c(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Hc(){return[]}function jr(e){return e==null?Hc:function(){return this.querySelectorAll(e)}}function Fc(e){return function(){return $c(e.apply(this,arguments))}}function Vc(e){typeof e=="function"?e=Fc(e):e=jr(e);for(var t=this._groups,n=t.length,s=[],r=[],i=0;i<n;++i)for(var a=t[i],c=a.length,f,l=0;l<c;++l)(f=a[l])&&(s.push(e.call(f,f.__data__,l,a)),r.push(f));return new de(s,r)}function _r(e){return function(){return this.matches(e)}}function Er(e){return function(t){return t.matches(e)}}var Bc=Array.prototype.find;function Gc(e){return function(){return Bc.call(this.children,e)}}function Yc(){return this.firstElementChild}function Xc(e){return this.select(e==null?Yc:Gc(typeof e=="function"?e:Er(e)))}var Wc=Array.prototype.filter;function Zc(){return Array.from(this.children)}function qc(e){return function(){return Wc.call(this.children,e)}}function Qc(e){return this.selectAll(e==null?Zc:qc(typeof e=="function"?e:Er(e)))}function Uc(e){typeof e!="function"&&(e=_r(e));for(var t=this._groups,n=t.length,s=new Array(n),r=0;r<n;++r)for(var i=t[r],a=i.length,c=s[r]=[],f,l=0;l<a;++l)(f=i[l])&&e.call(f,f.__data__,l,i)&&c.push(f);return new de(s,this._parents)}function Cr(e){return new Array(e.length)}function Kc(){return new de(this._enter||this._groups.map(Cr),this._parents)}function $t(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}$t.prototype={constructor:$t,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Jc(e){return function(){return e}}function el(e,t,n,s,r,i){for(var a=0,c,f=t.length,l=i.length;a<l;++a)(c=t[a])?(c.__data__=i[a],s[a]=c):n[a]=new $t(e,i[a]);for(;a<f;++a)(c=t[a])&&(r[a]=c)}function tl(e,t,n,s,r,i,a){var c,f,l=new Map,d=t.length,h=i.length,u=new Array(d),m;for(c=0;c<d;++c)(f=t[c])&&(u[c]=m=a.call(f,f.__data__,c,t)+"",l.has(m)?r[c]=f:l.set(m,f));for(c=0;c<h;++c)m=a.call(e,i[c],c,i)+"",(f=l.get(m))?(s[c]=f,f.__data__=i[c],l.delete(m)):n[c]=new $t(e,i[c]);for(c=0;c<d;++c)(f=t[c])&&l.get(u[c])===f&&(r[c]=f)}function nl(e){return e.__data__}function sl(e,t){if(!arguments.length)return Array.from(this,nl);var n=t?tl:el,s=this._parents,r=this._groups;typeof e!="function"&&(e=Jc(e));for(var i=r.length,a=new Array(i),c=new Array(i),f=new Array(i),l=0;l<i;++l){var d=s[l],h=r[l],u=h.length,m=rl(e.call(d,d&&d.__data__,l,s)),g=m.length,w=c[l]=new Array(g),v=a[l]=new Array(g),x=f[l]=new Array(u);n(d,h,w,v,x,m,t);for(var S=0,p=0,b,E;S<g;++S)if(b=w[S]){for(S>=p&&(p=S+1);!(E=v[p])&&++p<g;);b._next=E||null}}return a=new de(a,s),a._enter=c,a._exit=f,a}function rl(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ol(){return new de(this._exit||this._groups.map(Cr),this._parents)}function il(e,t,n){var s=this.enter(),r=this,i=this.exit();return typeof e=="function"?(s=e(s),s&&(s=s.selection())):s=s.append(e+""),t!=null&&(r=t(r),r&&(r=r.selection())),n==null?i.remove():n(i),s&&r?s.merge(r).order():r}function al(e){for(var t=e.selection?e.selection():e,n=this._groups,s=t._groups,r=n.length,i=s.length,a=Math.min(r,i),c=new Array(r),f=0;f<a;++f)for(var l=n[f],d=s[f],h=l.length,u=c[f]=new Array(h),m,g=0;g<h;++g)(m=l[g]||d[g])&&(u[g]=m);for(;f<r;++f)c[f]=n[f];return new de(c,this._parents)}function cl(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var s=e[t],r=s.length-1,i=s[r],a;--r>=0;)(a=s[r])&&(i&&a.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(a,i),i=a);return this}function ll(e){e||(e=ul);function t(h,u){return h&&u?e(h.__data__,u.__data__):!h-!u}for(var n=this._groups,s=n.length,r=new Array(s),i=0;i<s;++i){for(var a=n[i],c=a.length,f=r[i]=new Array(c),l,d=0;d<c;++d)(l=a[d])&&(f[d]=l);f.sort(t)}return new de(r,this._parents).order()}function ul(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function dl(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function fl(){return Array.from(this)}function hl(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var s=e[t],r=0,i=s.length;r<i;++r){var a=s[r];if(a)return a}return null}function ml(){let e=0;for(const t of this)++e;return e}function gl(){return!this.node()}function pl(e){for(var t=this._groups,n=0,s=t.length;n<s;++n)for(var r=t[n],i=0,a=r.length,c;i<a;++i)(c=r[i])&&e.call(c,c.__data__,i,r);return this}function xl(e){return function(){this.removeAttribute(e)}}function yl(e){return function(){this.removeAttributeNS(e.space,e.local)}}function bl(e,t){return function(){this.setAttribute(e,t)}}function wl(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function vl(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Nl(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Sl(e,t){var n=qt(e);if(arguments.length<2){var s=this.node();return n.local?s.getAttributeNS(n.space,n.local):s.getAttribute(n)}return this.each((t==null?n.local?yl:xl:typeof t=="function"?n.local?Nl:vl:n.local?wl:bl)(n,t))}function kr(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function jl(e){return function(){this.style.removeProperty(e)}}function _l(e,t,n){return function(){this.style.setProperty(e,t,n)}}function El(e,t,n){return function(){var s=t.apply(this,arguments);s==null?this.style.removeProperty(e):this.style.setProperty(e,s,n)}}function Cl(e,t,n){return arguments.length>1?this.each((t==null?jl:typeof t=="function"?El:_l)(e,t,n??"")):Be(this.node(),e)}function Be(e,t){return e.style.getPropertyValue(t)||kr(e).getComputedStyle(e,null).getPropertyValue(t)}function kl(e){return function(){delete this[e]}}function Ml(e,t){return function(){this[e]=t}}function Il(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Pl(e,t){return arguments.length>1?this.each((t==null?kl:typeof t=="function"?Il:Ml)(e,t)):this.node()[e]}function Mr(e){return e.trim().split(/^|\s+/)}function Vn(e){return e.classList||new Ir(e)}function Ir(e){this._node=e,this._names=Mr(e.getAttribute("class")||"")}Ir.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Pr(e,t){for(var n=Vn(e),s=-1,r=t.length;++s<r;)n.add(t[s])}function Ar(e,t){for(var n=Vn(e),s=-1,r=t.length;++s<r;)n.remove(t[s])}function Al(e){return function(){Pr(this,e)}}function Tl(e){return function(){Ar(this,e)}}function Dl(e,t){return function(){(t.apply(this,arguments)?Pr:Ar)(this,e)}}function Rl(e,t){var n=Mr(e+"");if(arguments.length<2){for(var s=Vn(this.node()),r=-1,i=n.length;++r<i;)if(!s.contains(n[r]))return!1;return!0}return this.each((typeof t=="function"?Dl:t?Al:Tl)(n,t))}function Ll(){this.textContent=""}function zl(e){return function(){this.textContent=e}}function Ol(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function $l(e){return arguments.length?this.each(e==null?Ll:(typeof e=="function"?Ol:zl)(e)):this.node().textContent}function Hl(){this.innerHTML=""}function Fl(e){return function(){this.innerHTML=e}}function Vl(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Bl(e){return arguments.length?this.each(e==null?Hl:(typeof e=="function"?Vl:Fl)(e)):this.node().innerHTML}function Gl(){this.nextSibling&&this.parentNode.appendChild(this)}function Yl(){return this.each(Gl)}function Xl(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Wl(){return this.each(Xl)}function Zl(e){var t=typeof e=="function"?e:Sr(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function ql(){return null}function Ql(e,t){var n=typeof e=="function"?e:Sr(e),s=t==null?ql:typeof t=="function"?t:Fn(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),s.apply(this,arguments)||null)})}function Ul(){var e=this.parentNode;e&&e.removeChild(this)}function Kl(){return this.each(Ul)}function Jl(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function eu(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function tu(e){return this.select(e?eu:Jl)}function nu(e){return arguments.length?this.property("__data__",e):this.node().__data__}function su(e){return function(t){e.call(this,t,this.__data__)}}function ru(e){return e.trim().split(/^|\s+/).map(function(t){var n="",s=t.indexOf(".");return s>=0&&(n=t.slice(s+1),t=t.slice(0,s)),{type:t,name:n}})}function ou(e){return function(){var t=this.__on;if(t){for(var n=0,s=-1,r=t.length,i;n<r;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++s]=i;++s?t.length=s:delete this.__on}}}function iu(e,t,n){return function(){var s=this.__on,r,i=su(t);if(s){for(var a=0,c=s.length;a<c;++a)if((r=s[a]).type===e.type&&r.name===e.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),r.value=t;return}}this.addEventListener(e.type,i,n),r={type:e.type,name:e.name,value:t,listener:i,options:n},s?s.push(r):this.__on=[r]}}function au(e,t,n){var s=ru(e+""),r,i=s.length,a;if(arguments.length<2){var c=this.node().__on;if(c){for(var f=0,l=c.length,d;f<l;++f)for(r=0,d=c[f];r<i;++r)if((a=s[r]).type===d.type&&a.name===d.name)return d.value}return}for(c=t?iu:ou,r=0;r<i;++r)this.each(c(s[r],t,n));return this}function Tr(e,t,n){var s=kr(e),r=s.CustomEvent;typeof r=="function"?r=new r(t,n):(r=s.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function cu(e,t){return function(){return Tr(this,e,t)}}function lu(e,t){return function(){return Tr(this,e,t.apply(this,arguments))}}function uu(e,t){return this.each((typeof t=="function"?lu:cu)(e,t))}function*du(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var s=e[t],r=0,i=s.length,a;r<i;++r)(a=s[r])&&(yield a)}var Dr=[null];function de(e,t){this._groups=e,this._parents=t}function pt(){return new de([[document.documentElement]],Dr)}function fu(){return this}de.prototype=pt.prototype={constructor:de,select:Oc,selectAll:Vc,selectChild:Xc,selectChildren:Qc,filter:Uc,data:sl,enter:Kc,exit:ol,join:il,merge:al,selection:fu,order:cl,sort:ll,call:dl,nodes:fl,node:hl,size:ml,empty:gl,each:pl,attr:Sl,style:Cl,property:Pl,classed:Rl,text:$l,html:Bl,raise:Yl,lower:Wl,append:Zl,insert:Ql,remove:Kl,clone:tu,datum:nu,on:au,dispatch:uu,[Symbol.iterator]:du};function ue(e){return typeof e=="string"?new de([[document.querySelector(e)]],[document.documentElement]):new de([[e]],Dr)}function hu(e){let t;for(;t=e.sourceEvent;)e=t;return e}function fe(e,t){if(e=hu(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var s=n.createSVGPoint();return s.x=e.clientX,s.y=e.clientY,s=s.matrixTransform(t.getScreenCTM().inverse()),[s.x,s.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}const mu={passive:!1},lt={capture:!0,passive:!1};function mn(e){e.stopImmediatePropagation()}function Ve(e){e.preventDefault(),e.stopImmediatePropagation()}function Rr(e){var t=e.document.documentElement,n=ue(e).on("dragstart.drag",Ve,lt);"onselectstart"in t?n.on("selectstart.drag",Ve,lt):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Lr(e,t){var n=e.document.documentElement,s=ue(e).on("dragstart.drag",null);t&&(s.on("click.drag",Ve,lt),setTimeout(function(){s.on("click.drag",null)},0)),"onselectstart"in n?s.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const jt=e=>()=>e;function En(e,{sourceEvent:t,subject:n,target:s,identifier:r,active:i,x:a,y:c,dx:f,dy:l,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:s,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:c,enumerable:!0,configurable:!0},dx:{value:f,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:d}})}En.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function gu(e){return!e.ctrlKey&&!e.button}function pu(){return this.parentNode}function xu(e,t){return t??{x:e.x,y:e.y}}function yu(){return navigator.maxTouchPoints||"ontouchstart"in this}function zr(){var e=gu,t=pu,n=xu,s=yu,r={},i=Zt("start","drag","end"),a=0,c,f,l,d,h=0;function u(b){b.on("mousedown.drag",m).filter(s).on("touchstart.drag",v).on("touchmove.drag",x,mu).on("touchend.drag touchcancel.drag",S).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(b,E){if(!(d||!e.call(this,b,E))){var j=p(this,t.call(this,b,E),b,E,"mouse");j&&(ue(b.view).on("mousemove.drag",g,lt).on("mouseup.drag",w,lt),Rr(b.view),mn(b),l=!1,c=b.clientX,f=b.clientY,j("start",b))}}function g(b){if(Ve(b),!l){var E=b.clientX-c,j=b.clientY-f;l=E*E+j*j>h}r.mouse("drag",b)}function w(b){ue(b.view).on("mousemove.drag mouseup.drag",null),Lr(b.view,l),Ve(b),r.mouse("end",b)}function v(b,E){if(e.call(this,b,E)){var j=b.changedTouches,k=t.call(this,b,E),T=j.length,D,F;for(D=0;D<T;++D)(F=p(this,k,b,E,j[D].identifier,j[D]))&&(mn(b),F("start",b,j[D]))}}function x(b){var E=b.changedTouches,j=E.length,k,T;for(k=0;k<j;++k)(T=r[E[k].identifier])&&(Ve(b),T("drag",b,E[k]))}function S(b){var E=b.changedTouches,j=E.length,k,T;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),k=0;k<j;++k)(T=r[E[k].identifier])&&(mn(b),T("end",b,E[k]))}function p(b,E,j,k,T,D){var F=i.copy(),A=fe(D||j,E),R,O,y;if((y=n.call(b,new En("beforestart",{sourceEvent:j,target:u,identifier:T,active:a,x:A[0],y:A[1],dx:0,dy:0,dispatch:F}),k))!=null)return R=y.x-A[0]||0,O=y.y-A[1]||0,function _(C,P,N){var I=A,z;switch(C){case"start":r[T]=_,z=a++;break;case"end":delete r[T],--a;case"drag":A=fe(N||P,E),z=a;break}F.call(C,b,new En(C,{sourceEvent:P,subject:y,target:u,identifier:T,active:z,x:A[0]+R,y:A[1]+O,dx:A[0]-I[0],dy:A[1]-I[1],dispatch:F}),k)}}return u.filter=function(b){return arguments.length?(e=typeof b=="function"?b:jt(!!b),u):e},u.container=function(b){return arguments.length?(t=typeof b=="function"?b:jt(b),u):t},u.subject=function(b){return arguments.length?(n=typeof b=="function"?b:jt(b),u):n},u.touchable=function(b){return arguments.length?(s=typeof b=="function"?b:jt(!!b),u):s},u.on=function(){var b=i.on.apply(i,arguments);return b===i?u:b},u.clickDistance=function(b){return arguments.length?(h=(b=+b)*b,u):Math.sqrt(h)},u}var Ge=0,rt=0,tt=0,Or=1e3,Ht,ot,Ft=0,Re=0,Qt=0,ut=typeof performance=="object"&&performance.now?performance:Date,$r=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Bn(){return Re||($r(bu),Re=ut.now()+Qt)}function bu(){Re=0}function Vt(){this._call=this._time=this._next=null}Vt.prototype=Hr.prototype={constructor:Vt,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Bn():+n)+(t==null?0:+t),!this._next&&ot!==this&&(ot?ot._next=this:Ht=this,ot=this),this._call=e,this._time=n,Cn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Cn())}};function Hr(e,t,n){var s=new Vt;return s.restart(e,t,n),s}function wu(){Bn(),++Ge;for(var e=Ht,t;e;)(t=Re-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ge}function Es(){Re=(Ft=ut.now())+Qt,Ge=rt=0;try{wu()}finally{Ge=0,Nu(),Re=0}}function vu(){var e=ut.now(),t=e-Ft;t>Or&&(Qt-=t,Ft=e)}function Nu(){for(var e,t=Ht,n,s=1/0;t;)t._call?(s>t._time&&(s=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Ht=n);ot=e,Cn(s)}function Cn(e){if(!Ge){rt&&(rt=clearTimeout(rt));var t=e-Re;t>24?(e<1/0&&(rt=setTimeout(Es,e-ut.now()-Qt)),tt&&(tt=clearInterval(tt))):(tt||(Ft=ut.now(),tt=setInterval(vu,Or)),Ge=1,$r(Es))}}function Cs(e,t,n){var s=new Vt;return t=t==null?0:+t,s.restart(r=>{s.stop(),e(r+t)},t,n),s}var Su=Zt("start","end","cancel","interrupt"),ju=[],Fr=0,ks=1,kn=2,Tt=3,Ms=4,Mn=5,Dt=6;function Ut(e,t,n,s,r,i){var a=e.__transition;if(!a)e.__transition={};else if(n in a)return;_u(e,n,{name:t,index:s,group:r,on:Su,tween:ju,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:Fr})}function Gn(e,t){var n=ge(e,t);if(n.state>Fr)throw new Error("too late; already scheduled");return n}function xe(e,t){var n=ge(e,t);if(n.state>Tt)throw new Error("too late; already running");return n}function ge(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function _u(e,t,n){var s=e.__transition,r;s[t]=n,n.timer=Hr(i,0,n.time);function i(l){n.state=ks,n.timer.restart(a,n.delay,n.time),n.delay<=l&&a(l-n.delay)}function a(l){var d,h,u,m;if(n.state!==ks)return f();for(d in s)if(m=s[d],m.name===n.name){if(m.state===Tt)return Cs(a);m.state===Ms?(m.state=Dt,m.timer.stop(),m.on.call("interrupt",e,e.__data__,m.index,m.group),delete s[d]):+d<t&&(m.state=Dt,m.timer.stop(),m.on.call("cancel",e,e.__data__,m.index,m.group),delete s[d])}if(Cs(function(){n.state===Tt&&(n.state=Ms,n.timer.restart(c,n.delay,n.time),c(l))}),n.state=kn,n.on.call("start",e,e.__data__,n.index,n.group),n.state===kn){for(n.state=Tt,r=new Array(u=n.tween.length),d=0,h=-1;d<u;++d)(m=n.tween[d].value.call(e,e.__data__,n.index,n.group))&&(r[++h]=m);r.length=h+1}}function c(l){for(var d=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(f),n.state=Mn,1),h=-1,u=r.length;++h<u;)r[h].call(e,d);n.state===Mn&&(n.on.call("end",e,e.__data__,n.index,n.group),f())}function f(){n.state=Dt,n.timer.stop(),delete s[t];for(var l in s)return;delete e.__transition}}function Rt(e,t){var n=e.__transition,s,r,i=!0,a;if(n){t=t==null?null:t+"";for(a in n){if((s=n[a]).name!==t){i=!1;continue}r=s.state>kn&&s.state<Mn,s.state=Dt,s.timer.stop(),s.on.call(r?"interrupt":"cancel",e,e.__data__,s.index,s.group),delete n[a]}i&&delete e.__transition}}function Eu(e){return this.each(function(){Rt(this,e)})}function Cu(e,t){var n,s;return function(){var r=xe(this,e),i=r.tween;if(i!==n){s=n=i;for(var a=0,c=s.length;a<c;++a)if(s[a].name===t){s=s.slice(),s.splice(a,1);break}}r.tween=s}}function ku(e,t,n){var s,r;if(typeof n!="function")throw new Error;return function(){var i=xe(this,e),a=i.tween;if(a!==s){r=(s=a).slice();for(var c={name:t,value:n},f=0,l=r.length;f<l;++f)if(r[f].name===t){r[f]=c;break}f===l&&r.push(c)}i.tween=r}}function Mu(e,t){var n=this._id;if(e+="",arguments.length<2){for(var s=ge(this.node(),n).tween,r=0,i=s.length,a;r<i;++r)if((a=s[r]).name===e)return a.value;return null}return this.each((t==null?Cu:ku)(n,e,t))}function Yn(e,t,n){var s=e._id;return e.each(function(){var r=xe(this,s);(r.value||(r.value={}))[t]=n.apply(this,arguments)}),function(r){return ge(r,s).value[t]}}function Vr(e,t){var n;return(typeof t=="number"?Ie:t instanceof gs?ps:(n=gs(t))?(t=n,ps):ic)(e,t)}function Iu(e){return function(){this.removeAttribute(e)}}function Pu(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Au(e,t,n){var s,r=n+"",i;return function(){var a=this.getAttribute(e);return a===r?null:a===s?i:i=t(s=a,n)}}function Tu(e,t,n){var s,r=n+"",i;return function(){var a=this.getAttributeNS(e.space,e.local);return a===r?null:a===s?i:i=t(s=a,n)}}function Du(e,t,n){var s,r,i;return function(){var a,c=n(this),f;return c==null?void this.removeAttribute(e):(a=this.getAttribute(e),f=c+"",a===f?null:a===s&&f===r?i:(r=f,i=t(s=a,c)))}}function Ru(e,t,n){var s,r,i;return function(){var a,c=n(this),f;return c==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),f=c+"",a===f?null:a===s&&f===r?i:(r=f,i=t(s=a,c)))}}function Lu(e,t){var n=qt(e),s=n==="transform"?kc:Vr;return this.attrTween(e,typeof t=="function"?(n.local?Ru:Du)(n,s,Yn(this,"attr."+e,t)):t==null?(n.local?Pu:Iu)(n):(n.local?Tu:Au)(n,s,t))}function zu(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Ou(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function $u(e,t){var n,s;function r(){var i=t.apply(this,arguments);return i!==s&&(n=(s=i)&&Ou(e,i)),n}return r._value=t,r}function Hu(e,t){var n,s;function r(){var i=t.apply(this,arguments);return i!==s&&(n=(s=i)&&zu(e,i)),n}return r._value=t,r}function Fu(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var s=qt(e);return this.tween(n,(s.local?$u:Hu)(s,t))}function Vu(e,t){return function(){Gn(this,e).delay=+t.apply(this,arguments)}}function Bu(e,t){return t=+t,function(){Gn(this,e).delay=t}}function Gu(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Vu:Bu)(t,e)):ge(this.node(),t).delay}function Yu(e,t){return function(){xe(this,e).duration=+t.apply(this,arguments)}}function Xu(e,t){return t=+t,function(){xe(this,e).duration=t}}function Wu(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Yu:Xu)(t,e)):ge(this.node(),t).duration}function Zu(e,t){if(typeof t!="function")throw new Error;return function(){xe(this,e).ease=t}}function qu(e){var t=this._id;return arguments.length?this.each(Zu(t,e)):ge(this.node(),t).ease}function Qu(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;xe(this,e).ease=n}}function Uu(e){if(typeof e!="function")throw new Error;return this.each(Qu(this._id,e))}function Ku(e){typeof e!="function"&&(e=_r(e));for(var t=this._groups,n=t.length,s=new Array(n),r=0;r<n;++r)for(var i=t[r],a=i.length,c=s[r]=[],f,l=0;l<a;++l)(f=i[l])&&e.call(f,f.__data__,l,i)&&c.push(f);return new Ne(s,this._parents,this._name,this._id)}function Ju(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,s=t.length,r=n.length,i=Math.min(s,r),a=new Array(s),c=0;c<i;++c)for(var f=t[c],l=n[c],d=f.length,h=a[c]=new Array(d),u,m=0;m<d;++m)(u=f[m]||l[m])&&(h[m]=u);for(;c<s;++c)a[c]=t[c];return new Ne(a,this._parents,this._name,this._id)}function ed(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function td(e,t,n){var s,r,i=ed(t)?Gn:xe;return function(){var a=i(this,e),c=a.on;c!==s&&(r=(s=c).copy()).on(t,n),a.on=r}}function nd(e,t){var n=this._id;return arguments.length<2?ge(this.node(),n).on.on(e):this.each(td(n,e,t))}function sd(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function rd(){return this.on("end.remove",sd(this._id))}function od(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Fn(e));for(var s=this._groups,r=s.length,i=new Array(r),a=0;a<r;++a)for(var c=s[a],f=c.length,l=i[a]=new Array(f),d,h,u=0;u<f;++u)(d=c[u])&&(h=e.call(d,d.__data__,u,c))&&("__data__"in d&&(h.__data__=d.__data__),l[u]=h,Ut(l[u],t,n,u,l,ge(d,n)));return new Ne(i,this._parents,t,n)}function id(e){var t=this._name,n=this._id;typeof e!="function"&&(e=jr(e));for(var s=this._groups,r=s.length,i=[],a=[],c=0;c<r;++c)for(var f=s[c],l=f.length,d,h=0;h<l;++h)if(d=f[h]){for(var u=e.call(d,d.__data__,h,f),m,g=ge(d,n),w=0,v=u.length;w<v;++w)(m=u[w])&&Ut(m,t,n,w,u,g);i.push(u),a.push(d)}return new Ne(i,a,t,n)}var ad=pt.prototype.constructor;function cd(){return new ad(this._groups,this._parents)}function ld(e,t){var n,s,r;return function(){var i=Be(this,e),a=(this.style.removeProperty(e),Be(this,e));return i===a?null:i===n&&a===s?r:r=t(n=i,s=a)}}function Br(e){return function(){this.style.removeProperty(e)}}function ud(e,t,n){var s,r=n+"",i;return function(){var a=Be(this,e);return a===r?null:a===s?i:i=t(s=a,n)}}function dd(e,t,n){var s,r,i;return function(){var a=Be(this,e),c=n(this),f=c+"";return c==null&&(f=c=(this.style.removeProperty(e),Be(this,e))),a===f?null:a===s&&f===r?i:(r=f,i=t(s=a,c))}}function fd(e,t){var n,s,r,i="style."+t,a="end."+i,c;return function(){var f=xe(this,e),l=f.on,d=f.value[i]==null?c||(c=Br(t)):void 0;(l!==n||r!==d)&&(s=(n=l).copy()).on(a,r=d),f.on=s}}function hd(e,t,n){var s=(e+="")=="transform"?Cc:Vr;return t==null?this.styleTween(e,ld(e,s)).on("end.style."+e,Br(e)):typeof t=="function"?this.styleTween(e,dd(e,s,Yn(this,"style."+e,t))).each(fd(this._id,e)):this.styleTween(e,ud(e,s,t),n).on("end.style."+e,null)}function md(e,t,n){return function(s){this.style.setProperty(e,t.call(this,s),n)}}function gd(e,t,n){var s,r;function i(){var a=t.apply(this,arguments);return a!==r&&(s=(r=a)&&md(e,a,n)),s}return i._value=t,i}function pd(e,t,n){var s="style."+(e+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(t==null)return this.tween(s,null);if(typeof t!="function")throw new Error;return this.tween(s,gd(e,t,n??""))}function xd(e){return function(){this.textContent=e}}function yd(e){return function(){var t=e(this);this.textContent=t??""}}function bd(e){return this.tween("text",typeof e=="function"?yd(Yn(this,"text",e)):xd(e==null?"":e+""))}function wd(e){return function(t){this.textContent=e.call(this,t)}}function vd(e){var t,n;function s(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&wd(r)),t}return s._value=e,s}function Nd(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,vd(e))}function Sd(){for(var e=this._name,t=this._id,n=Gr(),s=this._groups,r=s.length,i=0;i<r;++i)for(var a=s[i],c=a.length,f,l=0;l<c;++l)if(f=a[l]){var d=ge(f,t);Ut(f,e,n,l,a,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new Ne(s,this._parents,e,n)}function jd(){var e,t,n=this,s=n._id,r=n.size();return new Promise(function(i,a){var c={value:a},f={value:function(){--r===0&&i()}};n.each(function(){var l=xe(this,s),d=l.on;d!==e&&(t=(e=d).copy(),t._.cancel.push(c),t._.interrupt.push(c),t._.end.push(f)),l.on=t}),r===0&&i()})}var _d=0;function Ne(e,t,n,s){this._groups=e,this._parents=t,this._name=n,this._id=s}function Gr(){return++_d}var be=pt.prototype;Ne.prototype={constructor:Ne,select:od,selectAll:id,selectChild:be.selectChild,selectChildren:be.selectChildren,filter:Ku,merge:Ju,selection:cd,transition:Sd,call:be.call,nodes:be.nodes,node:be.node,size:be.size,empty:be.empty,each:be.each,on:nd,attr:Lu,attrTween:Fu,style:hd,styleTween:pd,text:bd,textTween:Nd,remove:rd,tween:Mu,delay:Gu,duration:Wu,ease:qu,easeVarying:Uu,end:jd,[Symbol.iterator]:be[Symbol.iterator]};function Ed(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Cd={time:null,delay:0,duration:250,ease:Ed};function kd(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Md(e){var t,n;e instanceof Ne?(t=e._id,e=e._name):(t=Gr(),(n=Cd).time=Bn(),e=e==null?null:e+"");for(var s=this._groups,r=s.length,i=0;i<r;++i)for(var a=s[i],c=a.length,f,l=0;l<c;++l)(f=a[l])&&Ut(f,e,t,l,a,n||kd(f,t));return new Ne(s,this._parents,e,t)}pt.prototype.interrupt=Eu;pt.prototype.transition=Md;const _t=e=>()=>e;function Id(e,{sourceEvent:t,target:n,transform:s,dispatch:r}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:s,enumerable:!0,configurable:!0},_:{value:r}})}function ve(e,t,n){this.k=e,this.x=t,this.y=n}ve.prototype={constructor:ve,scale:function(e){return e===1?this:new ve(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new ve(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Kt=new ve(1,0,0);Yr.prototype=ve.prototype;function Yr(e){for(;!e.__zoom;)if(!(e=e.parentNode))return Kt;return e.__zoom}function gn(e){e.stopImmediatePropagation()}function nt(e){e.preventDefault(),e.stopImmediatePropagation()}function Pd(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Ad(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Is(){return this.__zoom||Kt}function Td(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Dd(){return navigator.maxTouchPoints||"ontouchstart"in this}function Rd(e,t,n){var s=e.invertX(t[0][0])-n[0][0],r=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],a=e.invertY(t[1][1])-n[1][1];return e.translate(r>s?(s+r)/2:Math.min(0,s)||Math.max(0,r),a>i?(i+a)/2:Math.min(0,i)||Math.max(0,a))}function Xr(){var e=Pd,t=Ad,n=Rd,s=Td,r=Dd,i=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],c=250,f=Pt,l=Zt("start","zoom","end"),d,h,u,m=500,g=150,w=0,v=10;function x(y){y.property("__zoom",Is).on("wheel.zoom",T,{passive:!1}).on("mousedown.zoom",D).on("dblclick.zoom",F).filter(r).on("touchstart.zoom",A).on("touchmove.zoom",R).on("touchend.zoom touchcancel.zoom",O).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}x.transform=function(y,_,C,P){var N=y.selection?y.selection():y;N.property("__zoom",Is),y!==N?E(y,_,C,P):N.interrupt().each(function(){j(this,arguments).event(P).start().zoom(null,typeof _=="function"?_.apply(this,arguments):_).end()})},x.scaleBy=function(y,_,C,P){x.scaleTo(y,function(){var N=this.__zoom.k,I=typeof _=="function"?_.apply(this,arguments):_;return N*I},C,P)},x.scaleTo=function(y,_,C,P){x.transform(y,function(){var N=t.apply(this,arguments),I=this.__zoom,z=C==null?b(N):typeof C=="function"?C.apply(this,arguments):C,H=I.invert(z),$=typeof _=="function"?_.apply(this,arguments):_;return n(p(S(I,$),z,H),N,a)},C,P)},x.translateBy=function(y,_,C,P){x.transform(y,function(){return n(this.__zoom.translate(typeof _=="function"?_.apply(this,arguments):_,typeof C=="function"?C.apply(this,arguments):C),t.apply(this,arguments),a)},null,P)},x.translateTo=function(y,_,C,P,N){x.transform(y,function(){var I=t.apply(this,arguments),z=this.__zoom,H=P==null?b(I):typeof P=="function"?P.apply(this,arguments):P;return n(Kt.translate(H[0],H[1]).scale(z.k).translate(typeof _=="function"?-_.apply(this,arguments):-_,typeof C=="function"?-C.apply(this,arguments):-C),I,a)},P,N)};function S(y,_){return _=Math.max(i[0],Math.min(i[1],_)),_===y.k?y:new ve(_,y.x,y.y)}function p(y,_,C){var P=_[0]-C[0]*y.k,N=_[1]-C[1]*y.k;return P===y.x&&N===y.y?y:new ve(y.k,P,N)}function b(y){return[(+y[0][0]+ +y[1][0])/2,(+y[0][1]+ +y[1][1])/2]}function E(y,_,C,P){y.on("start.zoom",function(){j(this,arguments).event(P).start()}).on("interrupt.zoom end.zoom",function(){j(this,arguments).event(P).end()}).tween("zoom",function(){var N=this,I=arguments,z=j(N,I).event(P),H=t.apply(N,I),$=C==null?b(H):typeof C=="function"?C.apply(N,I):C,Y=Math.max(H[1][0]-H[0][0],H[1][1]-H[0][1]),G=N.__zoom,Z=typeof _=="function"?_.apply(N,I):_,L=f(G.invert($).concat(Y/G.k),Z.invert($).concat(Y/Z.k));return function(B){if(B===1)B=Z;else{var V=L(B),X=Y/V[2];B=new ve(X,$[0]-V[0]*X,$[1]-V[1]*X)}z.zoom(null,B)}})}function j(y,_,C){return!C&&y.__zooming||new k(y,_)}function k(y,_){this.that=y,this.args=_,this.active=0,this.sourceEvent=null,this.extent=t.apply(y,_),this.taps=0}k.prototype={event:function(y){return y&&(this.sourceEvent=y),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(y,_){return this.mouse&&y!=="mouse"&&(this.mouse[1]=_.invert(this.mouse[0])),this.touch0&&y!=="touch"&&(this.touch0[1]=_.invert(this.touch0[0])),this.touch1&&y!=="touch"&&(this.touch1[1]=_.invert(this.touch1[0])),this.that.__zoom=_,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(y){var _=ue(this.that).datum();l.call(y,this.that,new Id(y,{sourceEvent:this.sourceEvent,target:x,transform:this.that.__zoom,dispatch:l}),_)}};function T(y,..._){if(!e.apply(this,arguments))return;var C=j(this,_).event(y),P=this.__zoom,N=Math.max(i[0],Math.min(i[1],P.k*Math.pow(2,s.apply(this,arguments)))),I=fe(y);if(C.wheel)(C.mouse[0][0]!==I[0]||C.mouse[0][1]!==I[1])&&(C.mouse[1]=P.invert(C.mouse[0]=I)),clearTimeout(C.wheel);else{if(P.k===N)return;C.mouse=[I,P.invert(I)],Rt(this),C.start()}nt(y),C.wheel=setTimeout(z,g),C.zoom("mouse",n(p(S(P,N),C.mouse[0],C.mouse[1]),C.extent,a));function z(){C.wheel=null,C.end()}}function D(y,..._){if(u||!e.apply(this,arguments))return;var C=y.currentTarget,P=j(this,_,!0).event(y),N=ue(y.view).on("mousemove.zoom",$,!0).on("mouseup.zoom",Y,!0),I=fe(y,C),z=y.clientX,H=y.clientY;Rr(y.view),gn(y),P.mouse=[I,this.__zoom.invert(I)],Rt(this),P.start();function $(G){if(nt(G),!P.moved){var Z=G.clientX-z,L=G.clientY-H;P.moved=Z*Z+L*L>w}P.event(G).zoom("mouse",n(p(P.that.__zoom,P.mouse[0]=fe(G,C),P.mouse[1]),P.extent,a))}function Y(G){N.on("mousemove.zoom mouseup.zoom",null),Lr(G.view,P.moved),nt(G),P.event(G).end()}}function F(y,..._){if(e.apply(this,arguments)){var C=this.__zoom,P=fe(y.changedTouches?y.changedTouches[0]:y,this),N=C.invert(P),I=C.k*(y.shiftKey?.5:2),z=n(p(S(C,I),P,N),t.apply(this,_),a);nt(y),c>0?ue(this).transition().duration(c).call(E,z,P,y):ue(this).call(x.transform,z,P,y)}}function A(y,..._){if(e.apply(this,arguments)){var C=y.touches,P=C.length,N=j(this,_,y.changedTouches.length===P).event(y),I,z,H,$;for(gn(y),z=0;z<P;++z)H=C[z],$=fe(H,this),$=[$,this.__zoom.invert($),H.identifier],N.touch0?!N.touch1&&N.touch0[2]!==$[2]&&(N.touch1=$,N.taps=0):(N.touch0=$,I=!0,N.taps=1+!!d);d&&(d=clearTimeout(d)),I&&(N.taps<2&&(h=$[0],d=setTimeout(function(){d=null},m)),Rt(this),N.start())}}function R(y,..._){if(this.__zooming){var C=j(this,_).event(y),P=y.changedTouches,N=P.length,I,z,H,$;for(nt(y),I=0;I<N;++I)z=P[I],H=fe(z,this),C.touch0&&C.touch0[2]===z.identifier?C.touch0[0]=H:C.touch1&&C.touch1[2]===z.identifier&&(C.touch1[0]=H);if(z=C.that.__zoom,C.touch1){var Y=C.touch0[0],G=C.touch0[1],Z=C.touch1[0],L=C.touch1[1],B=(B=Z[0]-Y[0])*B+(B=Z[1]-Y[1])*B,V=(V=L[0]-G[0])*V+(V=L[1]-G[1])*V;z=S(z,Math.sqrt(B/V)),H=[(Y[0]+Z[0])/2,(Y[1]+Z[1])/2],$=[(G[0]+L[0])/2,(G[1]+L[1])/2]}else if(C.touch0)H=C.touch0[0],$=C.touch0[1];else return;C.zoom("touch",n(p(z,H,$),C.extent,a))}}function O(y,..._){if(this.__zooming){var C=j(this,_).event(y),P=y.changedTouches,N=P.length,I,z;for(gn(y),u&&clearTimeout(u),u=setTimeout(function(){u=null},m),I=0;I<N;++I)z=P[I],C.touch0&&C.touch0[2]===z.identifier?delete C.touch0:C.touch1&&C.touch1[2]===z.identifier&&delete C.touch1;if(C.touch1&&!C.touch0&&(C.touch0=C.touch1,delete C.touch1),C.touch0)C.touch0[1]=this.__zoom.invert(C.touch0[0]);else if(C.end(),C.taps===2&&(z=fe(z,this),Math.hypot(h[0]-z[0],h[1]-z[1])<v)){var H=ue(this).on("dblclick.zoom");H&&H.apply(this,arguments)}}}return x.wheelDelta=function(y){return arguments.length?(s=typeof y=="function"?y:_t(+y),x):s},x.filter=function(y){return arguments.length?(e=typeof y=="function"?y:_t(!!y),x):e},x.touchable=function(y){return arguments.length?(r=typeof y=="function"?y:_t(!!y),x):r},x.extent=function(y){return arguments.length?(t=typeof y=="function"?y:_t([[+y[0][0],+y[0][1]],[+y[1][0],+y[1][1]]]),x):t},x.scaleExtent=function(y){return arguments.length?(i[0]=+y[0],i[1]=+y[1],x):[i[0],i[1]]},x.translateExtent=function(y){return arguments.length?(a[0][0]=+y[0][0],a[1][0]=+y[1][0],a[0][1]=+y[0][1],a[1][1]=+y[1][1],x):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},x.constrain=function(y){return arguments.length?(n=y,x):n},x.duration=function(y){return arguments.length?(c=+y,x):c},x.interpolate=function(y){return arguments.length?(f=y,x):f},x.on=function(){var y=l.on.apply(l,arguments);return y===l?x:y},x.clickDistance=function(y){return arguments.length?(w=(y=+y)*y,x):Math.sqrt(w)},x.tapDistance=function(y){return arguments.length?(v=+y,x):v},x}const pe={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:s})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:s}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},dt=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Wr=["Enter"," ","Escape"],Zr={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var Ye;(function(e){e.Strict="strict",e.Loose="loose"})(Ye||(Ye={}));var De;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(De||(De={}));var ft;(function(e){e.Partial="partial",e.Full="full"})(ft||(ft={}));const qr={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var Ce;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Ce||(Ce={}));var Bt;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Bt||(Bt={}));var W;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(W||(W={}));const Ps={[W.Left]:W.Right,[W.Right]:W.Left,[W.Top]:W.Bottom,[W.Bottom]:W.Top};function Qr(e){return e===null?null:e?"valid":"invalid"}const Ur=e=>"id"in e&&"source"in e&&"target"in e,Ld=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Xn=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),xt=(e,t=[0,0])=>{const{width:n,height:s}=Se(e),r=e.origin??t,i=n*r[0],a=s*r[1];return{x:e.position.x-i,y:e.position.y-a}},zd=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((s,r)=>{const i=typeof r=="string";let a=!t.nodeLookup&&!i?r:void 0;t.nodeLookup&&(a=i?t.nodeLookup.get(r):Xn(r)?r:t.nodeLookup.get(r.id));const c=a?Gt(a,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return Jt(s,c)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return en(n)},yt=(e,t={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},s=!1;return e.forEach(r=>{(t.filter===void 0||t.filter(r))&&(n=Jt(n,Gt(r)),s=!0)}),s?en(n):{x:0,y:0,width:0,height:0}},Wn=(e,t,[n,s,r]=[0,0,1],i=!1,a=!1)=>{const c={...wt(t,[n,s,r]),width:t.width/r,height:t.height/r},f=[];for(const l of e.values()){const{measured:d,selectable:h=!0,hidden:u=!1}=l;if(a&&!h||u)continue;const m=d.width??l.width??l.initialWidth??null,g=d.height??l.height??l.initialHeight??null,w=ht(c,We(l)),v=(m??0)*(g??0),x=i&&w>0;(!l.internals.handleBounds||x||w>=v||l.dragging)&&f.push(l)}return f},Od=(e,t)=>{const n=new Set;return e.forEach(s=>{n.add(s.id)}),t.filter(s=>n.has(s.source)||n.has(s.target))};function $d(e,t){const n=new Map,s=t?.nodes?new Set(t.nodes.map(r=>r.id)):null;return e.forEach(r=>{r.measured.width&&r.measured.height&&(t?.includeHiddenNodes||!r.hidden)&&(!s||s.has(r.id))&&n.set(r.id,r)}),n}async function Hd({nodes:e,width:t,height:n,panZoom:s,minZoom:r,maxZoom:i},a){if(e.size===0)return Promise.resolve(!0);const c=$d(e,a),f=yt(c),l=Zn(f,t,n,a?.minZoom??r,a?.maxZoom??i,a?.padding??.1);return await s.setViewport(l,{duration:a?.duration,ease:a?.ease,interpolate:a?.interpolate}),Promise.resolve(!0)}function Kr({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:s=[0,0],nodeExtent:r,onError:i}){const a=n.get(e),c=a.parentId?n.get(a.parentId):void 0,{x:f,y:l}=c?c.internals.positionAbsolute:{x:0,y:0},d=a.origin??s;let h=a.extent||r;if(a.extent==="parent"&&!a.expandParent)if(!c)i?.("005",pe.error005());else{const m=c.measured.width,g=c.measured.height;m&&g&&(h=[[f,l],[f+m,l+g]])}else c&&Ze(a.extent)&&(h=[[a.extent[0][0]+f,a.extent[0][1]+l],[a.extent[1][0]+f,a.extent[1][1]+l]]);const u=Ze(h)?Le(t,h,a.measured):t;return(a.measured.width===void 0||a.measured.height===void 0)&&i?.("015",pe.error015()),{position:{x:u.x-f+(a.measured.width??0)*d[0],y:u.y-l+(a.measured.height??0)*d[1]},positionAbsolute:u}}async function Fd({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:s,onBeforeDelete:r}){const i=new Set(e.map(u=>u.id)),a=[];for(const u of n){if(u.deletable===!1)continue;const m=i.has(u.id),g=!m&&u.parentId&&a.find(w=>w.id===u.parentId);(m||g)&&a.push(u)}const c=new Set(t.map(u=>u.id)),f=s.filter(u=>u.deletable!==!1),d=Od(a,f);for(const u of f)c.has(u.id)&&!d.find(g=>g.id===u.id)&&d.push(u);if(!r)return{edges:d,nodes:a};const h=await r({nodes:a,edges:d});return typeof h=="boolean"?h?{edges:d,nodes:a}:{edges:[],nodes:[]}:h}const Xe=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Le=(e={x:0,y:0},t,n)=>({x:Xe(e.x,t[0][0],t[1][0]-(n?.width??0)),y:Xe(e.y,t[0][1],t[1][1]-(n?.height??0))});function Jr(e,t,n){const{width:s,height:r}=Se(n),{x:i,y:a}=n.internals.positionAbsolute;return Le(e,[[i,a],[i+s,a+r]],t)}const As=(e,t,n)=>e<t?Xe(Math.abs(e-t),1,t)/t:e>n?-Xe(Math.abs(e-n),1,t)/t:0,eo=(e,t,n=15,s=40)=>{const r=As(e.x,s,t.width-s)*n,i=As(e.y,s,t.height-s)*n;return[r,i]},Jt=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),In=({x:e,y:t,width:n,height:s})=>({x:e,y:t,x2:e+n,y2:t+s}),en=({x:e,y:t,x2:n,y2:s})=>({x:e,y:t,width:n-e,height:s-t}),We=(e,t=[0,0])=>{const{x:n,y:s}=Xn(e)?e.internals.positionAbsolute:xt(e,t);return{x:n,y:s,width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}},Gt=(e,t=[0,0])=>{const{x:n,y:s}=Xn(e)?e.internals.positionAbsolute:xt(e,t);return{x:n,y:s,x2:n+(e.measured?.width??e.width??e.initialWidth??0),y2:s+(e.measured?.height??e.height??e.initialHeight??0)}},to=(e,t)=>en(Jt(In(e),In(t))),ht=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),s=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*s)},Ts=e=>he(e.width)&&he(e.height)&&he(e.x)&&he(e.y),he=e=>!isNaN(e)&&isFinite(e),Vd=(e,t)=>{},bt=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),wt=({x:e,y:t},[n,s,r],i=!1,a=[1,1])=>{const c={x:(e-n)/r,y:(t-s)/r};return i?bt(c,a):c},Yt=({x:e,y:t},[n,s,r])=>({x:e*r+n,y:t*r+s});function $e(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function Bd(e,t,n){if(typeof e=="string"||typeof e=="number"){const s=$e(e,n),r=$e(e,t);return{top:s,right:r,bottom:s,left:r,x:r*2,y:s*2}}if(typeof e=="object"){const s=$e(e.top??e.y??0,n),r=$e(e.bottom??e.y??0,n),i=$e(e.left??e.x??0,t),a=$e(e.right??e.x??0,t);return{top:s,right:a,bottom:r,left:i,x:i+a,y:s+r}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function Gd(e,t,n,s,r,i){const{x:a,y:c}=Yt(e,[t,n,s]),{x:f,y:l}=Yt({x:e.x+e.width,y:e.y+e.height},[t,n,s]),d=r-f,h=i-l;return{left:Math.floor(a),top:Math.floor(c),right:Math.floor(d),bottom:Math.floor(h)}}const Zn=(e,t,n,s,r,i)=>{const a=Bd(i,t,n),c=(t-a.x)/e.width,f=(n-a.y)/e.height,l=Math.min(c,f),d=Xe(l,s,r),h=e.x+e.width/2,u=e.y+e.height/2,m=t/2-h*d,g=n/2-u*d,w=Gd(e,m,g,d,t,n),v={left:Math.min(w.left-a.left,0),top:Math.min(w.top-a.top,0),right:Math.min(w.right-a.right,0),bottom:Math.min(w.bottom-a.bottom,0)};return{x:m-v.left+v.right,y:g-v.top+v.bottom,zoom:d}},mt=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function Ze(e){return e!=null&&e!=="parent"}function Se(e){return{width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}}function no(e){return(e.measured?.width??e.width??e.initialWidth)!==void 0&&(e.measured?.height??e.height??e.initialHeight)!==void 0}function so(e,t={width:0,height:0},n,s,r){const i={...e},a=s.get(n);if(a){const c=a.origin||r;i.x+=a.internals.positionAbsolute.x-(t.width??0)*c[0],i.y+=a.internals.positionAbsolute.y-(t.height??0)*c[1]}return i}function Ds(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Yd(){let e,t;return{promise:new Promise((s,r)=>{e=s,t=r}),resolve:e,reject:t}}function Xd(e){return{...Zr,...e||{}}}function it(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:s,containerBounds:r}){const{x:i,y:a}=me(e),c=wt({x:i-(r?.left??0),y:a-(r?.top??0)},s),{x:f,y:l}=n?bt(c,t):c;return{xSnapped:f,ySnapped:l,...c}}const qn=e=>({width:e.offsetWidth,height:e.offsetHeight}),ro=e=>e?.getRootNode?.()||window?.document,Wd=["INPUT","SELECT","TEXTAREA"];function oo(e){const t=e.composedPath?.()?.[0]||e.target;return t?.nodeType!==1?!1:Wd.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const io=e=>"clientX"in e,me=(e,t)=>{const n=io(e),s=n?e.clientX:e.touches?.[0].clientX,r=n?e.clientY:e.touches?.[0].clientY;return{x:s-(t?.left??0),y:r-(t?.top??0)}},Rs=(e,t,n,s,r)=>{const i=t.querySelectorAll(`.${e}`);return!i||!i.length?null:Array.from(i).map(a=>{const c=a.getBoundingClientRect();return{id:a.getAttribute("data-handleid"),type:e,nodeId:r,position:a.getAttribute("data-handlepos"),x:(c.left-n.left)/s,y:(c.top-n.top)/s,...qn(a)}})};function ao({sourceX:e,sourceY:t,targetX:n,targetY:s,sourceControlX:r,sourceControlY:i,targetControlX:a,targetControlY:c}){const f=e*.125+r*.375+a*.375+n*.125,l=t*.125+i*.375+c*.375+s*.125,d=Math.abs(f-e),h=Math.abs(l-t);return[f,l,d,h]}function Et(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Ls({pos:e,x1:t,y1:n,x2:s,y2:r,c:i}){switch(e){case W.Left:return[t-Et(t-s,i),n];case W.Right:return[t+Et(s-t,i),n];case W.Top:return[t,n-Et(n-r,i)];case W.Bottom:return[t,n+Et(r-n,i)]}}function co({sourceX:e,sourceY:t,sourcePosition:n=W.Bottom,targetX:s,targetY:r,targetPosition:i=W.Top,curvature:a=.25}){const[c,f]=Ls({pos:n,x1:e,y1:t,x2:s,y2:r,c:a}),[l,d]=Ls({pos:i,x1:s,y1:r,x2:e,y2:t,c:a}),[h,u,m,g]=ao({sourceX:e,sourceY:t,targetX:s,targetY:r,sourceControlX:c,sourceControlY:f,targetControlX:l,targetControlY:d});return[`M${e},${t} C${c},${f} ${l},${d} ${s},${r}`,h,u,m,g]}function lo({sourceX:e,sourceY:t,targetX:n,targetY:s}){const r=Math.abs(n-e)/2,i=n<e?n+r:n-r,a=Math.abs(s-t)/2,c=s<t?s+a:s-a;return[i,c,r,a]}function Zd({sourceNode:e,targetNode:t,selected:n=!1,zIndex:s=0,elevateOnSelect:r=!1,zIndexMode:i="basic"}){if(i==="manual")return s;const a=r&&n?s+1e3:s,c=Math.max(e.parentId||r&&e.selected?e.internals.z:0,t.parentId||r&&t.selected?t.internals.z:0);return a+c}function qd({sourceNode:e,targetNode:t,width:n,height:s,transform:r}){const i=Jt(Gt(e),Gt(t));i.x===i.x2&&(i.x2+=1),i.y===i.y2&&(i.y2+=1);const a={x:-r[0]/r[2],y:-r[1]/r[2],width:n/r[2],height:s/r[2]};return ht(a,en(i))>0}const Qd=({source:e,sourceHandle:t,target:n,targetHandle:s})=>`xy-edge__${e}${t||""}-${n}${s||""}`,Ud=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Kd=(e,t,n={})=>{if(!e.source||!e.target)return t;const s=n.getEdgeId||Qd;let r;return Ur(e)?r={...e}:r={...e,id:s(e)},Ud(r,t)?t:(r.sourceHandle===null&&delete r.sourceHandle,r.targetHandle===null&&delete r.targetHandle,t.concat(r))};function uo({sourceX:e,sourceY:t,targetX:n,targetY:s}){const[r,i,a,c]=lo({sourceX:e,sourceY:t,targetX:n,targetY:s});return[`M ${e},${t}L ${n},${s}`,r,i,a,c]}const zs={[W.Left]:{x:-1,y:0},[W.Right]:{x:1,y:0},[W.Top]:{x:0,y:-1},[W.Bottom]:{x:0,y:1}},Jd=({source:e,sourcePosition:t=W.Bottom,target:n})=>t===W.Left||t===W.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Os=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function ef({source:e,sourcePosition:t=W.Bottom,target:n,targetPosition:s=W.Top,center:r,offset:i,stepPosition:a}){const c=zs[t],f=zs[s],l={x:e.x+c.x*i,y:e.y+c.y*i},d={x:n.x+f.x*i,y:n.y+f.y*i},h=Jd({source:l,sourcePosition:t,target:d}),u=h.x!==0?"x":"y",m=h[u];let g=[],w,v;const x={x:0,y:0},S={x:0,y:0},[,,p,b]=lo({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(c[u]*f[u]===-1){u==="x"?(w=r.x??l.x+(d.x-l.x)*a,v=r.y??(l.y+d.y)/2):(w=r.x??(l.x+d.x)/2,v=r.y??l.y+(d.y-l.y)*a);const j=[{x:w,y:l.y},{x:w,y:d.y}],k=[{x:l.x,y:v},{x:d.x,y:v}];c[u]===m?g=u==="x"?j:k:g=u==="x"?k:j}else{const j=[{x:l.x,y:d.y}],k=[{x:d.x,y:l.y}];if(u==="x"?g=c.x===m?k:j:g=c.y===m?j:k,t===s){const R=Math.abs(e[u]-n[u]);if(R<=i){const O=Math.min(i-1,i-R);c[u]===m?x[u]=(l[u]>e[u]?-1:1)*O:S[u]=(d[u]>n[u]?-1:1)*O}}if(t!==s){const R=u==="x"?"y":"x",O=c[u]===f[R],y=l[R]>d[R],_=l[R]<d[R];(c[u]===1&&(!O&&y||O&&_)||c[u]!==1&&(!O&&_||O&&y))&&(g=u==="x"?j:k)}const T={x:l.x+x.x,y:l.y+x.y},D={x:d.x+S.x,y:d.y+S.y},F=Math.max(Math.abs(T.x-g[0].x),Math.abs(D.x-g[0].x)),A=Math.max(Math.abs(T.y-g[0].y),Math.abs(D.y-g[0].y));F>=A?(w=(T.x+D.x)/2,v=g[0].y):(w=g[0].x,v=(T.y+D.y)/2)}return[[e,{x:l.x+x.x,y:l.y+x.y},...g,{x:d.x+S.x,y:d.y+S.y},n],w,v,p,b]}function tf(e,t,n,s){const r=Math.min(Os(e,t)/2,Os(t,n)/2,s),{x:i,y:a}=t;if(e.x===i&&i===n.x||e.y===a&&a===n.y)return`L${i} ${a}`;if(e.y===a){const l=e.x<n.x?-1:1,d=e.y<n.y?1:-1;return`L ${i+r*l},${a}Q ${i},${a} ${i},${a+r*d}`}const c=e.x<n.x?1:-1,f=e.y<n.y?-1:1;return`L ${i},${a+r*f}Q ${i},${a} ${i+r*c},${a}`}function Pn({sourceX:e,sourceY:t,sourcePosition:n=W.Bottom,targetX:s,targetY:r,targetPosition:i=W.Top,borderRadius:a=5,centerX:c,centerY:f,offset:l=20,stepPosition:d=.5}){const[h,u,m,g,w]=ef({source:{x:e,y:t},sourcePosition:n,target:{x:s,y:r},targetPosition:i,center:{x:c,y:f},offset:l,stepPosition:d});return[h.reduce((x,S,p)=>{let b="";return p>0&&p<h.length-1?b=tf(h[p-1],S,h[p+1],a):b=`${p===0?"M":"L"}${S.x} ${S.y}`,x+=b,x},""),u,m,g,w]}function $s(e){return e&&!!(e.internals.handleBounds||e.handles?.length)&&!!(e.measured.width||e.width||e.initialWidth)}function nf(e){const{sourceNode:t,targetNode:n}=e;if(!$s(t)||!$s(n))return null;const s=t.internals.handleBounds||Hs(t.handles),r=n.internals.handleBounds||Hs(n.handles),i=Fs(s?.source??[],e.sourceHandle),a=Fs(e.connectionMode===Ye.Strict?r?.target??[]:(r?.target??[]).concat(r?.source??[]),e.targetHandle);if(!i||!a)return e.onError?.("008",pe.error008(i?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const c=i?.position||W.Bottom,f=a?.position||W.Top,l=ze(t,i,c),d=ze(n,a,f);return{sourceX:l.x,sourceY:l.y,targetX:d.x,targetY:d.y,sourcePosition:c,targetPosition:f}}function Hs(e){if(!e)return null;const t=[],n=[];for(const s of e)s.width=s.width??1,s.height=s.height??1,s.type==="source"?t.push(s):s.type==="target"&&n.push(s);return{source:t,target:n}}function ze(e,t,n=W.Left,s=!1){const r=(t?.x??0)+e.internals.positionAbsolute.x,i=(t?.y??0)+e.internals.positionAbsolute.y,{width:a,height:c}=t??Se(e);if(s)return{x:r+a/2,y:i+c/2};switch(t?.position??n){case W.Top:return{x:r+a/2,y:i};case W.Right:return{x:r+a,y:i+c/2};case W.Bottom:return{x:r+a/2,y:i+c};case W.Left:return{x:r,y:i+c/2}}}function Fs(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function An(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(s=>`${s}=${e[s]}`).join("&")}`:""}function sf(e,{id:t,defaultColor:n,defaultMarkerStart:s,defaultMarkerEnd:r}){const i=new Set;return e.reduce((a,c)=>([c.markerStart||s,c.markerEnd||r].forEach(f=>{if(f&&typeof f=="object"){const l=An(f,t);i.has(l)||(a.push({id:l,color:f.color||n,...f}),i.add(l))}}),a),[]).sort((a,c)=>a.id.localeCompare(c.id))}const fo=1e3,rf=10,Qn={nodeOrigin:[0,0],nodeExtent:dt,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},of={...Qn,checkEquality:!0};function Un(e,t){const n={...e};for(const s in t)t[s]!==void 0&&(n[s]=t[s]);return n}function af(e,t,n){const s=Un(Qn,n);for(const r of e.values())if(r.parentId)Jn(r,e,t,s);else{const i=xt(r,s.nodeOrigin),a=Ze(r.extent)?r.extent:s.nodeExtent,c=Le(i,a,Se(r));r.internals.positionAbsolute=c}}function cf(e,t){if(!e.handles)return e.measured?t?.internals.handleBounds:void 0;const n=[],s=[];for(const r of e.handles){const i={id:r.id,width:r.width??1,height:r.height??1,nodeId:e.id,x:r.x,y:r.y,position:r.position,type:r.type};r.type==="source"?n.push(i):r.type==="target"&&s.push(i)}return{source:n,target:s}}function Kn(e){return e==="manual"}function Tn(e,t,n,s={}){const r=Un(of,s),i={i:0},a=new Map(t),c=r?.elevateNodesOnSelect&&!Kn(r.zIndexMode)?fo:0;let f=e.length>0;t.clear(),n.clear();for(const l of e){let d=a.get(l.id);if(r.checkEquality&&l===d?.internals.userNode)t.set(l.id,d);else{const h=xt(l,r.nodeOrigin),u=Ze(l.extent)?l.extent:r.nodeExtent,m=Le(h,u,Se(l));d={...r.defaults,...l,measured:{width:l.measured?.width,height:l.measured?.height},internals:{positionAbsolute:m,handleBounds:cf(l,d),z:ho(l,c,r.zIndexMode),userNode:l}},t.set(l.id,d)}(d.measured===void 0||d.measured.width===void 0||d.measured.height===void 0)&&!d.hidden&&(f=!1),l.parentId&&Jn(d,t,n,s,i)}return f}function lf(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function Jn(e,t,n,s,r){const{elevateNodesOnSelect:i,nodeOrigin:a,nodeExtent:c,zIndexMode:f}=Un(Qn,s),l=e.parentId,d=t.get(l);if(!d){console.warn(`Parent node ${l} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}lf(e,n),r&&!d.parentId&&d.internals.rootParentIndex===void 0&&f==="auto"&&(d.internals.rootParentIndex=++r.i,d.internals.z=d.internals.z+r.i*rf),r&&d.internals.rootParentIndex!==void 0&&(r.i=d.internals.rootParentIndex);const h=i&&!Kn(f)?fo:0,{x:u,y:m,z:g}=uf(e,d,a,c,h,f),{positionAbsolute:w}=e.internals,v=u!==w.x||m!==w.y;(v||g!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:v?{x:u,y:m}:w,z:g}})}function ho(e,t,n){const s=he(e.zIndex)?e.zIndex:0;return Kn(n)?s:s+(e.selected?t:0)}function uf(e,t,n,s,r,i){const{x:a,y:c}=t.internals.positionAbsolute,f=Se(e),l=xt(e,n),d=Ze(e.extent)?Le(l,e.extent,f):l;let h=Le({x:a+d.x,y:c+d.y},s,f);e.extent==="parent"&&(h=Jr(h,f,t));const u=ho(e,r,i),m=t.internals.z??0;return{x:h.x,y:h.y,z:m>=u?m+1:u}}function es(e,t,n,s=[0,0]){const r=[],i=new Map;for(const a of e){const c=t.get(a.parentId);if(!c)continue;const f=i.get(a.parentId)?.expandedRect??We(c),l=to(f,a.rect);i.set(a.parentId,{expandedRect:l,parent:c})}return i.size>0&&i.forEach(({expandedRect:a,parent:c},f)=>{const l=c.internals.positionAbsolute,d=Se(c),h=c.origin??s,u=a.x<l.x?Math.round(Math.abs(l.x-a.x)):0,m=a.y<l.y?Math.round(Math.abs(l.y-a.y)):0,g=Math.max(d.width,Math.round(a.width)),w=Math.max(d.height,Math.round(a.height)),v=(g-d.width)*h[0],x=(w-d.height)*h[1];(u>0||m>0||v||x)&&(r.push({id:f,type:"position",position:{x:c.position.x-u+v,y:c.position.y-m+x}}),n.get(f)?.forEach(S=>{e.some(p=>p.id===S.id)||r.push({id:S.id,type:"position",position:{x:S.position.x+u,y:S.position.y+m}})})),(d.width<a.width||d.height<a.height||u||m)&&r.push({id:f,type:"dimensions",setAttributes:!0,dimensions:{width:g+(u?h[0]*u-v:0),height:w+(m?h[1]*m-x:0)}})}),r}function df(e,t,n,s,r,i,a){const c=s?.querySelector(".xyflow__viewport");let f=!1;if(!c)return{changes:[],updatedInternals:f};const l=[],d=window.getComputedStyle(c),{m22:h}=new window.DOMMatrixReadOnly(d.transform),u=[];for(const m of e.values()){const g=t.get(m.id);if(!g)continue;if(g.hidden){t.set(g.id,{...g,internals:{...g.internals,handleBounds:void 0}}),f=!0;continue}const w=qn(m.nodeElement),v=g.measured.width!==w.width||g.measured.height!==w.height;if(!!(w.width&&w.height&&(v||!g.internals.handleBounds||m.force))){const S=m.nodeElement.getBoundingClientRect(),p=Ze(g.extent)?g.extent:i;let{positionAbsolute:b}=g.internals;g.parentId&&g.extent==="parent"?b=Jr(b,w,t.get(g.parentId)):p&&(b=Le(b,p,w));const E={...g,measured:w,internals:{...g.internals,positionAbsolute:b,handleBounds:{source:Rs("source",m.nodeElement,S,h,g.id),target:Rs("target",m.nodeElement,S,h,g.id)}}};t.set(g.id,E),g.parentId&&Jn(E,t,n,{nodeOrigin:r,zIndexMode:a}),f=!0,v&&(l.push({id:g.id,type:"dimensions",dimensions:w}),g.expandParent&&g.parentId&&u.push({id:g.id,parentId:g.parentId,rect:We(E,r)}))}}if(u.length>0){const m=es(u,t,n,r);l.push(...m)}return{changes:l,updatedInternals:f}}async function ff({delta:e,panZoom:t,transform:n,translateExtent:s,width:r,height:i}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const a=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[r,i]],s),c=!!a&&(a.x!==n[0]||a.y!==n[1]||a.k!==n[2]);return Promise.resolve(c)}function Vs(e,t,n,s,r,i){let a=r;const c=s.get(a)||new Map;s.set(a,c.set(n,t)),a=`${r}-${e}`;const f=s.get(a)||new Map;if(s.set(a,f.set(n,t)),i){a=`${r}-${e}-${i}`;const l=s.get(a)||new Map;s.set(a,l.set(n,t))}}function mo(e,t,n){e.clear(),t.clear();for(const s of n){const{source:r,target:i,sourceHandle:a=null,targetHandle:c=null}=s,f={edgeId:s.id,source:r,target:i,sourceHandle:a,targetHandle:c},l=`${r}-${a}--${i}-${c}`,d=`${i}-${c}--${r}-${a}`;Vs("source",f,d,e,r,a),Vs("target",f,l,e,i,c),t.set(s.id,s)}}function go(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:go(n,t):!1}function Bs(e,t,n){let s=e;do{if(s?.matches?.(t))return!0;if(s===n)return!1;s=s?.parentElement}while(s);return!1}function hf(e,t,n,s){const r=new Map;for(const[i,a]of e)if((a.selected||a.id===s)&&(!a.parentId||!go(a,e))&&(a.draggable||t&&typeof a.draggable>"u")){const c=e.get(i);c&&r.set(i,{id:i,position:c.position||{x:0,y:0},distance:{x:n.x-c.internals.positionAbsolute.x,y:n.y-c.internals.positionAbsolute.y},extent:c.extent,parentId:c.parentId,origin:c.origin,expandParent:c.expandParent,internals:{positionAbsolute:c.internals.positionAbsolute||{x:0,y:0}},measured:{width:c.measured.width??0,height:c.measured.height??0}})}return r}function pn({nodeId:e,dragItems:t,nodeLookup:n,dragging:s=!0}){const r=[];for(const[a,c]of t){const f=n.get(a)?.internals.userNode;f&&r.push({...f,position:c.position,dragging:s})}if(!e)return[r[0],r];const i=n.get(e)?.internals.userNode;return[i?{...i,position:t.get(e)?.position||i.position,dragging:s}:r[0],r]}function mf({dragItems:e,snapGrid:t,x:n,y:s}){const r=e.values().next().value;if(!r)return null;const i={x:n-r.distance.x,y:s-r.distance.y},a=bt(i,t);return{x:a.x-i.x,y:a.y-i.y}}function gf({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:s,onDragStop:r}){let i={x:null,y:null},a=0,c=new Map,f=!1,l={x:0,y:0},d=null,h=!1,u=null,m=!1,g=!1,w=null;function v({noDragClassName:S,handleSelector:p,domNode:b,isSelectable:E,nodeId:j,nodeClickDistance:k=0}){u=ue(b);function T({x:R,y:O}){const{nodeLookup:y,nodeExtent:_,snapGrid:C,snapToGrid:P,nodeOrigin:N,onNodeDrag:I,onSelectionDrag:z,onError:H,updateNodePositions:$}=t();i={x:R,y:O};let Y=!1;const G=c.size>1,Z=G&&_?In(yt(c)):null,L=G&&P?mf({dragItems:c,snapGrid:C,x:R,y:O}):null;for(const[B,V]of c){if(!y.has(B))continue;let X={x:R-V.distance.x,y:O-V.distance.y};P&&(X=L?{x:Math.round(X.x+L.x),y:Math.round(X.y+L.y)}:bt(X,C));let Q=null;if(G&&_&&!V.extent&&Z){const{positionAbsolute:K}=V.internals,ne=K.x-Z.x+_[0][0],re=K.x+V.measured.width-Z.x2+_[1][0],se=K.y-Z.y+_[0][1],le=K.y+V.measured.height-Z.y2+_[1][1];Q=[[ne,se],[re,le]]}const{position:U,positionAbsolute:q}=Kr({nodeId:B,nextPosition:X,nodeLookup:y,nodeExtent:Q||_,nodeOrigin:N,onError:H});Y=Y||V.position.x!==U.x||V.position.y!==U.y,V.position=U,V.internals.positionAbsolute=q}if(g=g||Y,!!Y&&($(c,!0),w&&(s||I||!j&&z))){const[B,V]=pn({nodeId:j,dragItems:c,nodeLookup:y});s?.(w,c,B,V),I?.(w,B,V),j||z?.(w,V)}}async function D(){if(!d)return;const{transform:R,panBy:O,autoPanSpeed:y,autoPanOnNodeDrag:_}=t();if(!_){f=!1,cancelAnimationFrame(a);return}const[C,P]=eo(l,d,y);(C!==0||P!==0)&&(i.x=(i.x??0)-C/R[2],i.y=(i.y??0)-P/R[2],await O({x:C,y:P})&&T(i)),a=requestAnimationFrame(D)}function F(R){const{nodeLookup:O,multiSelectionActive:y,nodesDraggable:_,transform:C,snapGrid:P,snapToGrid:N,selectNodesOnDrag:I,onNodeDragStart:z,onSelectionDragStart:H,unselectNodesAndEdges:$}=t();h=!0,(!I||!E)&&!y&&j&&(O.get(j)?.selected||$()),E&&I&&j&&e?.(j);const Y=it(R.sourceEvent,{transform:C,snapGrid:P,snapToGrid:N,containerBounds:d});if(i=Y,c=hf(O,_,Y,j),c.size>0&&(n||z||!j&&H)){const[G,Z]=pn({nodeId:j,dragItems:c,nodeLookup:O});n?.(R.sourceEvent,c,G,Z),z?.(R.sourceEvent,G,Z),j||H?.(R.sourceEvent,Z)}}const A=zr().clickDistance(k).on("start",R=>{const{domNode:O,nodeDragThreshold:y,transform:_,snapGrid:C,snapToGrid:P}=t();d=O?.getBoundingClientRect()||null,m=!1,g=!1,w=R.sourceEvent,y===0&&F(R),i=it(R.sourceEvent,{transform:_,snapGrid:C,snapToGrid:P,containerBounds:d}),l=me(R.sourceEvent,d)}).on("drag",R=>{const{autoPanOnNodeDrag:O,transform:y,snapGrid:_,snapToGrid:C,nodeDragThreshold:P,nodeLookup:N}=t(),I=it(R.sourceEvent,{transform:y,snapGrid:_,snapToGrid:C,containerBounds:d});if(w=R.sourceEvent,(R.sourceEvent.type==="touchmove"&&R.sourceEvent.touches.length>1||j&&!N.has(j))&&(m=!0),!m){if(!f&&O&&h&&(f=!0,D()),!h){const z=me(R.sourceEvent,d),H=z.x-l.x,$=z.y-l.y;Math.sqrt(H*H+$*$)>P&&F(R)}(i.x!==I.xSnapped||i.y!==I.ySnapped)&&c&&h&&(l=me(R.sourceEvent,d),T(I))}}).on("end",R=>{if(!(!h||m)&&(f=!1,h=!1,cancelAnimationFrame(a),c.size>0)){const{nodeLookup:O,updateNodePositions:y,onNodeDragStop:_,onSelectionDragStop:C}=t();if(g&&(y(c,!1),g=!1),r||_||!j&&C){const[P,N]=pn({nodeId:j,dragItems:c,nodeLookup:O,dragging:!1});r?.(R.sourceEvent,c,P,N),_?.(R.sourceEvent,P,N),j||C?.(R.sourceEvent,N)}}}).filter(R=>{const O=R.target;return!R.button&&(!S||!Bs(O,`.${S}`,b))&&(!p||Bs(O,p,b))});u.call(A)}function x(){u?.on(".drag",null)}return{update:v,destroy:x}}function pf(e,t,n){const s=[],r={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const i of t.values())ht(r,We(i))>0&&s.push(i);return s}const xf=250;function yf(e,t,n,s){let r=[],i=1/0;const a=pf(e,n,t+xf);for(const c of a){const f=[...c.internals.handleBounds?.source??[],...c.internals.handleBounds?.target??[]];for(const l of f){if(s.nodeId===l.nodeId&&s.type===l.type&&s.id===l.id)continue;const{x:d,y:h}=ze(c,l,l.position,!0),u=Math.sqrt(Math.pow(d-e.x,2)+Math.pow(h-e.y,2));u>t||(u<i?(r=[{...l,x:d,y:h}],i=u):u===i&&r.push({...l,x:d,y:h}))}}if(!r.length)return null;if(r.length>1){const c=s.type==="source"?"target":"source";return r.find(f=>f.type===c)??r[0]}return r[0]}function po(e,t,n,s,r,i=!1){const a=s.get(e);if(!a)return null;const c=r==="strict"?a.internals.handleBounds?.[t]:[...a.internals.handleBounds?.source??[],...a.internals.handleBounds?.target??[]],f=(n?c?.find(l=>l.id===n):c?.[0])??null;return f&&i?{...f,...ze(a,f,f.position,!0)}:f}function xo(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function bf(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const yo=()=>!0;function wf(e,{connectionMode:t,connectionRadius:n,handleId:s,nodeId:r,edgeUpdaterType:i,isTarget:a,domNode:c,nodeLookup:f,lib:l,autoPanOnConnect:d,flowId:h,panBy:u,cancelConnection:m,onConnectStart:g,onConnect:w,onConnectEnd:v,isValidConnection:x=yo,onReconnectEnd:S,updateConnection:p,getTransform:b,getFromHandle:E,autoPanSpeed:j,dragThreshold:k=1,handleDomNode:T}){const D=ro(e.target);let F=0,A;const{x:R,y:O}=me(e),y=xo(i,T),_=c?.getBoundingClientRect();let C=!1;if(!_||!y)return;const P=po(r,y,s,f,t);if(!P)return;let N=me(e,_),I=!1,z=null,H=!1,$=null;function Y(){if(!d||!_)return;const[U,q]=eo(N,_,j);u({x:U,y:q}),F=requestAnimationFrame(Y)}const G={...P,nodeId:r,type:y,position:P.position},Z=f.get(r);let B={inProgress:!0,isValid:null,from:ze(Z,G,W.Left,!0),fromHandle:G,fromPosition:G.position,fromNode:Z,to:N,toHandle:null,toPosition:Ps[G.position],toNode:null,pointer:N};function V(){C=!0,p(B),g?.(e,{nodeId:r,handleId:s,handleType:y})}k===0&&V();function X(U){if(!C){const{x:le,y:je}=me(U),ye=le-R,Me=je-O;if(!(ye*ye+Me*Me>k*k))return;V()}if(!E()||!G){Q(U);return}const q=b();N=me(U,_),A=yf(wt(N,q,!1,[1,1]),n,f,G),I||(Y(),I=!0);const K=bo(U,{handle:A,connectionMode:t,fromNodeId:r,fromHandleId:s,fromType:a?"target":"source",isValidConnection:x,doc:D,lib:l,flowId:h,nodeLookup:f});$=K.handleDomNode,z=K.connection,H=bf(!!A,K.isValid);const ne=f.get(r),re=ne?ze(ne,G,W.Left,!0):B.from,se={...B,from:re,isValid:H,to:K.toHandle&&H?Yt({x:K.toHandle.x,y:K.toHandle.y},q):N,toHandle:K.toHandle,toPosition:H&&K.toHandle?K.toHandle.position:Ps[G.position],toNode:K.toHandle?f.get(K.toHandle.nodeId):null,pointer:N};p(se),B=se}function Q(U){if(!("touches"in U&&U.touches.length>0)){if(C){(A||$)&&z&&H&&w?.(z);const{inProgress:q,...K}=B,ne={...K,toPosition:B.toHandle?B.toPosition:null};v?.(U,ne),i&&S?.(U,ne)}m(),cancelAnimationFrame(F),I=!1,H=!1,z=null,$=null,D.removeEventListener("mousemove",X),D.removeEventListener("mouseup",Q),D.removeEventListener("touchmove",X),D.removeEventListener("touchend",Q)}}D.addEventListener("mousemove",X),D.addEventListener("mouseup",Q),D.addEventListener("touchmove",X),D.addEventListener("touchend",Q)}function bo(e,{handle:t,connectionMode:n,fromNodeId:s,fromHandleId:r,fromType:i,doc:a,lib:c,flowId:f,isValidConnection:l=yo,nodeLookup:d}){const h=i==="target",u=t?a.querySelector(`.${c}-flow__handle[data-id="${f}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:m,y:g}=me(e),w=a.elementFromPoint(m,g),v=w?.classList.contains(`${c}-flow__handle`)?w:u,x={handleDomNode:v,isValid:!1,connection:null,toHandle:null};if(v){const S=xo(void 0,v),p=v.getAttribute("data-nodeid"),b=v.getAttribute("data-handleid"),E=v.classList.contains("connectable"),j=v.classList.contains("connectableend");if(!p||!S)return x;const k={source:h?p:s,sourceHandle:h?b:r,target:h?s:p,targetHandle:h?r:b};x.connection=k;const D=E&&j&&(n===Ye.Strict?h&&S==="source"||!h&&S==="target":p!==s||b!==r);x.isValid=D&&l(k),x.toHandle=po(p,S,b,d,n,!0)}return x}const Dn={onPointerDown:wf,isValid:bo};function vf({domNode:e,panZoom:t,getTransform:n,getViewScale:s}){const r=ue(e);function i({translateExtent:c,width:f,height:l,zoomStep:d=1,pannable:h=!0,zoomable:u=!0,inversePan:m=!1}){const g=p=>{if(p.sourceEvent.type!=="wheel"||!t)return;const b=n(),E=p.sourceEvent.ctrlKey&&mt()?10:1,j=-p.sourceEvent.deltaY*(p.sourceEvent.deltaMode===1?.05:p.sourceEvent.deltaMode?1:.002)*d,k=b[2]*Math.pow(2,j*E);t.scaleTo(k)};let w=[0,0];const v=p=>{(p.sourceEvent.type==="mousedown"||p.sourceEvent.type==="touchstart")&&(w=[p.sourceEvent.clientX??p.sourceEvent.touches[0].clientX,p.sourceEvent.clientY??p.sourceEvent.touches[0].clientY])},x=p=>{const b=n();if(p.sourceEvent.type!=="mousemove"&&p.sourceEvent.type!=="touchmove"||!t)return;const E=[p.sourceEvent.clientX??p.sourceEvent.touches[0].clientX,p.sourceEvent.clientY??p.sourceEvent.touches[0].clientY],j=[E[0]-w[0],E[1]-w[1]];w=E;const k=s()*Math.max(b[2],Math.log(b[2]))*(m?-1:1),T={x:b[0]-j[0]*k,y:b[1]-j[1]*k},D=[[0,0],[f,l]];t.setViewportConstrained({x:T.x,y:T.y,zoom:b[2]},D,c)},S=Xr().on("start",v).on("zoom",h?x:null).on("zoom.wheel",u?g:null);r.call(S,{})}function a(){r.on("zoom",null)}return{update:i,destroy:a,pointer:fe}}const tn=e=>({x:e.x,y:e.y,zoom:e.k}),xn=({x:e,y:t,zoom:n})=>Kt.translate(e,t).scale(n),He=(e,t)=>e.target.closest(`.${t}`),wo=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Nf=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,yn=(e,t=0,n=Nf,s=()=>{})=>{const r=typeof t=="number"&&t>0;return r||s(),r?e.transition().duration(t).ease(n).on("end",s):e},vo=e=>{const t=e.ctrlKey&&mt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function Sf({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:s,panOnScrollMode:r,panOnScrollSpeed:i,zoomOnPinch:a,onPanZoomStart:c,onPanZoom:f,onPanZoomEnd:l}){return d=>{if(He(d,t))return d.ctrlKey&&d.preventDefault(),!1;d.preventDefault(),d.stopImmediatePropagation();const h=n.property("__zoom").k||1;if(d.ctrlKey&&a){const v=fe(d),x=vo(d),S=h*Math.pow(2,x);s.scaleTo(n,S,v,d);return}const u=d.deltaMode===1?20:1;let m=r===De.Vertical?0:d.deltaX*u,g=r===De.Horizontal?0:d.deltaY*u;!mt()&&d.shiftKey&&r!==De.Vertical&&(m=d.deltaY*u,g=0),s.translateBy(n,-(m/h)*i,-(g/h)*i,{internal:!0});const w=tn(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling?(f?.(d,w),e.panScrollTimeout=setTimeout(()=>{l?.(d,w),e.isPanScrolling=!1},150)):(e.isPanScrolling=!0,c?.(d,w))}}function jf({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(s,r){const i=s.type==="wheel",a=!t&&i&&!s.ctrlKey,c=He(s,e);if(s.ctrlKey&&i&&c&&s.preventDefault(),a||c)return null;s.preventDefault(),n.call(this,s,r)}}function _f({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return s=>{if(s.sourceEvent?.internal)return;const r=tn(s.transform);e.mouseButton=s.sourceEvent?.button||0,e.isZoomingOrPanning=!0,e.prevViewport=r,s.sourceEvent?.type==="mousedown"&&t(!0),n&&n?.(s.sourceEvent,r)}}function Ef({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:s,onPanZoom:r}){return i=>{e.usedRightMouseButton=!!(n&&wo(t,e.mouseButton??0)),i.sourceEvent?.sync||s([i.transform.x,i.transform.y,i.transform.k]),r&&!i.sourceEvent?.internal&&r?.(i.sourceEvent,tn(i.transform))}}function Cf({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:s,onPanZoomEnd:r,onPaneContextMenu:i}){return a=>{if(!a.sourceEvent?.internal&&(e.isZoomingOrPanning=!1,i&&wo(t,e.mouseButton??0)&&!e.usedRightMouseButton&&a.sourceEvent&&i(a.sourceEvent),e.usedRightMouseButton=!1,s(!1),r)){const c=tn(a.transform);e.prevViewport=c,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{r?.(a.sourceEvent,c)},n?150:0)}}}function kf({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:s,panOnScroll:r,zoomOnDoubleClick:i,userSelectionActive:a,noWheelClassName:c,noPanClassName:f,lib:l,connectionInProgress:d}){return h=>{const u=e||t,m=n&&h.ctrlKey,g=h.type==="wheel";if(h.button===1&&h.type==="mousedown"&&(He(h,`${l}-flow__node`)||He(h,`${l}-flow__edge`)))return!0;if(!s&&!u&&!r&&!i&&!n||a||d&&!g||He(h,c)&&g||He(h,f)&&(!g||r&&g&&!e)||!n&&h.ctrlKey&&g)return!1;if(!n&&h.type==="touchstart"&&h.touches?.length>1)return h.preventDefault(),!1;if(!u&&!r&&!m&&g||!s&&(h.type==="mousedown"||h.type==="touchstart")||Array.isArray(s)&&!s.includes(h.button)&&h.type==="mousedown")return!1;const w=Array.isArray(s)&&s.includes(h.button)||!h.button||h.button<=1;return(!h.ctrlKey||g)&&w}}function Mf({domNode:e,minZoom:t,maxZoom:n,translateExtent:s,viewport:r,onPanZoom:i,onPanZoomStart:a,onPanZoomEnd:c,onDraggingChange:f}){const l={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},d=e.getBoundingClientRect(),h=Xr().scaleExtent([t,n]).translateExtent(s),u=ue(e).call(h);S({x:r.x,y:r.y,zoom:Xe(r.zoom,t,n)},[[0,0],[d.width,d.height]],s);const m=u.on("wheel.zoom"),g=u.on("dblclick.zoom");h.wheelDelta(vo);function w(A,R){return u?new Promise(O=>{h?.interpolate(R?.interpolate==="linear"?fn:Pt).transform(yn(u,R?.duration,R?.ease,()=>O(!0)),A)}):Promise.resolve(!1)}function v({noWheelClassName:A,noPanClassName:R,onPaneContextMenu:O,userSelectionActive:y,panOnScroll:_,panOnDrag:C,panOnScrollMode:P,panOnScrollSpeed:N,preventScrolling:I,zoomOnPinch:z,zoomOnScroll:H,zoomOnDoubleClick:$,zoomActivationKeyPressed:Y,lib:G,onTransformChange:Z,connectionInProgress:L,paneClickDistance:B,selectionOnDrag:V}){y&&!l.isZoomingOrPanning&&x();const X=_&&!Y&&!y;h.clickDistance(V?1/0:!he(B)||B<0?0:B);const Q=X?Sf({zoomPanValues:l,noWheelClassName:A,d3Selection:u,d3Zoom:h,panOnScrollMode:P,panOnScrollSpeed:N,zoomOnPinch:z,onPanZoomStart:a,onPanZoom:i,onPanZoomEnd:c}):jf({noWheelClassName:A,preventScrolling:I,d3ZoomHandler:m});if(u.on("wheel.zoom",Q,{passive:!1}),!y){const q=_f({zoomPanValues:l,onDraggingChange:f,onPanZoomStart:a});h.on("start",q);const K=Ef({zoomPanValues:l,panOnDrag:C,onPaneContextMenu:!!O,onPanZoom:i,onTransformChange:Z});h.on("zoom",K);const ne=Cf({zoomPanValues:l,panOnDrag:C,panOnScroll:_,onPaneContextMenu:O,onPanZoomEnd:c,onDraggingChange:f});h.on("end",ne)}const U=kf({zoomActivationKeyPressed:Y,panOnDrag:C,zoomOnScroll:H,panOnScroll:_,zoomOnDoubleClick:$,zoomOnPinch:z,userSelectionActive:y,noPanClassName:R,noWheelClassName:A,lib:G,connectionInProgress:L});h.filter(U),$?u.on("dblclick.zoom",g):u.on("dblclick.zoom",null)}function x(){h.on("zoom",null)}async function S(A,R,O){const y=xn(A),_=h?.constrain()(y,R,O);return _&&await w(_),new Promise(C=>C(_))}async function p(A,R){const O=xn(A);return await w(O,R),new Promise(y=>y(O))}function b(A){if(u){const R=xn(A),O=u.property("__zoom");(O.k!==A.zoom||O.x!==A.x||O.y!==A.y)&&h?.transform(u,R,null,{sync:!0})}}function E(){const A=u?Yr(u.node()):{x:0,y:0,k:1};return{x:A.x,y:A.y,zoom:A.k}}function j(A,R){return u?new Promise(O=>{h?.interpolate(R?.interpolate==="linear"?fn:Pt).scaleTo(yn(u,R?.duration,R?.ease,()=>O(!0)),A)}):Promise.resolve(!1)}function k(A,R){return u?new Promise(O=>{h?.interpolate(R?.interpolate==="linear"?fn:Pt).scaleBy(yn(u,R?.duration,R?.ease,()=>O(!0)),A)}):Promise.resolve(!1)}function T(A){h?.scaleExtent(A)}function D(A){h?.translateExtent(A)}function F(A){const R=!he(A)||A<0?0:A;h?.clickDistance(R)}return{update:v,destroy:x,setViewport:p,setViewportConstrained:S,getViewport:E,scaleTo:j,scaleBy:k,setScaleExtent:T,setTranslateExtent:D,syncViewport:b,setClickDistance:F}}var qe;(function(e){e.Line="line",e.Handle="handle"})(qe||(qe={}));function If({width:e,prevWidth:t,height:n,prevHeight:s,affectsX:r,affectsY:i}){const a=e-t,c=n-s,f=[a>0?1:a<0?-1:0,c>0?1:c<0?-1:0];return a&&r&&(f[0]=f[0]*-1),c&&i&&(f[1]=f[1]*-1),f}function Gs(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),s=e.includes("left"),r=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:s,affectsY:r}}function _e(e,t){return Math.max(0,t-e)}function Ee(e,t){return Math.max(0,e-t)}function Ct(e,t,n){return Math.max(0,t-e,e-n)}function Ys(e,t){return e?!t:t}function Pf(e,t,n,s,r,i,a,c){let{affectsX:f,affectsY:l}=t;const{isHorizontal:d,isVertical:h}=t,u=d&&h,{xSnapped:m,ySnapped:g}=n,{minWidth:w,maxWidth:v,minHeight:x,maxHeight:S}=s,{x:p,y:b,width:E,height:j,aspectRatio:k}=e;let T=Math.floor(d?m-e.pointerX:0),D=Math.floor(h?g-e.pointerY:0);const F=E+(f?-T:T),A=j+(l?-D:D),R=-i[0]*E,O=-i[1]*j;let y=Ct(F,w,v),_=Ct(A,x,S);if(a){let N=0,I=0;f&&T<0?N=_e(p+T+R,a[0][0]):!f&&T>0&&(N=Ee(p+F+R,a[1][0])),l&&D<0?I=_e(b+D+O,a[0][1]):!l&&D>0&&(I=Ee(b+A+O,a[1][1])),y=Math.max(y,N),_=Math.max(_,I)}if(c){let N=0,I=0;f&&T>0?N=Ee(p+T,c[0][0]):!f&&T<0&&(N=_e(p+F,c[1][0])),l&&D>0?I=Ee(b+D,c[0][1]):!l&&D<0&&(I=_e(b+A,c[1][1])),y=Math.max(y,N),_=Math.max(_,I)}if(r){if(d){const N=Ct(F/k,x,S)*k;if(y=Math.max(y,N),a){let I=0;!f&&!l||f&&!l&&u?I=Ee(b+O+F/k,a[1][1])*k:I=_e(b+O+(f?T:-T)/k,a[0][1])*k,y=Math.max(y,I)}if(c){let I=0;!f&&!l||f&&!l&&u?I=_e(b+F/k,c[1][1])*k:I=Ee(b+(f?T:-T)/k,c[0][1])*k,y=Math.max(y,I)}}if(h){const N=Ct(A*k,w,v)/k;if(_=Math.max(_,N),a){let I=0;!f&&!l||l&&!f&&u?I=Ee(p+A*k+R,a[1][0])/k:I=_e(p+(l?D:-D)*k+R,a[0][0])/k,_=Math.max(_,I)}if(c){let I=0;!f&&!l||l&&!f&&u?I=_e(p+A*k,c[1][0])/k:I=Ee(p+(l?D:-D)*k,c[0][0])/k,_=Math.max(_,I)}}}D=D+(D<0?_:-_),T=T+(T<0?y:-y),r&&(u?F>A*k?D=(Ys(f,l)?-T:T)/k:T=(Ys(f,l)?-D:D)*k:d?(D=T/k,l=f):(T=D*k,f=l));const C=f?p+T:p,P=l?b+D:b;return{width:E+(f?-T:T),height:j+(l?-D:D),x:i[0]*T*(f?-1:1)+C,y:i[1]*D*(l?-1:1)+P}}const No={width:0,height:0,x:0,y:0},Af={...No,pointerX:0,pointerY:0,aspectRatio:1};function Tf(e){return[[0,0],[e.measured.width,e.measured.height]]}function Df(e,t,n){const s=t.position.x+e.position.x,r=t.position.y+e.position.y,i=e.measured.width??0,a=e.measured.height??0,c=n[0]*i,f=n[1]*a;return[[s-c,r-f],[s+i-c,r+a-f]]}function Rf({domNode:e,nodeId:t,getStoreItems:n,onChange:s,onEnd:r}){const i=ue(e);let a={controlDirection:Gs("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function c({controlPosition:l,boundaries:d,keepAspectRatio:h,resizeDirection:u,onResizeStart:m,onResize:g,onResizeEnd:w,shouldResize:v}){let x={...No},S={...Af};a={boundaries:d,resizeDirection:u,keepAspectRatio:h,controlDirection:Gs(l)};let p,b=null,E=[],j,k,T,D=!1;const F=zr().on("start",A=>{const{nodeLookup:R,transform:O,snapGrid:y,snapToGrid:_,nodeOrigin:C,paneDomNode:P}=n();if(p=R.get(t),!p)return;b=P?.getBoundingClientRect()??null;const{xSnapped:N,ySnapped:I}=it(A.sourceEvent,{transform:O,snapGrid:y,snapToGrid:_,containerBounds:b});x={width:p.measured.width??0,height:p.measured.height??0,x:p.position.x??0,y:p.position.y??0},S={...x,pointerX:N,pointerY:I,aspectRatio:x.width/x.height},j=void 0,p.parentId&&(p.extent==="parent"||p.expandParent)&&(j=R.get(p.parentId),k=j&&p.extent==="parent"?Tf(j):void 0),E=[],T=void 0;for(const[z,H]of R)if(H.parentId===t&&(E.push({id:z,position:{...H.position},extent:H.extent}),H.extent==="parent"||H.expandParent)){const $=Df(H,p,H.origin??C);T?T=[[Math.min($[0][0],T[0][0]),Math.min($[0][1],T[0][1])],[Math.max($[1][0],T[1][0]),Math.max($[1][1],T[1][1])]]:T=$}m?.(A,{...x})}).on("drag",A=>{const{transform:R,snapGrid:O,snapToGrid:y,nodeOrigin:_}=n(),C=it(A.sourceEvent,{transform:R,snapGrid:O,snapToGrid:y,containerBounds:b}),P=[];if(!p)return;const{x:N,y:I,width:z,height:H}=x,$={},Y=p.origin??_,{width:G,height:Z,x:L,y:B}=Pf(S,a.controlDirection,C,a.boundaries,a.keepAspectRatio,Y,k,T),V=G!==z,X=Z!==H,Q=L!==N&&V,U=B!==I&&X;if(!Q&&!U&&!V&&!X)return;if((Q||U||Y[0]===1||Y[1]===1)&&($.x=Q?L:x.x,$.y=U?B:x.y,x.x=$.x,x.y=$.y,E.length>0)){const re=L-N,se=B-I;for(const le of E)le.position={x:le.position.x-re+Y[0]*(G-z),y:le.position.y-se+Y[1]*(Z-H)},P.push(le)}if((V||X)&&($.width=V&&(!a.resizeDirection||a.resizeDirection==="horizontal")?G:x.width,$.height=X&&(!a.resizeDirection||a.resizeDirection==="vertical")?Z:x.height,x.width=$.width,x.height=$.height),j&&p.expandParent){const re=Y[0]*($.width??0);$.x&&$.x<re&&(x.x=re,S.x=S.x-($.x-re));const se=Y[1]*($.height??0);$.y&&$.y<se&&(x.y=se,S.y=S.y-($.y-se))}const q=If({width:x.width,prevWidth:z,height:x.height,prevHeight:H,affectsX:a.controlDirection.affectsX,affectsY:a.controlDirection.affectsY}),K={...x,direction:q};v?.(A,K)!==!1&&(D=!0,g?.(A,K),s($,P))}).on("end",A=>{D&&(w?.(A,{...x}),r?.({...x}),D=!1)});i.call(F)}function f(){i.on(".drag",null)}return{update:c,destroy:f}}const Lf={},Xs=e=>{let t;const n=new Set,s=(d,h)=>{const u=typeof d=="function"?d(t):d;if(!Object.is(u,t)){const m=t;t=h??(typeof u!="object"||u===null)?u:Object.assign({},t,u),n.forEach(g=>g(t,m))}},r=()=>t,f={setState:s,getState:r,getInitialState:()=>l,subscribe:d=>(n.add(d),()=>n.delete(d)),destroy:()=>{(Lf?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},l=t=e(s,r,f);return f},zf=e=>e?Xs(e):Xs,{useDebugValue:Of}=la,{useSyncExternalStoreWithSelector:$f}=ac,Hf=e=>e;function So(e,t=Hf,n){const s=$f(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Of(s),s}const Ws=(e,t)=>{const n=zf(e),s=(r,i=t)=>So(n,r,i);return Object.assign(s,n),s},Ff=(e,t)=>e?Ws(e,t):Ws;function oe(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[s,r]of e)if(!Object.is(r,t.get(s)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const s of e)if(!t.has(s))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const s of n)if(!Object.prototype.hasOwnProperty.call(t,s)||!Object.is(e[s],t[s]))return!1;return!0}const nn=M.createContext(null),Vf=nn.Provider,jo=pe.error001();function te(e,t){const n=M.useContext(nn);if(n===null)throw new Error(jo);return So(n,e,t)}function ie(){const e=M.useContext(nn);if(e===null)throw new Error(jo);return M.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const Zs={display:"none"},Bf={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},_o="react-flow__node-desc",Eo="react-flow__edge-desc",Gf="react-flow__aria-live",Yf=e=>e.ariaLiveMessage,Xf=e=>e.ariaLabelConfig;function Wf({rfId:e}){const t=te(Yf);return o.jsx("div",{id:`${Gf}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Bf,children:t})}function Zf({rfId:e,disableKeyboardA11y:t}){const n=te(Xf);return o.jsxs(o.Fragment,{children:[o.jsx("div",{id:`${_o}-${e}`,style:Zs,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),o.jsx("div",{id:`${Eo}-${e}`,style:Zs,children:n["edge.a11yDescription.default"]}),!t&&o.jsx(Wf,{rfId:e})]})}const sn=M.forwardRef(({position:e="top-left",children:t,className:n,style:s,...r},i)=>{const a=`${e}`.split("-");return o.jsx("div",{className:ce(["react-flow__panel",n,...a]),style:s,ref:i,...r,children:t})});sn.displayName="Panel";function qf({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:o.jsx(sn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:o.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const Qf=e=>{const t=[],n=[];for(const[,s]of e.nodeLookup)s.selected&&t.push(s.internals.userNode);for(const[,s]of e.edgeLookup)s.selected&&n.push(s);return{selectedNodes:t,selectedEdges:n}},kt=e=>e.id;function Uf(e,t){return oe(e.selectedNodes.map(kt),t.selectedNodes.map(kt))&&oe(e.selectedEdges.map(kt),t.selectedEdges.map(kt))}function Kf({onSelectionChange:e}){const t=ie(),{selectedNodes:n,selectedEdges:s}=te(Qf,Uf);return M.useEffect(()=>{const r={nodes:n,edges:s};e?.(r),t.getState().onSelectionChangeHandlers.forEach(i=>i(r))},[n,s,e]),null}const Jf=e=>!!e.onSelectionChangeHandlers;function eh({onSelectionChange:e}){const t=te(Jf);return e||t?o.jsx(Kf,{onSelectionChange:e}):null}const Co=[0,0],th={x:0,y:0,zoom:1},nh=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode"],qs=[...nh,"rfId"],sh=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges}),Qs={translateExtent:dt,nodeOrigin:Co,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function rh(e){const{setNodes:t,setEdges:n,setMinZoom:s,setMaxZoom:r,setTranslateExtent:i,setNodeExtent:a,reset:c,setDefaultNodesAndEdges:f}=te(sh,oe),l=ie();M.useEffect(()=>(f(e.defaultNodes,e.defaultEdges),()=>{d.current=Qs,c()}),[]);const d=M.useRef(Qs);return M.useEffect(()=>{for(const h of qs){const u=e[h],m=d.current[h];u!==m&&(typeof e[h]>"u"||(h==="nodes"?t(u):h==="edges"?n(u):h==="minZoom"?s(u):h==="maxZoom"?r(u):h==="translateExtent"?i(u):h==="nodeExtent"?a(u):h==="ariaLabelConfig"?l.setState({ariaLabelConfig:Xd(u)}):h==="fitView"?l.setState({fitViewQueued:u}):h==="fitViewOptions"?l.setState({fitViewOptions:u}):l.setState({[h]:u})))}d.current=e},qs.map(h=>e[h])),null}function Us(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function oh(e){const[t,n]=M.useState(e==="system"?null:e);return M.useEffect(()=>{if(e!=="system"){n(e);return}const s=Us(),r=()=>n(s?.matches?"dark":"light");return r(),s?.addEventListener("change",r),()=>{s?.removeEventListener("change",r)}},[e]),t!==null?t:Us()?.matches?"dark":"light"}const Ks=typeof document<"u"?document:null;function gt(e=null,t={target:Ks,actInsideInputWithModifier:!0}){const[n,s]=M.useState(!1),r=M.useRef(!1),i=M.useRef(new Set([])),[a,c]=M.useMemo(()=>{if(e!==null){const l=(Array.isArray(e)?e:[e]).filter(h=>typeof h=="string").map(h=>h.replace("+",`
`).replace(`

`,`
+`).split(`
`)),d=l.reduce((h,u)=>h.concat(...u),[]);return[l,d]}return[[],[]]},[e]);return M.useEffect(()=>{const f=t?.target??Ks,l=t?.actInsideInputWithModifier??!0;if(e!==null){const d=m=>{if(r.current=m.ctrlKey||m.metaKey||m.shiftKey||m.altKey,(!r.current||r.current&&!l)&&oo(m))return!1;const w=er(m.code,c);if(i.current.add(m[w]),Js(a,i.current,!1)){const v=m.composedPath?.()?.[0]||m.target,x=v?.nodeName==="BUTTON"||v?.nodeName==="A";t.preventDefault!==!1&&(r.current||!x)&&m.preventDefault(),s(!0)}},h=m=>{const g=er(m.code,c);Js(a,i.current,!0)?(s(!1),i.current.clear()):i.current.delete(m[g]),m.key==="Meta"&&i.current.clear(),r.current=!1},u=()=>{i.current.clear(),s(!1)};return f?.addEventListener("keydown",d),f?.addEventListener("keyup",h),window.addEventListener("blur",u),window.addEventListener("contextmenu",u),()=>{f?.removeEventListener("keydown",d),f?.removeEventListener("keyup",h),window.removeEventListener("blur",u),window.removeEventListener("contextmenu",u)}}},[e,s]),n}function Js(e,t,n){return e.filter(s=>n||s.length===t.size).some(s=>s.every(r=>t.has(r)))}function er(e,t){return t.includes(e)?"code":"key"}const ih=()=>{const e=ie();return M.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:s}=e.getState();return s?s.scaleTo(t,{duration:n?.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[s,r,i],panZoom:a}=e.getState();return a?(await a.setViewport({x:t.x??s,y:t.y??r,zoom:t.zoom??i},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,s]=e.getState().transform;return{x:t,y:n,zoom:s}},setCenter:async(t,n,s)=>e.getState().setCenter(t,n,s),fitBounds:async(t,n)=>{const{width:s,height:r,minZoom:i,maxZoom:a,panZoom:c}=e.getState(),f=Zn(t,s,r,i,a,n?.padding??.1);return c?(await c.setViewport(f,{duration:n?.duration,ease:n?.ease,interpolate:n?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:s,snapGrid:r,snapToGrid:i,domNode:a}=e.getState();if(!a)return t;const{x:c,y:f}=a.getBoundingClientRect(),l={x:t.x-c,y:t.y-f},d=n.snapGrid??r,h=n.snapToGrid??i;return wt(l,s,h,d)},flowToScreenPosition:t=>{const{transform:n,domNode:s}=e.getState();if(!s)return t;const{x:r,y:i}=s.getBoundingClientRect(),a=Yt(t,n);return{x:a.x+r,y:a.y+i}}}),[])};function ko(e,t){const n=[],s=new Map,r=[];for(const i of e)if(i.type==="add"){r.push(i);continue}else if(i.type==="remove"||i.type==="replace")s.set(i.id,[i]);else{const a=s.get(i.id);a?a.push(i):s.set(i.id,[i])}for(const i of t){const a=s.get(i.id);if(!a){n.push(i);continue}if(a[0].type==="remove")continue;if(a[0].type==="replace"){n.push({...a[0].item});continue}const c={...i};for(const f of a)ah(f,c);n.push(c)}return r.length&&r.forEach(i=>{i.index!==void 0?n.splice(i.index,0,{...i.item}):n.push({...i.item})}),n}function ah(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured={...e.dimensions},e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Mo(e,t){return ko(e,t)}function Io(e,t){return ko(e,t)}function Pe(e,t){return{id:e,type:"select",selected:t}}function Fe(e,t=new Set,n=!1){const s=[];for(const[r,i]of e){const a=t.has(r);!(i.selected===void 0&&!a)&&i.selected!==a&&(n&&(i.selected=a),s.push(Pe(i.id,a)))}return s}function tr({items:e=[],lookup:t}){const n=[],s=new Map(e.map(r=>[r.id,r]));for(const[r,i]of e.entries()){const a=t.get(i.id),c=a?.internals?.userNode??a;c!==void 0&&c!==i&&n.push({id:i.id,item:i,type:"replace"}),c===void 0&&n.push({item:i,type:"add",index:r})}for(const[r]of t)s.get(r)===void 0&&n.push({id:r,type:"remove"});return n}function nr(e){return{id:e.id,type:"remove"}}const sr=e=>Ld(e),ch=e=>Ur(e);function Po(e){return M.forwardRef(e)}const lh=typeof window<"u"?M.useLayoutEffect:M.useEffect;function rr(e){const[t,n]=M.useState(BigInt(0)),[s]=M.useState(()=>uh(()=>n(r=>r+BigInt(1))));return lh(()=>{const r=s.get();r.length&&(e(r),s.reset())},[t]),s}function uh(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const Ao=M.createContext(null);function dh({children:e}){const t=ie(),n=M.useCallback(c=>{const{nodes:f=[],setNodes:l,hasDefaultNodes:d,onNodesChange:h,nodeLookup:u,fitViewQueued:m,onNodesChangeMiddlewareMap:g}=t.getState();let w=f;for(const x of c)w=typeof x=="function"?x(w):x;let v=tr({items:w,lookup:u});for(const x of g.values())v=x(v);d&&l(w),v.length>0?h?.(v):m&&window.requestAnimationFrame(()=>{const{fitViewQueued:x,nodes:S,setNodes:p}=t.getState();x&&p(S)})},[]),s=rr(n),r=M.useCallback(c=>{const{edges:f=[],setEdges:l,hasDefaultEdges:d,onEdgesChange:h,edgeLookup:u}=t.getState();let m=f;for(const g of c)m=typeof g=="function"?g(m):g;d?l(m):h&&h(tr({items:m,lookup:u}))},[]),i=rr(r),a=M.useMemo(()=>({nodeQueue:s,edgeQueue:i}),[]);return o.jsx(Ao.Provider,{value:a,children:e})}function fh(){const e=M.useContext(Ao);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const hh=e=>!!e.panZoom;function ts(){const e=ih(),t=ie(),n=fh(),s=te(hh),r=M.useMemo(()=>{const i=h=>t.getState().nodeLookup.get(h),a=h=>{n.nodeQueue.push(h)},c=h=>{n.edgeQueue.push(h)},f=h=>{const{nodeLookup:u,nodeOrigin:m}=t.getState(),g=sr(h)?h:u.get(h.id),w=g.parentId?so(g.position,g.measured,g.parentId,u,m):g.position,v={...g,position:w,width:g.measured?.width??g.width,height:g.measured?.height??g.height};return We(v)},l=(h,u,m={replace:!1})=>{a(g=>g.map(w=>{if(w.id===h){const v=typeof u=="function"?u(w):u;return m.replace&&sr(v)?v:{...w,...v}}return w}))},d=(h,u,m={replace:!1})=>{c(g=>g.map(w=>{if(w.id===h){const v=typeof u=="function"?u(w):u;return m.replace&&ch(v)?v:{...w,...v}}return w}))};return{getNodes:()=>t.getState().nodes.map(h=>({...h})),getNode:h=>i(h)?.internals.userNode,getInternalNode:i,getEdges:()=>{const{edges:h=[]}=t.getState();return h.map(u=>({...u}))},getEdge:h=>t.getState().edgeLookup.get(h),setNodes:a,setEdges:c,addNodes:h=>{const u=Array.isArray(h)?h:[h];n.nodeQueue.push(m=>[...m,...u])},addEdges:h=>{const u=Array.isArray(h)?h:[h];n.edgeQueue.push(m=>[...m,...u])},toObject:()=>{const{nodes:h=[],edges:u=[],transform:m}=t.getState(),[g,w,v]=m;return{nodes:h.map(x=>({...x})),edges:u.map(x=>({...x})),viewport:{x:g,y:w,zoom:v}}},deleteElements:async({nodes:h=[],edges:u=[]})=>{const{nodes:m,edges:g,onNodesDelete:w,onEdgesDelete:v,triggerNodeChanges:x,triggerEdgeChanges:S,onDelete:p,onBeforeDelete:b}=t.getState(),{nodes:E,edges:j}=await Fd({nodesToRemove:h,edgesToRemove:u,nodes:m,edges:g,onBeforeDelete:b}),k=j.length>0,T=E.length>0;if(k){const D=j.map(nr);v?.(j),S(D)}if(T){const D=E.map(nr);w?.(E),x(D)}return(T||k)&&p?.({nodes:E,edges:j}),{deletedNodes:E,deletedEdges:j}},getIntersectingNodes:(h,u=!0,m)=>{const g=Ts(h),w=g?h:f(h),v=m!==void 0;return w?(m||t.getState().nodes).filter(x=>{const S=t.getState().nodeLookup.get(x.id);if(S&&!g&&(x.id===h.id||!S.internals.positionAbsolute))return!1;const p=We(v?x:S),b=ht(p,w);return u&&b>0||b>=p.width*p.height||b>=w.width*w.height}):[]},isNodeIntersecting:(h,u,m=!0)=>{const w=Ts(h)?h:f(h);if(!w)return!1;const v=ht(w,u);return m&&v>0||v>=u.width*u.height||v>=w.width*w.height},updateNode:l,updateNodeData:(h,u,m={replace:!1})=>{l(h,g=>{const w=typeof u=="function"?u(g):u;return m.replace?{...g,data:w}:{...g,data:{...g.data,...w}}},m)},updateEdge:d,updateEdgeData:(h,u,m={replace:!1})=>{d(h,g=>{const w=typeof u=="function"?u(g):u;return m.replace?{...g,data:w}:{...g,data:{...g.data,...w}}},m)},getNodesBounds:h=>{const{nodeLookup:u,nodeOrigin:m}=t.getState();return zd(h,{nodeLookup:u,nodeOrigin:m})},getHandleConnections:({type:h,id:u,nodeId:m})=>Array.from(t.getState().connectionLookup.get(`${m}-${h}${u?`-${u}`:""}`)?.values()??[]),getNodeConnections:({type:h,handleId:u,nodeId:m})=>Array.from(t.getState().connectionLookup.get(`${m}${h?u?`-${h}-${u}`:`-${h}`:""}`)?.values()??[]),fitView:async h=>{const u=t.getState().fitViewResolver??Yd();return t.setState({fitViewQueued:!0,fitViewOptions:h,fitViewResolver:u}),n.nodeQueue.push(m=>[...m]),u.promise}}},[]);return M.useMemo(()=>({...r,...e,viewportInitialized:s}),[s])}const or=e=>e.selected,mh=typeof window<"u"?window:void 0;function gh({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=ie(),{deleteElements:s}=ts(),r=gt(e,{actInsideInputWithModifier:!1}),i=gt(t,{target:mh});M.useEffect(()=>{if(r){const{edges:a,nodes:c}=n.getState();s({nodes:c.filter(or),edges:a.filter(or)}),n.setState({nodesSelectionActive:!1})}},[r]),M.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])}function ph(e){const t=ie();M.useEffect(()=>{const n=()=>{if(!e.current||!(e.current.checkVisibility?.()??!0))return!1;const s=qn(e.current);(s.height===0||s.width===0)&&t.getState().onError?.("004",pe.error004()),t.setState({width:s.width||500,height:s.height||500})};if(e.current){n(),window.addEventListener("resize",n);const s=new ResizeObserver(()=>n());return s.observe(e.current),()=>{window.removeEventListener("resize",n),s&&e.current&&s.unobserve(e.current)}}},[])}const rn={position:"absolute",width:"100%",height:"100%",top:0,left:0},xh=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib,connectionInProgress:e.connection.inProgress});function yh({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:s=!1,panOnScrollSpeed:r=.5,panOnScrollMode:i=De.Free,zoomOnDoubleClick:a=!0,panOnDrag:c=!0,defaultViewport:f,translateExtent:l,minZoom:d,maxZoom:h,zoomActivationKeyCode:u,preventScrolling:m=!0,children:g,noWheelClassName:w,noPanClassName:v,onViewportChange:x,isControlledViewport:S,paneClickDistance:p,selectionOnDrag:b}){const E=ie(),j=M.useRef(null),{userSelectionActive:k,lib:T,connectionInProgress:D}=te(xh,oe),F=gt(u),A=M.useRef();ph(j);const R=M.useCallback(O=>{x?.({x:O[0],y:O[1],zoom:O[2]}),S||E.setState({transform:O})},[x,S]);return M.useEffect(()=>{if(j.current){A.current=Mf({domNode:j.current,minZoom:d,maxZoom:h,translateExtent:l,viewport:f,onDraggingChange:C=>E.setState({paneDragging:C}),onPanZoomStart:(C,P)=>{const{onViewportChangeStart:N,onMoveStart:I}=E.getState();I?.(C,P),N?.(P)},onPanZoom:(C,P)=>{const{onViewportChange:N,onMove:I}=E.getState();I?.(C,P),N?.(P)},onPanZoomEnd:(C,P)=>{const{onViewportChangeEnd:N,onMoveEnd:I}=E.getState();I?.(C,P),N?.(P)}});const{x:O,y,zoom:_}=A.current.getViewport();return E.setState({panZoom:A.current,transform:[O,y,_],domNode:j.current.closest(".react-flow")}),()=>{A.current?.destroy()}}},[]),M.useEffect(()=>{A.current?.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:s,panOnScrollSpeed:r,panOnScrollMode:i,zoomOnDoubleClick:a,panOnDrag:c,zoomActivationKeyPressed:F,preventScrolling:m,noPanClassName:v,userSelectionActive:k,noWheelClassName:w,lib:T,onTransformChange:R,connectionInProgress:D,selectionOnDrag:b,paneClickDistance:p})},[e,t,n,s,r,i,a,c,F,m,v,k,w,T,R,D,b,p]),o.jsx("div",{className:"react-flow__renderer",ref:j,style:rn,children:g})}const bh=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function wh(){const{userSelectionActive:e,userSelectionRect:t}=te(bh,oe);return e&&t?o.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const bn=(e,t)=>n=>{n.target===t.current&&e?.(n)},vh=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function Nh({isSelecting:e,selectionKeyPressed:t,selectionMode:n=ft.Full,panOnDrag:s,paneClickDistance:r,selectionOnDrag:i,onSelectionStart:a,onSelectionEnd:c,onPaneClick:f,onPaneContextMenu:l,onPaneScroll:d,onPaneMouseEnter:h,onPaneMouseMove:u,onPaneMouseLeave:m,children:g}){const w=ie(),{userSelectionActive:v,elementsSelectable:x,dragging:S,connectionInProgress:p}=te(vh,oe),b=x&&(e||v),E=M.useRef(null),j=M.useRef(),k=M.useRef(new Set),T=M.useRef(new Set),D=M.useRef(!1),F=N=>{if(D.current||p){D.current=!1;return}f?.(N),w.getState().resetSelectedElements(),w.setState({nodesSelectionActive:!1})},A=N=>{if(Array.isArray(s)&&s?.includes(2)){N.preventDefault();return}l?.(N)},R=d?N=>d(N):void 0,O=N=>{D.current&&(N.stopPropagation(),D.current=!1)},y=N=>{const{domNode:I}=w.getState();if(j.current=I?.getBoundingClientRect(),!j.current)return;const z=N.target===E.current;if(!z&&!!N.target.closest(".nokey")||!e||!(i&&z||t)||N.button!==0||!N.isPrimary)return;N.target?.setPointerCapture?.(N.pointerId),D.current=!1;const{x:Y,y:G}=me(N.nativeEvent,j.current);w.setState({userSelectionRect:{width:0,height:0,startX:Y,startY:G,x:Y,y:G}}),z||(N.stopPropagation(),N.preventDefault())},_=N=>{const{userSelectionRect:I,transform:z,nodeLookup:H,edgeLookup:$,connectionLookup:Y,triggerNodeChanges:G,triggerEdgeChanges:Z,defaultEdgeOptions:L,resetSelectedElements:B}=w.getState();if(!j.current||!I)return;const{x:V,y:X}=me(N.nativeEvent,j.current),{startX:Q,startY:U}=I;if(!D.current){const se=t?0:r;if(Math.hypot(V-Q,X-U)<=se)return;B(),a?.(N)}D.current=!0;const q={startX:Q,startY:U,x:V<Q?V:Q,y:X<U?X:U,width:Math.abs(V-Q),height:Math.abs(X-U)},K=k.current,ne=T.current;k.current=new Set(Wn(H,q,z,n===ft.Partial,!0).map(se=>se.id)),T.current=new Set;const re=L?.selectable??!0;for(const se of k.current){const le=Y.get(se);if(le)for(const{edgeId:je}of le.values()){const ye=$.get(je);ye&&(ye.selectable??re)&&T.current.add(je)}}if(!Ds(K,k.current)){const se=Fe(H,k.current,!0);G(se)}if(!Ds(ne,T.current)){const se=Fe($,T.current);Z(se)}w.setState({userSelectionRect:q,userSelectionActive:!0,nodesSelectionActive:!1})},C=N=>{N.button===0&&(N.target?.releasePointerCapture?.(N.pointerId),!v&&N.target===E.current&&w.getState().userSelectionRect&&F?.(N),w.setState({userSelectionActive:!1,userSelectionRect:null}),D.current&&(c?.(N),w.setState({nodesSelectionActive:k.current.size>0})))},P=s===!0||Array.isArray(s)&&s.includes(0);return o.jsxs("div",{className:ce(["react-flow__pane",{draggable:P,dragging:S,selection:e}]),onClick:b?void 0:bn(F,E),onContextMenu:bn(A,E),onWheel:bn(R,E),onPointerEnter:b?void 0:h,onPointerMove:b?_:u,onPointerUp:b?C:void 0,onPointerDownCapture:b?y:void 0,onClickCapture:b?O:void 0,onPointerLeave:m,ref:E,style:rn,children:[g,o.jsx(wh,{})]})}function Rn({id:e,store:t,unselect:n=!1,nodeRef:s}){const{addSelectedNodes:r,unselectNodesAndEdges:i,multiSelectionActive:a,nodeLookup:c,onError:f}=t.getState(),l=c.get(e);if(!l){f?.("012",pe.error012(e));return}t.setState({nodesSelectionActive:!1}),l.selected?(n||l.selected&&a)&&(i({nodes:[l],edges:[]}),requestAnimationFrame(()=>s?.current?.blur())):r([e])}function To({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:s,nodeId:r,isSelectable:i,nodeClickDistance:a}){const c=ie(),[f,l]=M.useState(!1),d=M.useRef();return M.useEffect(()=>{d.current=gf({getStoreItems:()=>c.getState(),onNodeMouseDown:h=>{Rn({id:h,store:c,nodeRef:e})},onDragStart:()=>{l(!0)},onDragStop:()=>{l(!1)}})},[]),M.useEffect(()=>{if(t)d.current?.destroy();else if(e.current)return d.current?.update({noDragClassName:n,handleSelector:s,domNode:e.current,isSelectable:i,nodeId:r,nodeClickDistance:a}),()=>{d.current?.destroy()}},[n,s,t,i,e,r]),f}const Sh=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function Do(){const e=ie();return M.useCallback(n=>{const{nodeExtent:s,snapToGrid:r,snapGrid:i,nodesDraggable:a,onError:c,updateNodePositions:f,nodeLookup:l,nodeOrigin:d}=e.getState(),h=new Map,u=Sh(a),m=r?i[0]:5,g=r?i[1]:5,w=n.direction.x*m*n.factor,v=n.direction.y*g*n.factor;for(const[,x]of l){if(!u(x))continue;let S={x:x.internals.positionAbsolute.x+w,y:x.internals.positionAbsolute.y+v};r&&(S=bt(S,i));const{position:p,positionAbsolute:b}=Kr({nodeId:x.id,nextPosition:S,nodeLookup:l,nodeExtent:s,nodeOrigin:d,onError:c});x.position=p,x.internals.positionAbsolute=b,h.set(x.id,x)}f(h)},[])}const ns=M.createContext(null),jh=ns.Provider;ns.Consumer;const Ro=()=>M.useContext(ns),_h=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),Eh=(e,t,n)=>s=>{const{connectionClickStartHandle:r,connectionMode:i,connection:a}=s,{fromHandle:c,toHandle:f,isValid:l}=a,d=f?.nodeId===e&&f?.id===t&&f?.type===n;return{connectingFrom:c?.nodeId===e&&c?.id===t&&c?.type===n,connectingTo:d,clickConnecting:r?.nodeId===e&&r?.id===t&&r?.type===n,isPossibleEndHandle:i===Ye.Strict?c?.type!==n:e!==c?.nodeId||t!==c?.id,connectionInProcess:!!c,clickConnectionInProcess:!!r,valid:d&&l}};function Ch({type:e="source",position:t=W.Top,isValidConnection:n,isConnectable:s=!0,isConnectableStart:r=!0,isConnectableEnd:i=!0,id:a,onConnect:c,children:f,className:l,onMouseDown:d,onTouchStart:h,...u},m){const g=a||null,w=e==="target",v=ie(),x=Ro(),{connectOnClick:S,noPanClassName:p,rfId:b}=te(_h,oe),{connectingFrom:E,connectingTo:j,clickConnecting:k,isPossibleEndHandle:T,connectionInProcess:D,clickConnectionInProcess:F,valid:A}=te(Eh(x,g,e),oe);x||v.getState().onError?.("010",pe.error010());const R=_=>{const{defaultEdgeOptions:C,onConnect:P,hasDefaultEdges:N}=v.getState(),I={...C,..._};if(N){const{edges:z,setEdges:H}=v.getState();H(Kd(I,z))}P?.(I),c?.(I)},O=_=>{if(!x)return;const C=io(_.nativeEvent);if(r&&(C&&_.button===0||!C)){const P=v.getState();Dn.onPointerDown(_.nativeEvent,{handleDomNode:_.currentTarget,autoPanOnConnect:P.autoPanOnConnect,connectionMode:P.connectionMode,connectionRadius:P.connectionRadius,domNode:P.domNode,nodeLookup:P.nodeLookup,lib:P.lib,isTarget:w,handleId:g,nodeId:x,flowId:P.rfId,panBy:P.panBy,cancelConnection:P.cancelConnection,onConnectStart:P.onConnectStart,onConnectEnd:P.onConnectEnd,updateConnection:P.updateConnection,onConnect:R,isValidConnection:n||P.isValidConnection,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,autoPanSpeed:P.autoPanSpeed,dragThreshold:P.connectionDragThreshold})}C?d?.(_):h?.(_)},y=_=>{const{onClickConnectStart:C,onClickConnectEnd:P,connectionClickStartHandle:N,connectionMode:I,isValidConnection:z,lib:H,rfId:$,nodeLookup:Y,connection:G}=v.getState();if(!x||!N&&!r)return;if(!N){C?.(_.nativeEvent,{nodeId:x,handleId:g,handleType:e}),v.setState({connectionClickStartHandle:{nodeId:x,type:e,id:g}});return}const Z=ro(_.target),L=n||z,{connection:B,isValid:V}=Dn.isValid(_.nativeEvent,{handle:{nodeId:x,id:g,type:e},connectionMode:I,fromNodeId:N.nodeId,fromHandleId:N.id||null,fromType:N.type,isValidConnection:L,flowId:$,doc:Z,lib:H,nodeLookup:Y});V&&B&&R(B);const X=structuredClone(G);delete X.inProgress,X.toPosition=X.toHandle?X.toHandle.position:null,P?.(_,X),v.setState({connectionClickStartHandle:null})};return o.jsx("div",{"data-handleid":g,"data-nodeid":x,"data-handlepos":t,"data-id":`${b}-${x}-${g}-${e}`,className:ce(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",p,l,{source:!w,target:w,connectable:s,connectablestart:r,connectableend:i,clickconnecting:k,connectingfrom:E,connectingto:j,valid:A,connectionindicator:s&&(!D||T)&&(D||F?i:r)}]),onMouseDown:O,onTouchStart:O,onClick:S?y:void 0,ref:m,...u,children:f})}const Xt=M.memo(Po(Ch));function kh({data:e,isConnectable:t,sourcePosition:n=W.Bottom}){return o.jsxs(o.Fragment,{children:[e?.label,o.jsx(Xt,{type:"source",position:n,isConnectable:t})]})}function Mh({data:e,isConnectable:t,targetPosition:n=W.Top,sourcePosition:s=W.Bottom}){return o.jsxs(o.Fragment,{children:[o.jsx(Xt,{type:"target",position:n,isConnectable:t}),e?.label,o.jsx(Xt,{type:"source",position:s,isConnectable:t})]})}function Ih(){return null}function Ph({data:e,isConnectable:t,targetPosition:n=W.Top}){return o.jsxs(o.Fragment,{children:[o.jsx(Xt,{type:"target",position:n,isConnectable:t}),e?.label]})}const Wt={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},ir={input:kh,default:Mh,output:Ph,group:Ih};function Ah(e){return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??e.style?.width,height:e.height??e.initialHeight??e.style?.height}:{width:e.width??e.style?.width,height:e.height??e.style?.height}}const Th=e=>{const{width:t,height:n,x:s,y:r}=yt(e.nodeLookup,{filter:i=>!!i.selected});return{width:he(t)?t:null,height:he(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${s}px,${r}px)`}};function Dh({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const s=ie(),{width:r,height:i,transformString:a,userSelectionActive:c}=te(Th,oe),f=Do(),l=M.useRef(null);if(M.useEffect(()=>{n||l.current?.focus({preventScroll:!0})},[n]),To({nodeRef:l}),c||!r||!i)return null;const d=e?u=>{const m=s.getState().nodes.filter(g=>g.selected);e(u,m)}:void 0,h=u=>{Object.prototype.hasOwnProperty.call(Wt,u.key)&&(u.preventDefault(),f({direction:Wt[u.key],factor:u.shiftKey?4:1}))};return o.jsx("div",{className:ce(["react-flow__nodesselection","react-flow__container",t]),style:{transform:a},children:o.jsx("div",{ref:l,className:"react-flow__nodesselection-rect",onContextMenu:d,tabIndex:n?void 0:-1,onKeyDown:n?void 0:h,style:{width:r,height:i}})})}const ar=typeof window<"u"?window:void 0,Rh=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function Lo({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:s,onPaneMouseLeave:r,onPaneContextMenu:i,onPaneScroll:a,paneClickDistance:c,deleteKeyCode:f,selectionKeyCode:l,selectionOnDrag:d,selectionMode:h,onSelectionStart:u,onSelectionEnd:m,multiSelectionKeyCode:g,panActivationKeyCode:w,zoomActivationKeyCode:v,elementsSelectable:x,zoomOnScroll:S,zoomOnPinch:p,panOnScroll:b,panOnScrollSpeed:E,panOnScrollMode:j,zoomOnDoubleClick:k,panOnDrag:T,defaultViewport:D,translateExtent:F,minZoom:A,maxZoom:R,preventScrolling:O,onSelectionContextMenu:y,noWheelClassName:_,noPanClassName:C,disableKeyboardA11y:P,onViewportChange:N,isControlledViewport:I}){const{nodesSelectionActive:z,userSelectionActive:H}=te(Rh,oe),$=gt(l,{target:ar}),Y=gt(w,{target:ar}),G=Y||T,Z=Y||b,L=d&&G!==!0,B=$||H||L;return gh({deleteKeyCode:f,multiSelectionKeyCode:g}),o.jsx(yh,{onPaneContextMenu:i,elementsSelectable:x,zoomOnScroll:S,zoomOnPinch:p,panOnScroll:Z,panOnScrollSpeed:E,panOnScrollMode:j,zoomOnDoubleClick:k,panOnDrag:!$&&G,defaultViewport:D,translateExtent:F,minZoom:A,maxZoom:R,zoomActivationKeyCode:v,preventScrolling:O,noWheelClassName:_,noPanClassName:C,onViewportChange:N,isControlledViewport:I,paneClickDistance:c,selectionOnDrag:L,children:o.jsxs(Nh,{onSelectionStart:u,onSelectionEnd:m,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:s,onPaneMouseLeave:r,onPaneContextMenu:i,onPaneScroll:a,panOnDrag:G,isSelecting:!!B,selectionMode:h,selectionKeyPressed:$,paneClickDistance:c,selectionOnDrag:L,children:[e,z&&o.jsx(Dh,{onSelectionContextMenu:y,noPanClassName:C,disableKeyboardA11y:P})]})})}Lo.displayName="FlowRenderer";const Lh=M.memo(Lo),zh=e=>t=>e?Wn(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function Oh(e){return te(M.useCallback(zh(e),[e]),oe)}const $h=e=>e.updateNodeInternals;function Hh(){const e=te($h),[t]=M.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const s=new Map;n.forEach(r=>{const i=r.target.getAttribute("data-id");s.set(i,{id:i,nodeElement:r.target,force:!0})}),e(s)}));return M.useEffect(()=>()=>{t?.disconnect()},[t]),t}function Fh({node:e,nodeType:t,hasDimensions:n,resizeObserver:s}){const r=ie(),i=M.useRef(null),a=M.useRef(null),c=M.useRef(e.sourcePosition),f=M.useRef(e.targetPosition),l=M.useRef(t),d=n&&!!e.internals.handleBounds;return M.useEffect(()=>{i.current&&!e.hidden&&(!d||a.current!==i.current)&&(a.current&&s?.unobserve(a.current),s?.observe(i.current),a.current=i.current)},[d,e.hidden]),M.useEffect(()=>()=>{a.current&&(s?.unobserve(a.current),a.current=null)},[]),M.useEffect(()=>{if(i.current){const h=l.current!==t,u=c.current!==e.sourcePosition,m=f.current!==e.targetPosition;(h||u||m)&&(l.current=t,c.current=e.sourcePosition,f.current=e.targetPosition,r.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:i.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),i}function Vh({id:e,onClick:t,onMouseEnter:n,onMouseMove:s,onMouseLeave:r,onContextMenu:i,onDoubleClick:a,nodesDraggable:c,elementsSelectable:f,nodesConnectable:l,nodesFocusable:d,resizeObserver:h,noDragClassName:u,noPanClassName:m,disableKeyboardA11y:g,rfId:w,nodeTypes:v,nodeClickDistance:x,onError:S}){const{node:p,internals:b,isParent:E}=te(V=>{const X=V.nodeLookup.get(e),Q=V.parentLookup.has(e);return{node:X,internals:X.internals,isParent:Q}},oe);let j=p.type||"default",k=v?.[j]||ir[j];k===void 0&&(S?.("003",pe.error003(j)),j="default",k=v?.default||ir.default);const T=!!(p.draggable||c&&typeof p.draggable>"u"),D=!!(p.selectable||f&&typeof p.selectable>"u"),F=!!(p.connectable||l&&typeof p.connectable>"u"),A=!!(p.focusable||d&&typeof p.focusable>"u"),R=ie(),O=no(p),y=Fh({node:p,nodeType:j,hasDimensions:O,resizeObserver:h}),_=To({nodeRef:y,disabled:p.hidden||!T,noDragClassName:u,handleSelector:p.dragHandle,nodeId:e,isSelectable:D,nodeClickDistance:x}),C=Do();if(p.hidden)return null;const P=Se(p),N=Ah(p),I=D||T||t||n||s||r,z=n?V=>n(V,{...b.userNode}):void 0,H=s?V=>s(V,{...b.userNode}):void 0,$=r?V=>r(V,{...b.userNode}):void 0,Y=i?V=>i(V,{...b.userNode}):void 0,G=a?V=>a(V,{...b.userNode}):void 0,Z=V=>{const{selectNodesOnDrag:X,nodeDragThreshold:Q}=R.getState();D&&(!X||!T||Q>0)&&Rn({id:e,store:R,nodeRef:y}),t&&t(V,{...b.userNode})},L=V=>{if(!(oo(V.nativeEvent)||g)){if(Wr.includes(V.key)&&D){const X=V.key==="Escape";Rn({id:e,store:R,unselect:X,nodeRef:y})}else if(T&&p.selected&&Object.prototype.hasOwnProperty.call(Wt,V.key)){V.preventDefault();const{ariaLabelConfig:X}=R.getState();R.setState({ariaLiveMessage:X["node.a11yDescription.ariaLiveMessage"]({direction:V.key.replace("Arrow","").toLowerCase(),x:~~b.positionAbsolute.x,y:~~b.positionAbsolute.y})}),C({direction:Wt[V.key],factor:V.shiftKey?4:1})}}},B=()=>{if(g||!y.current?.matches(":focus-visible"))return;const{transform:V,width:X,height:Q,autoPanOnNodeFocus:U,setCenter:q}=R.getState();if(!U)return;Wn(new Map([[e,p]]),{x:0,y:0,width:X,height:Q},V,!0).length>0||q(p.position.x+P.width/2,p.position.y+P.height/2,{zoom:V[2]})};return o.jsx("div",{className:ce(["react-flow__node",`react-flow__node-${j}`,{[m]:T},p.className,{selected:p.selected,selectable:D,parent:E,draggable:T,dragging:_}]),ref:y,style:{zIndex:b.z,transform:`translate(${b.positionAbsolute.x}px,${b.positionAbsolute.y}px)`,pointerEvents:I?"all":"none",visibility:O?"visible":"hidden",...p.style,...N},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:z,onMouseMove:H,onMouseLeave:$,onContextMenu:Y,onClick:Z,onDoubleClick:G,onKeyDown:A?L:void 0,tabIndex:A?0:void 0,onFocus:A?B:void 0,role:p.ariaRole??(A?"group":void 0),"aria-roledescription":"node","aria-describedby":g?void 0:`${_o}-${w}`,"aria-label":p.ariaLabel,...p.domAttributes,children:o.jsx(jh,{value:e,children:o.jsx(k,{id:e,data:p.data,type:j,positionAbsoluteX:b.positionAbsolute.x,positionAbsoluteY:b.positionAbsolute.y,selected:p.selected??!1,selectable:D,draggable:T,deletable:p.deletable??!0,isConnectable:F,sourcePosition:p.sourcePosition,targetPosition:p.targetPosition,dragging:_,dragHandle:p.dragHandle,zIndex:b.z,parentId:p.parentId,...P})})})}var Bh=M.memo(Vh);const Gh=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function zo(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:s,elementsSelectable:r,onError:i}=te(Gh,oe),a=Oh(e.onlyRenderVisibleElements),c=Hh();return o.jsx("div",{className:"react-flow__nodes",style:rn,children:a.map(f=>o.jsx(Bh,{id:f,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:c,nodesDraggable:t,nodesConnectable:n,nodesFocusable:s,elementsSelectable:r,nodeClickDistance:e.nodeClickDistance,onError:i},f))})}zo.displayName="NodeRenderer";const Yh=M.memo(zo);function Xh(e){return te(M.useCallback(n=>{if(!e)return n.edges.map(r=>r.id);const s=[];if(n.width&&n.height)for(const r of n.edges){const i=n.nodeLookup.get(r.source),a=n.nodeLookup.get(r.target);i&&a&&qd({sourceNode:i,targetNode:a,width:n.width,height:n.height,transform:n.transform})&&s.push(r.id)}return s},[e]),oe)}const Wh=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e}};return o.jsx("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},Zh=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e,fill:e}};return o.jsx("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},cr={[Bt.Arrow]:Wh,[Bt.ArrowClosed]:Zh};function qh(e){const t=ie();return M.useMemo(()=>Object.prototype.hasOwnProperty.call(cr,e)?cr[e]:(t.getState().onError?.("009",pe.error009(e)),null),[e])}const Qh=({id:e,type:t,color:n,width:s=12.5,height:r=12.5,markerUnits:i="strokeWidth",strokeWidth:a,orient:c="auto-start-reverse"})=>{const f=qh(t);return f?o.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${s}`,markerHeight:`${r}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:c,refX:"0",refY:"0",children:o.jsx(f,{color:n,strokeWidth:a})}):null},Oo=({defaultColor:e,rfId:t})=>{const n=te(i=>i.edges),s=te(i=>i.defaultEdgeOptions),r=M.useMemo(()=>sf(n,{id:t,defaultColor:e,defaultMarkerStart:s?.markerStart,defaultMarkerEnd:s?.markerEnd}),[n,s,t,e]);return r.length?o.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:o.jsx("defs",{children:r.map(i=>o.jsx(Qh,{id:i.id,type:i.type,color:i.color,width:i.width,height:i.height,markerUnits:i.markerUnits,strokeWidth:i.strokeWidth,orient:i.orient},i.id))})}):null};Oo.displayName="MarkerDefinitions";var Uh=M.memo(Oo);function $o({x:e,y:t,label:n,labelStyle:s,labelShowBg:r=!0,labelBgStyle:i,labelBgPadding:a=[2,4],labelBgBorderRadius:c=2,children:f,className:l,...d}){const[h,u]=M.useState({x:1,y:0,width:0,height:0}),m=ce(["react-flow__edge-textwrapper",l]),g=M.useRef(null);return M.useEffect(()=>{if(g.current){const w=g.current.getBBox();u({x:w.x,y:w.y,width:w.width,height:w.height})}},[n]),n?o.jsxs("g",{transform:`translate(${e-h.width/2} ${t-h.height/2})`,className:m,visibility:h.width?"visible":"hidden",...d,children:[r&&o.jsx("rect",{width:h.width+2*a[0],x:-a[0],y:-a[1],height:h.height+2*a[1],className:"react-flow__edge-textbg",style:i,rx:c,ry:c}),o.jsx("text",{className:"react-flow__edge-text",y:h.height/2,dy:"0.3em",ref:g,style:s,children:n}),f]}):null}$o.displayName="EdgeText";const Kh=M.memo($o);function on({path:e,labelX:t,labelY:n,label:s,labelStyle:r,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:f,interactionWidth:l=20,...d}){return o.jsxs(o.Fragment,{children:[o.jsx("path",{...d,d:e,fill:"none",className:ce(["react-flow__edge-path",d.className])}),l?o.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:l,className:"react-flow__edge-interaction"}):null,s&&he(t)&&he(n)?o.jsx(Kh,{x:t,y:n,label:s,labelStyle:r,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:f}):null]})}function lr({pos:e,x1:t,y1:n,x2:s,y2:r}){return e===W.Left||e===W.Right?[.5*(t+s),n]:[t,.5*(n+r)]}function Ho({sourceX:e,sourceY:t,sourcePosition:n=W.Bottom,targetX:s,targetY:r,targetPosition:i=W.Top}){const[a,c]=lr({pos:n,x1:e,y1:t,x2:s,y2:r}),[f,l]=lr({pos:i,x1:s,y1:r,x2:e,y2:t}),[d,h,u,m]=ao({sourceX:e,sourceY:t,targetX:s,targetY:r,sourceControlX:a,sourceControlY:c,targetControlX:f,targetControlY:l});return[`M${e},${t} C${a},${c} ${f},${l} ${s},${r}`,d,h,u,m]}function Fo(e){return M.memo(({id:t,sourceX:n,sourceY:s,targetX:r,targetY:i,sourcePosition:a,targetPosition:c,label:f,labelStyle:l,labelShowBg:d,labelBgStyle:h,labelBgPadding:u,labelBgBorderRadius:m,style:g,markerEnd:w,markerStart:v,interactionWidth:x})=>{const[S,p,b]=Ho({sourceX:n,sourceY:s,sourcePosition:a,targetX:r,targetY:i,targetPosition:c}),E=e.isInternal?void 0:t;return o.jsx(on,{id:E,path:S,labelX:p,labelY:b,label:f,labelStyle:l,labelShowBg:d,labelBgStyle:h,labelBgPadding:u,labelBgBorderRadius:m,style:g,markerEnd:w,markerStart:v,interactionWidth:x})})}const Jh=Fo({isInternal:!1}),Vo=Fo({isInternal:!0});Jh.displayName="SimpleBezierEdge";Vo.displayName="SimpleBezierEdgeInternal";function Bo(e){return M.memo(({id:t,sourceX:n,sourceY:s,targetX:r,targetY:i,label:a,labelStyle:c,labelShowBg:f,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:h,style:u,sourcePosition:m=W.Bottom,targetPosition:g=W.Top,markerEnd:w,markerStart:v,pathOptions:x,interactionWidth:S})=>{const[p,b,E]=Pn({sourceX:n,sourceY:s,sourcePosition:m,targetX:r,targetY:i,targetPosition:g,borderRadius:x?.borderRadius,offset:x?.offset,stepPosition:x?.stepPosition}),j=e.isInternal?void 0:t;return o.jsx(on,{id:j,path:p,labelX:b,labelY:E,label:a,labelStyle:c,labelShowBg:f,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:h,style:u,markerEnd:w,markerStart:v,interactionWidth:S})})}const Go=Bo({isInternal:!1}),Yo=Bo({isInternal:!0});Go.displayName="SmoothStepEdge";Yo.displayName="SmoothStepEdgeInternal";function Xo(e){return M.memo(({id:t,...n})=>{const s=e.isInternal?void 0:t;return o.jsx(Go,{...n,id:s,pathOptions:M.useMemo(()=>({borderRadius:0,offset:n.pathOptions?.offset}),[n.pathOptions?.offset])})})}const em=Xo({isInternal:!1}),Wo=Xo({isInternal:!0});em.displayName="StepEdge";Wo.displayName="StepEdgeInternal";function Zo(e){return M.memo(({id:t,sourceX:n,sourceY:s,targetX:r,targetY:i,label:a,labelStyle:c,labelShowBg:f,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:h,style:u,markerEnd:m,markerStart:g,interactionWidth:w})=>{const[v,x,S]=uo({sourceX:n,sourceY:s,targetX:r,targetY:i}),p=e.isInternal?void 0:t;return o.jsx(on,{id:p,path:v,labelX:x,labelY:S,label:a,labelStyle:c,labelShowBg:f,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:h,style:u,markerEnd:m,markerStart:g,interactionWidth:w})})}const tm=Zo({isInternal:!1}),qo=Zo({isInternal:!0});tm.displayName="StraightEdge";qo.displayName="StraightEdgeInternal";function Qo(e){return M.memo(({id:t,sourceX:n,sourceY:s,targetX:r,targetY:i,sourcePosition:a=W.Bottom,targetPosition:c=W.Top,label:f,labelStyle:l,labelShowBg:d,labelBgStyle:h,labelBgPadding:u,labelBgBorderRadius:m,style:g,markerEnd:w,markerStart:v,pathOptions:x,interactionWidth:S})=>{const[p,b,E]=co({sourceX:n,sourceY:s,sourcePosition:a,targetX:r,targetY:i,targetPosition:c,curvature:x?.curvature}),j=e.isInternal?void 0:t;return o.jsx(on,{id:j,path:p,labelX:b,labelY:E,label:f,labelStyle:l,labelShowBg:d,labelBgStyle:h,labelBgPadding:u,labelBgBorderRadius:m,style:g,markerEnd:w,markerStart:v,interactionWidth:S})})}const nm=Qo({isInternal:!1}),Uo=Qo({isInternal:!0});nm.displayName="BezierEdge";Uo.displayName="BezierEdgeInternal";const ur={default:Uo,straight:qo,step:Wo,smoothstep:Yo,simplebezier:Vo},dr={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},sm=(e,t,n)=>n===W.Left?e-t:n===W.Right?e+t:e,rm=(e,t,n)=>n===W.Top?e-t:n===W.Bottom?e+t:e,fr="react-flow__edgeupdater";function hr({position:e,centerX:t,centerY:n,radius:s=10,onMouseDown:r,onMouseEnter:i,onMouseOut:a,type:c}){return o.jsx("circle",{onMouseDown:r,onMouseEnter:i,onMouseOut:a,className:ce([fr,`${fr}-${c}`]),cx:sm(t,s,e),cy:rm(n,s,e),r:s,stroke:"transparent",fill:"transparent"})}function om({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:s,sourceY:r,targetX:i,targetY:a,sourcePosition:c,targetPosition:f,onReconnect:l,onReconnectStart:d,onReconnectEnd:h,setReconnecting:u,setUpdateHover:m}){const g=ie(),w=(b,E)=>{if(b.button!==0)return;const{autoPanOnConnect:j,domNode:k,isValidConnection:T,connectionMode:D,connectionRadius:F,lib:A,onConnectStart:R,onConnectEnd:O,cancelConnection:y,nodeLookup:_,rfId:C,panBy:P,updateConnection:N}=g.getState(),I=E.type==="target",z=(Y,G)=>{u(!1),h?.(Y,n,E.type,G)},H=Y=>l?.(n,Y),$=(Y,G)=>{u(!0),d?.(b,n,E.type),R?.(Y,G)};Dn.onPointerDown(b.nativeEvent,{autoPanOnConnect:j,connectionMode:D,connectionRadius:F,domNode:k,handleId:E.id,nodeId:E.nodeId,nodeLookup:_,isTarget:I,edgeUpdaterType:E.type,lib:A,flowId:C,cancelConnection:y,panBy:P,isValidConnection:T,onConnect:H,onConnectStart:$,onConnectEnd:O,onReconnectEnd:z,updateConnection:N,getTransform:()=>g.getState().transform,getFromHandle:()=>g.getState().connection.fromHandle,dragThreshold:g.getState().connectionDragThreshold,handleDomNode:b.currentTarget})},v=b=>w(b,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),x=b=>w(b,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),S=()=>m(!0),p=()=>m(!1);return o.jsxs(o.Fragment,{children:[(e===!0||e==="source")&&o.jsx(hr,{position:c,centerX:s,centerY:r,radius:t,onMouseDown:v,onMouseEnter:S,onMouseOut:p,type:"source"}),(e===!0||e==="target")&&o.jsx(hr,{position:f,centerX:i,centerY:a,radius:t,onMouseDown:x,onMouseEnter:S,onMouseOut:p,type:"target"})]})}function im({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:s,onClick:r,onDoubleClick:i,onContextMenu:a,onMouseEnter:c,onMouseMove:f,onMouseLeave:l,reconnectRadius:d,onReconnect:h,onReconnectStart:u,onReconnectEnd:m,rfId:g,edgeTypes:w,noPanClassName:v,onError:x,disableKeyboardA11y:S}){let p=te(q=>q.edgeLookup.get(e));const b=te(q=>q.defaultEdgeOptions);p=b?{...b,...p}:p;let E=p.type||"default",j=w?.[E]||ur[E];j===void 0&&(x?.("011",pe.error011(E)),E="default",j=w?.default||ur.default);const k=!!(p.focusable||t&&typeof p.focusable>"u"),T=typeof h<"u"&&(p.reconnectable||n&&typeof p.reconnectable>"u"),D=!!(p.selectable||s&&typeof p.selectable>"u"),F=M.useRef(null),[A,R]=M.useState(!1),[O,y]=M.useState(!1),_=ie(),{zIndex:C,sourceX:P,sourceY:N,targetX:I,targetY:z,sourcePosition:H,targetPosition:$}=te(M.useCallback(q=>{const K=q.nodeLookup.get(p.source),ne=q.nodeLookup.get(p.target);if(!K||!ne)return{zIndex:p.zIndex,...dr};const re=nf({id:e,sourceNode:K,targetNode:ne,sourceHandle:p.sourceHandle||null,targetHandle:p.targetHandle||null,connectionMode:q.connectionMode,onError:x});return{zIndex:Zd({selected:p.selected,zIndex:p.zIndex,sourceNode:K,targetNode:ne,elevateOnSelect:q.elevateEdgesOnSelect,zIndexMode:q.zIndexMode}),...re||dr}},[p.source,p.target,p.sourceHandle,p.targetHandle,p.selected,p.zIndex]),oe),Y=M.useMemo(()=>p.markerStart?`url('#${An(p.markerStart,g)}')`:void 0,[p.markerStart,g]),G=M.useMemo(()=>p.markerEnd?`url('#${An(p.markerEnd,g)}')`:void 0,[p.markerEnd,g]);if(p.hidden||P===null||N===null||I===null||z===null)return null;const Z=q=>{const{addSelectedEdges:K,unselectNodesAndEdges:ne,multiSelectionActive:re}=_.getState();D&&(_.setState({nodesSelectionActive:!1}),p.selected&&re?(ne({nodes:[],edges:[p]}),F.current?.blur()):K([e])),r&&r(q,p)},L=i?q=>{i(q,{...p})}:void 0,B=a?q=>{a(q,{...p})}:void 0,V=c?q=>{c(q,{...p})}:void 0,X=f?q=>{f(q,{...p})}:void 0,Q=l?q=>{l(q,{...p})}:void 0,U=q=>{if(!S&&Wr.includes(q.key)&&D){const{unselectNodesAndEdges:K,addSelectedEdges:ne}=_.getState();q.key==="Escape"?(F.current?.blur(),K({edges:[p]})):ne([e])}};return o.jsx("svg",{style:{zIndex:C},children:o.jsxs("g",{className:ce(["react-flow__edge",`react-flow__edge-${E}`,p.className,v,{selected:p.selected,animated:p.animated,inactive:!D&&!r,updating:A,selectable:D}]),onClick:Z,onDoubleClick:L,onContextMenu:B,onMouseEnter:V,onMouseMove:X,onMouseLeave:Q,onKeyDown:k?U:void 0,tabIndex:k?0:void 0,role:p.ariaRole??(k?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":p.ariaLabel===null?void 0:p.ariaLabel||`Edge from ${p.source} to ${p.target}`,"aria-describedby":k?`${Eo}-${g}`:void 0,ref:F,...p.domAttributes,children:[!O&&o.jsx(j,{id:e,source:p.source,target:p.target,type:p.type,selected:p.selected,animated:p.animated,selectable:D,deletable:p.deletable??!0,label:p.label,labelStyle:p.labelStyle,labelShowBg:p.labelShowBg,labelBgStyle:p.labelBgStyle,labelBgPadding:p.labelBgPadding,labelBgBorderRadius:p.labelBgBorderRadius,sourceX:P,sourceY:N,targetX:I,targetY:z,sourcePosition:H,targetPosition:$,data:p.data,style:p.style,sourceHandleId:p.sourceHandle,targetHandleId:p.targetHandle,markerStart:Y,markerEnd:G,pathOptions:"pathOptions"in p?p.pathOptions:void 0,interactionWidth:p.interactionWidth}),T&&o.jsx(om,{edge:p,isReconnectable:T,reconnectRadius:d,onReconnect:h,onReconnectStart:u,onReconnectEnd:m,sourceX:P,sourceY:N,targetX:I,targetY:z,sourcePosition:H,targetPosition:$,setUpdateHover:R,setReconnecting:y})]})})}var am=M.memo(im);const cm=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function Ko({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:s,noPanClassName:r,onReconnect:i,onEdgeContextMenu:a,onEdgeMouseEnter:c,onEdgeMouseMove:f,onEdgeMouseLeave:l,onEdgeClick:d,reconnectRadius:h,onEdgeDoubleClick:u,onReconnectStart:m,onReconnectEnd:g,disableKeyboardA11y:w}){const{edgesFocusable:v,edgesReconnectable:x,elementsSelectable:S,onError:p}=te(cm,oe),b=Xh(t);return o.jsxs("div",{className:"react-flow__edges",children:[o.jsx(Uh,{defaultColor:e,rfId:n}),b.map(E=>o.jsx(am,{id:E,edgesFocusable:v,edgesReconnectable:x,elementsSelectable:S,noPanClassName:r,onReconnect:i,onContextMenu:a,onMouseEnter:c,onMouseMove:f,onMouseLeave:l,onClick:d,reconnectRadius:h,onDoubleClick:u,onReconnectStart:m,onReconnectEnd:g,rfId:n,onError:p,edgeTypes:s,disableKeyboardA11y:w},E))]})}Ko.displayName="EdgeRenderer";const lm=M.memo(Ko),um=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function dm({children:e}){const t=te(um);return o.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function fm(e){const t=ts(),n=M.useRef(!1);M.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const hm=e=>e.panZoom?.syncViewport;function mm(e){const t=te(hm),n=ie();return M.useEffect(()=>{e&&(t?.(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function gm(e){return e.connection.inProgress?{...e.connection,to:wt(e.connection.to,e.transform)}:{...e.connection}}function pm(e){return gm}function xm(e){const t=pm();return te(t,oe)}const ym=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function bm({containerStyle:e,style:t,type:n,component:s}){const{nodesConnectable:r,width:i,height:a,isValid:c,inProgress:f}=te(ym,oe);return!(i&&r&&f)?null:o.jsx("svg",{style:e,width:i,height:a,className:"react-flow__connectionline react-flow__container",children:o.jsx("g",{className:ce(["react-flow__connection",Qr(c)]),children:o.jsx(Jo,{style:t,type:n,CustomComponent:s,isValid:c})})})}const Jo=({style:e,type:t=Ce.Bezier,CustomComponent:n,isValid:s})=>{const{inProgress:r,from:i,fromNode:a,fromHandle:c,fromPosition:f,to:l,toNode:d,toHandle:h,toPosition:u,pointer:m}=xm();if(!r)return;if(n)return o.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:a,fromHandle:c,fromX:i.x,fromY:i.y,toX:l.x,toY:l.y,fromPosition:f,toPosition:u,connectionStatus:Qr(s),toNode:d,toHandle:h,pointer:m});let g="";const w={sourceX:i.x,sourceY:i.y,sourcePosition:f,targetX:l.x,targetY:l.y,targetPosition:u};switch(t){case Ce.Bezier:[g]=co(w);break;case Ce.SimpleBezier:[g]=Ho(w);break;case Ce.Step:[g]=Pn({...w,borderRadius:0});break;case Ce.SmoothStep:[g]=Pn(w);break;default:[g]=uo(w)}return o.jsx("path",{d:g,fill:"none",className:"react-flow__connection-path",style:e})};Jo.displayName="ConnectionLine";const wm={};function mr(e=wm){M.useRef(e),ie(),M.useEffect(()=>{},[e])}function vm(){ie(),M.useRef(!1),M.useEffect(()=>{},[])}function ei({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:s,onEdgeClick:r,onNodeDoubleClick:i,onEdgeDoubleClick:a,onNodeMouseEnter:c,onNodeMouseMove:f,onNodeMouseLeave:l,onNodeContextMenu:d,onSelectionContextMenu:h,onSelectionStart:u,onSelectionEnd:m,connectionLineType:g,connectionLineStyle:w,connectionLineComponent:v,connectionLineContainerStyle:x,selectionKeyCode:S,selectionOnDrag:p,selectionMode:b,multiSelectionKeyCode:E,panActivationKeyCode:j,zoomActivationKeyCode:k,deleteKeyCode:T,onlyRenderVisibleElements:D,elementsSelectable:F,defaultViewport:A,translateExtent:R,minZoom:O,maxZoom:y,preventScrolling:_,defaultMarkerColor:C,zoomOnScroll:P,zoomOnPinch:N,panOnScroll:I,panOnScrollSpeed:z,panOnScrollMode:H,zoomOnDoubleClick:$,panOnDrag:Y,onPaneClick:G,onPaneMouseEnter:Z,onPaneMouseMove:L,onPaneMouseLeave:B,onPaneScroll:V,onPaneContextMenu:X,paneClickDistance:Q,nodeClickDistance:U,onEdgeContextMenu:q,onEdgeMouseEnter:K,onEdgeMouseMove:ne,onEdgeMouseLeave:re,reconnectRadius:se,onReconnect:le,onReconnectStart:je,onReconnectEnd:ye,noDragClassName:Me,noWheelClassName:Ue,noPanClassName:Ke,disableKeyboardA11y:Je,nodeExtent:an,rfId:vt,viewport:Oe,onViewportChange:et}){return mr(e),mr(t),vm(),fm(n),mm(Oe),o.jsx(Lh,{onPaneClick:G,onPaneMouseEnter:Z,onPaneMouseMove:L,onPaneMouseLeave:B,onPaneContextMenu:X,onPaneScroll:V,paneClickDistance:Q,deleteKeyCode:T,selectionKeyCode:S,selectionOnDrag:p,selectionMode:b,onSelectionStart:u,onSelectionEnd:m,multiSelectionKeyCode:E,panActivationKeyCode:j,zoomActivationKeyCode:k,elementsSelectable:F,zoomOnScroll:P,zoomOnPinch:N,zoomOnDoubleClick:$,panOnScroll:I,panOnScrollSpeed:z,panOnScrollMode:H,panOnDrag:Y,defaultViewport:A,translateExtent:R,minZoom:O,maxZoom:y,onSelectionContextMenu:h,preventScrolling:_,noDragClassName:Me,noWheelClassName:Ue,noPanClassName:Ke,disableKeyboardA11y:Je,onViewportChange:et,isControlledViewport:!!Oe,children:o.jsxs(dm,{children:[o.jsx(lm,{edgeTypes:t,onEdgeClick:r,onEdgeDoubleClick:a,onReconnect:le,onReconnectStart:je,onReconnectEnd:ye,onlyRenderVisibleElements:D,onEdgeContextMenu:q,onEdgeMouseEnter:K,onEdgeMouseMove:ne,onEdgeMouseLeave:re,reconnectRadius:se,defaultMarkerColor:C,noPanClassName:Ke,disableKeyboardA11y:Je,rfId:vt}),o.jsx(bm,{style:w,type:g,component:v,containerStyle:x}),o.jsx("div",{className:"react-flow__edgelabel-renderer"}),o.jsx(Yh,{nodeTypes:e,onNodeClick:s,onNodeDoubleClick:i,onNodeMouseEnter:c,onNodeMouseMove:f,onNodeMouseLeave:l,onNodeContextMenu:d,nodeClickDistance:U,onlyRenderVisibleElements:D,noPanClassName:Ke,noDragClassName:Me,disableKeyboardA11y:Je,nodeExtent:an,rfId:vt}),o.jsx("div",{className:"react-flow__viewport-portal"})]})})}ei.displayName="GraphView";const Nm=M.memo(ei),gr=({nodes:e,edges:t,defaultNodes:n,defaultEdges:s,width:r,height:i,fitView:a,fitViewOptions:c,minZoom:f=.5,maxZoom:l=2,nodeOrigin:d,nodeExtent:h,zIndexMode:u="basic"}={})=>{const m=new Map,g=new Map,w=new Map,v=new Map,x=s??t??[],S=n??e??[],p=d??[0,0],b=h??dt;mo(w,v,x);const E=Tn(S,m,g,{nodeOrigin:p,nodeExtent:b,zIndexMode:u});let j=[0,0,1];if(a&&r&&i){const k=yt(m,{filter:A=>!!((A.width||A.initialWidth)&&(A.height||A.initialHeight))}),{x:T,y:D,zoom:F}=Zn(k,r,i,f,l,c?.padding??.1);j=[T,D,F]}return{rfId:"1",width:r??0,height:i??0,transform:j,nodes:S,nodesInitialized:E,nodeLookup:m,parentLookup:g,edges:x,edgeLookup:v,connectionLookup:w,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:s!==void 0,panZoom:null,minZoom:f,maxZoom:l,translateExtent:dt,nodeExtent:b,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Ye.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:p,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:a??!1,fitViewOptions:c,fitViewResolver:null,connection:{...qr},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:Vd,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:Zr,zIndexMode:u,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}},Sm=({nodes:e,edges:t,defaultNodes:n,defaultEdges:s,width:r,height:i,fitView:a,fitViewOptions:c,minZoom:f,maxZoom:l,nodeOrigin:d,nodeExtent:h,zIndexMode:u})=>Ff((m,g)=>{async function w(){const{nodeLookup:v,panZoom:x,fitViewOptions:S,fitViewResolver:p,width:b,height:E,minZoom:j,maxZoom:k}=g();x&&(await Hd({nodes:v,width:b,height:E,panZoom:x,minZoom:j,maxZoom:k},S),p?.resolve(!0),m({fitViewResolver:null}))}return{...gr({nodes:e,edges:t,width:r,height:i,fitView:a,fitViewOptions:c,minZoom:f,maxZoom:l,nodeOrigin:d,nodeExtent:h,defaultNodes:n,defaultEdges:s,zIndexMode:u}),setNodes:v=>{const{nodeLookup:x,parentLookup:S,nodeOrigin:p,elevateNodesOnSelect:b,fitViewQueued:E,zIndexMode:j}=g(),k=Tn(v,x,S,{nodeOrigin:p,nodeExtent:h,elevateNodesOnSelect:b,checkEquality:!0,zIndexMode:j});E&&k?(w(),m({nodes:v,nodesInitialized:k,fitViewQueued:!1,fitViewOptions:void 0})):m({nodes:v,nodesInitialized:k})},setEdges:v=>{const{connectionLookup:x,edgeLookup:S}=g();mo(x,S,v),m({edges:v})},setDefaultNodesAndEdges:(v,x)=>{if(v){const{setNodes:S}=g();S(v),m({hasDefaultNodes:!0})}if(x){const{setEdges:S}=g();S(x),m({hasDefaultEdges:!0})}},updateNodeInternals:v=>{const{triggerNodeChanges:x,nodeLookup:S,parentLookup:p,domNode:b,nodeOrigin:E,nodeExtent:j,debug:k,fitViewQueued:T,zIndexMode:D}=g(),{changes:F,updatedInternals:A}=df(v,S,p,b,E,j,D);A&&(af(S,p,{nodeOrigin:E,nodeExtent:j,zIndexMode:D}),T?(w(),m({fitViewQueued:!1,fitViewOptions:void 0})):m({}),F?.length>0&&(k&&console.log("React Flow: trigger node changes",F),x?.(F)))},updateNodePositions:(v,x=!1)=>{const S=[];let p=[];const{nodeLookup:b,triggerNodeChanges:E,connection:j,updateConnection:k,onNodesChangeMiddlewareMap:T}=g();for(const[D,F]of v){const A=b.get(D),R=!!(A?.expandParent&&A?.parentId&&F?.position),O={id:D,type:"position",position:R?{x:Math.max(0,F.position.x),y:Math.max(0,F.position.y)}:F.position,dragging:x};if(A&&j.inProgress&&j.fromNode.id===A.id){const y=ze(A,j.fromHandle,W.Left,!0);k({...j,from:y})}R&&A.parentId&&S.push({id:D,parentId:A.parentId,rect:{...F.internals.positionAbsolute,width:F.measured.width??0,height:F.measured.height??0}}),p.push(O)}if(S.length>0){const{parentLookup:D,nodeOrigin:F}=g(),A=es(S,b,D,F);p.push(...A)}for(const D of T.values())p=D(p);E(p)},triggerNodeChanges:v=>{const{onNodesChange:x,setNodes:S,nodes:p,hasDefaultNodes:b,debug:E}=g();if(v?.length){if(b){const j=Mo(v,p);S(j)}E&&console.log("React Flow: trigger node changes",v),x?.(v)}},triggerEdgeChanges:v=>{const{onEdgesChange:x,setEdges:S,edges:p,hasDefaultEdges:b,debug:E}=g();if(v?.length){if(b){const j=Io(v,p);S(j)}E&&console.log("React Flow: trigger edge changes",v),x?.(v)}},addSelectedNodes:v=>{const{multiSelectionActive:x,edgeLookup:S,nodeLookup:p,triggerNodeChanges:b,triggerEdgeChanges:E}=g();if(x){const j=v.map(k=>Pe(k,!0));b(j);return}b(Fe(p,new Set([...v]),!0)),E(Fe(S))},addSelectedEdges:v=>{const{multiSelectionActive:x,edgeLookup:S,nodeLookup:p,triggerNodeChanges:b,triggerEdgeChanges:E}=g();if(x){const j=v.map(k=>Pe(k,!0));E(j);return}E(Fe(S,new Set([...v]))),b(Fe(p,new Set,!0))},unselectNodesAndEdges:({nodes:v,edges:x}={})=>{const{edges:S,nodes:p,nodeLookup:b,triggerNodeChanges:E,triggerEdgeChanges:j}=g(),k=v||p,T=x||S,D=k.map(A=>{const R=b.get(A.id);return R&&(R.selected=!1),Pe(A.id,!1)}),F=T.map(A=>Pe(A.id,!1));E(D),j(F)},setMinZoom:v=>{const{panZoom:x,maxZoom:S}=g();x?.setScaleExtent([v,S]),m({minZoom:v})},setMaxZoom:v=>{const{panZoom:x,minZoom:S}=g();x?.setScaleExtent([S,v]),m({maxZoom:v})},setTranslateExtent:v=>{g().panZoom?.setTranslateExtent(v),m({translateExtent:v})},resetSelectedElements:()=>{const{edges:v,nodes:x,triggerNodeChanges:S,triggerEdgeChanges:p,elementsSelectable:b}=g();if(!b)return;const E=x.reduce((k,T)=>T.selected?[...k,Pe(T.id,!1)]:k,[]),j=v.reduce((k,T)=>T.selected?[...k,Pe(T.id,!1)]:k,[]);S(E),p(j)},setNodeExtent:v=>{const{nodes:x,nodeLookup:S,parentLookup:p,nodeOrigin:b,elevateNodesOnSelect:E,nodeExtent:j,zIndexMode:k}=g();v[0][0]===j[0][0]&&v[0][1]===j[0][1]&&v[1][0]===j[1][0]&&v[1][1]===j[1][1]||(Tn(x,S,p,{nodeOrigin:b,nodeExtent:v,elevateNodesOnSelect:E,checkEquality:!1,zIndexMode:k}),m({nodeExtent:v}))},panBy:v=>{const{transform:x,width:S,height:p,panZoom:b,translateExtent:E}=g();return ff({delta:v,panZoom:b,transform:x,translateExtent:E,width:S,height:p})},setCenter:async(v,x,S)=>{const{width:p,height:b,maxZoom:E,panZoom:j}=g();if(!j)return Promise.resolve(!1);const k=typeof S?.zoom<"u"?S.zoom:E;return await j.setViewport({x:p/2-v*k,y:b/2-x*k,zoom:k},{duration:S?.duration,ease:S?.ease,interpolate:S?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{m({connection:{...qr}})},updateConnection:v=>{m({connection:v})},reset:()=>m({...gr()})}},Object.is);function jm({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:s,initialWidth:r,initialHeight:i,initialMinZoom:a,initialMaxZoom:c,initialFitViewOptions:f,fitView:l,nodeOrigin:d,nodeExtent:h,zIndexMode:u,children:m}){const[g]=M.useState(()=>Sm({nodes:e,edges:t,defaultNodes:n,defaultEdges:s,width:r,height:i,fitView:l,minZoom:a,maxZoom:c,fitViewOptions:f,nodeOrigin:d,nodeExtent:h,zIndexMode:u}));return o.jsx(Vf,{value:g,children:o.jsx(dh,{children:m})})}function _m({children:e,nodes:t,edges:n,defaultNodes:s,defaultEdges:r,width:i,height:a,fitView:c,fitViewOptions:f,minZoom:l,maxZoom:d,nodeOrigin:h,nodeExtent:u,zIndexMode:m}){return M.useContext(nn)?o.jsx(o.Fragment,{children:e}):o.jsx(jm,{initialNodes:t,initialEdges:n,defaultNodes:s,defaultEdges:r,initialWidth:i,initialHeight:a,fitView:c,initialFitViewOptions:f,initialMinZoom:l,initialMaxZoom:d,nodeOrigin:h,nodeExtent:u,zIndexMode:m,children:e})}const Em={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function Cm({nodes:e,edges:t,defaultNodes:n,defaultEdges:s,className:r,nodeTypes:i,edgeTypes:a,onNodeClick:c,onEdgeClick:f,onInit:l,onMove:d,onMoveStart:h,onMoveEnd:u,onConnect:m,onConnectStart:g,onConnectEnd:w,onClickConnectStart:v,onClickConnectEnd:x,onNodeMouseEnter:S,onNodeMouseMove:p,onNodeMouseLeave:b,onNodeContextMenu:E,onNodeDoubleClick:j,onNodeDragStart:k,onNodeDrag:T,onNodeDragStop:D,onNodesDelete:F,onEdgesDelete:A,onDelete:R,onSelectionChange:O,onSelectionDragStart:y,onSelectionDrag:_,onSelectionDragStop:C,onSelectionContextMenu:P,onSelectionStart:N,onSelectionEnd:I,onBeforeDelete:z,connectionMode:H,connectionLineType:$=Ce.Bezier,connectionLineStyle:Y,connectionLineComponent:G,connectionLineContainerStyle:Z,deleteKeyCode:L="Backspace",selectionKeyCode:B="Shift",selectionOnDrag:V=!1,selectionMode:X=ft.Full,panActivationKeyCode:Q="Space",multiSelectionKeyCode:U=mt()?"Meta":"Control",zoomActivationKeyCode:q=mt()?"Meta":"Control",snapToGrid:K,snapGrid:ne,onlyRenderVisibleElements:re=!1,selectNodesOnDrag:se,nodesDraggable:le,autoPanOnNodeFocus:je,nodesConnectable:ye,nodesFocusable:Me,nodeOrigin:Ue=Co,edgesFocusable:Ke,edgesReconnectable:Je,elementsSelectable:an=!0,defaultViewport:vt=th,minZoom:Oe=.5,maxZoom:et=2,translateExtent:ss=dt,preventScrolling:ii=!0,nodeExtent:cn,defaultMarkerColor:ai="#b1b1b7",zoomOnScroll:ci=!0,zoomOnPinch:li=!0,panOnScroll:ui=!1,panOnScrollSpeed:di=.5,panOnScrollMode:fi=De.Free,zoomOnDoubleClick:hi=!0,panOnDrag:mi=!0,onPaneClick:gi,onPaneMouseEnter:pi,onPaneMouseMove:xi,onPaneMouseLeave:yi,onPaneScroll:bi,onPaneContextMenu:wi,paneClickDistance:vi=1,nodeClickDistance:Ni=0,children:Si,onReconnect:ji,onReconnectStart:_i,onReconnectEnd:Ei,onEdgeContextMenu:Ci,onEdgeDoubleClick:ki,onEdgeMouseEnter:Mi,onEdgeMouseMove:Ii,onEdgeMouseLeave:Pi,reconnectRadius:Ai=10,onNodesChange:Ti,onEdgesChange:Di,noDragClassName:Ri="nodrag",noWheelClassName:Li="nowheel",noPanClassName:rs="nopan",fitView:os,fitViewOptions:is,connectOnClick:zi,attributionPosition:Oi,proOptions:$i,defaultEdgeOptions:Hi,elevateNodesOnSelect:Fi=!0,elevateEdgesOnSelect:Vi=!1,disableKeyboardA11y:as=!1,autoPanOnConnect:Bi,autoPanOnNodeDrag:Gi,autoPanSpeed:Yi,connectionRadius:Xi,isValidConnection:Wi,onError:Zi,style:qi,id:cs,nodeDragThreshold:Qi,connectionDragThreshold:Ui,viewport:Ki,onViewportChange:Ji,width:ea,height:ta,colorMode:na="light",debug:sa,onScroll:ls,ariaLabelConfig:ra,zIndexMode:us="basic",...oa},ia){const ln=cs||"1",aa=oh(na),ca=M.useCallback(ds=>{ds.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),ls?.(ds)},[ls]);return o.jsx("div",{"data-testid":"rf__wrapper",...oa,onScroll:ca,style:{...qi,...Em},ref:ia,className:ce(["react-flow",r,aa]),id:cs,role:"application",children:o.jsxs(_m,{nodes:e,edges:t,width:ea,height:ta,fitView:os,fitViewOptions:is,minZoom:Oe,maxZoom:et,nodeOrigin:Ue,nodeExtent:cn,zIndexMode:us,children:[o.jsx(Nm,{onInit:l,onNodeClick:c,onEdgeClick:f,onNodeMouseEnter:S,onNodeMouseMove:p,onNodeMouseLeave:b,onNodeContextMenu:E,onNodeDoubleClick:j,nodeTypes:i,edgeTypes:a,connectionLineType:$,connectionLineStyle:Y,connectionLineComponent:G,connectionLineContainerStyle:Z,selectionKeyCode:B,selectionOnDrag:V,selectionMode:X,deleteKeyCode:L,multiSelectionKeyCode:U,panActivationKeyCode:Q,zoomActivationKeyCode:q,onlyRenderVisibleElements:re,defaultViewport:vt,translateExtent:ss,minZoom:Oe,maxZoom:et,preventScrolling:ii,zoomOnScroll:ci,zoomOnPinch:li,zoomOnDoubleClick:hi,panOnScroll:ui,panOnScrollSpeed:di,panOnScrollMode:fi,panOnDrag:mi,onPaneClick:gi,onPaneMouseEnter:pi,onPaneMouseMove:xi,onPaneMouseLeave:yi,onPaneScroll:bi,onPaneContextMenu:wi,paneClickDistance:vi,nodeClickDistance:Ni,onSelectionContextMenu:P,onSelectionStart:N,onSelectionEnd:I,onReconnect:ji,onReconnectStart:_i,onReconnectEnd:Ei,onEdgeContextMenu:Ci,onEdgeDoubleClick:ki,onEdgeMouseEnter:Mi,onEdgeMouseMove:Ii,onEdgeMouseLeave:Pi,reconnectRadius:Ai,defaultMarkerColor:ai,noDragClassName:Ri,noWheelClassName:Li,noPanClassName:rs,rfId:ln,disableKeyboardA11y:as,nodeExtent:cn,viewport:Ki,onViewportChange:Ji}),o.jsx(rh,{nodes:e,edges:t,defaultNodes:n,defaultEdges:s,onConnect:m,onConnectStart:g,onConnectEnd:w,onClickConnectStart:v,onClickConnectEnd:x,nodesDraggable:le,autoPanOnNodeFocus:je,nodesConnectable:ye,nodesFocusable:Me,edgesFocusable:Ke,edgesReconnectable:Je,elementsSelectable:an,elevateNodesOnSelect:Fi,elevateEdgesOnSelect:Vi,minZoom:Oe,maxZoom:et,nodeExtent:cn,onNodesChange:Ti,onEdgesChange:Di,snapToGrid:K,snapGrid:ne,connectionMode:H,translateExtent:ss,connectOnClick:zi,defaultEdgeOptions:Hi,fitView:os,fitViewOptions:is,onNodesDelete:F,onEdgesDelete:A,onDelete:R,onNodeDragStart:k,onNodeDrag:T,onNodeDragStop:D,onSelectionDrag:_,onSelectionDragStart:y,onSelectionDragStop:C,onMove:d,onMoveStart:h,onMoveEnd:u,noPanClassName:rs,nodeOrigin:Ue,rfId:ln,autoPanOnConnect:Bi,autoPanOnNodeDrag:Gi,autoPanSpeed:Yi,onError:Zi,connectionRadius:Xi,isValidConnection:Wi,selectNodesOnDrag:se,nodeDragThreshold:Qi,connectionDragThreshold:Ui,onBeforeDelete:z,debug:sa,ariaLabelConfig:ra,zIndexMode:us}),o.jsx(eh,{onSelectionChange:O}),Si,o.jsx(qf,{proOptions:$i,position:Oi}),o.jsx(Zf,{rfId:ln,disableKeyboardA11y:as})]})})}var km=Po(Cm);function Mm(e){const[t,n]=M.useState(e),s=M.useCallback(r=>n(i=>Mo(r,i)),[]);return[t,n,s]}function Im(e){const[t,n]=M.useState(e),s=M.useCallback(r=>n(i=>Io(r,i)),[]);return[t,n,s]}function Pm({dimensions:e,lineWidth:t,variant:n,className:s}){return o.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:ce(["react-flow__background-pattern",n,s])})}function Am({radius:e,className:t}){return o.jsx("circle",{cx:e,cy:e,r:e,className:ce(["react-flow__background-pattern","dots",t])})}var ke;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(ke||(ke={}));const Tm={[ke.Dots]:1,[ke.Lines]:1,[ke.Cross]:6},Dm=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function ti({id:e,variant:t=ke.Dots,gap:n=20,size:s,lineWidth:r=1,offset:i=0,color:a,bgColor:c,style:f,className:l,patternClassName:d}){const h=M.useRef(null),{transform:u,patternId:m}=te(Dm,oe),g=s||Tm[t],w=t===ke.Dots,v=t===ke.Cross,x=Array.isArray(n)?n:[n,n],S=[x[0]*u[2]||1,x[1]*u[2]||1],p=g*u[2],b=Array.isArray(i)?i:[i,i],E=v?[p,p]:S,j=[b[0]*u[2]||1+E[0]/2,b[1]*u[2]||1+E[1]/2],k=`${m}${e||""}`;return o.jsxs("svg",{className:ce(["react-flow__background",l]),style:{...f,...rn,"--xy-background-color-props":c,"--xy-background-pattern-color-props":a},ref:h,"data-testid":"rf__background",children:[o.jsx("pattern",{id:k,x:u[0]%S[0],y:u[1]%S[1],width:S[0],height:S[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${j[0]},-${j[1]})`,children:w?o.jsx(Am,{radius:p/2,className:d}):o.jsx(Pm,{dimensions:E,lineWidth:r,variant:t,className:d})}),o.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${k})`})]})}ti.displayName="Background";const Rm=M.memo(ti);function Lm(){return o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:o.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function zm(){return o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:o.jsx("path",{d:"M0 0h32v4.2H0z"})})}function Om(){return o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:o.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function $m(){return o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:o.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Hm(){return o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:o.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function Mt({children:e,className:t,...n}){return o.jsx("button",{type:"button",className:ce(["react-flow__controls-button",t]),...n,children:e})}const Fm=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function ni({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:s=!0,fitViewOptions:r,onZoomIn:i,onZoomOut:a,onFitView:c,onInteractiveChange:f,className:l,children:d,position:h="bottom-left",orientation:u="vertical","aria-label":m}){const g=ie(),{isInteractive:w,minZoomReached:v,maxZoomReached:x,ariaLabelConfig:S}=te(Fm,oe),{zoomIn:p,zoomOut:b,fitView:E}=ts(),j=()=>{p(),i?.()},k=()=>{b(),a?.()},T=()=>{E(r),c?.()},D=()=>{g.setState({nodesDraggable:!w,nodesConnectable:!w,elementsSelectable:!w}),f?.(!w)},F=u==="horizontal"?"horizontal":"vertical";return o.jsxs(sn,{className:ce(["react-flow__controls",F,l]),position:h,style:e,"data-testid":"rf__controls","aria-label":m??S["controls.ariaLabel"],children:[t&&o.jsxs(o.Fragment,{children:[o.jsx(Mt,{onClick:j,className:"react-flow__controls-zoomin",title:S["controls.zoomIn.ariaLabel"],"aria-label":S["controls.zoomIn.ariaLabel"],disabled:x,children:o.jsx(Lm,{})}),o.jsx(Mt,{onClick:k,className:"react-flow__controls-zoomout",title:S["controls.zoomOut.ariaLabel"],"aria-label":S["controls.zoomOut.ariaLabel"],disabled:v,children:o.jsx(zm,{})})]}),n&&o.jsx(Mt,{className:"react-flow__controls-fitview",onClick:T,title:S["controls.fitView.ariaLabel"],"aria-label":S["controls.fitView.ariaLabel"],children:o.jsx(Om,{})}),s&&o.jsx(Mt,{className:"react-flow__controls-interactive",onClick:D,title:S["controls.interactive.ariaLabel"],"aria-label":S["controls.interactive.ariaLabel"],children:w?o.jsx(Hm,{}):o.jsx($m,{})}),d]})}ni.displayName="Controls";const Vm=M.memo(ni);function Bm({id:e,x:t,y:n,width:s,height:r,style:i,color:a,strokeColor:c,strokeWidth:f,className:l,borderRadius:d,shapeRendering:h,selected:u,onClick:m}){const{background:g,backgroundColor:w}=i||{},v=a||g||w;return o.jsx("rect",{className:ce(["react-flow__minimap-node",{selected:u},l]),x:t,y:n,rx:d,ry:d,width:s,height:r,style:{fill:v,stroke:c,strokeWidth:f},shapeRendering:h,onClick:m?x=>m(x,e):void 0})}const Gm=M.memo(Bm),Ym=e=>e.nodes.map(t=>t.id),wn=e=>e instanceof Function?e:()=>e;function Xm({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:s=5,nodeStrokeWidth:r,nodeComponent:i=Gm,onClick:a}){const c=te(Ym,oe),f=wn(t),l=wn(e),d=wn(n),h=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return o.jsx(o.Fragment,{children:c.map(u=>o.jsx(Zm,{id:u,nodeColorFunc:f,nodeStrokeColorFunc:l,nodeClassNameFunc:d,nodeBorderRadius:s,nodeStrokeWidth:r,NodeComponent:i,onClick:a,shapeRendering:h},u))})}function Wm({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:s,nodeBorderRadius:r,nodeStrokeWidth:i,shapeRendering:a,NodeComponent:c,onClick:f}){const{node:l,x:d,y:h,width:u,height:m}=te(g=>{const{internals:w}=g.nodeLookup.get(e),v=w.userNode,{x,y:S}=w.positionAbsolute,{width:p,height:b}=Se(v);return{node:v,x,y:S,width:p,height:b}},oe);return!l||l.hidden||!no(l)?null:o.jsx(c,{x:d,y:h,width:u,height:m,style:l.style,selected:!!l.selected,className:s(l),color:t(l),borderRadius:r,strokeColor:n(l),strokeWidth:i,shapeRendering:a,onClick:f,id:l.id})}const Zm=M.memo(Wm);var qm=M.memo(Xm);const Qm=200,Um=150,Km=e=>!e.hidden,Jm=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?to(yt(e.nodeLookup,{filter:Km}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},eg="react-flow__minimap-desc";function si({style:e,className:t,nodeStrokeColor:n,nodeColor:s,nodeClassName:r="",nodeBorderRadius:i=5,nodeStrokeWidth:a,nodeComponent:c,bgColor:f,maskColor:l,maskStrokeColor:d,maskStrokeWidth:h,position:u="bottom-right",onClick:m,onNodeClick:g,pannable:w=!1,zoomable:v=!1,ariaLabel:x,inversePan:S,zoomStep:p=1,offsetScale:b=5}){const E=ie(),j=M.useRef(null),{boundingRect:k,viewBB:T,rfId:D,panZoom:F,translateExtent:A,flowWidth:R,flowHeight:O,ariaLabelConfig:y}=te(Jm,oe),_=e?.width??Qm,C=e?.height??Um,P=k.width/_,N=k.height/C,I=Math.max(P,N),z=I*_,H=I*C,$=b*I,Y=k.x-(z-k.width)/2-$,G=k.y-(H-k.height)/2-$,Z=z+$*2,L=H+$*2,B=`${eg}-${D}`,V=M.useRef(0),X=M.useRef();V.current=I,M.useEffect(()=>{if(j.current&&F)return X.current=vf({domNode:j.current,panZoom:F,getTransform:()=>E.getState().transform,getViewScale:()=>V.current}),()=>{X.current?.destroy()}},[F]),M.useEffect(()=>{X.current?.update({translateExtent:A,width:R,height:O,inversePan:S,pannable:w,zoomStep:p,zoomable:v})},[w,v,S,p,A,R,O]);const Q=m?K=>{const[ne,re]=X.current?.pointer(K)||[0,0];m(K,{x:ne,y:re})}:void 0,U=g?M.useCallback((K,ne)=>{const re=E.getState().nodeLookup.get(ne).internals.userNode;g(K,re)},[]):void 0,q=x??y["minimap.ariaLabel"];return o.jsx(sn,{position:u,style:{...e,"--xy-minimap-background-color-props":typeof f=="string"?f:void 0,"--xy-minimap-mask-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-stroke-color-props":typeof d=="string"?d:void 0,"--xy-minimap-mask-stroke-width-props":typeof h=="number"?h*I:void 0,"--xy-minimap-node-background-color-props":typeof s=="string"?s:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof a=="number"?a:void 0},className:ce(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:o.jsxs("svg",{width:_,height:C,viewBox:`${Y} ${G} ${Z} ${L}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":B,ref:j,onClick:Q,children:[q&&o.jsx("title",{id:B,children:q}),o.jsx(qm,{onClick:U,nodeColor:s,nodeStrokeColor:n,nodeBorderRadius:i,nodeClassName:r,nodeStrokeWidth:a,nodeComponent:c}),o.jsx("path",{className:"react-flow__minimap-mask",d:`M${Y-$},${G-$}h${Z+$*2}v${L+$*2}h${-Z-$*2}z
        M${T.x},${T.y}h${T.width}v${T.height}h${-T.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}si.displayName="MiniMap";const tg=M.memo(si),ng=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,sg={[qe.Line]:"right",[qe.Handle]:"bottom-right"};function rg({nodeId:e,position:t,variant:n=qe.Handle,className:s,style:r=void 0,children:i,color:a,minWidth:c=10,minHeight:f=10,maxWidth:l=Number.MAX_VALUE,maxHeight:d=Number.MAX_VALUE,keepAspectRatio:h=!1,resizeDirection:u,autoScale:m=!0,shouldResize:g,onResizeStart:w,onResize:v,onResizeEnd:x}){const S=Ro(),p=typeof e=="string"?e:S,b=ie(),E=M.useRef(null),j=n===qe.Handle,k=te(M.useCallback(ng(j&&m),[j,m]),oe),T=M.useRef(null),D=t??sg[n];M.useEffect(()=>{if(!(!E.current||!p))return T.current||(T.current=Rf({domNode:E.current,nodeId:p,getStoreItems:()=>{const{nodeLookup:A,transform:R,snapGrid:O,snapToGrid:y,nodeOrigin:_,domNode:C}=b.getState();return{nodeLookup:A,transform:R,snapGrid:O,snapToGrid:y,nodeOrigin:_,paneDomNode:C}},onChange:(A,R)=>{const{triggerNodeChanges:O,nodeLookup:y,parentLookup:_,nodeOrigin:C}=b.getState(),P=[],N={x:A.x,y:A.y},I=y.get(p);if(I&&I.expandParent&&I.parentId){const z=I.origin??C,H=A.width??I.measured.width??0,$=A.height??I.measured.height??0,Y={id:I.id,parentId:I.parentId,rect:{width:H,height:$,...so({x:A.x??I.position.x,y:A.y??I.position.y},{width:H,height:$},I.parentId,y,z)}},G=es([Y],y,_,C);P.push(...G),N.x=A.x?Math.max(z[0]*H,A.x):void 0,N.y=A.y?Math.max(z[1]*$,A.y):void 0}if(N.x!==void 0&&N.y!==void 0){const z={id:p,type:"position",position:{...N}};P.push(z)}if(A.width!==void 0&&A.height!==void 0){const H={id:p,type:"dimensions",resizing:!0,setAttributes:u?u==="horizontal"?"width":"height":!0,dimensions:{width:A.width,height:A.height}};P.push(H)}for(const z of R){const H={...z,type:"position"};P.push(H)}O(P)},onEnd:({width:A,height:R})=>{const O={id:p,type:"dimensions",resizing:!1,dimensions:{width:A,height:R}};b.getState().triggerNodeChanges([O])}})),T.current.update({controlPosition:D,boundaries:{minWidth:c,minHeight:f,maxWidth:l,maxHeight:d},keepAspectRatio:h,resizeDirection:u,onResizeStart:w,onResize:v,onResizeEnd:x,shouldResize:g}),()=>{T.current?.destroy()}},[D,c,f,l,d,h,w,v,x,g]);const F=D.split("-");return o.jsx("div",{className:ce(["react-flow__resize-control","nodrag",...F,n,s]),ref:E,style:{...r,scale:k,...a&&{[j?"backgroundColor":"borderColor"]:a}},children:i})}M.memo(rg);const og={toggles:{Project:!0,Person:!0,Team:!0,Sprint:!0,Risk:!0,Document:!0,Action:!0,Fact:!0,Decision:!0,Question:!0,Email:!1,Contact:!1},searchQuery:"",minTier:2,showSemantic:!1,layout:"concentric"},ri=M.createContext(void 0);function ig({children:e}){const[t,n]=M.useState(og),[s,r]=M.useState(null),[i,a]=M.useState(null),c=f=>{n(l=>({...l,toggles:{...l.toggles,[f]:!l.toggles[f]}}))};return o.jsx(ri.Provider,{value:{filters:t,setFilters:n,selectedNodeId:s,setSelectedNodeId:r,hoveredNodeId:i,setHoveredNodeId:a,toggleType:c},children:e})}function oi(){const e=M.useContext(ri);if(e===void 0)throw new Error("useGraphState must be used within a GraphProvider");return e}const at={getSyncStatus:async e=>{const t=await dn.get("/api/graphrag/sync-status",{params:{project_id:e}});return t.status||t},triggerSync:async e=>dn.post("/api/graphrag/sync",{project_id:e}),triggerResync:async e=>dn.post("/api/graphrag/resync",{project_id:e}),getNodes:async(e,t)=>{let n=un.from("graph_nodes").select("*").eq("project_id",e);t&&t.length>0&&(n=n.in("label",t));const{data:s,error:r}=await n;if(r)throw r;return(s||[]).map(i=>({id:i.id,label:i.label,data:{...i.properties,label:i.properties.name||i.properties.title||i.label,type:i.label,project_id:i.project_id},position:{x:0,y:0}}))},getEdges:async e=>{const{data:t,error:n}=await un.from("graph_relationships").select("*").eq("project_id",e);if(n)throw n;return(t||[]).map(s=>({id:s.id,source:s.from_id,target:s.to_id,label:s.type,data:s.properties}))},getSemanticNeighbors:async(e,t,n=.78,s=10)=>{const{data:r,error:i}=await un.rpc("find_semantic_neighbors",{p_entity_id:e,p_project_id:t,p_threshold:n,p_limit:s});if(i)throw i;return r||[]}};function ag(e){const{currentProjectId:t}=Ln();return zn({queryKey:["graph","nodes",t,e],queryFn:async()=>t?await at.getNodes(t,e):[],enabled:!!t,staleTime:300*1e3,placeholderData:ua})}function cg(){const{currentProjectId:e}=Ln();return zn({queryKey:["graph","edges",e],queryFn:async()=>e?await at.getEdges(e):[],enabled:!!e,staleTime:300*1e3})}const lg={Project:0,Person:1,Team:1,Sprint:1,Document:1,Email:1,CalendarEvent:1,Contact:1,Risk:2,Action:2,Fact:2,Decision:2,Question:2,UserStory:2},pr={Project:{w:280,h:120},Document:{w:220,h:90},Person:{w:200,h:80},Contact:{w:200,h:85},Team:{w:220,h:85},Sprint:{w:200,h:65},Email:{w:220,h:80},CalendarEvent:{w:210,h:80},Fact:{w:200,h:80},Decision:{w:200,h:80},Risk:{w:210,h:95},Action:{w:220,h:90},Question:{w:200,h:75},UserStory:{w:210,h:80},default:{w:200,h:80}},xr={BELONGS_TO_PROJECT:{stroke:"#cbd5e1",width:1,opacity:0,dash:"5 5"},EXTRACTED_FROM:{stroke:"#f59e0b",width:2,opacity:.8},IMPLEMENTS:{stroke:"#3b82f6",width:2,opacity:.9},DEPENDS_ON:{stroke:"#3b82f6",width:2,opacity:.9},ASSIGNED_TO:{stroke:"#10b981",width:1.5,opacity:.7},OWNED_BY:{stroke:"#10b981",width:1.5,opacity:.7},AUTHORED_BY:{stroke:"#10b981",width:1.5,opacity:.7},MEMBER_OF_TEAM:{stroke:"#a855f7",width:1.5,opacity:.7},WORKS_WITH:{stroke:"#4ade80",width:1,opacity:.4},SIMILAR_TO:{stroke:"#facc15",width:1,opacity:.5,dash:"4 4"},MENTIONS:{stroke:"#f59e0b",width:1.5,opacity:.8},INVOLVES:{stroke:"#06b6d4",width:1.5,opacity:.8},LINKED_TO:{stroke:"#a855f7",width:1.5,opacity:.7},DERIVED_FROM:{stroke:"#94a3b8",width:1.5,opacity:.7},default:{stroke:"#64748b",width:1,opacity:.5}},ug=new Set(["WORKS_WITH","BELONGS_TO_PROJECT"]);function dg(e,t){const n=new Map,s=new Set,r=new Map,i=d=>d?.trim().toLowerCase()||"";e.forEach(d=>{if(d.label==="Contact"){const h=d.id;d.data.linked_person_id&&(s.add(d.data.linked_person_id),n.set(d.data.linked_person_id,h)),d.data.name&&r.set(i(d.data.name),h),d.data.label&&r.set(i(d.data.label),h),Array.isArray(d.data.aliases)&&d.data.aliases.forEach(u=>{u&&r.set(i(u),h)})}});const a=[],c=new Set;e.forEach(d=>{if(d.label==="Person"){let g=!1,w="";if(s.has(d.id))g=!0,w=n.get(d.data.linked_person_id||d.id);else{const v=i(d.data.label||d.data.name);r.has(v)&&(g=!0,w=r.get(v),n.set(d.id,w))}if(g){c.add(d.id);return}}const h=d.label||"default",u=lg[h]??2,m=pr[h]??pr.default;a.push({...d,width:m.w,height:m.h,data:{...d.data,tier:u,label:d.data.label||d.label,_display:{width:m.w,height:m.h,colorToken:fg(h)}}})});const f=[],l={};return t.forEach(d=>{if(ug.has(d.label||""))return;let h=d.source,u=d.target;if(n.has(h)&&(h=n.get(h)),n.has(u)&&(u=n.get(u)),h===u)return;const m=xr[d.label||""]||xr.default,g={...d,id:d.id||`${h}-${u}-${d.label}`,source:h,target:u,type:"default",style:{stroke:m.stroke,strokeWidth:m.width,opacity:m.opacity,strokeDasharray:m.dash},animated:d.label==="SIMILAR_TO"||d.label==="DEPENDS_ON"||d.label==="INVOLVES",data:{...d.data,originalLabel:d.label},label:void 0};if(d.label==="WORKS_WITH"){const w=[h,u].sort().join("__");l[w]||(l[w]=[]),l[w].push(g)}else f.push(g)}),Object.entries(l).forEach(([d,h])=>{if(h.length>0){const u={...h[0]};if(h.length>1){u.label=`${h.length}`;const m=u.style?.strokeWidth||1,g=Math.min(h.length*.2,3);u.style={...u.style,strokeWidth:m+g,opacity:.6}}f.push(u)}}),{nodes:a,edges:f}}function fg(e){switch(e){case"Project":return"blue";case"Person":return"green";case"Contact":return"teal";case"Team":return"purple";case"Sprint":return"indigo";case"Document":return"amber";case"Risk":return"red";case"Action":return"emerald";case"Fact":return"sky";case"Decision":return"orange";case"Question":return"violet";case"UserStory":return"pink";case"Email":return"slate";case"CalendarEvent":return"cyan";default:return"slate"}}function hg(){const{filters:e}=oi(),t=M.useMemo(()=>Object.entries(e.toggles).filter(([d,h])=>h).map(([d])=>d),[e.toggles]),{data:n,isLoading:s,error:r}=ag(t),{data:i,isLoading:a,error:c}=cg(),{nodes:f,edges:l}=M.useMemo(()=>{if(!n||!i)return{nodes:[],edges:[]};const{nodes:d,edges:h}=dg(n,i),u=d.map((x,S)=>x.data.tier===0?S:-1).filter(x=>x!==-1);let m=d;if(u.length>1){const x=new Set(u.slice(1));m=d.filter((S,p)=>!x.has(p))}const g=m.filter(x=>{if(e.toggles[x.label]===!1||(x.data.tier??2)>e.minTier)return!1;if(e.searchQuery){const S=e.searchQuery.toLowerCase(),p=x.data.label?.toLowerCase()||"",b=x.label.toLowerCase();if(!p.includes(S)&&!b.includes(S))return!1}return!0}),w=new Set(g.map(x=>x.id)),v=h.filter(x=>!(!w.has(x.source)||!w.has(x.target)||!e.showSemantic&&x.label==="SIMILAR_TO"));return{nodes:g,edges:v}},[n,i,e]);return{nodes:f,edges:l,isLoading:s||a,error:r||c}}function mg(e,t,n={center:{x:0,y:0},tier1Radius:300,tier2Radius:600}){return{nodes:M.useMemo(()=>{if(!e||e.length===0)return[];const r=e.filter(u=>(u.data.tier??2)===0),i=e.filter(u=>(u.data.tier??2)===1),a=e.filter(u=>(u.data.tier??2)===2),c=Math.max(i.length*100,1e3),f=Math.max(n.tier1Radius,c/(2*Math.PI)),l=Math.max(a.length*50,2e3),d=Math.max(n.tier2Radius,f+250,l/(2*Math.PI)),h=r[0];if(h&&(h.position={...n.center}),i.length>0){const u=2*Math.PI/i.length;i.forEach((m,g)=>{const w=g*u;m.position={x:n.center.x+f*Math.cos(w),y:n.center.y+f*Math.sin(w)}})}if(a.length>0){const u=2*Math.PI/a.length;a.forEach((m,g)=>{const w=g*u;m.position={x:n.center.x+d*Math.cos(w),y:n.center.y+d*Math.sin(w)}})}return[...r,...i,...a]},[e,n.center.x,n.center.y,n.tier1Radius,n.tier2Radius]),edges:t}}function gg(){const{currentProjectId:e}=Ln(),t=da(),n=zn({queryKey:["graph","sync","status",e],queryFn:async()=>{if(!e)return null;const i=await at.getSyncStatus(e);return{...i,is_connected:!!i?.last_synced_at,node_count:i?.node_count||0,edge_count:i?.edge_count||0,pending_count:i?.pending_count||0}},enabled:!!e,refetchInterval:i=>i?.sync_status==="syncing"?2e3:3e4}),s=fs({mutationFn:async()=>{if(!e)throw new Error("No project selected");return await at.triggerSync(e)},onSuccess:()=>{t.invalidateQueries({queryKey:["graph","sync","status"]}),t.invalidateQueries({queryKey:["graph","nodes"]}),t.invalidateQueries({queryKey:["graph","edges"]}),ee.success("Graph sync started")},onError:i=>{ee.error(`Sync failed: ${i.message}`)}}),r=fs({mutationFn:async()=>{if(!e)throw new Error("No project selected");return await at.triggerResync(e)},onSuccess:()=>{t.invalidateQueries({queryKey:["graph","sync","status"]}),t.invalidateQueries({queryKey:["graph","nodes"]}),t.invalidateQueries({queryKey:["graph","edges"]}),ee.success("Full graph resync started")},onError:i=>{ee.error(`Resync failed: ${i.message}`)}});return{status:n.data,isLoadingStatus:n.isLoading,isSyncing:n.data?.sync_status==="syncing"||s.isPending||r.isPending,sync:s.mutate,resync:r.mutate,error:n.error||s.error||r.error}}const pg=[{label:"All Nodes",query:"MATCH (n) RETURN labels(n) AS type, n.name AS name, n.id AS id LIMIT 50"},{label:"All Relationships",query:"MATCH (a)-[r]->(b) RETURN a.name AS from, type(r) AS rel, b.name AS to LIMIT 50"},{label:"People & Projects",query:"MATCH (p:Person)-[r]->(proj:Project) RETURN p.name, type(r), proj.name"},{label:"Risks",query:"MATCH (r:Risk) RETURN r.name, r.content, r.impact, r.status"},{label:"Action Items",query:"MATCH (a:Action) RETURN a.name, a.task, a.owner, a.status, a.deadline"},{label:"Decisions",query:"MATCH (d:Decision) RETURN d.name, d.content, d.owner, d.status"},{label:"Node Connections",query:'MATCH (n)-[r]-(m) WHERE n.name =~ ".*SEARCH.*" RETURN n.name, type(r), m.name LIMIT 30'},{label:"Graph Stats",query:"MATCH (n) RETURN labels(n)[0] AS type, count(n) AS count ORDER BY count DESC"}];function xg(){const[e,t]=M.useState(""),[n,s]=M.useState("table"),[r,i]=M.useState(null),[a,c]=M.useState([]),[f,l]=M.useState(!1),[d,h]=M.useState(!0),u=M.useRef(null),m=fa(),g=ha(),w=M.useCallback(()=>{e.trim()&&m.mutate({query:e.trim()},{onSuccess:j=>{i(j),c(k=>[{query:e.trim(),time:new Date().toLocaleTimeString(),success:!0},...k.slice(0,19)]),ee.success("Query executed")},onError:()=>{c(j=>[{query:e.trim(),time:new Date().toLocaleTimeString(),success:!1},...j.slice(0,19)]),ee.error("Query failed")}})},[e,m]),v=M.useCallback(()=>{if(!e.trim()){ee.error("Describe what you want to query");return}g.mutate({query:e.trim()},{onSuccess:j=>{const k=j;k.cypher&&(t(String(k.cypher)),ee.success("Cypher generated by AI"))},onError:()=>ee.error("Failed to generate query")})},[e,g]),x=M.useCallback(j=>{(j.ctrlKey||j.metaKey)&&j.key==="Enter"&&(j.preventDefault(),w())},[w]),S=r?.nodes||[],p=r?.edges||[],b=r?.records||r?.rows||[],E=b.length>0?Object.keys(b[0]):[];return o.jsxs("div",{className:"h-full flex flex-col",children:[o.jsxs("div",{className:"shrink-0 border-b border-gm-border-primary",children:[o.jsxs("button",{onClick:()=>h(!d),className:"w-full flex items-center justify-between px-4 py-2 text-left",children:[o.jsx("span",{className:"text-[10px] font-semibold text-gm-text-tertiary uppercase tracking-wider",children:"Templates"}),d?o.jsx(xs,{className:"w-3 h-3 text-gm-text-tertiary"}):o.jsx(ys,{className:"w-3 h-3 text-gm-text-tertiary"})]}),d&&o.jsx("div",{className:"flex gap-1.5 px-4 pb-3 flex-wrap",children:pg.map((j,k)=>o.jsx("button",{onClick:()=>t(j.query),className:"px-2.5 py-1 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-[10px] text-gm-text-primary hover:bg-gm-surface-hover hover:border-blue-600/30 transition-colors",children:j.label},k))})]}),o.jsx("div",{className:"shrink-0 p-4 border-b border-gm-border-primary",children:o.jsxs("div",{className:"relative",children:[o.jsx("textarea",{ref:u,value:e,onChange:j=>t(j.target.value),onKeyDown:x,rows:4,placeholder:"Enter Cypher query... (Ctrl+Enter to execute)\\n\\nOr describe what you want in natural language, then click AI Generate",className:"w-full bg-gm-surface-secondary border border-gm-border-primary rounded-xl px-4 py-3 text-xs text-gm-text-primary font-mono leading-relaxed resize-y focus:outline-none focus:ring-2 focus:ring-gm-border-focus placeholder:text-gray-500"}),o.jsxs("div",{className:"absolute bottom-2 right-2 flex gap-1.5",children:[o.jsxs("button",{onClick:v,disabled:g.isPending||!e.trim(),className:"px-2.5 py-1 rounded-lg bg-blue-600/10 text-gm-interactive-primary text-[10px] font-medium hover:bg-blue-600/20 flex items-center gap-1 disabled:opacity-50 transition-colors",children:[g.isPending?o.jsx(J,{className:"w-3 h-3 animate-spin"}):o.jsx(Te,{className:"w-3 h-3"})," AI Generate"]}),o.jsxs("button",{onClick:w,disabled:m.isPending||!e.trim(),className:"px-2.5 py-1 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-[10px] font-medium hover:bg-gm-interactive-primary-hover flex items-center gap-1 disabled:opacity-50 transition-colors",children:[m.isPending?o.jsx(J,{className:"w-3 h-3 animate-spin"}):o.jsx(cc,{className:"w-3 h-3"})," Execute"]})]})]})}),o.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col",children:[r&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-gm-border-primary shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-3 text-[10px] text-gm-text-tertiary",children:[b.length>0&&o.jsxs("span",{children:[b.length," records"]}),S.length>0&&o.jsxs("span",{children:[S.length," nodes"]}),p.length>0&&o.jsxs("span",{children:[p.length," edges"]})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:()=>s("table"),className:ae("p-1 rounded",n==="table"?"bg-blue-600/10 text-gm-interactive-primary":"text-gm-text-tertiary"),children:o.jsx(jc,{className:"w-3.5 h-3.5"})}),o.jsx("button",{onClick:()=>s("json"),className:ae("p-1 rounded",n==="json"?"bg-blue-600/10 text-gm-interactive-primary":"text-gm-text-tertiary"),children:o.jsx(Ot,{className:"w-3.5 h-3.5"})}),o.jsx("button",{onClick:()=>{navigator.clipboard.writeText(JSON.stringify(r,null,2)),ee.success("Copied")},className:"p-1 rounded text-gm-text-tertiary hover:text-gm-text-primary",children:o.jsx(lc,{className:"w-3.5 h-3.5"})})]})]}),o.jsx("div",{className:"flex-1 overflow-auto p-4",children:n==="table"&&b.length>0?o.jsxs("table",{className:"w-full text-xs",children:[o.jsx("thead",{children:o.jsx("tr",{className:"border-b border-gm-border-primary",children:E.map(j=>o.jsx("th",{className:"py-1.5 px-2 text-left font-medium text-gm-text-tertiary text-[10px] uppercase",children:j},j))})}),o.jsx("tbody",{children:b.map((j,k)=>o.jsx("tr",{className:"border-b border-[var(--gm-border-primary)] hover:bg-[var(--gm-surface-hover)]",children:E.map(T=>o.jsx("td",{className:"py-1.5 px-2 text-gm-text-primary max-w-[200px] truncate",children:typeof j[T]=="object"?JSON.stringify(j[T]):String(j[T]??"")},T))},k))})]}):n==="json"||b.length===0?o.jsx("pre",{className:"text-[10px] text-gm-text-primary font-mono whitespace-pre-wrap leading-relaxed",children:JSON.stringify(r,null,2)}):null})]}),!r&&o.jsx("div",{className:"flex-1 flex items-center justify-center text-gm-text-tertiary",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Ot,{className:"w-10 h-10 mx-auto mb-3 text-gray-600"}),o.jsx("p",{className:"text-xs",children:"Write a Cypher query or use a template above"}),o.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:"Ctrl+Enter to execute"})]})})]}),a.length>0&&o.jsxs("div",{className:"shrink-0 border-t border-gm-border-primary",children:[o.jsxs("button",{onClick:()=>l(!f),className:"w-full flex items-center justify-between px-4 py-2",children:[o.jsxs("span",{className:"text-[10px] font-semibold text-gm-text-tertiary uppercase tracking-wider flex items-center gap-1",children:[o.jsx(yr,{className:"w-3 h-3"})," History (",a.length,")"]}),f?o.jsx(xs,{className:"w-3 h-3 text-gm-text-tertiary"}):o.jsx(ys,{className:"w-3 h-3 text-gm-text-tertiary"})]}),f&&o.jsx("div",{className:"px-4 pb-3 max-h-32 overflow-y-auto space-y-1",children:a.map((j,k)=>o.jsxs("button",{onClick:()=>t(j.query),className:"w-full text-left flex items-center gap-2 px-2 py-1 rounded hover:bg-gm-surface-secondary transition-colors",children:[o.jsx("div",{className:ae("w-1.5 h-1.5 rounded-full shrink-0",j.success?"bg-gm-status-success":"bg-gm-status-danger")}),o.jsx("span",{className:"text-[10px] text-gm-text-primary font-mono truncate flex-1",children:j.query}),o.jsx("span",{className:"text-[10px] text-gm-text-tertiary shrink-0",children:j.time})]},k))})]})]})}const vn={Project:"#6366f1",Person:"#ec4899",Team:"#8b5cf6",Document:"#06b6d4",Fact:"#f59e0b",Decision:"#a855f7",Risk:"#ef4444",Action:"#22c55e",Question:"#3b82f6",Email:"#f97316",Contact:"#ec4899",Sprint:"#14b8a6"};function yg(){const e=ma(),t=ga(),n=pa(),s=xa(),r=e.data,i=r?.stats||r,a=Number(i?.nodeCount??i?.node_count??0),c=Number(i?.edgeCount??i?.edge_count??0),f=Number(i?.density??0),l=Number(i?.avgDegree??i?.avg_degree??0),d=i?.entityDistribution??i?.distribution??i?.byLabel??{},h=r?.recommendations||[],u=t.data?.communities||[],m=n.data?.nodes||[],g=s.data?.bridges||[],w=e.isLoading,v=Math.max(...Object.values(d),1);return w?o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx(J,{className:"h-8 w-8 animate-spin text-gm-interactive-primary"})}):o.jsxs("div",{className:"h-full overflow-y-auto p-5 space-y-5",children:[o.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[o.jsx(It,{icon:On,label:"Nodes",value:String(a),color:"text-gm-interactive-primary",bgColor:"bg-blue-600/10"}),o.jsx(It,{icon:Nn,label:"Edges",value:String(c),color:"text-purple-500",bgColor:"bg-purple-500/10"}),o.jsx(It,{icon:$n,label:"Density",value:f.toFixed(4),color:"text-orange-500",bgColor:"bg-orange-500/10"}),o.jsx(It,{icon:uc,label:"Avg Degree",value:l.toFixed(2),color:"text-green-500",bgColor:"bg-green-500/10"})]}),Object.keys(d).length>0&&o.jsxs("div",{className:"bg-gm-surface-primary border border-gm-border-primary rounded-xl p-5",children:[o.jsxs("h3",{className:"text-xs font-semibold text-gm-text-tertiary uppercase tracking-wider mb-4 flex items-center gap-1.5",children:[o.jsx(Hn,{className:"w-3.5 h-3.5"})," Entity Distribution"]}),o.jsx("div",{className:"space-y-2",children:Object.entries(d).sort(([,x],[,S])=>S-x).map(([x,S])=>{const p=S/v*100,b=vn[x]||"#64748b";return o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[o.jsx("span",{className:"font-medium",style:{color:b},children:x}),o.jsx("span",{className:"text-gm-text-tertiary font-mono",children:S})]}),o.jsx("div",{className:"w-full h-2 bg-gm-surface-secondary rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full rounded-full transition-all",style:{width:`${p}%`,backgroundColor:b}})})]},x)})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{className:"bg-gm-surface-primary border border-gm-border-primary rounded-xl p-5",children:[o.jsxs("h3",{className:"text-xs font-semibold text-gm-text-tertiary uppercase tracking-wider mb-3 flex items-center gap-1.5",children:[o.jsx(ya,{className:"w-3.5 h-3.5"})," Key People",n.isLoading&&o.jsx(J,{className:"w-3 h-3 animate-spin"})]}),m.length===0?o.jsx("p",{className:"text-xs text-gm-text-tertiary text-center py-4",children:"No centrality data"}):o.jsx("div",{className:"space-y-2",children:m.slice(0,10).map((x,S)=>{const p=String(x.name||x.label||x.id||""),b=Number(x.score||x.centrality||x.degree||0),E=String(x.type||x.label||"");return o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-7 h-7 rounded-full flex items-center justify-center text-[10px] font-bold text-white shrink-0",style:{backgroundColor:vn[E]||"#ec4899"},children:p.charAt(0).toUpperCase()}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-xs font-medium text-gm-text-primary truncate",children:p}),o.jsx("div",{className:"w-full h-1 bg-gm-surface-secondary rounded-full mt-0.5",children:o.jsx("div",{className:"h-full bg-pink-500 rounded-full",style:{width:`${Math.min(b*100,100)}%`}})})]}),o.jsx("span",{className:"text-[10px] text-gm-text-tertiary font-mono shrink-0",children:b.toFixed(3)})]},S)})})]}),o.jsxs("div",{className:"bg-gm-surface-primary border border-gm-border-primary rounded-xl p-5",children:[o.jsxs("h3",{className:"text-xs font-semibold text-gm-text-tertiary uppercase tracking-wider mb-3 flex items-center gap-1.5",children:[o.jsx(Sn,{className:"w-3.5 h-3.5"})," Bridge Nodes",s.isLoading&&o.jsx(J,{className:"w-3 h-3 animate-spin"})]}),g.length===0?o.jsx("p",{className:"text-xs text-gm-text-tertiary text-center py-4",children:"No bridge data"}):o.jsx("div",{className:"space-y-2",children:g.slice(0,10).map((x,S)=>{const p=String(x.name||x.label||x.id||""),b=Number(x.score||x.betweenness||0),E=String(x.type||x.label||"");return o.jsxs("div",{className:"flex items-center gap-2 bg-[var(--gm-surface-hover)] rounded-lg p-2",children:[o.jsx("div",{className:"w-2 h-2 rounded-full shrink-0",style:{backgroundColor:vn[E]||"#64748b"}}),o.jsx("span",{className:"text-xs text-gm-text-primary truncate flex-1",children:p}),o.jsx("span",{className:"text-[10px] text-gm-text-tertiary capitalize",children:E}),o.jsx("span",{className:"text-[10px] text-gm-text-tertiary font-mono",children:b.toFixed(3)})]},S)})})]})]}),u.length>0&&o.jsxs("div",{className:"bg-gm-surface-primary border border-gm-border-primary rounded-xl p-5",children:[o.jsxs("h3",{className:"text-xs font-semibold text-gm-text-tertiary uppercase tracking-wider mb-3 flex items-center gap-1.5",children:[o.jsx(ba,{className:"w-3.5 h-3.5"})," Communities",t.isLoading&&o.jsx(J,{className:"w-3 h-3 animate-spin"}),o.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded-full bg-gm-surface-secondary",children:u.length})]}),o.jsx("div",{className:"grid grid-cols-3 gap-2",children:u.map((x,S)=>{const p=x.members||x.nodes||[],b=String(x.name||x.label||`Community ${S+1}`);return o.jsxs("div",{className:"bg-[var(--gm-surface-hover)] rounded-lg p-3",children:[o.jsx("p",{className:"text-xs font-medium text-gm-text-primary mb-1",children:b}),o.jsxs("p",{className:"text-[10px] text-gm-text-tertiary",children:[p.length," members"]}),o.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[p.slice(0,5).map((E,j)=>o.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-gm-surface-secondary text-gm-text-tertiary truncate max-w-[80px]",children:String(E.name||E.label||E.id||"")},j)),p.length>5&&o.jsxs("span",{className:"text-[9px] text-gm-text-tertiary",children:["+",p.length-5]})]})]},S)})})]}),h.length>0&&o.jsxs("div",{className:"bg-blue-600/5 border-l-[3px] border-gm-interactive-primary rounded-r-lg p-4",children:[o.jsxs("h3",{className:"text-[10px] font-semibold text-gm-interactive-primary uppercase tracking-wider mb-2 flex items-center gap-1.5",children:[o.jsx(Te,{className:"w-3.5 h-3.5"})," AI Recommendations"]}),o.jsx("ul",{className:"space-y-1.5",children:h.map((x,S)=>o.jsxs("li",{className:"text-xs text-gm-text-primary flex items-start gap-2",children:[o.jsx("span",{className:"text-gm-interactive-primary mt-0.5",children:""})," ",x]},S))})]})]})}function It({icon:e,label:t,value:n,color:s,bgColor:r}){return o.jsx("div",{className:"bg-gm-surface-primary border border-gm-border-primary rounded-xl px-4 py-3",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:ae("w-8 h-8 rounded-lg flex items-center justify-center",r),children:o.jsx(e,{className:ae("w-4 h-4",s)})}),o.jsxs("div",{children:[o.jsx("span",{className:ae("text-lg font-bold",s),children:n}),o.jsx("p",{className:"text-[10px] text-gm-text-tertiary uppercase tracking-wider",children:t})]})]})})}const st={Project:"#6366f1",Person:"#ec4899",Team:"#8b5cf6",Document:"#06b6d4",Fact:"#f59e0b",Decision:"#a855f7",Risk:"#ef4444",Action:"#22c55e",Question:"#3b82f6",Email:"#f97316",Contact:"#ec4899",Sprint:"#14b8a6"};function bg(){const[e,t]=M.useState("entities"),[n,s]=M.useState(""),[r,i]=M.useState("");wa();const a=va(),c=Na(),f=Sa(),l=ja(),d=_a(),h=Ea(),u=Ca(),m=ka(),g=Ma(),w=Ia(),v=Pa(),x=Aa(),S=Ta(),p=Da(),b=Ra(),E=La(),j=za(),k=Oa(),T=$a(),D=Ha(),F=c.data?.entities||c.data?.types||[],A=f.data?.relations||f.data?.types||[],R=l.data?.suggestions||[],O=a.data||{},y=d.data||{},_=h.data?.compliance||h.data||{},C=_.issues||_.violations||[],P=u.data?.changes||u.data||[],N=m.data||{},I=g.data?.unused||g.data||{},z=I.entities||[],H=I.relations||[],$=w.data||{},Y=[{key:"entities",label:"Entities",icon:On,count:F.length},{key:"relations",label:"Relations",icon:Sn,count:A.length},{key:"suggestions",label:"AI Suggestions",icon:Te,count:R.length},{key:"stats",label:"Stats",icon:$n},{key:"changes",label:"Changes",icon:bs},{key:"cleanup",label:"Cleanup",icon:Ae},{key:"jobs",label:"Jobs",icon:Lt}],G=()=>{n.trim()&&S.mutate({name:n.trim()},{onSuccess:()=>{ee.success("Entity type added"),s("")},onError:()=>ee.error("Failed to add entity type")})},Z=()=>{r.trim()&&p.mutate({name:r.trim()},{onSuccess:()=>{ee.success("Relation type added"),i("")},onError:()=>ee.error("Failed to add relation type")})};return o.jsxs("div",{className:"h-full flex flex-col",children:[o.jsx("div",{className:"flex gap-1 px-4 border-b border-gm-border-primary bg-gm-surface-secondary shrink-0",children:Y.map(L=>{const B=L.icon;return o.jsxs("button",{onClick:()=>t(L.key),className:ae("flex items-center gap-1.5 px-3 py-2 text-[10px] font-medium border-b-2 transition-colors",e===L.key?"border-gm-interactive-primary text-gm-interactive-primary":"border-transparent text-gm-text-tertiary hover:text-gm-text-primary"),children:[o.jsx(B,{className:"w-3 h-3"})," ",L.label,L.count!==void 0&&L.count>0&&o.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded-full bg-gm-surface-secondary text-gm-text-tertiary",children:L.count})]},L.key)})}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[e==="entities"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex gap-2 items-center",children:[o.jsx("input",{value:n,onChange:L=>s(L.target.value),placeholder:"New entity type...",className:"flex-1 bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-1.5 text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus",onKeyDown:L=>L.key==="Enter"&&G()}),o.jsxs("button",{onClick:G,disabled:S.isPending||!n.trim(),className:"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover disabled:opacity-50 flex items-center gap-1 transition-colors",children:[o.jsx(ws,{className:"w-3 h-3"})," Add"]})]}),c.isLoading?o.jsx(J,{className:"w-5 h-5 animate-spin text-gm-interactive-primary mx-auto"}):o.jsx("div",{className:"grid grid-cols-3 gap-2",children:F.map((L,B)=>{const V=String(L.name||L.type||L.label||""),X=Number(L.count||L.instances||0),Q=L.properties||[],U=st[V]||(L.color?String(L.color):"#64748b");return o.jsxs("div",{className:"bg-[var(--gm-surface-hover)] rounded-xl p-3 border border-gm-border-primary hover:border-blue-600/20 transition-colors",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[o.jsx("div",{className:"w-3 h-3 rounded-full shrink-0",style:{backgroundColor:U}}),o.jsx("span",{className:"text-xs font-semibold text-gm-text-primary",children:V}),X>0&&o.jsx("span",{className:"text-[10px] text-gm-text-tertiary ml-auto",children:X})]}),Q.length>0&&o.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[Q.slice(0,4).map((q,K)=>o.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-gm-surface-secondary text-gm-text-tertiary",children:String(q.name||q)},K)),Q.length>4&&o.jsxs("span",{className:"text-[9px] text-gm-text-tertiary",children:["+",Q.length-4]})]})]},B)})})]}),e==="relations"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex gap-2 items-center",children:[o.jsx("input",{value:r,onChange:L=>i(L.target.value),placeholder:"New relation type...",className:"flex-1 bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-1.5 text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus",onKeyDown:L=>L.key==="Enter"&&Z()}),o.jsxs("button",{onClick:Z,disabled:p.isPending||!r.trim(),className:"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover disabled:opacity-50 flex items-center gap-1 transition-colors",children:[o.jsx(ws,{className:"w-3 h-3"})," Add"]})]}),f.isLoading?o.jsx(J,{className:"w-5 h-5 animate-spin text-gm-interactive-primary mx-auto"}):o.jsx("div",{className:"space-y-1.5",children:A.map((L,B)=>{const V=String(L.name||L.type||L.label||""),X=Number(L.count||L.instances||0),Q=String(L.from||L.source||L.from_type||""),U=String(L.to||L.target||L.to_type||"");return o.jsxs("div",{className:"flex items-center gap-2 bg-[var(--gm-surface-hover)] rounded-lg p-2.5",children:[Q&&o.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded font-medium",style:{backgroundColor:`${st[Q]||"#64748b"}20`,color:st[Q]||"#64748b"},children:Q}),o.jsxs("span",{className:"text-xs font-medium text-gm-interactive-primary",children:[" ",V.replace(/_/g," ")," "]}),U&&o.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded font-medium",style:{backgroundColor:`${st[U]||"#64748b"}20`,color:st[U]||"#64748b"},children:U}),X>0&&o.jsx("span",{className:"text-[10px] text-gm-text-tertiary ml-auto",children:X})]},B)})})]}),e==="suggestions"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex gap-2 items-center",children:[o.jsxs("button",{onClick:()=>k.mutate(void 0,{onSuccess:()=>ee.success("Graph analysis started  new suggestions will appear shortly")}),disabled:k.isPending,className:"px-3 py-1.5 rounded-lg bg-blue-600/10 text-gm-interactive-primary text-xs font-medium hover:bg-blue-600/20 disabled:opacity-50 flex items-center gap-1.5 transition-colors",children:[k.isPending?o.jsx(J,{className:"w-3.5 h-3.5 animate-spin"}):o.jsx(dc,{className:"w-3.5 h-3.5"})," Analyze Graph"]}),o.jsxs("button",{onClick:()=>j.mutate({minConfidence:.8},{onSuccess:()=>ee.success("High-confidence suggestions auto-approved")}),disabled:j.isPending||R.length===0,className:"px-3 py-1.5 rounded-lg bg-gm-status-success-bg text-gm-status-success text-xs font-medium hover:bg-green-500/20 disabled:opacity-50 flex items-center gap-1.5 transition-colors",children:[j.isPending?o.jsx(J,{className:"w-3.5 h-3.5 animate-spin"}):o.jsx(fc,{className:"w-3.5 h-3.5"})," Auto-Approve (80%)"]}),o.jsxs("button",{onClick:()=>D.mutate(void 0,{onSuccess:()=>ee.success("Relationship inference started")}),disabled:D.isPending,className:"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors",children:[D.isPending?o.jsx(J,{className:"w-3.5 h-3.5 animate-spin"}):o.jsx(Sn,{className:"w-3.5 h-3.5"})," Infer Relations"]})]}),l.isLoading?o.jsx(J,{className:"w-5 h-5 animate-spin text-gm-interactive-primary mx-auto"}):R.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Te,{className:"w-10 h-10 mx-auto mb-3 text-gray-600"}),o.jsx("p",{className:"text-xs text-gm-text-tertiary",children:"No AI suggestions pending"})]}):o.jsx("div",{className:"space-y-2",children:R.map((L,B)=>{const V=String(L.type||L.suggestion_type||""),X=String(L.name||L.suggested_name||L.content||""),Q=String(L.reason||L.explanation||""),U=Number(L.confidence||0);return o.jsx("div",{className:"bg-[var(--gm-surface-hover)] rounded-xl p-3 border border-gm-border-primary",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(Te,{className:"w-4 h-4 text-gm-interactive-primary shrink-0 mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-xs font-semibold text-gm-text-primary",children:X}),o.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-blue-600/10 text-gm-interactive-primary capitalize",children:V}),U>0&&o.jsxs("span",{className:"text-[10px] text-gm-text-tertiary",children:[Math.round(U*100),"%"]})]}),Q&&o.jsx("p",{className:"text-[10px] text-gm-text-tertiary mt-1",children:Q})]}),o.jsxs("div",{className:"flex gap-1 shrink-0",children:[o.jsx("button",{onClick:()=>v.mutate({id:String(L.id)},{onSuccess:()=>ee.success("Approved")}),disabled:v.isPending,className:"p-1.5 rounded-lg bg-gm-status-success-bg text-gm-status-success hover:bg-green-500/20 transition-colors",children:o.jsx(wr,{className:"w-3.5 h-3.5"})}),o.jsx("button",{onClick:()=>x.mutate({id:String(L.id)},{onSuccess:()=>ee.success("Rejected")}),disabled:x.isPending,className:"p-1.5 rounded-lg bg-gm-status-danger-bg text-gm-status-danger hover:bg-red-500/20 transition-colors",children:o.jsx(hc,{className:"w-3.5 h-3.5"})})]})]})},B)})})]}),e==="stats"&&o.jsx("div",{className:"space-y-4",children:a.isLoading?o.jsx(J,{className:"w-5 h-5 animate-spin text-gm-interactive-primary mx-auto"}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"grid grid-cols-3 gap-3",children:Object.entries(O).filter(([,L])=>typeof L=="number").slice(0,9).map(([L,B])=>o.jsxs("div",{className:"bg-gm-surface-secondary rounded-xl p-3 border border-gm-border-primary",children:[o.jsx("p",{className:"text-lg font-bold text-gm-text-primary",children:String(B)}),o.jsx("p",{className:"text-[10px] text-gm-text-tertiary capitalize",children:L.replace(/_/g," ")})]},L))}),C.length>0&&o.jsxs("div",{className:"bg-[var(--gm-status-warning-bg)] border border-yellow-500/20 rounded-xl p-4",children:[o.jsxs("h4",{className:"text-xs font-semibold text-gm-status-warning mb-2 flex items-center gap-1.5",children:[o.jsx(ct,{className:"w-3.5 h-3.5"})," Compliance Issues (",C.length,")"]}),o.jsx("div",{className:"space-y-1.5",children:C.slice(0,5).map((L,B)=>o.jsx("p",{className:"text-xs text-gm-text-primary",children:String(L.message||L.description||JSON.stringify(L))},B))})]})]})}),e==="changes"&&o.jsxs("div",{className:"space-y-4",children:[!m.isLoading&&Object.keys(N).length>0&&o.jsxs("div",{className:"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary",children:[o.jsxs("h4",{className:"text-xs font-semibold text-gm-text-primary mb-3 flex items-center gap-1.5",children:[o.jsx(bc,{className:"w-3.5 h-3.5"})," Ontology Diff"]}),o.jsx("div",{className:"space-y-2 text-xs",children:Object.entries(N).map(([L,B])=>o.jsxs("div",{children:[o.jsx("span",{className:"text-gm-text-tertiary capitalize font-medium",children:L.replace(/_/g," ")}),o.jsx("pre",{className:"text-[10px] text-gm-text-primary mt-1 bg-gm-surface-secondary rounded-lg p-2 overflow-x-auto",children:typeof B=="string"?B:JSON.stringify(B,null,2)})]},L))})]}),u.isLoading?o.jsx(J,{className:"w-5 h-5 animate-spin text-gm-interactive-primary mx-auto"}):P.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(bs,{className:"w-10 h-10 mx-auto mb-3 text-gray-600"}),o.jsx("p",{className:"text-xs text-gm-text-tertiary",children:"No changes recorded"})]}):o.jsx("div",{className:"space-y-1.5",children:P.slice(0,30).map((L,B)=>o.jsxs("div",{className:"flex items-start gap-2 bg-[var(--gm-surface-hover)] rounded-lg p-2.5 border border-gm-border-primary",children:[o.jsx("div",{className:ae("w-2 h-2 rounded-full mt-1 shrink-0",String(L.action||L.type)==="add"?"bg-gm-status-success":String(L.action||L.type)==="remove"?"bg-gm-status-danger":"bg-gm-status-warning")}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-xs text-gm-text-primary",children:String(L.description||L.message||L.action||"")}),o.jsxs("p",{className:"text-[10px] text-gm-text-tertiary",children:[String(L.target||L.entity||""),"  ",L.created_at?new Date(String(L.created_at)).toLocaleString():""]})]})]},B))}),!w.isLoading&&Object.keys($).length>0&&o.jsxs("div",{className:"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary",children:[o.jsxs("h4",{className:"text-xs font-semibold text-gm-text-primary mb-2 flex items-center gap-1.5",children:[o.jsx(zt,{className:"w-3.5 h-3.5"})," Sync Status"]}),o.jsx("div",{className:"space-y-1 text-xs",children:Object.entries($).map(([L,B])=>o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-gm-text-tertiary capitalize w-28 shrink-0",children:L.replace(/_/g," ")}),o.jsx("span",{className:"text-gm-text-primary text-[10px]",children:B==null?"":String(B)})]},L))})]})]}),e==="cleanup"&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3",children:[o.jsxs("h4",{className:"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5",children:[o.jsx(ct,{className:"w-3.5 h-3.5 text-gm-status-warning"})," Unused Types"]}),g.isLoading?o.jsx(J,{className:"w-4 h-4 animate-spin"}):o.jsxs(o.Fragment,{children:[z.length>0?o.jsxs("div",{children:[o.jsxs("p",{className:"text-[10px] text-gm-text-tertiary uppercase tracking-wider mb-1.5",children:["Entities (",z.length,")"]}),o.jsx("div",{className:"flex flex-wrap gap-1.5",children:z.map(L=>o.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-gm-status-warning-bg text-gm-status-warning font-medium",children:L},L))})]}):o.jsx("p",{className:"text-xs text-gm-text-tertiary",children:"All entity types in use"}),H.length>0&&o.jsxs("div",{children:[o.jsxs("p",{className:"text-[10px] text-gm-text-tertiary uppercase tracking-wider mb-1.5",children:["Relations (",H.length,")"]}),o.jsx("div",{className:"flex flex-wrap gap-1.5",children:H.map(L=>o.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-gm-status-warning-bg text-gm-status-warning font-medium",children:L},L))})]})]})]}),o.jsxs("div",{className:"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3",children:[o.jsxs("h4",{className:"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5",children:[o.jsx(Ae,{className:"w-3.5 h-3.5"})," Cleanup Unused"]}),o.jsx("p",{className:"text-[10px] text-gm-text-tertiary",children:"Remove unused entity and relation types from the ontology schema."}),o.jsxs("div",{className:"flex gap-2",children:[z.length>0&&o.jsxs("button",{onClick:()=>T.mutate({entities:z},{onSuccess:()=>ee.success("Unused entities removed")}),disabled:T.isPending,className:"px-3 py-1.5 rounded-lg bg-gm-status-danger-bg text-gm-status-danger text-xs font-medium hover:bg-red-500/20 disabled:opacity-50 flex items-center gap-1.5 transition-colors",children:[T.isPending?o.jsx(J,{className:"w-3.5 h-3.5 animate-spin"}):o.jsx(Ae,{className:"w-3.5 h-3.5"})," Remove Entities"]}),H.length>0&&o.jsxs("button",{onClick:()=>T.mutate({relations:H},{onSuccess:()=>ee.success("Unused relations removed")}),disabled:T.isPending,className:"px-3 py-1.5 rounded-lg bg-gm-status-danger-bg text-gm-status-danger text-xs font-medium hover:bg-red-500/20 disabled:opacity-50 flex items-center gap-1.5 transition-colors",children:[T.isPending?o.jsx(J,{className:"w-3.5 h-3.5 animate-spin"}):o.jsx(Ae,{className:"w-3.5 h-3.5"})," Remove Relations"]})]})]})]}),e==="jobs"&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary",children:[o.jsx("h4",{className:"text-xs font-semibold text-gm-text-primary mb-2",children:"Background Worker"}),d.isLoading?o.jsx(J,{className:"w-4 h-4 animate-spin"}):o.jsxs("div",{className:"space-y-1 text-xs text-gm-text-secondary",children:[o.jsxs("p",{children:["Status: ",o.jsx("span",{className:ae("font-medium",y.status==="running"||y.running?"text-gm-status-success":"text-gm-text-tertiary"),children:String(y.status||(y.running?"Running":"Idle"))})]}),y.lastRun&&o.jsxs("p",{children:["Last run: ",new Date(String(y.lastRun||y.last_run)).toLocaleString()]}),y.nextRun&&o.jsxs("p",{children:["Next run: ",new Date(String(y.nextRun||y.next_run)).toLocaleString()]})]})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("button",{onClick:()=>b.mutate(void 0,{onSuccess:()=>ee.success("Worker triggered")}),disabled:b.isPending,className:"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors",children:[b.isPending?o.jsx(J,{className:"w-3.5 h-3.5 animate-spin"}):o.jsx(yr,{className:"w-3.5 h-3.5"})," Trigger Worker"]}),o.jsxs("button",{onClick:()=>E.mutate(void 0,{onSuccess:()=>ee.success("Sync triggered")}),disabled:E.isPending,className:"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors",children:[E.isPending?o.jsx(J,{className:"w-3.5 h-3.5 animate-spin"}):o.jsx(Lt,{className:"w-3.5 h-3.5"})," Force Sync"]})]})]})]})]})}const wg=["Who are the key people in this project?","What are the main risks identified?","Show me connections between teams and documents","What decisions have been made recently?","Find all action items and their owners","What are the open questions?"];function vg({open:e,onClose:t}){const[n,s]=M.useState([]),[r,i]=M.useState(""),[a,c]=M.useState(null),f=M.useRef(null),l=M.useRef(null),d=Fa();M.useEffect(()=>{e&&l.current&&l.current.focus()},[e]),M.useEffect(()=>{f.current&&(f.current.scrollTop=f.current.scrollHeight)},[n]);const h=M.useCallback(u=>{const m=(u||r).trim();if(!m)return;i("");const g={role:"user",content:m,timestamp:new Date().toLocaleTimeString()};s(w=>[...w,g]),d.mutate({query:m},{onSuccess:w=>{const v=w,x={role:"assistant",content:String(v.answer||v.response||"No answer generated."),cypher:v.cypherUsed?String(v.cypherUsed):void 0,sources:v.sources,reasoning:v.reasoning,timestamp:new Date().toLocaleTimeString()};s(S=>[...S,x])},onError:()=>{s(w=>[...w,{role:"assistant",content:"Failed to query the knowledge graph. Please try again.",timestamp:new Date().toLocaleTimeString()}])}})},[r,d]);return e?o.jsxs("div",{className:"fixed bottom-4 right-4 w-96 h-[600px] bg-gm-surface-primary border border-gm-border-primary rounded-2xl shadow-2xl z-50 flex flex-col overflow-hidden",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-600/10 to-transparent border-b border-gm-border-primary shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-600/20 flex items-center justify-center",children:o.jsx(Te,{className:"w-4 h-4 text-gm-interactive-primary"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-semibold text-gm-text-primary",children:"Graph Copilot"}),o.jsx("p",{className:"text-[10px] text-gm-text-tertiary",children:"Ask anything about your knowledge graph"})]})]}),o.jsx("button",{onClick:t,className:"p-1.5 rounded-lg hover:bg-gm-surface-secondary text-gm-text-tertiary hover:text-gm-text-primary transition-colors",children:o.jsx(br,{className:"w-4 h-4"})})]}),o.jsxs("div",{ref:f,className:"flex-1 overflow-y-auto p-4 space-y-3",children:[n.length===0&&o.jsxs("div",{className:"text-center py-6",children:[o.jsx(Va,{className:"w-10 h-10 mx-auto mb-3 text-gray-600"}),o.jsx("p",{className:"text-xs text-gm-text-tertiary mb-4",children:"Ask me about your knowledge graph"}),o.jsx("div",{className:"space-y-1.5",children:wg.map((u,m)=>o.jsx("button",{onClick:()=>h(u),className:"w-full text-left px-3 py-2 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-[10px] text-gm-text-primary hover:bg-gm-surface-hover hover:border-blue-600/30 transition-colors",children:u},m))})]}),n.map((u,m)=>o.jsx("div",{className:ae("flex",u.role==="user"?"justify-end":"justify-start"),children:o.jsxs("div",{className:ae("max-w-[85%] rounded-xl px-3 py-2",u.role==="user"?"bg-gm-interactive-primary text-gm-text-on-brand":"bg-gm-surface-secondary border border-gm-border-primary"),children:[o.jsx("p",{className:ae("text-xs leading-relaxed whitespace-pre-wrap",u.role==="user"?"":"text-gm-text-primary"),children:u.content}),u.reasoning&&u.reasoning.length>0&&o.jsxs("div",{className:"mt-2 pt-2 border-t border-[var(--gm-border-primary)]",children:[o.jsx("p",{className:"text-[9px] text-gm-text-tertiary font-semibold uppercase mb-1",children:"Reasoning"}),u.reasoning.map((g,w)=>o.jsxs("p",{className:"text-[10px] text-gm-text-tertiary flex items-start gap-1",children:[o.jsxs("span",{className:"text-gm-interactive-primary",children:[w+1,"."]})," ",g]},w))]}),u.cypher&&o.jsxs("div",{className:"mt-2",children:[o.jsxs("button",{onClick:()=>c(a===m?null:m),className:"text-[9px] text-gm-interactive-primary hover:underline flex items-center gap-1",children:[o.jsx(Ot,{className:"w-3 h-3"})," ",a===m?"Hide":"Show"," Cypher"]}),a===m&&o.jsx("pre",{className:"mt-1 p-2 rounded bg-gm-surface-secondary text-[9px] text-gm-text-primary font-mono overflow-x-auto",children:u.cypher})]}),u.sources&&u.sources.length>0&&o.jsxs("div",{className:"mt-2 pt-2 border-t border-[var(--gm-border-primary)]",children:[o.jsxs("p",{className:"text-[9px] text-gm-text-tertiary font-semibold uppercase mb-1",children:["Sources (",u.sources.length,")"]}),u.sources.slice(0,3).map((g,w)=>o.jsx("p",{className:"text-[10px] text-gm-text-tertiary truncate",children:String(g.name||g.title||g.label||JSON.stringify(g).substring(0,60))},w))]}),o.jsx("p",{className:ae("text-[9px] mt-1",u.role==="user"?"text-white/50":"text-gray-500"),children:u.timestamp})]})},m)),d.isPending&&o.jsx("div",{className:"flex justify-start",children:o.jsxs("div",{className:"bg-gm-surface-secondary border border-gm-border-primary rounded-xl px-3 py-2 flex items-center gap-2",children:[o.jsx(J,{className:"w-3.5 h-3.5 animate-spin text-gm-interactive-primary"}),o.jsx("span",{className:"text-xs text-gm-text-tertiary",children:"Querying knowledge graph..."})]})})]}),o.jsx("div",{className:"shrink-0 px-4 py-3 border-t border-gm-border-primary bg-gm-surface-secondary",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{ref:l,value:r,onChange:u=>i(u.target.value),onKeyDown:u=>u.key==="Enter"&&!u.shiftKey&&h(),placeholder:"Ask about the knowledge graph...",className:"flex-1 bg-gm-surface-primary border border-gm-border-primary rounded-lg px-3 py-2 text-xs text-gm-text-primary placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-gm-border-focus"}),o.jsx("button",{onClick:()=>h(),disabled:d.isPending||!r.trim(),className:"w-8 h-8 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand flex items-center justify-center hover:bg-gm-interactive-primary-hover disabled:opacity-50 transition-colors",children:d.isPending?o.jsx(J,{className:"w-3.5 h-3.5 animate-spin"}):o.jsx(mc,{className:"w-3.5 h-3.5"})})]})})]}):null}function Ng(){const[e,t]=M.useState("connection"),[n,s]=M.useState({uri:"",username:"",password:"",database:""}),[r,i]=M.useState(null),a=Ba(),c=Ga(),f=Ya(),l=Xa(),d=Wa(),h=Za(),u=qa(),m=Qa(),g=Ua(),w=Ka(),v=Ja(),x=ec(),S=tc(),p=nc(),b=a.data||{},E=c.data||{},j=f.data?.providers||[],k=l.data?.graphs||l.data||[],T=d.data||{},D=h.data||{},F=[{key:"connection",label:"Connection",icon:vs},{key:"management",label:"Management",icon:Lt},{key:"graphs",label:"Graphs",icon:Nt},{key:"status",label:"Status",icon:hn}],A=()=>{u.mutate(n,{onSuccess:()=>{ee.success("Connected to graph database"),a.refetch(),c.refetch()},onError:()=>ee.error("Connection failed")})},R=()=>{m.mutate(n.uri?n:{},{onSuccess:y=>{y?.ok?ee.success("Connection test passed"):ee.warning("Connection test returned issues")},onError:()=>ee.error("Connection test failed")})},O=y=>{p.mutate(y,{onSuccess:()=>{ee.success(`Graph "${y}" deleted`),l.refetch(),i(null)},onError:()=>ee.error("Delete failed")})};return o.jsxs("div",{className:"h-full flex flex-col",children:[o.jsx("div",{className:"flex gap-1 px-4 border-b border-gm-border-primary bg-gm-surface-secondary shrink-0",children:F.map(y=>{const _=y.icon;return o.jsxs("button",{onClick:()=>t(y.key),className:ae("flex items-center gap-1.5 px-3 py-2 text-[10px] font-medium border-b-2 transition-colors",e===y.key?"border-gm-interactive-primary text-gm-interactive-primary":"border-transparent text-gm-text-tertiary hover:text-gm-text-primary"),children:[o.jsx(_,{className:"w-3 h-3"})," ",y.label]},y.key)})}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[e==="connection"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary",children:[o.jsxs("h4",{className:"text-xs font-semibold text-gm-text-primary mb-3 flex items-center gap-1.5",children:[o.jsx(hn,{className:"w-3.5 h-3.5"})," Current Connection"]}),a.isLoading?o.jsx(J,{className:"w-4 h-4 animate-spin"}):o.jsxs("div",{className:"space-y-1.5 text-xs",children:[Object.entries(b).filter(([y])=>!y.toLowerCase().includes("password")).map(([y,_])=>o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gm-text-tertiary capitalize",children:y.replace(/_/g," ")}),o.jsx("span",{className:"text-gm-text-primary font-medium",children:String(_??"")})]},y)),Object.keys(b).length===0&&o.jsx("p",{className:"text-gm-text-tertiary",children:"No connection configured"})]})]}),j.length>0&&o.jsxs("div",{className:"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary",children:[o.jsxs("h4",{className:"text-xs font-semibold text-gm-text-primary mb-3 flex items-center gap-1.5",children:[o.jsx(Hn,{className:"w-3.5 h-3.5"})," Available Providers"]}),o.jsx("div",{className:"space-y-2",children:j.map((y,_)=>o.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[o.jsx("div",{className:ae("w-2 h-2 rounded-full",y.available?"bg-gm-status-success":"bg-gm-text-tertiary")}),o.jsx("span",{className:"text-gm-text-primary font-medium",children:String(y.name||y.type||y.provider||"")}),y.version&&o.jsxs("span",{className:"text-gm-text-tertiary",children:["v",String(y.version)]})]},_))})]}),o.jsxs("div",{className:"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary",children:[o.jsx("h4",{className:"text-xs font-semibold text-gm-text-primary mb-3",children:"Connect to Graph Database"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] text-gm-text-tertiary uppercase tracking-wider",children:"URI"}),o.jsx("input",{value:n.uri,onChange:y=>s(_=>({..._,uri:y.target.value})),placeholder:"bolt://localhost:7687",className:"mt-1 w-full bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-1.5 text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] text-gm-text-tertiary uppercase tracking-wider",children:"Username"}),o.jsx("input",{value:n.username,onChange:y=>s(_=>({..._,username:y.target.value})),placeholder:"neo4j",className:"mt-1 w-full bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-1.5 text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] text-gm-text-tertiary uppercase tracking-wider",children:"Password"}),o.jsx("input",{type:"password",value:n.password,onChange:y=>s(_=>({..._,password:y.target.value})),className:"mt-1 w-full bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-1.5 text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] text-gm-text-tertiary uppercase tracking-wider",children:"Database"}),o.jsx("input",{value:n.database,onChange:y=>s(_=>({..._,database:y.target.value})),placeholder:"neo4j",className:"mt-1 w-full bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-1.5 text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus"})]}),o.jsxs("div",{className:"flex gap-2 pt-1",children:[o.jsxs("button",{onClick:R,disabled:m.isPending,className:"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors",children:[m.isPending?o.jsx(J,{className:"w-3.5 h-3.5 animate-spin"}):o.jsx(gc,{className:"w-3.5 h-3.5"})," Test"]}),o.jsxs("button",{onClick:A,disabled:u.isPending,className:"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors",children:[u.isPending?o.jsx(J,{className:"w-3.5 h-3.5 animate-spin"}):o.jsx(vs,{className:"w-3.5 h-3.5"})," Connect"]})]})]})]})]}),e==="management"&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary",children:[o.jsxs("h4",{className:"text-xs font-semibold text-gm-text-primary mb-3 flex items-center gap-1.5",children:[o.jsx(sc,{className:"w-3.5 h-3.5"})," Sync & Indexing"]}),o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsxs("button",{onClick:()=>g.mutate(void 0,{onSuccess:()=>ee.success("Full sync started")}),disabled:g.isPending,className:"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors",children:[g.isPending?o.jsx(J,{className:"w-3.5 h-3.5 animate-spin"}):o.jsx(zt,{className:"w-3.5 h-3.5"})," Full Sync"]}),o.jsxs("button",{onClick:()=>v.mutate(void 0,{onSuccess:()=>ee.success("Indexes created")}),disabled:v.isPending,className:"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors",children:[v.isPending?o.jsx(J,{className:"w-3.5 h-3.5 animate-spin"}):o.jsx(Nt,{className:"w-3.5 h-3.5"})," Create Indexes"]}),o.jsxs("button",{onClick:()=>w.mutate(void 0,{onSuccess:()=>ee.success("Sync cleanup done")}),disabled:w.isPending,className:"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors",children:[w.isPending?o.jsx(J,{className:"w-3.5 h-3.5 animate-spin"}):o.jsx(rc,{className:"w-3.5 h-3.5"})," Sync Cleanup"]})]})]}),o.jsxs("div",{className:"bg-[var(--gm-status-danger-bg)] rounded-xl p-4 border border-red-500/20",children:[o.jsxs("h4",{className:"text-xs font-semibold text-gm-status-danger mb-3 flex items-center gap-1.5",children:[o.jsx(ct,{className:"w-3.5 h-3.5"})," Cleanup Operations"]}),o.jsx("p",{className:"text-[10px] text-gm-text-tertiary mb-3",children:"These operations modify graph data. Use with caution."}),o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsxs("button",{onClick:()=>x.mutate(void 0,{onSuccess:y=>ee.success(`Cleaned ${y?.removed??""} orphan nodes`)}),disabled:x.isPending,className:"px-3 py-1.5 rounded-lg bg-gm-status-warning-bg text-gm-status-warning text-xs font-medium hover:bg-yellow-500/20 disabled:opacity-50 flex items-center gap-1.5 transition-colors",children:[x.isPending?o.jsx(J,{className:"w-3.5 h-3.5 animate-spin"}):o.jsx(Ae,{className:"w-3.5 h-3.5"})," Clean Orphans"]}),o.jsxs("button",{onClick:()=>S.mutate(void 0,{onSuccess:y=>ee.success(`Merged ${y?.merged??""} duplicates`)}),disabled:S.isPending,className:"px-3 py-1.5 rounded-lg bg-gm-status-warning-bg text-gm-status-warning text-xs font-medium hover:bg-yellow-500/20 disabled:opacity-50 flex items-center gap-1.5 transition-colors",children:[S.isPending?o.jsx(J,{className:"w-3.5 h-3.5 animate-spin"}):o.jsx(Ae,{className:"w-3.5 h-3.5"})," Clean Duplicates"]})]})]}),o.jsxs("div",{className:"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary",children:[o.jsx("h4",{className:"text-xs font-semibold text-gm-text-primary mb-3",children:"Sync Status"}),d.isLoading?o.jsx(J,{className:"w-4 h-4 animate-spin"}):o.jsx("div",{className:"space-y-1.5 text-xs",children:Object.entries(T).filter(([,y])=>y!=null).slice(0,10).map(([y,_])=>o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gm-text-tertiary capitalize",children:y.replace(/_/g," ")}),o.jsx("span",{className:"text-gm-text-primary font-medium",children:typeof _=="boolean"?_?"":"":String(_)})]},y))})]})]}),e==="graphs"&&o.jsx("div",{className:"space-y-4",children:l.isLoading?o.jsx(J,{className:"w-5 h-5 animate-spin text-gm-interactive-primary mx-auto"}):o.jsxs(o.Fragment,{children:[Array.isArray(k)&&k.length>0?o.jsx("div",{className:"space-y-2",children:k.map((y,_)=>{const C=String(y.name||y.graph||y.id||`graph-${_}`),P=Number(y.node_count||y.nodes||0),N=Number(y.edge_count||y.edges||0);return o.jsxs("div",{className:"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary flex items-center gap-3",children:[o.jsx(Nt,{className:"w-5 h-5 text-gm-interactive-primary shrink-0"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-xs font-semibold text-gm-text-primary",children:C}),o.jsxs("p",{className:"text-[10px] text-gm-text-tertiary",children:[P," nodes  ",N," edges"]})]}),r===C?o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:()=>O(C),disabled:p.isPending,className:"px-2 py-1 rounded text-[10px] bg-gm-status-danger text-white font-medium",children:p.isPending?o.jsx(J,{className:"w-3 h-3 animate-spin"}):"Confirm"}),o.jsx("button",{onClick:()=>i(null),className:"px-2 py-1 rounded text-[10px] bg-gm-surface-secondary text-gm-text-tertiary",children:"Cancel"})]}):o.jsx("button",{onClick:()=>i(C),className:"p-1.5 rounded-lg text-gm-text-tertiary hover:bg-gm-status-danger-bg hover:text-gm-status-danger transition-colors",children:o.jsx(Ae,{className:"w-3.5 h-3.5"})})]},_)})}):o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Nt,{className:"w-10 h-10 mx-auto mb-3 text-gray-600"}),o.jsx("p",{className:"text-xs text-gm-text-tertiary",children:"No graphs found"})]}),Object.keys(D).length>0&&o.jsxs("div",{className:"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary",children:[o.jsx("h4",{className:"text-xs font-semibold text-gm-text-primary mb-3",children:"Multi-Graph Stats"}),o.jsx("div",{className:"grid grid-cols-3 gap-3",children:Object.entries(D).filter(([,y])=>typeof y=="number").slice(0,6).map(([y,_])=>o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-lg font-bold text-gm-text-primary",children:String(_)}),o.jsx("p",{className:"text-[10px] text-gm-text-tertiary capitalize",children:y.replace(/_/g," ")})]},y))})]})]})}),e==="status"&&o.jsx("div",{className:"space-y-4",children:c.isLoading?o.jsx(J,{className:"w-5 h-5 animate-spin text-gm-interactive-primary mx-auto"}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary",children:[o.jsxs("h4",{className:"text-xs font-semibold text-gm-text-primary mb-3 flex items-center gap-1.5",children:[o.jsx(hn,{className:"w-3.5 h-3.5"})," Graph Database Status"]}),o.jsxs("div",{className:"space-y-2 text-xs",children:[Object.entries(E).filter(([,y])=>y!=null).map(([y,_])=>o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-gm-text-tertiary capitalize",children:y.replace(/_/g," ")}),o.jsx("span",{className:ae("font-medium",_==="healthy"||_===!0||_==="connected"?"text-gm-status-success":_==="degraded"||_==="warning"?"text-gm-status-warning":_==="error"||_===!1||_==="disconnected"?"text-gm-status-danger":"text-gm-text-primary"),children:typeof _=="boolean"?_?o.jsx(wr,{className:"w-3.5 h-3.5 inline"}):o.jsx(ct,{className:"w-3.5 h-3.5 inline"}):String(_)})]},y)),Object.keys(E).length===0&&o.jsx("p",{className:"text-gm-text-tertiary",children:"No status data available"})]})]}),o.jsxs("button",{onClick:()=>{c.refetch(),d.refetch(),a.refetch()},className:"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover flex items-center gap-1.5 transition-colors",children:[o.jsx(zt,{className:"w-3.5 h-3.5"})," Refresh Status"]})]})})]})]})}const we={Project:"#6366f1",Person:"#ec4899",Team:"#8b5cf6",Document:"#06b6d4",Fact:"#f59e0b",Decision:"#a855f7",Risk:"#ef4444",Action:"#22c55e",Question:"#3b82f6",Email:"#f97316",Contact:"#ec4899",Sprint:"#14b8a6"};function Sg(){const{filters:e,setFilters:t,toggleType:n,selectedNodeId:s,setSelectedNodeId:r}=oi(),{nodes:i,edges:a,isLoading:c,error:f}=hg(),{nodes:l,edges:d}=mg(i,a),{sync:h,isSyncing:u,status:m}=gg(),[g,w]=M.useState("explorer"),[v,x]=M.useState(!1),[S,p]=M.useState(!1),[b,E]=M.useState(!1),j=M.useMemo(()=>l.map(N=>({id:N.id,position:N.position||{x:0,y:0},data:{label:N.data?.label||N.id,type:N.label||N.data?.type||"unknown",tier:N.data?.tier??2},type:"default",style:{background:we[N.label||""]||"#64748b",color:"#fff",border:s===N.id?"3px solid #fff":"1px solid rgba(255,255,255,0.2)",borderRadius:N.data?.tier===0?"50%":"12px",padding:N.data?.tier===0?"16px":"8px 12px",fontSize:N.data?.tier===0?"14px":N.data?.tier===1?"12px":"10px",fontWeight:N.data?.tier===0?"700":"500",width:N.data?.tier===0?"80px":"auto",height:N.data?.tier===0?"80px":"auto",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:s===N.id?"0 0 20px rgba(99,102,241,0.5)":"0 2px 8px rgba(0,0,0,0.3)",cursor:"pointer"}})),[l,s]),k=M.useMemo(()=>d.map(N=>({id:N.id,source:N.source,target:N.target,label:N.label||void 0,animated:N.animated||!1,style:N.style||{stroke:"rgba(148,163,184,0.4)",strokeWidth:1},type:"default",labelStyle:{fontSize:"8px",fill:"#94a3b8"}})),[d]),[T,D,F]=Mm(j),[A,R,O]=Im(k);M.useEffect(()=>{D(j)},[j]),M.useEffect(()=>{R(k)},[k]);const y=M.useCallback((N,I)=>{r(s===I.id?null:I.id),E(!1)},[s,r]),_=i.find(N=>N.id===s),C=a.filter(N=>N.source===s||N.target===s),P=[{key:"explorer",label:"Explorer",icon:hs},{key:"query",label:"Query",icon:Ot},{key:"analytics",label:"Analytics",icon:$n},{key:"ontology",label:"Ontology",icon:Hn},{key:"settings",label:"Settings",icon:Lt}];return o.jsxs("div",{className:"flex flex-col h-[calc(100vh-4rem)]",children:[o.jsxs("div",{className:"flex items-center justify-between px-5 py-2.5 border-b border-gm-border-primary bg-gm-surface-primary shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("h1",{className:"text-base font-bold text-gm-text-primary",children:"Knowledge Graph"}),o.jsxs("span",{className:"text-[10px] text-gm-text-tertiary bg-gm-surface-secondary px-2 py-0.5 rounded-full",children:[i.length," nodes  ",a.length," edges"]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"flex bg-gm-surface-secondary rounded-lg border border-gm-border-primary overflow-hidden",role:"tablist",children:P.map(N=>{const I=N.icon;return o.jsxs("button",{onClick:()=>w(N.key),role:"tab","aria-selected":g===N.key,className:ae("px-3 py-1.5 text-[10px] font-medium flex items-center gap-1 transition-colors",g===N.key?"bg-gm-interactive-primary text-gm-text-on-brand":"text-gm-text-tertiary hover:text-gm-text-primary"),children:[o.jsx(I,{className:"w-3 h-3"})," ",N.label]},N.key)})}),g==="explorer"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"relative",children:[o.jsx(oc,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 w-3 h-3 text-gm-text-tertiary"}),o.jsx("input",{value:e.searchQuery,onChange:N=>t(I=>({...I,searchQuery:N.target.value})),placeholder:"Search nodes...","aria-label":"Search graph nodes",className:"pl-7 pr-3 py-1.5 bg-gm-surface-secondary border border-gm-border-primary rounded-lg text-[10px] text-gm-text-primary w-36 focus:outline-none focus:ring-2 focus:ring-gm-border-focus"})]}),o.jsxs("button",{onClick:()=>x(!v),"aria-expanded":v,className:ae("px-2 py-1.5 rounded-lg text-[10px] font-medium border flex items-center gap-1 transition-colors",v?"bg-blue-600/10 border-blue-600/30 text-gm-interactive-primary":"bg-gm-surface-secondary border-gm-border-primary text-gm-text-tertiary"),children:[o.jsx(pc,{className:"w-3 h-3"})," Filters"]})]}),o.jsxs("button",{onClick:()=>h(),disabled:u,"aria-label":"Sync knowledge graph",className:"px-2.5 py-1.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-[10px] font-medium hover:bg-gm-interactive-primary-hover flex items-center gap-1 disabled:opacity-50 transition-colors",children:[u?o.jsx(J,{className:"w-3 h-3 animate-spin"}):o.jsx(zt,{className:"w-3 h-3"})," Sync"]}),o.jsxs("button",{onClick:()=>p(!S),"aria-expanded":S,className:ae("px-2.5 py-1.5 rounded-lg text-[10px] font-medium flex items-center gap-1 transition-colors border",S?"bg-blue-600/10 border-blue-600/30 text-gm-interactive-primary":"bg-gm-surface-secondary border-gm-border-primary text-gm-text-tertiary hover:text-gm-text-primary"),children:[o.jsx(Te,{className:"w-3 h-3"})," AI Copilot"]})]})]}),v&&g==="explorer"&&o.jsx("div",{className:"flex items-center gap-1.5 px-5 py-2 border-b border-gm-border-primary bg-[var(--gm-surface-hover)] flex-wrap shrink-0",children:Object.entries(e.toggles).map(([N,I])=>o.jsx("button",{onClick:()=>n(N),className:ae("px-2 py-0.5 rounded-md text-[10px] font-medium transition-colors border",I?"border-current/20 text-gm-text-primary":"border-gm-border-primary text-gray-500 line-through"),style:{backgroundColor:I?`${we[N]||"#64748b"}15`:void 0,color:I?we[N]||"#64748b":void 0},children:N},N))}),o.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[g==="explorer"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex-1 relative",children:[c?o.jsx("div",{className:"flex items-center justify-center h-full",children:o.jsx(J,{className:"h-8 w-8 animate-spin text-gm-interactive-primary"})}):f?o.jsx("div",{className:"flex items-center justify-center h-full",children:o.jsxs("div",{className:"text-center",children:[o.jsx(ct,{className:"h-10 w-10 text-gm-status-danger mx-auto mb-3"}),o.jsx("p",{className:"text-xs text-gm-text-tertiary mb-3",children:"Failed to load graph. Try syncing."}),o.jsx("button",{onClick:()=>h(),className:"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium",children:"Sync Graph"})]})}):i.length===0?o.jsx("div",{className:"flex items-center justify-center h-full",children:o.jsxs("div",{className:"text-center",children:[o.jsx(hs,{className:"h-12 w-12 mx-auto mb-4 text-gray-600"}),o.jsx("p",{className:"text-sm text-gm-text-tertiary mb-1",children:"No graph data yet"}),o.jsx("p",{className:"text-xs text-gray-400 mb-3",children:"Process documents and sync to populate the knowledge graph"}),o.jsx("button",{onClick:()=>h(),className:"px-4 py-2 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover transition-colors",children:"Sync Graph"})]})}):o.jsxs(km,{nodes:T,edges:A,onNodesChange:F,onEdgesChange:O,onNodeClick:y,fitView:!0,fitViewOptions:{padding:.3},minZoom:.1,maxZoom:3,proOptions:{hideAttribution:!0},className:"bg-gm-surface-primary",children:[o.jsx(Rm,{color:"rgba(148,163,184,0.15)",gap:24,size:1}),o.jsx(Vm,{showInteractive:!1,className:"!bg-gm-surface-secondary !border-gm-border-primary !rounded-lg !shadow-lg"}),o.jsx(tg,{nodeColor:N=>we[N.data?.type]||"#64748b",className:"!bg-gm-surface-secondary !border-gm-border-primary !rounded-lg"})]}),i.length>0&&o.jsx("div",{className:"absolute bottom-14 left-3 bg-gm-surface-primary backdrop-blur-sm border border-gm-border-primary rounded-lg p-2 flex flex-wrap gap-x-3 gap-y-1 max-w-xs",children:Object.entries(we).filter(([N])=>i.some(I=>(I.label||I.data?.type)===N)).map(([N,I])=>o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:I}}),o.jsx("span",{className:"text-[9px] text-gm-text-tertiary",children:N})]},N))})]}),_&&!b&&o.jsx("div",{className:"w-72 border-l border-gm-border-primary bg-gm-surface-primary overflow-y-auto shrink-0",children:o.jsxs("div",{className:"p-4 space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h3",{className:"text-sm font-semibold text-gm-text-primary truncate",children:_.data?.label||_.id}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:()=>E(!0),"aria-label":"Collapse detail panel",className:"p-1 rounded hover:bg-gm-surface-secondary",children:o.jsx(ms,{className:"w-3.5 h-3.5 text-gm-text-tertiary"})}),o.jsx("button",{onClick:()=>r(null),"aria-label":"Close detail panel",className:"p-1 rounded hover:bg-gm-surface-secondary",children:o.jsx(br,{className:"w-3.5 h-3.5 text-gm-text-tertiary"})})]})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-[10px] font-medium text-gm-text-tertiary uppercase tracking-wider",children:"Type"}),o.jsx("p",{className:"text-xs font-medium mt-0.5 px-2 py-0.5 rounded inline-block",style:{backgroundColor:`${we[_.label||""]||"#64748b"}20`,color:we[_.label||""]||"#64748b"},children:_.label||_.data?.type||"unknown"})]}),_.data?.tier!==void 0&&o.jsxs("div",{children:[o.jsx("span",{className:"text-[10px] font-medium text-gm-text-tertiary uppercase tracking-wider",children:"Tier"}),o.jsx("p",{className:"text-xs text-gm-text-primary mt-0.5",children:_.data.tier})]}),_.data?.metadata&&typeof _.data.metadata=="object"&&o.jsxs("div",{children:[o.jsx("span",{className:"text-[10px] font-medium text-gm-text-tertiary uppercase tracking-wider",children:"Details"}),o.jsx("div",{className:"mt-1.5 space-y-1.5",children:Object.entries(_.data.metadata).filter(([N,I])=>I!=null&&I!=="").slice(0,10).map(([N,I])=>o.jsxs("div",{className:"text-[10px]",children:[o.jsx("span",{className:"text-gm-text-tertiary capitalize",children:N.replace(/_/g," ")}),o.jsx("p",{className:"text-gm-text-primary break-all mt-0.5",children:String(I).substring(0,200)})]},N))})]}),o.jsxs("div",{children:[o.jsxs("span",{className:"text-[10px] font-medium text-gm-text-tertiary uppercase tracking-wider flex items-center gap-1",children:[o.jsx(Nn,{className:"w-3 h-3"})," Connections (",C.length,")"]}),o.jsxs("div",{className:"mt-1.5 space-y-1",children:[C.slice(0,15).map(N=>{const I=N.source===s?N.target:N.source,z=i.find($=>$.id===I),H=z?.label||z?.data?.type||"";return o.jsxs("button",{onClick:()=>{r(I),E(!1)},className:"w-full text-left flex items-center gap-2 text-[10px] px-2 py-1.5 rounded-lg hover:bg-gm-surface-secondary transition-colors",children:[o.jsx("div",{className:"w-2 h-2 rounded-full shrink-0",style:{backgroundColor:we[H]||"#64748b"}}),o.jsx("span",{className:"text-gm-text-tertiary truncate",children:N.label||"related"}),o.jsx("span",{className:"text-gm-text-primary truncate",children:z?.data?.label||I})]},N.id)}),C.length>15&&o.jsxs("p",{className:"text-[10px] text-gm-text-tertiary text-center",children:["+",C.length-15," more"]})]})]})]})}),_&&b&&o.jsx("button",{onClick:()=>E(!1),className:"absolute right-2 top-1/2 -translate-y-1/2 w-6 h-16 bg-gm-surface-secondary border border-gm-border-primary rounded-l-lg flex items-center justify-center hover:bg-gm-surface-hover transition-colors",style:{borderColor:we[_.label||""]||"#64748b"},children:o.jsx(ms,{className:"w-3 h-3 text-gm-text-tertiary rotate-180"})})]}),g==="query"&&o.jsx("div",{className:"flex-1 bg-gm-surface-primary",children:o.jsx(xg,{})}),g==="analytics"&&o.jsx("div",{className:"flex-1 bg-gm-surface-primary",children:o.jsx(yg,{})}),g==="ontology"&&o.jsx("div",{className:"flex-1 bg-gm-surface-primary",children:o.jsx(bg,{})}),g==="settings"&&o.jsx("div",{className:"flex-1 bg-gm-surface-primary",children:o.jsx(Ng,{})})]}),m&&o.jsxs("div",{className:"flex items-center gap-3 px-5 py-1.5 border-t border-gm-border-primary text-[10px] text-gm-text-tertiary bg-gm-surface-secondary shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("div",{className:ae("w-1.5 h-1.5 rounded-full",m.health_status==="healthy"?"bg-gm-status-success":m.health_status==="degraded"?"bg-gm-status-warning":"bg-gm-status-danger")}),o.jsx("span",{className:"capitalize",children:m.health_status})]}),m.last_synced_at&&o.jsxs("span",{children:["Synced: ",new Date(m.last_synced_at).toLocaleString()]}),o.jsxs("span",{className:"flex items-center gap-0.5",children:[o.jsx(On,{className:"w-3 h-3"})," ",m.node_count," nodes"]}),o.jsxs("span",{className:"flex items-center gap-0.5",children:[o.jsx(Nn,{className:"w-3 h-3"})," ",m.edge_count," edges"]})]}),o.jsx(vg,{open:S,onClose:()=>p(!1)})]})}function Xg(){return o.jsx(ig,{children:o.jsx(Sg,{})})}export{Xg as default};
//# sourceMappingURL=GraphPage-BYyCSCmt.js.map

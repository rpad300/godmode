import{c as F,d7 as Z,r as a,j as e,N as k,g as we,ag as Se,af as ne,a0 as ie,ae as le,a as o,$ as Ce,O as l,df as K,eB as ce,T as ke,ad as oe,d6 as Ae,cf as Pe,b1 as _,eC as Te,C as _e,F as Ie,eD as Le,eE as De,eF as Ee,eG as ze,eH as Me,eI as Ue,eJ as Re,b4 as $e,av as Oe,b3 as te,K as V,an as Fe,Z as de,J as Ke,eK as Be}from"./main-fI1tvvj5.js";import{I as me,A as Ge}from"./AvatarUpload-BgZivgCc.js";import{A as Ve,a as He,b as Je,c as Ye,d as qe,e as We,f as Ze,g as Xe}from"./alert-dialog-DoicuCuq.js";import{M as xe,L as pe}from"./monitor-BDKpbneq.js";import{S as he}from"./sparkles-BVZ2_1k0.js";import{L as Qe}from"./link-2-pRFXINl4.js";import{G as X}from"./globe-wrEFY_Ku.js";import{K as ae}from"./key-Ct4KUgKI.js";import{C as se}from"./circle-x-ClEi8u6i.js";import{E as O,C as et,P as tt}from"./palette-BZlKlUXk.js";import{L as ge}from"./lightbulb-Bu8JpZHP.js";import{L as ue}from"./list-checks-Cksw-JPh.js";import{C as at}from"./chevron-up-CmBp8Ii2.js";import{C as st}from"./chevron-down-Cv_bzBMP.js";import{P as rt}from"./plus-B5uVkXEF.js";import{E as nt}from"./eye-CkHWNw62.js";import{P as ve}from"./pen-COGw609H.js";import{A as Q}from"./arrow-left-BmkUHkl7.js";import"./upload-PuE9TYGO.js";import"./index-DHyBFhrO.js";import"./index-ZO6WGjvj.js";const it=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]],lt=F("at-sign",it);const ct=[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]],je=F("headphones",ct);const ot=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],dt=F("lock",ot);const mt=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]],H=F("text-align-start",mt);const xt=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],pt=F("type",xt),T="rounded-xl border border-[var(--gm-border-primary)] bg-[var(--gm-surface-primary)] shadow-[var(--shadow-sm)] transition-all duration-200",b="w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] placeholder:text-[var(--gm-text-placeholder)] focus:outline-none focus:border-[var(--gm-border-focus)] focus:shadow-[var(--shadow-focus)] transition-all duration-150",L="inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg bg-[var(--gm-interactive-primary)] text-[var(--gm-text-on-brand)] hover:bg-[var(--gm-interactive-primary-hover)] shadow-sm transition-all duration-150 disabled:opacity-50",E="inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg bg-[var(--gm-interactive-secondary)] text-[var(--gm-text-primary)] hover:bg-[var(--gm-interactive-secondary-hover)] border border-[var(--gm-border-primary)] transition-all duration-150",ht="inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg bg-[var(--color-danger-500)] text-white hover:bg-[var(--color-danger-600)] shadow-sm transition-all duration-150 disabled:opacity-50",D="text-[10px] font-bold text-[var(--gm-accent-primary)] uppercase tracking-[0.1em]",C="text-[10px] font-bold text-[var(--gm-text-tertiary)] uppercase tracking-wider mb-1 flex items-center gap-1.5",gt=[{id:"general",label:"General",icon:ne},{id:"security",label:"Security",icon:dt},{id:"sessions",label:"Sessions",icon:xe},{id:"settings",label:"User Settings",icon:he},{id:"companies",label:"Companies",icon:ie},{id:"integrations",label:"Integrations",icon:Qe}];function M({title:t,subtitle:d}){return e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-bold text-[var(--gm-text-primary)]",children:t}),d&&e.jsx("p",{className:"text-xs text-[var(--gm-text-tertiary)] mt-0.5",children:d})]})}const qt=()=>{const{user:t,isLoading:d}=Z(),[n,i]=a.useState("general");if(d)return e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(k,{className:"h-6 w-6 animate-spin text-[var(--gm-accent-primary)]"})});const g=we(t?.display_name||t?.email||"");return e.jsxs("div",{className:"flex h-full",children:[e.jsxs("div",{className:"w-48 shrink-0 border-r border-[var(--gm-border-primary)] bg-[var(--gm-bg-primary)] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center gap-2.5 px-4 py-4 border-b border-[var(--gm-border-primary)]",children:[Se(t?.avatar_url)?e.jsx("img",{src:t.avatar_url,alt:t?.display_name||"",className:"w-7 h-7 rounded-full object-cover",onError:h=>{h.target.style.display="none"}}):e.jsx("div",{className:"w-7 h-7 rounded-full bg-[var(--gm-interactive-primary)]/10 flex items-center justify-center",children:e.jsx("span",{className:"text-[10px] font-bold text-[var(--gm-accent-primary)]",children:g})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("span",{className:"text-sm font-bold text-[var(--gm-accent-primary)]",children:"Profile"}),e.jsx("p",{className:"text-[10px] text-[var(--gm-text-tertiary)] truncate",children:t?.email})]})]}),e.jsx("nav",{className:"py-2",children:gt.map(h=>{const r=h.icon,x=n===h.id;return e.jsxs("button",{onClick:()=>i(h.id),className:o("w-full flex items-center gap-2.5 px-4 py-2 text-xs transition-colors",x?"text-[var(--gm-accent-primary)] bg-[var(--gm-surface-hover)] font-semibold":"text-[var(--gm-text-tertiary)] hover:text-[var(--gm-text-primary)] hover:bg-[var(--gm-surface-hover)]"),children:[e.jsx(r,{className:"w-3.5 h-3.5 shrink-0"}),e.jsx("span",{className:"flex-1 text-left",children:h.label}),x&&e.jsx(le,{className:"w-3 h-3 shrink-0"})]},h.id)})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[n==="general"&&e.jsx(ut,{}),n==="security"&&e.jsx(vt,{}),n==="sessions"&&e.jsx(jt,{}),n==="settings"&&e.jsx(bt,{}),n==="companies"&&e.jsx(wt,{}),n==="integrations"&&e.jsx(Nt,{})]})]})};function ut(){const{user:t,updateProfile:d,uploadAvatar:n,deleteAvatar:i}=Z(),[g,h]=a.useState(""),[r,x]=a.useState(""),[v,N]=a.useState(""),[j,p]=a.useState(""),[f,A]=a.useState("Europe/Lisbon"),[P,m]=a.useState("en"),[y,u]=a.useState(!1);a.useEffect(()=>{t&&(h(t.username||""),x(t.display_name||""),p(t.avatar_url||""),A(t.timezone||"Europe/Lisbon"))},[t]);const U=async()=>{if(g&&!/^[a-zA-Z0-9_]{3,30}$/.test(g)){l.error("Username must be 3-30 characters, alphanumeric and underscores only");return}if(r&&r.trim().length<2){l.error("Display name must be at least 2 characters");return}u(!0);try{await d.mutateAsync({username:g,display_name:r,avatar_url:j||void 0,timezone:f}),l.success("Profile updated")}catch(w){l.error(w.message||"Failed to update profile")}finally{u(!1)}};return e.jsxs("div",{className:"space-y-5",children:[e.jsx(M,{title:"General",subtitle:"Manage your account information and preferences"}),e.jsxs("div",{className:o(T,"p-5 space-y-5"),children:[e.jsx("h3",{className:D,children:"Account Information"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:C,children:[e.jsx(Ce,{className:"w-3 h-3"})," Email"]}),e.jsx("input",{value:t?.email||"",readOnly:!0,className:o(b,"opacity-60 cursor-not-allowed")}),e.jsx("p",{className:"text-[10px] text-[var(--gm-text-tertiary)] mt-1",children:"Email cannot be changed"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:C,children:[e.jsx(lt,{className:"w-3 h-3"})," Username"]}),e.jsx("input",{value:g,onChange:w=>h(w.target.value),className:b})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:C,children:[e.jsx(pt,{className:"w-3 h-3"})," Display Name"]}),e.jsx("input",{value:r,onChange:w=>x(w.target.value),className:b})]}),e.jsxs("div",{children:[e.jsxs("label",{className:C,children:[e.jsx(H,{className:"w-3 h-3"})," Bio"]}),e.jsx("textarea",{value:v,onChange:w=>N(w.target.value),placeholder:"Tell us a bit about yourself",rows:3,className:o(b,"resize-y")})]}),e.jsxs("div",{children:[e.jsxs("label",{className:C,children:[e.jsx(me,{className:"w-3 h-3"})," Avatar"]}),e.jsx("div",{className:"mt-2",children:e.jsx(Ge,{currentUrl:j,name:r||g||t?.email||"",onUpload:async w=>{const z=await n.mutateAsync(w);return p(z),l.success("Avatar uploaded"),z},onUrlChange:w=>{p(w),l.info("URL set — click Save to apply")},onRemove:async()=>{await i.mutateAsync(),p(""),l.success("Avatar removed")},size:"lg"})})]})]}),e.jsxs("div",{className:o(T,"p-5 space-y-4"),children:[e.jsx("h3",{className:D,children:"Preferences"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:C,children:[e.jsx(X,{className:"w-3 h-3"})," Timezone"]}),e.jsxs("select",{value:f,onChange:w=>A(w.target.value),className:b,children:[e.jsx("option",{value:"Europe/Lisbon",children:"Lisbon, Portugal (+00:00)"}),e.jsx("option",{value:"Europe/London",children:"London, UK (+00:00)"}),e.jsx("option",{value:"Europe/Paris",children:"Paris, France (+01:00)"}),e.jsx("option",{value:"Europe/Berlin",children:"Berlin, Germany (+01:00)"}),e.jsx("option",{value:"America/New_York",children:"New York, USA (-05:00)"}),e.jsx("option",{value:"America/Los_Angeles",children:"Los Angeles, USA (-08:00)"}),e.jsx("option",{value:"Asia/Tokyo",children:"Tokyo, Japan (+09:00)"}),e.jsx("option",{value:"Australia/Sydney",children:"Sydney, Australia (+11:00)"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:C,children:[e.jsx(pe,{className:"w-3 h-3"})," Language"]}),e.jsxs("select",{value:P,onChange:w=>m(w.target.value),className:b,children:[e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"pt",children:"Português"}),e.jsx("option",{value:"es",children:"Español"}),e.jsx("option",{value:"fr",children:"Français"}),e.jsx("option",{value:"de",children:"Deutsch"})]})]})]}),e.jsx("div",{className:"flex justify-end pt-2",children:e.jsxs("button",{onClick:U,disabled:y,className:L,children:[y?e.jsx(k,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(K,{className:"w-3.5 h-3.5"}),y?"Saving...":"Save Changes"]})})]})]})}function vt(){const{resetPassword:t}=ce(),[d,n]=a.useState(""),[i,g]=a.useState(""),[h,r]=a.useState(""),[x,v]=a.useState(!1),N=async()=>{if(!i||!h){l.error("Please fill in all password fields");return}if(i!==h){l.error("New passwords do not match");return}if(i.length<6){l.error("Password must be at least 6 characters");return}v(!0);try{await t(i),l.success("Password updated successfully"),n(""),g(""),r("")}catch(p){l.error(p.message||"Failed to update password")}finally{v(!1)}},j=()=>{l.error("Account deletion requires contacting an administrator")};return e.jsxs("div",{className:"space-y-5",children:[e.jsx(M,{title:"Security",subtitle:"Manage your password and account security"}),e.jsxs("div",{className:o(T,"p-5 space-y-4"),children:[e.jsx("h3",{className:D,children:"Change Password"}),e.jsxs("div",{children:[e.jsxs("label",{className:C,children:[e.jsx(ae,{className:"w-3 h-3"})," Current Password"]}),e.jsx("input",{type:"password",value:d,onChange:p=>n(p.target.value),className:b})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:C,children:"New Password"}),e.jsx("input",{type:"password",value:i,onChange:p=>g(p.target.value),className:b})]}),e.jsxs("div",{children:[e.jsx("label",{className:C,children:"Confirm Password"}),e.jsx("input",{type:"password",value:h,onChange:p=>r(p.target.value),className:b})]})]}),e.jsx("p",{className:"text-[10px] text-[var(--gm-accent-primary)]",children:"Minimum 6 characters"}),e.jsx("div",{className:"flex justify-end pt-2",children:e.jsxs("button",{onClick:N,disabled:x,className:L,children:[x?e.jsx(k,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(ae,{className:"w-3.5 h-3.5"}),x?"Updating...":"Update Password"]})})]}),e.jsxs("div",{className:"rounded-xl border border-[var(--color-danger-500)]/30 bg-[var(--color-danger-500)]/5 p-5",children:[e.jsxs("h3",{className:"text-xs font-bold text-[var(--color-danger-500)] mb-1 flex items-center gap-2",children:[e.jsx(ke,{className:"w-3.5 h-3.5"})," Danger Zone"]}),e.jsx("p",{className:"text-[10px] text-[var(--gm-text-tertiary)] mb-3",children:"Permanently delete your account and all associated data. This action cannot be undone."}),e.jsxs("button",{onClick:j,className:ht,children:[e.jsx(oe,{className:"w-3.5 h-3.5"})," Delete Account"]})]})]})}function jt(){const{logout:t}=ce(),d=[{id:"1",userAgent:navigator.userAgent,ip:"::1",lastActive:"Just now",current:!0}],n=async()=>{try{await t(),l.success("All other sessions signed out")}catch{l.error("Failed to sign out other sessions")}};return e.jsxs("div",{className:"space-y-5",children:[e.jsx(M,{title:"Sessions",subtitle:"Active login sessions for your account"}),e.jsxs("div",{className:o(T,"p-5 space-y-4"),children:[e.jsx("h3",{className:D,children:"Active Sessions"}),e.jsx("div",{className:"space-y-3",children:d.map(i=>e.jsxs("div",{className:o("flex items-center gap-4 p-4 rounded-lg border",i.current?"border-[var(--gm-accent-primary)]/30 bg-[var(--gm-accent-primary)]/5":"border-[var(--gm-border-primary)]"),children:[e.jsx(xe,{className:"w-7 h-7 text-[var(--gm-text-tertiary)] flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs text-[var(--gm-text-primary)] break-all",children:i.userAgent}),e.jsxs("p",{className:"text-[10px] text-[var(--gm-text-tertiary)] mt-1",children:[i.ip," • Last active: ",i.lastActive]})]}),i.current&&e.jsx("span",{className:"text-[10px] font-bold text-[var(--gm-accent-primary)] bg-[var(--gm-accent-primary)]/10 px-2 py-0.5 rounded-full flex-shrink-0",children:"Current"})]},i.id))}),e.jsx("div",{className:"flex justify-end pt-2",children:e.jsxs("button",{onClick:n,className:E,children:[e.jsx(Ae,{className:"w-3.5 h-3.5"})," Sign out all other sessions"]})})]})]})}function yt({meeting:t}){const{data:d,isLoading:n}=Be(t.meeting_id),[i,g]=a.useState("outline"),h=[{id:"transcript",label:"Transcript",icon:V,available:!0},{id:"outline",label:"Outline",icon:H,available:t.detailed_summary.length>0},{id:"keypoints",label:"Key Points",icon:ge,available:t.key_points.length>0},{id:"actions",label:"Actions",icon:ue,available:t.action_items.length>0},{id:"audio",label:"Audio",icon:je,available:!0}];return e.jsxs("div",{className:"border-t border-[var(--gm-border-primary)]/50 mx-4 mb-2",children:[e.jsx("div",{className:"flex gap-0.5 pt-2 pb-1 overflow-x-auto",children:h.map(({id:r,label:x,icon:v,available:N})=>e.jsxs("button",{onClick:()=>g(r),className:o("flex items-center gap-1 px-2.5 py-1.5 rounded-md text-[10px] font-medium whitespace-nowrap transition-colors",i===r?"bg-[var(--gm-accent-primary)]/10 text-[var(--gm-accent-primary)]":N?"text-[var(--gm-text-tertiary)] hover:text-[var(--gm-text-primary)] hover:bg-[var(--gm-surface-hover)]":"text-[var(--gm-text-tertiary)]/40 cursor-default"),children:[e.jsx(v,{className:"w-3 h-3"}),x,r==="actions"&&t.action_items.length>0&&e.jsxs("span",{className:"ml-0.5 text-[9px] opacity-60",children:["(",t.action_items.length,")"]}),r==="keypoints"&&t.key_points.length>0&&e.jsxs("span",{className:"ml-0.5 text-[9px] opacity-60",children:["(",t.key_points.length,")"]}),r==="outline"&&t.detailed_summary.length>0&&e.jsxs("span",{className:"ml-0.5 text-[9px] opacity-60",children:["(",t.detailed_summary.length,")"]})]},r))}),e.jsxs("div",{className:"pb-3 pt-1",children:[i==="transcript"&&e.jsx("div",{children:n?e.jsxs("div",{className:"flex items-center gap-2 py-4 justify-center",children:[e.jsx(k,{className:"w-4 h-4 animate-spin text-[var(--gm-text-tertiary)]"}),e.jsx("span",{className:"text-[10px] text-[var(--gm-text-tertiary)]",children:"Fetching transcript..."})]}):d?.transcript?e.jsx("pre",{className:"text-[10px] text-[var(--gm-text-secondary)] whitespace-pre-wrap max-h-[200px] overflow-y-auto bg-[var(--gm-bg-tertiary)] rounded-md p-3 font-mono leading-relaxed",children:d.transcript}):e.jsx("p",{className:"text-[10px] text-[var(--gm-text-tertiary)] italic py-2",children:d?.error||"No transcript content available."})}),i==="outline"&&e.jsx("div",{className:"space-y-2 max-h-[200px] overflow-y-auto",children:t.detailed_summary.length>0?t.detailed_summary.map((r,x)=>e.jsxs("div",{className:"text-[10px]",children:[e.jsx("span",{className:"font-medium text-[var(--gm-text-primary)]",children:r.title}),e.jsx("p",{className:"text-[var(--gm-text-tertiary)] mt-0.5",children:r.description})]},x)):e.jsx("p",{className:"text-[10px] text-[var(--gm-text-tertiary)] italic",children:"No outline available."})}),i==="keypoints"&&e.jsx("ul",{className:"space-y-1.5 max-h-[200px] overflow-y-auto",children:t.key_points.length>0?t.key_points.map((r,x)=>e.jsxs("li",{className:"text-[10px] text-[var(--gm-text-tertiary)] flex gap-1.5",children:[e.jsx("span",{className:"text-[var(--gm-accent-primary)] mt-0.5 flex-shrink-0",children:"•"}),e.jsx("span",{children:r.replace(/\{\{.*?\}\}/g,"").trim()})]},x)):e.jsx("p",{className:"text-[10px] text-[var(--gm-text-tertiary)] italic",children:"No key points available."})}),i==="actions"&&e.jsx("ul",{className:"space-y-1.5 max-h-[200px] overflow-y-auto",children:t.action_items.length>0?t.action_items.map((r,x)=>e.jsxs("li",{className:"text-[10px] flex items-start gap-1.5",children:[e.jsx("span",{className:o("mt-0.5 flex-shrink-0",r.completed?"text-emerald-500":"text-[var(--gm-text-tertiary)]"),children:r.completed?"✓":"○"}),e.jsx("span",{className:"text-[var(--gm-text-primary)] flex-1",children:r.title}),r.assignee&&e.jsx("span",{className:"text-[9px] px-1.5 py-0 rounded border border-[var(--gm-border-primary)] text-[var(--gm-text-tertiary)] flex-shrink-0",children:r.assignee})]},x)):e.jsx("p",{className:"text-[10px] text-[var(--gm-text-tertiary)] italic",children:"No action items available."})}),i==="audio"&&e.jsx("div",{children:n?e.jsxs("div",{className:"flex items-center gap-2 py-4 justify-center",children:[e.jsx(k,{className:"w-4 h-4 animate-spin text-[var(--gm-text-tertiary)]"}),e.jsx("span",{className:"text-[10px] text-[var(--gm-text-tertiary)]",children:"Checking for audio..."})]}):d?.audioUrl?e.jsxs("div",{className:"space-y-2",children:[e.jsx("audio",{controls:!0,className:"w-full h-8",preload:"none",children:e.jsx("source",{src:d.audioUrl,type:"audio/mpeg"})}),e.jsxs("a",{href:d.audioUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-[10px] text-[var(--gm-accent-primary)] hover:underline",children:[e.jsx(O,{className:"w-3 h-3"})," Open audio file"]})]}):e.jsx("p",{className:"text-[10px] text-[var(--gm-text-tertiary)] italic py-2",children:"No audio recording available for this meeting."})})]})]})}function Nt(){const t=Ie(),[d,n]=Le(),{data:i=[]}=De(),[g,h]=a.useState(!1),[r,x]=a.useState(new Set),[v,N]=a.useState(null),[j,p]=a.useState(""),[f,A]=a.useState({transcript:!0,keyPoints:!0,actionItems:!0,outline:!0,audio:!0}),[P,m]=a.useState(()=>{const s=new Date;return s.setDate(s.getDate()-30),s.toISOString().split("T")[0]}),[y,u]=a.useState(()=>new Date().toISOString().split("T")[0]),{data:U,isLoading:w}=Ee(),z=ze(),$=Me(),R=Ue(),{data:B,isLoading:J}=Re({limit:50,after:P||void 0,before:y||void 0,enabled:g&&!!U?.connected});a.useEffect(()=>{const s=d.get("krisp_connected"),S=d.get("krisp_error");s==="true"?(l.success("Krisp connected successfully!"),n({},{replace:!0})):S&&(l.error(`Krisp connection failed: ${decodeURIComponent(S)}`),n({},{replace:!0}))},[d,n]);const Y=async()=>{try{const s=await z.mutateAsync();s.url&&(window.location.href=s.url)}catch{l.error("Failed to start Krisp authorization")}},c=async()=>{if(confirm("Disconnect Krisp? You can reconnect anytime."))try{await $.mutateAsync(),h(!1),l.success("Krisp disconnected")}catch{l.error("Failed to disconnect")}},ye=s=>{x(S=>{const I=new Set(S);return I.has(s)?I.delete(s):I.add(s),I})},Ne=s=>{A(S=>({...S,[s]:!S[s]}))},fe=async()=>{if(r.size===0)return l.error("Select at least one meeting");if(!j)return l.error("Select a target project");if(!f.transcript&&!f.keyPoints&&!f.actionItems&&!f.outline)return l.error("Select at least one content type to import");const s=i.find(S=>S.id===j);try{const S=await R.mutateAsync({meetingIds:Array.from(r),projectId:j,importOptions:f});S.succeeded>0&&(l.success(`Imported ${S.succeeded} meeting(s) to ${s?.name||"project"}`),x(new Set)),S.failed>0&&l.error(`${S.failed} meeting(s) failed to import`)}catch{l.error("Import failed")}},ee=U?.connected===!0,q=B?.meetings||[],be=[{key:"transcript",icon:V,label:"Transcript"},{key:"keyPoints",icon:ge,label:"Key Points"},{key:"actionItems",icon:ue,label:"Action Items"},{key:"outline",icon:H,label:"Outline"},{key:"audio",icon:je,label:"Audio"}];return e.jsxs("div",{className:"space-y-5",children:[e.jsx(M,{title:"Integrations",subtitle:"Connect external services to your account"}),e.jsxs("div",{className:o(T,"p-5"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:o(D,"flex items-center gap-2"),children:[e.jsx($e,{className:"w-3.5 h-3.5"})," Krisp AI Meeting Assistant"]}),e.jsx("p",{className:"text-[10px] text-[var(--gm-text-tertiary)] mt-1",children:"Connect your Krisp account via OAuth to import transcripts and recordings."})]}),w?e.jsx(k,{className:"w-4 h-4 animate-spin text-[var(--gm-text-tertiary)]"}):ee?e.jsxs("span",{className:"inline-flex items-center gap-1 text-[10px] font-bold text-emerald-500 bg-emerald-500/10 border border-emerald-500/30 px-2 py-0.5 rounded-full",children:[e.jsx(Oe,{className:"w-3 h-3"})," Connected"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 text-[10px] font-bold text-[var(--gm-text-tertiary)] border border-[var(--gm-border-primary)] px-2 py-0.5 rounded-full",children:[e.jsx(se,{className:"w-3 h-3"})," Not connected"]})]}),ee?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsxs("button",{onClick:()=>h(!g),className:o(L,"flex-1 justify-center py-2"),children:[e.jsx(te,{className:"w-3.5 h-3.5"}),g?"Hide Meetings":"Browse & Import Meetings"]}),e.jsxs("button",{onClick:c,disabled:$.isPending,className:o(E,"hover:text-[var(--color-danger-500)] hover:border-[var(--color-danger-500)]/30"),children:[$.isPending?e.jsx(k,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(se,{className:"w-3.5 h-3.5"}),"Disconnect"]})]}),g&&e.jsxs("div",{className:"border border-[var(--gm-border-primary)] rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 bg-[var(--gm-bg-tertiary)] border-b border-[var(--gm-border-primary)]",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-[10px] text-[var(--gm-text-tertiary)] whitespace-nowrap uppercase tracking-wider font-bold",children:"From"}),e.jsx("input",{type:"date",value:P,onChange:s=>m(s.target.value),className:"px-2 py-1 text-xs rounded-md border border-[var(--gm-border-primary)] bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-primary)]"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-[10px] text-[var(--gm-text-tertiary)] whitespace-nowrap uppercase tracking-wider font-bold",children:"To"}),e.jsx("input",{type:"date",value:y,onChange:s=>u(s.target.value),className:"px-2 py-1 text-xs rounded-md border border-[var(--gm-border-primary)] bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-primary)]"})]}),e.jsxs("span",{className:"text-[10px] text-[var(--gm-text-tertiary)] ml-auto",children:[q.length," meeting(s)"]})]}),r.size>0&&e.jsxs("div",{className:"px-4 py-3 bg-[var(--gm-accent-primary)]/5 border-b border-[var(--gm-border-primary)] space-y-2.5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-xs text-[var(--gm-text-primary)] font-medium whitespace-nowrap",children:[r.size," selected →"]}),e.jsxs("select",{value:j,onChange:s=>p(s.target.value),className:o(b,"flex-1"),children:[e.jsx("option",{value:"",children:"Select target project..."}),i.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsxs("button",{onClick:fe,disabled:R.isPending||!j,className:L,children:[R.isPending?e.jsx(k,{className:"w-3 h-3 animate-spin"}):e.jsx(te,{className:"w-3 h-3"}),"Import"]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap",children:[e.jsx("span",{className:"text-[10px] text-[var(--gm-text-tertiary)] mr-1",children:"Include:"}),be.map(({key:s,icon:S,label:I})=>e.jsxs("button",{onClick:()=>Ne(s),className:o("flex items-center gap-1 px-2 py-1 rounded-md text-[10px] font-medium border transition-colors",f[s]?"bg-[var(--gm-accent-primary)]/10 border-[var(--gm-accent-primary)]/30 text-[var(--gm-accent-primary)]":"bg-[var(--gm-bg-tertiary)] border-[var(--gm-border-primary)] text-[var(--gm-text-tertiary)]"),children:[e.jsx(S,{className:"w-3 h-3"}),I]},s))]})]}),J?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(k,{className:"w-5 h-5 animate-spin text-[var(--gm-text-tertiary)]"}),e.jsx("span",{className:"ml-2 text-xs text-[var(--gm-text-tertiary)]",children:"Loading meetings from Krisp..."})]}):q.length===0?e.jsx("div",{className:"text-center py-8 text-[var(--gm-text-tertiary)] text-xs",children:"No meetings found for the selected date range."}):e.jsx("div",{className:"max-h-[500px] overflow-y-auto divide-y divide-[var(--gm-border-primary)]",children:q.map(s=>{const S=r.has(s.meeting_id),I=v===s.meeting_id,G=j?s.importedTo.some(W=>W.projectId===j):!1;return e.jsxs("div",{className:o(S&&"bg-[var(--gm-accent-primary)]/5",G&&"opacity-60"),children:[e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[e.jsx("input",{type:"checkbox",checked:S,onChange:()=>ye(s.meeting_id),disabled:G,className:"rounded border-[var(--gm-border-primary)] flex-shrink-0"}),e.jsxs("button",{onClick:()=>N(I?null:s.meeting_id),className:"flex-1 min-w-0 text-left",children:[e.jsx("p",{className:"text-xs font-medium text-[var(--gm-text-primary)] truncate",children:s.name}),e.jsxs("div",{className:"flex items-center gap-3 mt-0.5",children:[e.jsxs("span",{className:"text-[10px] text-[var(--gm-text-tertiary)] flex items-center gap-1",children:[e.jsx(Fe,{className:"w-3 h-3"}),s.date?new Date(s.date).toLocaleDateString():"—"]}),s.speakers.length>0&&e.jsxs("span",{className:"text-[10px] text-[var(--gm-text-tertiary)] flex items-center gap-1",children:[e.jsx(ne,{className:"w-3 h-3"}),s.speakers.slice(0,3).join(", "),s.speakers.length>3&&` +${s.speakers.length-3}`]}),s.detailed_summary.length>0&&e.jsxs("span",{className:"text-[10px] text-[var(--gm-text-tertiary)]",children:[s.detailed_summary.length," topics"]}),s.key_points.length>0&&e.jsxs("span",{className:"text-[10px] text-[var(--gm-text-tertiary)]",children:[s.key_points.length," key pts"]}),s.action_items.length>0&&e.jsxs("span",{className:"text-[10px] text-[var(--gm-text-tertiary)]",children:[s.action_items.length," actions"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[G&&e.jsxs("span",{className:"inline-flex items-center gap-0.5 text-[10px] font-bold text-emerald-500 border border-emerald-500/30 px-1.5 py-0 rounded",children:[e.jsx(K,{className:"w-3 h-3"})," Imported"]}),s.importedTo.length>0&&!G&&e.jsxs("span",{className:"text-[10px] border border-[var(--gm-border-primary)] px-1.5 py-0 rounded text-[var(--gm-text-tertiary)]",children:["In ",s.importedTo.map(W=>W.projectName).join(", ")]}),e.jsx("button",{onClick:()=>N(I?null:s.meeting_id),className:"p-1 text-[var(--gm-text-tertiary)] hover:text-[var(--gm-text-primary)] transition-colors",children:I?e.jsx(at,{className:"w-4 h-4"}):e.jsx(st,{className:"w-4 h-4"})})]})]}),I&&e.jsx(yt,{meeting:s})]},s.meeting_id)})})]}),e.jsx("div",{className:"flex justify-end mt-3",children:e.jsxs("button",{onClick:()=>t("/files"),className:"flex items-center gap-2 text-[10px] text-[var(--gm-text-tertiary)] hover:text-[var(--gm-accent-primary)] transition-colors",children:["View imported transcripts ",e.jsx(O,{className:"w-3 h-3"})]})})]}):e.jsxs("button",{onClick:Y,disabled:z.isPending,className:o(L,"w-full justify-center py-2.5"),children:[z.isPending?e.jsx(k,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(O,{className:"w-3.5 h-3.5"}),"Connect Krisp Account"]})]})]})}function ft({checked:t,onChange:d,disabled:n}){return e.jsx("button",{onClick:()=>!n&&d(!t),disabled:n,className:"relative inline-flex h-5 w-9 shrink-0 cursor-pointer rounded-full border border-[var(--gm-border-primary)] transition-colors duration-200 disabled:opacity-50",style:{backgroundColor:t?"var(--color-brand-500)":"var(--gm-bg-tertiary)"},children:e.jsx("span",{className:o("pointer-events-none inline-block h-4 w-4 rounded-full bg-white shadow-sm transition-transform duration-200",t?"translate-x-4":"translate-x-0")})})}function bt(){const{user:t,updateProfile:d}=Z(),{currentProject:n,currentProjectId:i}=Pe(),[g,h]=a.useState(()=>localStorage.getItem("godmode-theme")||"dark"),[r,x]=a.useState(()=>localStorage.getItem("godmode-language")||"en"),[v,N]=a.useState([]),[j,p]=a.useState([]),[f,A]=a.useState(""),[P,m]=a.useState(""),[y,u]=a.useState(!0),[U,w]=a.useState(!0),[z,$]=a.useState(!1),[R,B]=a.useState(!1);a.useEffect(()=>{t?.timezone&&m(t.timezone),n?.role&&A(n.role),_.get("/api/role-templates").then(c=>{c.roles&&N(c.roles)}).catch(()=>{}),_.get("/api/timezones").then(c=>{c.timezones&&p(c.timezones)}).catch(()=>{});try{const c=JSON.parse(localStorage.getItem("godmode-privacy")||"{}");c.analytics!==void 0&&u(c.analytics),c.errorReporting!==void 0&&w(c.errorReporting),c.aiData!==void 0&&$(c.aiData)}catch{}},[t,n,i]);const J=async()=>{B(!0);try{localStorage.setItem("godmode-theme",g),localStorage.setItem("godmode-language",r),localStorage.setItem("godmode-privacy",JSON.stringify({analytics:y,errorReporting:U,aiData:z})),g==="dark"?document.documentElement.classList.add("dark"):g==="light"&&document.documentElement.classList.remove("dark"),P!==t?.timezone&&await d.mutateAsync({timezone:P}),i&&f!==n?.role&&await _.put(`/api/projects/${i}/members/${t?.id}`,{role:f}),l.success("Settings saved")}catch(c){l.error(c.message||"Failed to save settings")}finally{B(!1)}},Y=[{label:"Analytics",desc:"Help improve GodMode with anonymous usage data",value:y,set:u},{label:"Error Reporting",desc:"Automatically report errors to help fix bugs",value:U,set:w},{label:"AI Data Improvement",desc:"Allow anonymized data to improve AI responses",value:z,set:$}];return e.jsxs("div",{className:"space-y-5",children:[e.jsx(M,{title:"User Settings",subtitle:"Appearance, role, and privacy preferences"}),e.jsxs("div",{className:o(T,"p-5 space-y-4"),children:[e.jsx("h3",{className:D,children:"Appearance"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:C,children:[e.jsx(he,{className:"w-3 h-3"})," Theme"]}),e.jsxs("select",{value:g,onChange:c=>h(c.target.value),className:b,children:[e.jsx("option",{value:"light",children:"Light"}),e.jsx("option",{value:"dark",children:"Dark"}),e.jsx("option",{value:"system",children:"System"})]}),e.jsx("p",{className:"text-[10px] text-[var(--gm-text-tertiary)] mt-1",children:"Choose your preferred color scheme"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:C,children:[e.jsx(pe,{className:"w-3 h-3"})," Language"]}),e.jsxs("select",{value:r,onChange:c=>x(c.target.value),className:b,children:[e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"pt",children:"Português"}),e.jsx("option",{value:"es",children:"Español"}),e.jsx("option",{value:"fr",children:"Français"}),e.jsx("option",{value:"de",children:"Deutsch"})]}),e.jsx("p",{className:"text-[10px] text-[var(--gm-text-tertiary)] mt-1",children:"Interface language preference"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg border border-[var(--gm-accent-primary)]/20 bg-[var(--gm-accent-primary)]/5",children:[e.jsx(Te,{className:"w-4 h-4 text-[var(--gm-accent-primary)] flex-shrink-0"}),e.jsxs("p",{className:"text-[10px] text-[var(--gm-text-tertiary)]",children:["For ",e.jsx("span",{className:"text-[var(--gm-accent-primary)] font-medium",children:"LLM configuration"})," and ",e.jsx("span",{className:"text-[var(--gm-accent-primary)] font-medium",children:"Graph"})," settings, use the ",e.jsx("span",{className:"text-[var(--gm-accent-primary)] font-medium",children:"Admin"})," section."]})]})]}),e.jsxs("div",{className:o(T,"p-5 space-y-4"),children:[e.jsx("h3",{className:D,children:"Role & Context"}),e.jsxs("div",{className:"p-3 rounded-lg bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)]",children:[e.jsx("p",{className:"text-[10px] text-[var(--gm-text-tertiary)] uppercase tracking-wider font-bold mb-1",children:"Active Project"}),e.jsx("p",{className:"text-xs font-medium text-[var(--gm-text-primary)]",children:n?.name||"No Active Project"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:C,children:[e.jsx(ie,{className:"w-3 h-3"})," Project Role"]}),e.jsxs("select",{value:f,onChange:c=>A(c.target.value),disabled:!i||i==="default",className:b,children:[e.jsx("option",{value:"",children:"Select a role..."}),v.filter(c=>c.name||c.display_name).map(c=>e.jsx("option",{value:c.display_name||c.name,children:c.display_name||c.name},c.id||c.name))]}),e.jsx("p",{className:"text-[10px] text-[var(--gm-text-tertiary)] mt-1",children:"Your role in the current project"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:C,children:[e.jsx(_e,{className:"w-3 h-3"})," Timezone"]}),e.jsxs("select",{value:P,onChange:c=>m(c.target.value),className:b,children:[e.jsx("option",{value:"",children:"Select timezone..."}),j.map(c=>e.jsxs("option",{value:c.code,children:[c.name," (",c.utc_offset,")"]},c.code))]}),e.jsx("p",{className:"text-[10px] text-[var(--gm-text-tertiary)] mt-1",children:"Used for scheduling and notifications"})]})]})]}),e.jsxs("div",{className:o(T,"p-5"),children:[e.jsx("h3",{className:o(D,"mb-4"),children:"Data & Privacy"}),e.jsx("div",{className:"space-y-1",children:Y.map(c=>e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-[var(--gm-border-primary)] last:border-0",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-[var(--gm-text-primary)]",children:c.label}),e.jsx("p",{className:"text-[10px] text-[var(--gm-text-tertiary)]",children:c.desc})]}),e.jsx(ft,{checked:c.value,onChange:c.set})]},c.label))})]}),e.jsx("div",{className:o(T,"p-4 flex justify-end"),children:e.jsxs("button",{onClick:J,disabled:R,className:L,children:[R?e.jsx(k,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(K,{className:"w-3.5 h-3.5"}),R?"Saving...":"Save Settings"]})})]})}const re=["Ficha de Identidade","Visão Geral e Posicionamento","Produtos e Serviços","Público-Alvo e Clientes","Equipa e Liderança","Presença Digital e Marketing","Análise Competitiva","Indicadores de Crescimento","Análise SWOT","Conclusões e Insights"];function wt(){const[t,d]=a.useState("list"),[n,i]=a.useState(null),[g,h]=a.useState([]),[r,x]=a.useState(!0),v=async()=>{try{x(!0);const p=await _.get("/api/companies");h(p.companies||[])}catch{l.error("Failed to load companies")}finally{x(!1)}};a.useEffect(()=>{v()},[]);const N=(p,f)=>{i(p),d(f)},j=()=>{d("list"),i(null),v()};return e.jsxs("div",{children:[t==="list"&&e.jsx(St,{companies:g,loading:r,onView:p=>N(p,"view"),onEdit:p=>N(p,"edit"),onTemplates:p=>N(p,"templates"),onRefresh:v}),t==="view"&&n&&e.jsx(Ct,{company:n,onBack:j,onEdit:()=>d("edit")}),t==="edit"&&n&&e.jsx(kt,{company:n,onBack:j,onTemplates:()=>d("templates")}),t==="templates"&&n&&e.jsx(At,{company:n,onBack:()=>d("edit")})]})}function St({companies:t,loading:d,onView:n,onEdit:i,onTemplates:g,onRefresh:h}){const[r,x]=a.useState(!1),[v,N]=a.useState(""),[j,p]=a.useState(null),f=async()=>{if(!v.trim()){l.error("Company name is required");return}x(!0);try{await _.post("/api/companies",{name:v.trim()}),l.success("Company created"),N(""),h()}catch(m){l.error(m.message||"Failed to create company")}finally{x(!1)}},A=async m=>{l.info(`Analyzing ${m.name}...`);try{await _.post(`/api/companies/${m.id}/analyze`,{}),l.success(`${m.name} analysis started`),h()}catch(y){l.error(y.message||"Analysis failed")}},P=async()=>{if(j)try{await _.delete(`/api/companies/${j.id}`),l.success("Company deleted"),h()}catch(m){l.error(m.message||"Failed to delete")}finally{p(null)}};return e.jsxs("div",{className:"space-y-5",children:[e.jsx(Ve,{open:!!j,onOpenChange:m=>{m||p(null)},children:e.jsxs(He,{children:[e.jsxs(Je,{children:[e.jsxs(Ye,{children:["Delete ",j?.name||"this item","?"]}),e.jsx(qe,{children:"This action cannot be undone. The company and all its data will be permanently removed."})]}),e.jsxs(We,{children:[e.jsx(Ze,{children:"Cancel"}),e.jsx(Xe,{onClick:P,className:"bg-[var(--color-danger-500)] text-white hover:bg-[var(--color-danger-600)]",children:"Delete"})]})]})}),e.jsx(M,{title:"Companies",subtitle:"Manage company profiles and assets"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{value:v,onChange:m=>N(m.target.value),placeholder:"New company name...",className:o(b,"max-w-xs"),onKeyDown:m=>{m.key==="Enter"&&f()}}),e.jsxs("button",{onClick:f,disabled:r,className:L,children:[r?e.jsx(k,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(rt,{className:"w-3.5 h-3.5"})," New company"]})]}),d?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(k,{className:"w-6 h-6 animate-spin text-[var(--gm-accent-primary)]"})}):t.length===0?e.jsx("div",{className:o(T,"p-10 text-center text-[var(--gm-text-tertiary)] text-sm"),children:"No companies yet. Create one above."}):e.jsx("div",{className:"space-y-2",children:t.map(m=>e.jsx("div",{className:o(T,"p-4 hover:border-[var(--gm-accent-primary)]/30"),children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-[var(--gm-bg-tertiary)] flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-[10px] font-bold text-[var(--gm-text-primary)]",children:(m.name||"???").substring(0,3).toUpperCase()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-xs font-semibold text-[var(--gm-text-primary)]",children:m.name}),(m.colors||[]).length>0&&e.jsx("div",{className:"flex gap-0.5",children:(m.colors||[]).map((y,u)=>e.jsx("div",{className:"w-2.5 h-2.5 rounded-sm",style:{backgroundColor:y}},u))}),e.jsx("span",{className:o("text-[10px] px-2 py-0.5 rounded-full font-medium",m.status==="analyzed"?"bg-emerald-500/10 text-emerald-500":"bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-tertiary)]"),children:m.status==="analyzed"?"Analyzed":"Not analyzed"})]}),m.website&&e.jsx("p",{className:"text-[10px] text-[var(--gm-text-tertiary)]",children:m.website})]}),e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0 flex-wrap",children:[e.jsxs("button",{onClick:()=>n(m),className:o(E,"border-0 px-2"),children:[e.jsx(nt,{className:"w-3 h-3"})," View"]}),e.jsxs("button",{onClick:()=>i(m),className:o(E,"border-0 px-2"),children:[e.jsx(ve,{className:"w-3 h-3"})," Edit"]}),e.jsxs("button",{onClick:()=>g(m),className:o(E,"border-0 px-2"),children:[e.jsx(V,{className:"w-3 h-3"})," Templates"]}),e.jsxs("button",{onClick:()=>A(m),className:o(E,"border-0 px-2"),children:[e.jsx(de,{className:"w-3 h-3"})," ",m.status==="analyzed"?"Re-analyze":"Analyze"]}),e.jsx("button",{onClick:()=>p(m),className:"p-1.5 rounded-lg text-[var(--gm-text-tertiary)] hover:bg-[var(--color-danger-500)]/10 hover:text-[var(--color-danger-500)] transition-colors",children:e.jsx(oe,{className:"w-3.5 h-3.5"})})]})]})},m.id))})]})}function Ct({company:t,onBack:d,onEdit:n}){const[i,g]=a.useState(re[0]),[h,r]=a.useState(!1),x=async()=>{r(!0);try{await _.post(`/api/companies/${t.id}/analyze`,{}),l.success("Analysis started")}catch(v){l.error(v.message||"Analysis failed")}finally{r(!1)}};return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("button",{onClick:d,className:"flex items-center gap-1.5 text-[10px] text-[var(--gm-text-tertiary)] hover:text-[var(--gm-accent-primary)] transition-colors",children:[e.jsx(Q,{className:"w-3.5 h-3.5"})," Back to Companies"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-[var(--gm-bg-tertiary)] flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-bold text-[var(--gm-text-primary)]",children:(t.name||"???").substring(0,3).toUpperCase()})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-lg font-bold text-[var(--gm-text-primary)]",children:t.name}),e.jsxs("div",{className:"flex items-center gap-3 mt-0.5",children:[t.website&&e.jsxs("a",{href:t.website,target:"_blank",rel:"noreferrer",className:"text-[10px] text-[var(--gm-accent-primary)] flex items-center gap-1 hover:underline",children:[e.jsx(X,{className:"w-3 h-3"})," ",t.website]}),t.linkedin&&e.jsxs("a",{href:t.linkedin,target:"_blank",rel:"noreferrer",className:"text-[10px] text-[var(--gm-accent-primary)] flex items-center gap-1 hover:underline",children:[e.jsx(O,{className:"w-3 h-3"})," LinkedIn"]})]})]}),e.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[e.jsxs("button",{onClick:x,disabled:h,className:L,children:[h?e.jsx(k,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(Ke,{className:"w-3.5 h-3.5"})," Re-analyze"]}),e.jsxs("button",{onClick:n,className:E,children:[e.jsx(ve,{className:"w-3.5 h-3.5"})," Edit"]})]})]}),e.jsxs("div",{className:"flex gap-5",children:[e.jsxs("div",{className:"w-52 flex-shrink-0 space-y-0.5",children:[e.jsx("p",{className:o(D,"mb-2 px-1"),children:"Report Sections"}),re.map(v=>e.jsxs("button",{onClick:()=>g(v),className:o("w-full text-left px-3 py-2 rounded-lg text-[10px] transition-colors flex items-center justify-between",i===v?"text-[var(--gm-accent-primary)] bg-[var(--gm-surface-hover)] font-semibold":"text-[var(--gm-text-tertiary)] hover:text-[var(--gm-text-primary)] hover:bg-[var(--gm-surface-hover)]"),children:[e.jsx("span",{className:"truncate",children:v}),i===v&&e.jsx(le,{className:"w-3 h-3 flex-shrink-0"})]},v))]}),e.jsxs("div",{className:o(T,"flex-1 p-5"),children:[e.jsx("h3",{className:"text-sm font-bold text-[var(--gm-text-primary)] mb-3",children:i}),e.jsx("div",{className:"text-xs text-[var(--gm-text-secondary)] whitespace-pre-line leading-relaxed",children:t.report?.[i]||`Content for "${i}" — run analysis to populate.`})]})]})]})}function kt({company:t,onBack:d,onTemplates:n}){const[i,g]=a.useState(t.name),[h,r]=a.useState(t.description||""),[x,v]=a.useState(t.logo_url||""),[N,j]=a.useState(t.website||""),[p,f]=a.useState(t.linkedin||""),[A,P]=a.useState(!1),m=async()=>{if(!i.trim()){l.error("Name is required");return}const y=/^https?:\/\//;if(N.trim()&&!y.test(N.trim())){l.error("Website must start with http:// or https://");return}if(p.trim()&&!y.test(p.trim())){l.error("LinkedIn URL must start with http:// or https://");return}P(!0);try{await _.put(`/api/companies/${t.id}`,{name:i,description:h,logo_url:x,website:N,linkedin:p}),l.success("Company updated"),d()}catch(u){l.error(u.message||"Failed to save")}finally{P(!1)}};return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("button",{onClick:d,className:"flex items-center gap-1.5 text-[10px] text-[var(--gm-text-tertiary)] hover:text-[var(--gm-accent-primary)] transition-colors",children:[e.jsx(Q,{className:"w-3.5 h-3.5"})," Back to Companies"]}),e.jsx(M,{title:`Edit ${t.name}`}),e.jsxs("div",{className:o(T,"p-5"),children:[e.jsxs("div",{className:"max-w-lg space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:C,children:"Name *"}),e.jsx("input",{value:i,onChange:y=>g(y.target.value),className:b})]}),e.jsxs("div",{children:[e.jsxs("label",{className:C,children:[e.jsx(H,{className:"w-3 h-3"})," Description"]}),e.jsx("textarea",{value:h,onChange:y=>r(y.target.value),rows:3,className:o(b,"resize-y")})]}),e.jsxs("div",{children:[e.jsxs("label",{className:C,children:[e.jsx(me,{className:"w-3 h-3"})," Logo URL"]}),e.jsx("input",{value:x,onChange:y=>v(y.target.value),placeholder:"https://...",className:o(b,"font-mono text-xs")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:C,children:[e.jsx(X,{className:"w-3 h-3"})," Website"]}),e.jsx("input",{value:N,onChange:y=>j(y.target.value),className:b})]}),e.jsxs("div",{children:[e.jsxs("label",{className:C,children:[e.jsx(O,{className:"w-3 h-3"})," LinkedIn"]}),e.jsx("input",{value:p,onChange:y=>f(y.target.value),className:b})]})]}),e.jsxs("div",{className:"border-t border-[var(--gm-border-primary)] pt-4 flex justify-center gap-2",children:[e.jsxs("button",{onClick:m,disabled:A,className:L,children:[A?e.jsx(k,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(K,{className:"w-3.5 h-3.5"}),A?"Saving...":"Save"]}),e.jsx("button",{onClick:d,className:E,children:"Cancel"})]})]}),e.jsxs("div",{className:"mt-6 pt-5 border-t border-[var(--gm-border-primary)]",children:[e.jsx("h3",{className:o(D,"mb-3"),children:"Documents"}),e.jsxs("button",{onClick:n,className:E,children:[e.jsx(V,{className:"w-3.5 h-3.5"})," Templates (A4 / PPT)"]})]})]})]})}function At({company:t,onBack:d}){const[n,i]=a.useState("a4"),[g,h]=a.useState("code"),[r,x]=a.useState(""),[v,N]=a.useState(!1),[j,p]=a.useState(!1),[f,A]=a.useState(!1),P=async()=>{N(!0);try{const u=await _.get(`/api/companies/${t.id}/templates/${n}`);x(u.template?.content||`<!-- No ${n} template yet -->`),l.success("Template loaded")}catch{x(`<!-- No ${n} template found -->`)}finally{N(!1)}},m=async()=>{p(!0);try{const u=await _.post(`/api/companies/${t.id}/templates/generate`,{type:n});x(u.template?.content||r),l.success("Template generated")}catch(u){l.error(u.message||"Generation failed")}finally{p(!1)}},y=async()=>{A(!0);try{await _.put(`/api/companies/${t.id}/templates/${n}`,{content:r}),l.success("Template saved")}catch(u){l.error(u.message||"Failed to save")}finally{A(!1)}};return a.useEffect(()=>{P()},[n]),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("button",{onClick:d,className:"flex items-center gap-1.5 text-[10px] text-[var(--gm-text-tertiary)] hover:text-[var(--gm-accent-primary)] transition-colors",children:[e.jsx(Q,{className:"w-3.5 h-3.5"})," Back to Edit"]}),e.jsx(M,{title:`${t.name} — Templates`,subtitle:"Manage document templates for this company"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex gap-1",children:["a4","ppt"].map(u=>e.jsx("button",{onClick:()=>i(u),className:o("px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",n===u?"bg-[var(--gm-accent-primary)]/10 text-[var(--gm-accent-primary)]":"text-[var(--gm-text-tertiary)] hover:text-[var(--gm-text-primary)]"),children:u==="a4"?"A4 document":"Presentation"},u))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:P,disabled:v,className:E,children:v?"Loading...":"Load current"}),e.jsxs("button",{onClick:m,disabled:j,className:L,children:[j?e.jsx(k,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(de,{className:"w-3.5 h-3.5"}),j?"Generating...":"Generate with AI"]}),e.jsxs("button",{onClick:y,disabled:f,className:L,children:[f?e.jsx(k,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(K,{className:"w-3.5 h-3.5"}),f?"Saving...":"Save template"]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex border-b border-[var(--gm-border-primary)] mb-2",children:["code","theme"].map(u=>e.jsxs("button",{onClick:()=>h(u),className:o("flex items-center gap-1.5 px-3 py-2 text-xs border-b-2 transition-colors",g===u?"text-[var(--gm-accent-primary)] border-[var(--gm-accent-primary)]":"text-[var(--gm-text-tertiary)] border-transparent"),children:[u==="code"?e.jsx(et,{className:"w-3 h-3"}):e.jsx(tt,{className:"w-3 h-3"}),u==="code"?"Code":"Theme"]},u))}),e.jsx("textarea",{value:r,onChange:u=>x(u.target.value),className:o(b,"h-[500px] font-mono text-[10px] resize-none")})]}),e.jsxs("div",{className:"w-[300px] flex-shrink-0",children:[e.jsx("p",{className:o(D,"mb-2"),children:"Preview"}),e.jsxs("div",{className:"bg-white border border-[var(--gm-border-primary)] rounded-lg overflow-hidden h-[500px]",children:[e.jsx("div",{className:"h-1.5 bg-[var(--color-danger-500)]"}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-5",children:[e.jsx("div",{className:"w-8 h-8 bg-[var(--gm-bg-tertiary)] rounded flex items-center justify-center",children:e.jsx("span",{className:"text-[8px] font-bold text-[var(--gm-text-tertiary)]",children:(t.name||"???").substring(0,3)})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-[var(--gm-text-primary)]",children:t.name}),e.jsxs("p",{className:"text-[8px] text-[var(--gm-text-tertiary)]",children:[n==="a4"?"Document":"Presentation"," Template"]})]})]}),e.jsxs("div",{className:"text-[9px] text-[var(--gm-text-tertiary)] whitespace-pre-wrap font-mono max-h-[400px] overflow-auto",children:[r.substring(0,500),r.length>500&&"..."]})]})]})]})]})]})}export{qt as default};
//# sourceMappingURL=ProfilePage-C-vCt1QZ.js.map

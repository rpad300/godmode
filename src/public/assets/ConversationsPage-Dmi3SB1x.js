import{r as i,j as e}from"./vendor-react-CZ-WyKWZ.js";import{t as g}from"./vendor-ui-BS9QKitv.js";import{c1 as Le,c2 as ke,c3 as Ce,c4 as ze,c5 as Ue,O as z,L as G,c as y,X as Se,U as X,C as Ae,T as Pe,x as ge,r as Oe,ad as pe,g as ue,a8 as le,c6 as Be,c7 as He,bo as We,bp as $e,bq as Ge,w as he,ai as Ke,c8 as Ze,s as Qe,P as Je,y as be}from"./main-B3DZn5B_.js";import{C as Ye}from"./CommentsPanel-CZdKIoGH.js";import{B as ye}from"./brain-BD_Z4K1O.js";import{B as Ve}from"./book-open-CD3TXH-Z.js";import{C as ve}from"./cpu-DUHk4ipN.js";import{C as Xe,P as qe}from"./paperclip-LWsHHImL.js";import{A as et}from"./arrow-left-BUrpeDp8.js";import{S as tt}from"./save-Dic_e7Eu.js";import{P as st}from"./pen-line-VNeSLMlJ.js";import{c as rt}from"./vendor-markdown-Cu8AM8lU.js";import{C as Z}from"./circle-check-big-Do7NRW-9.js";import{S as K}from"./sparkles-D3iJUPqd.js";import{R as De}from"./rotate-cw-wbVSlX31.js";import{L as fe}from"./lightbulb-0ivikuj5.js";import{L as at}from"./link-2-CvGSt01y.js";import{U as oe}from"./upload-C00nhlDV.js";import{E as nt}from"./ErrorState-to3SSPKs.js";import{C as it}from"./chart-column-BRODuIXF.js";import"./vendor-supabase-Bpw_79gH.js";import"./vendor-query-DSf7I7Ei.js";import"./vendor-router-D_XeKoA_.js";import"./send-CaMoZtNQ.js";import"./pen-UIQK8jUR.js";import"./circle-6fOsuLxM.js";const lt=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],q=rt("hash",lt),je="rounded-xl border border-[var(--gm-border-primary)] bg-[var(--gm-surface-primary)] shadow-[var(--shadow-sm)] transition-all duration-200",ot="inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg bg-[var(--color-danger-500)] text-white hover:bg-[var(--color-danger-600)] shadow-sm transition-all duration-150 disabled:opacity-50",ct="inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg bg-[var(--gm-interactive-secondary)] text-[var(--gm-text-primary)] hover:bg-[var(--gm-interactive-secondary-hover)] border border-[var(--gm-border-primary)] transition-all duration-150",ae={whatsapp:"bg-green-500/10 text-green-500 border-green-500/20",slack:"bg-purple-500/10 text-purple-500 border-purple-500/20",teams:"bg-blue-500/10 text-blue-500 border-blue-500/20",discord:"bg-indigo-500/10 text-indigo-500 border-indigo-500/20",zoom:"bg-sky-500/10 text-sky-500 border-sky-500/20",telegram:"bg-cyan-500/10 text-cyan-500 border-cyan-500/20"},Ne={whatsapp:"WhatsApp",slack:"Slack",teams:"Teams",discord:"Discord",zoom:"Zoom",telegram:"Telegram"};function mt({conversationId:m,onBack:w}){const[l,f]=i.useState("messages"),[j,F]=i.useState(!1),[p,S]=i.useState(""),[k,E]=i.useState(""),[D,R]=i.useState(!1),I=Le(m),M=ke(),A=Ce(),T=ze(),N=Ue();i.useEffect(()=>{f("messages"),F(!1),S(""),E(""),R(!1)},[m]);const a=I.data?.conversation,U=String(a?.title||a?.name||"Untitled Conversation"),_=String(a?.summary||""),c=String(a?.sourceApp||a?.source_app||""),s=String(a?.channelName||a?.channel_name||""),o=String(a?.workspaceName||a?.workspace_name||""),u=a?.participants||[],O=Number(a?.messageCount||a?.message_count||0),h=a?.messages||[],b=a?.dateRange,B=a?.importedAt?new Date(String(a.importedAt)).toLocaleString():"",H=!!(a?.is_embedded||a?.isEmbedded),x=a?.aiProcessedAt?new Date(String(a.aiProcessedAt)).toLocaleString():"",C=a?.extraction_result||a?.extractedEntities||{},L=C.facts||[],r=C.decisions||[],d=C.risks||[],W=C.actionItems||[],Q=C.questions||[],J=C.entities||a?.extractedEntities||[],Y=C.relationships||a?.extractedRelationships||[],ee=C.participants||[],Te=L.length+r.length+d.length+W.length+Q.length>0,Ee=J.length+Y.length>0,ce=ee.length>0||u.length>0,re=i.useMemo(()=>{if(!k.trim())return h;const t=k.toLowerCase();return h.filter(n=>String(n.text||n.content||n.body||"").toLowerCase().includes(t)||String(n.speaker||n.sender||n.author||"").toLowerCase().includes(t))},[h,k]),me=i.useMemo(()=>{const t=["bg-blue-500/20 text-blue-500","bg-green-500/20 text-green-500","bg-purple-500/20 text-purple-500","bg-orange-500/20 text-orange-500","bg-pink-500/20 text-pink-500","bg-cyan-500/20 text-cyan-500","bg-yellow-500/20 text-yellow-500","bg-red-500/20 text-red-500"],n={};return[...new Set(h.map(v=>String(v.speaker||v.sender||v.author||"Unknown")))].forEach((v,V)=>{n[v]=t[V%t.length]}),n},[h]),Ie=()=>{M.mutate(m,{onSuccess:()=>{g.success("Conversation deleted"),w()},onError:()=>g.error("Failed to delete")})},Fe=()=>{A.mutate(m,{onSuccess:()=>g.success("Re-embedding started"),onError:()=>g.error("Failed to re-embed")})},de=()=>{p.trim()&&T.mutate({id:m,data:{title:p.trim()}},{onSuccess:()=>{g.success("Title updated"),F(!1)},onError:()=>g.error("Failed to update title")})},Re=()=>{N.mutate(m,{onSuccess:()=>g.success("Summary generated"),onError:()=>g.error("Failed to generate summary")})},Me=[{key:"messages",label:"Messages",icon:z,count:O},{key:"summary",label:"Summary",icon:ye},{key:"knowledge",label:"Knowledge",icon:Ve,count:L.length+r.length+W.length+d.length+Q.length,hidden:!Te},{key:"entities",label:"Entities",icon:ve,count:J.length+Y.length,hidden:!Ee},{key:"people",label:"People",icon:Xe,count:ce?ee.length||u.length:0,hidden:!ce}];return e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("button",{onClick:w,className:"flex items-center gap-1.5 text-xs text-[var(--gm-text-tertiary)] hover:text-[var(--gm-text-primary)] transition-colors mb-2",children:[e.jsx(et,{className:"w-3.5 h-3.5"})," Back to Conversations"]}),e.jsxs("div",{className:je,children:[I.isLoading&&e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(G,{className:"w-8 h-8 animate-spin text-[var(--gm-accent-primary)]"})}),!I.isLoading&&!a&&e.jsx("div",{className:"flex items-center justify-center h-48 text-[var(--gm-text-tertiary)] text-sm",children:"Conversation not found."}),!I.isLoading&&a&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-5 rounded-t-xl",style:{background:"linear-gradient(to right, rgba(37,99,235,0.15), rgba(37,99,235,0.04))"},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:y("w-12 h-12 rounded-xl flex items-center justify-center shrink-0 border",ae[c]||"border-blue-500/30"),style:{backgroundColor:ae[c]?void 0:"rgba(37,99,235,0.15)"},children:e.jsx(z,{className:"w-6 h-6"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[j?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{value:p,onChange:t=>S(t.target.value),className:"bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-2 py-1 text-sm text-[var(--gm-text-primary)] flex-1 focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]",autoFocus:!0,onKeyDown:t=>t.key==="Enter"&&de()}),e.jsx("button",{onClick:de,className:"text-green-400 hover:text-green-300",children:e.jsx(tt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>F(!1),className:"text-[var(--gm-text-tertiary)] hover:text-[var(--gm-text-primary)]",children:e.jsx(Se,{className:"w-4 h-4"})})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{className:"text-lg font-semibold text-[var(--gm-text-primary)] leading-tight truncate",children:U}),e.jsx("button",{onClick:()=>{S(U),F(!0)},className:"text-[var(--gm-text-tertiary)] hover:text-[var(--gm-text-primary)] transition-colors",children:e.jsx(st,{className:"w-3.5 h-3.5"})})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1.5 flex-wrap",children:[c&&e.jsx("span",{className:y("text-[10px] px-2 py-0.5 rounded-full font-medium border",ae[c]||"bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-tertiary)] border-[var(--gm-border-primary)]"),children:Ne[c]||c}),s&&e.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded-full text-[var(--gm-text-tertiary)] bg-[var(--gm-bg-tertiary)]",children:["#",s]}),o&&e.jsx("span",{className:"text-[10px] text-[var(--gm-text-tertiary)]",children:o}),e.jsxs("span",{className:"text-[10px] text-[var(--gm-text-tertiary)] flex items-center gap-0.5",children:[e.jsx(X,{className:"w-3 h-3"})," ",u.length]}),e.jsxs("span",{className:"text-[10px] text-[var(--gm-text-tertiary)] flex items-center gap-0.5",children:[e.jsx(q,{className:"w-3 h-3"})," ",O," msgs"]}),b?.first&&e.jsxs("span",{className:"text-[10px] text-[var(--gm-text-tertiary)] flex items-center gap-0.5",children:[e.jsx(Ae,{className:"w-3 h-3"})," ",String(b.first).split("T")[0]]}),H?e.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-green-500/20 text-green-400 font-medium flex items-center gap-0.5",children:[e.jsx(Z,{className:"w-3 h-3"})," Embedded"]}):e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-yellow-500/20 text-yellow-400 font-medium",children:"Not embedded"}),x&&e.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-blue-500/20 text-blue-400 flex items-center gap-0.5",children:[e.jsx(K,{className:"w-3 h-3"})," AI processed"]})]})]}),e.jsx("div",{className:"flex items-center gap-1 shrink-0",children:e.jsx("button",{onClick:Fe,disabled:A.isPending,className:"p-2 rounded-lg text-[var(--gm-text-tertiary)] hover:bg-[var(--gm-surface-hover)] transition-colors",title:"Re-embed",children:A.isPending?e.jsx(G,{className:"w-4 h-4 animate-spin"}):e.jsx(De,{className:"w-4 h-4"})})})]})}),e.jsx("div",{className:"flex gap-1 px-5 border-b border-[var(--gm-border-primary)]",children:Me.filter(t=>!t.hidden).map(t=>{const n=t.icon;return e.jsxs("button",{onClick:()=>f(t.key),className:y("flex items-center gap-1.5 px-4 py-2.5 text-xs font-medium border-b-2 transition-colors",l===t.key?"border-[var(--gm-accent-primary)] text-[var(--gm-accent-primary)]":"border-transparent text-[var(--gm-text-tertiary)] hover:text-[var(--gm-text-primary)]"),children:[e.jsx(n,{className:"w-3.5 h-3.5"})," ",t.label,t.count!==void 0&&t.count>0&&e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded-full bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-tertiary)]",children:t.count})]},t.key)})}),e.jsxs("div",{className:"p-5 space-y-4",children:[l==="messages"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("input",{value:k,onChange:t=>E(t.target.value),placeholder:"Search messages...",className:"flex-1 bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-1.5 text-xs text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]"}),e.jsxs("span",{className:"text-[10px] text-[var(--gm-text-tertiary)]",children:[re.length,"/",h.length]})]}),re.length===0?e.jsxs("p",{className:"text-sm text-[var(--gm-text-tertiary)] text-center py-8",children:["No messages ",k?"matching your search":"available","."]}):e.jsx("div",{className:"space-y-2",children:re.map((t,n)=>{const P=String(t.speaker||t.sender||t.author||"Unknown"),v=P.charAt(0).toUpperCase(),V=String(t.text||t.content||t.body||""),xe=t.timestamp?new Date(String(t.timestamp)).toLocaleString():"",_e=me[P]||"bg-blue-600/20 text-[var(--gm-accent-primary)]";return e.jsxs("div",{className:"flex gap-3 group",children:[e.jsx("div",{className:y("w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 text-[10px] font-bold",_e),children:v}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-semibold text-[var(--gm-text-primary)]",children:P}),xe&&e.jsx("span",{className:"text-[10px] text-[var(--gm-text-tertiary)] opacity-0 group-hover:opacity-100 transition-opacity",children:xe})]}),e.jsx("p",{className:"text-xs text-[var(--gm-text-secondary)] mt-0.5 whitespace-pre-wrap leading-relaxed",children:V})]})]},n)})})]}),l==="summary"&&e.jsxs("div",{className:"space-y-4",children:[_?e.jsxs("div",{className:"bg-blue-600/5 border-l-[3px] border-[var(--gm-accent-primary)] rounded-r-lg p-4",children:[e.jsxs("div",{className:"text-[10px] uppercase tracking-wider text-[var(--gm-accent-primary)] font-semibold mb-1.5 flex items-center gap-1.5",children:[e.jsx(K,{className:"w-3.5 h-3.5"})," AI Summary"]}),e.jsx("p",{className:"text-sm text-[var(--gm-text-primary)] leading-relaxed",children:_})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ye,{className:"w-10 h-10 mx-auto mb-3 text-[var(--gm-text-tertiary)]"}),e.jsx("p",{className:"text-sm text-[var(--gm-text-tertiary)] mb-3",children:"No AI summary generated yet."}),e.jsxs("button",{onClick:Re,disabled:N.isPending,className:"px-4 py-2 rounded-lg bg-[var(--gm-interactive-primary)] text-[var(--gm-text-on-brand)] text-xs font-medium hover:bg-[var(--gm-interactive-primary-hover)] flex items-center gap-1.5 mx-auto disabled:opacity-50 transition-colors",children:[N.isPending?e.jsx(G,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(K,{className:"w-3.5 h-3.5"}),"Generate Summary"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(te,{label:"Participants",icon:X,children:e.jsx("div",{className:"flex flex-wrap gap-1.5 mt-1",children:u.map((t,n)=>e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-primary)] border border-[var(--gm-border-primary)]",children:t},n))})}),e.jsx(te,{label:"Statistics",icon:q,children:e.jsxs("div",{className:"space-y-1 mt-1 text-xs text-[var(--gm-text-secondary)]",children:[e.jsxs("p",{children:[O," messages"]}),e.jsxs("p",{children:[u.length," participants"]}),b?.first&&e.jsxs("p",{children:["From: ",String(b.first).split("T")[0]]}),b?.last&&e.jsxs("p",{children:["To: ",String(b.last).split("T")[0]]})]})}),e.jsx(te,{label:"Source",icon:z,children:e.jsxs("div",{className:"space-y-1 mt-1 text-xs text-[var(--gm-text-secondary)]",children:[c&&e.jsxs("p",{children:["Platform: ",Ne[c]||c]}),s&&e.jsxs("p",{children:["Channel: #",s]}),o&&e.jsxs("p",{children:["Workspace: ",o]}),B&&e.jsxs("p",{children:["Imported: ",B]})]})}),e.jsx(te,{label:"AI Processing",icon:K,children:e.jsxs("div",{className:"space-y-1 mt-1 text-xs text-[var(--gm-text-secondary)]",children:[e.jsxs("p",{children:["Status: ",x?"Processed":"Not processed"]}),x&&e.jsxs("p",{children:["At: ",x]}),e.jsxs("p",{children:["Embedded: ",H?"Yes":"No"]})]})})]})]}),l==="knowledge"&&e.jsxs("div",{className:"space-y-5",children:[L.length>0&&e.jsx($,{title:"Facts",icon:fe,color:"text-[var(--gm-accent-primary)]",count:L.length,children:L.map((t,n)=>e.jsxs("div",{className:"bg-[var(--gm-surface-hover)] rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-[var(--gm-text-primary)]",children:String(t.content)}),e.jsxs("div",{className:"flex gap-2 mt-1.5",children:[t.category&&e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-tertiary)] capitalize",children:String(t.category)}),t.confidence&&e.jsxs("span",{className:"text-[10px] text-[var(--gm-text-tertiary)]",children:[Math.round(Number(t.confidence)*100),"% confidence"]})]})]},n))}),W.length>0&&e.jsx($,{title:"Action Items",icon:Z,color:"text-green-500",count:W.length,children:W.map((t,n)=>e.jsxs("div",{className:"bg-[var(--gm-surface-hover)] rounded-lg p-3",children:[e.jsxs("p",{className:"text-xs text-[var(--gm-text-primary)] flex items-start gap-1.5",children:[e.jsx("span",{className:"text-green-500 mt-0.5",children:"☐"})," ",String(t.task)]}),e.jsxs("div",{className:"flex gap-2 mt-1.5 flex-wrap",children:[t.owner&&e.jsxs("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-tertiary)]",children:["Owner: ",String(t.owner)]}),t.deadline&&e.jsxs("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-tertiary)]",children:["Due: ",String(t.deadline)]}),t.status&&e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-blue-600/10 text-[var(--gm-accent-primary)] capitalize",children:String(t.status)})]})]},n))}),r.length>0&&e.jsx($,{title:"Decisions",icon:fe,color:"text-blue-500",count:r.length,children:r.map((t,n)=>e.jsxs("div",{className:"bg-[var(--gm-surface-hover)] rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-[var(--gm-text-primary)]",children:String(t.content)}),e.jsxs("div",{className:"flex gap-2 mt-1.5",children:[t.owner&&e.jsxs("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-tertiary)]",children:["By: ",String(t.owner)]}),t.status&&e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-blue-500/10 text-blue-500 capitalize",children:String(t.status)})]})]},n))}),d.length>0&&e.jsx($,{title:"Risks",icon:Pe,color:"text-red-500",count:d.length,children:d.map((t,n)=>e.jsxs("div",{className:"bg-[var(--gm-surface-hover)] rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-[var(--gm-text-primary)]",children:String(t.content)}),e.jsxs("div",{className:"flex gap-2 mt-1.5",children:[t.impact&&e.jsxs("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-red-500/10 text-red-500",children:["Impact: ",String(t.impact)]}),t.likelihood&&e.jsxs("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-yellow-500/10 text-yellow-500",children:["Likelihood: ",String(t.likelihood)]})]}),t.mitigation&&e.jsxs("p",{className:"text-[10px] text-[var(--gm-text-tertiary)] mt-1.5 italic",children:["Mitigation: ",String(t.mitigation)]})]},n))}),Q.length>0&&e.jsx($,{title:"Questions",icon:ge,color:"text-yellow-500",count:Q.length,children:Q.map((t,n)=>e.jsxs("div",{className:"bg-[var(--gm-surface-hover)] rounded-lg p-3",children:[e.jsxs("p",{className:"text-xs text-[var(--gm-text-primary)] flex items-start gap-1.5",children:[e.jsx(ge,{className:"w-3.5 h-3.5 text-yellow-500 shrink-0 mt-0.5"})," ",String(t.content)]}),e.jsxs("div",{className:"flex gap-2 mt-1.5",children:[t.assigned_to&&e.jsxs("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-tertiary)]",children:["Assigned: ",String(t.assigned_to)]}),t.priority&&e.jsx("span",{className:y("text-[10px] px-1.5 py-0.5 rounded capitalize",t.priority==="high"?"bg-red-500/10 text-red-500":t.priority==="medium"?"bg-yellow-500/10 text-yellow-500":"bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-tertiary)]"),children:String(t.priority)}),t.status&&e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-tertiary)] capitalize",children:String(t.status)})]})]},n))})]}),l==="entities"&&e.jsxs("div",{className:"space-y-5",children:[J.length>0&&e.jsx($,{title:"Entities",icon:ve,color:"text-[var(--gm-accent-primary)]",count:J.length,children:e.jsx("div",{className:"flex flex-wrap gap-2",children:J.map((t,n)=>e.jsxs("span",{className:"text-xs px-3 py-1.5 rounded-lg bg-blue-600/10 text-[var(--gm-accent-primary)] font-medium border border-blue-600/20",children:[String(t.name||t.text||t.label||JSON.stringify(t)),t.type&&e.jsxs("span",{className:"text-[10px] text-blue-500 ml-1.5 capitalize",children:["(",String(t.type),")"]})]},n))})}),Y.length>0&&e.jsx($,{title:"Relationships",icon:at,color:"text-purple-500",count:Y.length,children:Y.map((t,n)=>e.jsxs("div",{className:"flex items-center gap-2 bg-[var(--gm-surface-hover)] rounded-lg p-3",children:[e.jsx("span",{className:"text-xs font-medium text-[var(--gm-text-primary)]",children:String(t.from||t.source)}),e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded bg-purple-500/10 text-purple-500",children:String(t.type||t.label||"").replace(/_/g," ")}),e.jsx("span",{className:"text-xs font-medium text-[var(--gm-text-primary)]",children:String(t.to||t.target)})]},n))})]}),l==="people"&&e.jsx("div",{className:"space-y-3",children:ee.length>0?ee.map((t,n)=>{const P=String(t.name||"Unknown"),v=Oe(t);return e.jsxs("div",{className:"flex items-center gap-3 bg-[var(--gm-surface-hover)] rounded-xl p-4",children:[e.jsxs("div",{className:"w-10 h-10 rounded-full bg-blue-600/20 flex items-center justify-center text-sm font-bold text-[var(--gm-accent-primary)] shrink-0 overflow-hidden",children:[pe(v)?e.jsx("img",{src:v,alt:P,className:"w-full h-full object-cover",onError:V=>{V.target.style.display="none"}}):null,e.jsx("span",{className:pe(v)?"hidden":"",children:ue(P)})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-[var(--gm-text-primary)]",children:P}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-0.5",children:[t.role&&e.jsx("span",{className:"text-[10px] text-[var(--gm-text-tertiary)]",children:String(t.role)}),t.organization&&e.jsxs("span",{className:"text-[10px] text-[var(--gm-text-tertiary)]",children:["at ",String(t.organization)]})]})]})]},n)}):u.map((t,n)=>{const P=h.filter(v=>String(v.sender||v.author)===t).length;return e.jsxs("div",{className:"flex items-center gap-3 bg-[var(--gm-surface-hover)] rounded-xl p-4",children:[e.jsx("div",{className:y("w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold shrink-0",me[t]||"bg-blue-600/20 text-[var(--gm-accent-primary)]"),children:ue(t)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-[var(--gm-text-primary)]",children:t}),e.jsxs("p",{className:"text-[10px] text-[var(--gm-text-tertiary)]",children:[P," message",P!==1?"s":""]})]})]},n)})})]}),e.jsx("div",{className:"px-5 py-4 border-t border-[var(--gm-border-primary)]",children:e.jsxs("div",{className:"p-4 rounded-lg border border-red-500/20 bg-red-500/5",children:[e.jsx("p",{className:"text-xs font-semibold text-red-500 mb-1",children:"Danger Zone"}),e.jsx("p",{className:"text-xs text-[var(--gm-text-tertiary)] mb-3",children:"Deleting this conversation will permanently remove all associated data."}),D?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{className:ot,disabled:M.isPending,onClick:Ie,children:[M.isPending?e.jsx(G,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(le,{className:"w-3.5 h-3.5"})," Confirm Delete"]}),e.jsx("button",{className:ct,onClick:()=>R(!1),children:"Cancel"})]}):e.jsxs("button",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg bg-red-500/10 text-red-500 border border-red-500/30 hover:bg-red-500/20 transition-colors",onClick:()=>R(!0),children:[e.jsx(le,{className:"w-3.5 h-3.5"})," Delete Conversation"]})]})})]})]}),m&&e.jsx("div",{className:je,children:e.jsx(Ye,{targetType:"conversation",targetId:m})})]})}function te({label:m,icon:w,children:l}){return e.jsxs("div",{className:"bg-[var(--gm-bg-tertiary)] rounded-xl p-4 border border-[var(--gm-border-primary)]",children:[e.jsxs("h4",{className:"text-[10px] uppercase tracking-wider text-[var(--gm-text-tertiary)] font-semibold flex items-center gap-1.5",children:[e.jsx(w,{className:"w-3.5 h-3.5"})," ",m]}),l]})}function $({title:m,icon:w,color:l,count:f,children:j}){return e.jsxs("div",{children:[e.jsxs("h3",{className:y("text-xs font-semibold uppercase tracking-wider mb-3 flex items-center gap-2",l),children:[e.jsx(w,{className:"w-4 h-4"})," ",m,e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-tertiary)] ml-auto",children:f})]}),e.jsx("div",{className:"space-y-2",children:j})]})}const dt=[{value:"",label:"Auto-detect"},{value:"whatsapp",label:"WhatsApp"},{value:"slack",label:"Slack"},{value:"teams",label:"Microsoft Teams"},{value:"discord",label:"Discord"},{value:"zoom",label:"Zoom Chat"},{value:"telegram",label:"Telegram"},{value:"generic",label:"Generic Chat"}];function we({open:m,onClose:w}){const[l,f]=i.useState("input"),[j,F]=i.useState("paste"),[p,S]=i.useState(""),[k,E]=i.useState(""),[D,R]=i.useState(""),[I,M]=i.useState(""),[A,T]=i.useState(""),[N,a]=i.useState(!1),[U,_]=i.useState(""),[c,s]=i.useState(null),o=i.useRef(null),u=Be(),O=He(),h=()=>{S(""),E(""),R(""),M(""),T(""),a(!1),_(""),s(null),f("input"),w()},b=i.useCallback(r=>{_(r.name);const d=new FileReader;d.onload=W=>{S(String(W.target?.result||""))},d.readAsText(r)},[]),B=async()=>{if(!p.trim()||p.trim().length<20){g.error("Conversation text is too short");return}try{const r=await u.mutateAsync({text:p,formatHint:k||void 0});s(r),f("preview")}catch{g.error("Failed to parse conversation")}},H=async()=>{if(p.trim()){f("importing");try{const d=await O.mutateAsync({text:p,formatHint:k||void 0,meta:{title:D||void 0,channelName:I||void 0,documentDate:A||void 0},skipAI:N});g.success(`Imported: "${d.title||"Conversation"}" (${d.stats?.messageCount??"?"} messages)`),h()}catch{g.error("Failed to import conversation"),f("preview")}}},x=c?.stats,C=c?.messagesPreview||[],L=c?.warnings||[];return e.jsx(We,{open:m,onOpenChange:r=>!r&&h(),children:e.jsxs($e,{className:"max-w-2xl p-0 overflow-hidden max-h-[90vh] flex flex-col",children:[e.jsx(Ge,{className:"sr-only",children:"Import Conversation"}),e.jsx("div",{className:"px-5 py-4 shrink-0",style:{background:"linear-gradient(to right, rgba(37,99,235,0.25), rgba(37,99,235,0.08))"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{backgroundColor:"rgba(37,99,235,0.15)"},children:e.jsx(oe,{className:"w-4 h-4 text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-base font-semibold text-white",children:"Import Conversation"}),e.jsxs("p",{className:"text-[10px] text-slate-300",children:[l==="input"&&"Paste or upload a conversation transcript",l==="preview"&&"Review parsed conversation before importing",l==="importing"&&"Importing and analyzing with AI..."]})]})]}),e.jsx("button",{onClick:h,className:"w-8 h-8 rounded-lg flex items-center justify-center text-slate-400 hover:bg-white/10 transition-colors",children:e.jsx(Se,{className:"w-4 h-4"})})]})}),l==="input"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex px-5 border-b border-[var(--gm-border-primary)] shrink-0",style:{borderColor:"var(--gm-border-primary)"},children:[{key:"paste",label:"Paste Text"},{key:"upload",label:"Upload File"}].map(r=>e.jsx("button",{onClick:()=>F(r.key),className:y("px-4 py-2.5 text-xs font-medium border-b-2 transition-colors",j===r.key?"border-blue-500 text-blue-400":"border-transparent text-slate-400 hover:text-slate-200"),children:r.label},r.key))}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-5 space-y-4 bg-[var(--gm-surface-primary)]",style:{backgroundColor:"var(--gm-surface-primary)"},children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-semibold text-gm-text-tertiary uppercase tracking-wider",children:"Format"}),e.jsx("select",{value:k,onChange:r=>E(r.target.value),className:"mt-1 w-full bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-2 text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus",children:dt.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-semibold text-gm-text-tertiary uppercase tracking-wider",children:"Title (optional)"}),e.jsx("input",{value:D,onChange:r=>R(r.target.value),placeholder:"Auto-generated by AI",className:"mt-1 w-full bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-2 text-xs text-gm-text-primary placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-gm-border-focus"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-semibold text-gm-text-tertiary uppercase tracking-wider",children:"Channel name (optional)"}),e.jsx("input",{value:I,onChange:r=>M(r.target.value),placeholder:"e.g. #project-alpha",className:"mt-1 w-full bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-2 text-xs text-gm-text-primary placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-gm-border-focus"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-semibold text-gm-text-tertiary uppercase tracking-wider",children:"Document date (optional)"}),e.jsx("input",{type:"date",value:A,onChange:r=>T(r.target.value),className:"mt-1 w-full bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-2 text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus"})]})]}),j==="paste"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-semibold text-gm-text-tertiary uppercase tracking-wider",children:"Conversation text *"}),e.jsx("textarea",{value:p,onChange:r=>S(r.target.value),rows:12,placeholder:`Paste your exported conversation here...

Supported formats:
- WhatsApp: [31/01/2026, 10:00] John: Hello!
- Slack: john [10:00 AM] Hello!
- Discord: john — 01/31/2026 10:00 AM Hello!
- Teams: john 10:00 AM Hello!
- Generic: [10:00] john: Hello!`,className:"mt-1 w-full bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-2 text-xs text-gm-text-primary placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-gm-border-focus resize-y font-mono leading-relaxed"})]}),j==="upload"&&e.jsxs("div",{children:[e.jsxs("div",{className:"border-2 border-dashed border-gm-border-primary rounded-xl p-12 text-center hover:border-blue-600/30 transition-colors cursor-pointer bg-[var(--gm-surface-hover)]",onClick:()=>o.current?.click(),onDragOver:r=>r.preventDefault(),onDrop:r=>{r.preventDefault(),r.dataTransfer.files[0]&&b(r.dataTransfer.files[0])},children:[e.jsx(qe,{className:"w-12 h-12 mx-auto mb-3 text-gray-600"}),e.jsx("p",{className:"text-sm font-medium text-gm-interactive-primary",children:"Drop conversation file here"}),e.jsx("p",{className:"text-xs text-gm-text-tertiary mt-1",children:"or click to browse · .txt, .chat, .log"}),e.jsx("input",{ref:o,type:"file",className:"hidden",accept:".txt,.chat,.log,.text",onChange:r=>{r.target.files?.[0]&&b(r.target.files[0])}})]}),U&&e.jsxs("div",{className:"flex items-center gap-3 mt-4 p-3 bg-gm-surface-secondary rounded-lg border border-gm-border-primary",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-600/10 flex items-center justify-center",children:e.jsx(he,{className:"w-5 h-5 text-gm-interactive-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gm-text-primary",children:U}),e.jsxs("p",{className:"text-[10px] text-gm-text-tertiary",children:[p.length.toLocaleString()," characters loaded"]})]}),e.jsx("button",{onClick:()=>{S(""),_("")},className:"text-gm-text-tertiary hover:text-gm-status-danger text-lg",children:"×"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"skipAI",checked:N,onChange:r=>a(r.target.checked),className:"rounded border-gm-border-primary"}),e.jsx("label",{htmlFor:"skipAI",className:"text-xs text-gm-text-tertiary",children:"Skip AI processing (faster import, no entity extraction)"})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 px-5 py-3 border-t border-[var(--gm-border-primary)] shrink-0",style:{borderColor:"var(--gm-border-primary)",backgroundColor:"var(--gm-surface-secondary)"},children:[e.jsx("button",{onClick:h,className:"px-4 py-2 rounded-lg text-slate-300 text-sm font-medium hover:bg-white/10 border border-white/20 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:B,disabled:u.isPending||!p.trim(),className:"px-4 py-2 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-sm font-medium hover:bg-gm-interactive-primary-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors",children:[u.isPending?e.jsx(G,{className:"w-4 h-4 animate-spin"}):e.jsx(he,{className:"w-4 h-4"}),"Preview & Parse"]})]})]}),l==="preview"&&c&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-5 space-y-4 bg-[var(--gm-surface-primary)]",style:{backgroundColor:"var(--gm-surface-primary)"},children:[e.jsxs("div",{className:"bg-[var(--gm-status-success-bg)] border border-green-500/20 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Z,{className:"w-4 h-4 text-gm-status-success"}),e.jsx("span",{className:"text-xs font-semibold text-gm-status-success",children:"Parsed Successfully"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[e.jsx(se,{label:"Format",value:String(c.format||"auto"),icon:z}),e.jsx(se,{label:"Confidence",value:`${Math.round(Number(c.confidence||0)*100)}%`,icon:K}),e.jsx(se,{label:"Messages",value:String(x?.messageCount||0),icon:q}),e.jsx(se,{label:"Participants",value:String(x?.participants?.length||0),icon:X})]})]}),L.length>0&&e.jsxs("div",{className:"bg-[var(--gm-status-warning-bg)] border border-yellow-500/20 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Pe,{className:"w-4 h-4 text-gm-status-warning"}),e.jsx("span",{className:"text-xs font-semibold text-gm-status-warning",children:"Warnings"})]}),e.jsx("ul",{className:"space-y-1",children:L.map((r,d)=>e.jsx("li",{className:"text-xs text-gm-status-warning",children:r},d))})]}),x?.participants&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-[10px] font-semibold text-gm-text-tertiary uppercase tracking-wider mb-2 flex items-center gap-1.5",children:[e.jsx(X,{className:"w-3.5 h-3.5"})," Participants"]}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:x.participants.map((r,d)=>e.jsx("span",{className:"text-xs px-2.5 py-1 rounded-lg bg-gm-surface-secondary text-gm-text-primary border border-gm-border-primary",children:r},d))})]}),x?.dateRange&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gm-text-tertiary",children:[e.jsx(Ke,{className:"w-3.5 h-3.5"}),e.jsxs("span",{children:[String(x.dateRange?.first||"").split("T")[0]," → ",String(x.dateRange?.last||"").split("T")[0]]})]}),C.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-[10px] font-semibold text-gm-text-tertiary uppercase tracking-wider mb-2 flex items-center gap-1.5",children:[e.jsx(z,{className:"w-3.5 h-3.5"})," Message Preview (",C.length,c.hasMore?"+":"",")"]}),e.jsxs("div",{className:"bg-gm-surface-secondary rounded-xl p-3 space-y-2 max-h-64 overflow-y-auto",children:[C.map((r,d)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-[10px] font-semibold text-gm-interactive-primary min-w-[80px] truncate",children:String(r.speaker||r.sender||"Unknown")}),e.jsx("span",{className:"text-[10px] text-gm-text-secondary flex-1",children:String(r.text||r.content||"").substring(0,200)})]},d)),c.hasMore&&e.jsx("p",{className:"text-[10px] text-gm-text-tertiary text-center italic pt-1",children:"... more messages not shown in preview"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2 px-5 py-3 border-t border-[var(--gm-border-primary)] shrink-0",style:{borderColor:"var(--gm-border-primary)",backgroundColor:"var(--gm-surface-secondary)"},children:[e.jsx("button",{onClick:()=>f("input"),className:"px-4 py-2 rounded-lg text-slate-300 text-sm font-medium hover:bg-white/10 border border-white/20 transition-colors",children:"Back"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:h,className:"px-4 py-2 rounded-lg text-slate-300 text-sm font-medium hover:bg-white/10 border border-white/20 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:H,className:"px-4 py-2 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-sm font-medium hover:bg-gm-interactive-primary-hover flex items-center gap-1.5 transition-colors",children:[e.jsx(oe,{className:"w-4 h-4"})," Import",!N&&" & Analyze with AI"]})]})]})]}),l==="importing"&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 gap-4 bg-[var(--gm-surface-primary)]",style:{backgroundColor:"var(--gm-surface-primary)"},children:[e.jsx(G,{className:"w-10 h-10 animate-spin text-blue-400"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-[var(--gm-text-primary)]",children:"Importing conversation..."}),!N&&e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"AI is analyzing content, extracting entities, and generating summary"})]})]})]})})}function se({label:m,value:w,icon:l}){return e.jsxs("div",{className:"text-center",children:[e.jsx(l,{className:"w-4 h-4 mx-auto mb-1 text-gm-text-tertiary"}),e.jsx("p",{className:"text-sm font-bold text-gm-text-primary capitalize",children:w}),e.jsx("p",{className:"text-[10px] text-gm-text-tertiary",children:m})]})}const ne={whatsapp:"WhatsApp",slack:"Slack",teams:"Teams",discord:"Discord",zoom:"Zoom",telegram:"Telegram"},ie={whatsapp:"bg-green-500/10 text-green-500",slack:"bg-purple-500/10 text-purple-500",teams:"bg-blue-500/10 text-blue-500",discord:"bg-indigo-500/10 text-indigo-500",zoom:"bg-sky-500/10 text-sky-500",telegram:"bg-cyan-500/10 text-cyan-500"};function zt(){const[m,w]=i.useState(""),[l,f]=i.useState(""),[j,F]=i.useState(""),[p,S]=i.useState(null),[k,E]=i.useState(!1),D=Ze({search:m||void 0,sourceApp:l||void 0}),R=Qe(),I=ke(),M=Ce(),A=i.useMemo(()=>{const s=D.data?.conversations??[];return Array.isArray(s)?s:[]},[D.data]),T=i.useMemo(()=>A.filter(s=>!(j==="embedded"&&!s.is_embedded&&!s.isEmbedded||j==="not_embedded"&&(s.is_embedded||s.isEmbedded)||j==="ai_processed"&&!s.aiProcessedAt)),[A,j]),N=R.data,a=N?.bySource||{};if(p)return e.jsxs(e.Fragment,{children:[e.jsx(mt,{conversationId:p,onBack:()=>S(null)}),e.jsx(we,{open:k,onClose:()=>E(!1)})]});const U=(s,o)=>{s.stopPropagation(),confirm("Delete this conversation?")&&I.mutate(o,{onSuccess:()=>g.success("Conversation deleted"),onError:()=>g.error("Failed to delete")})},_=(s,o)=>{s.stopPropagation(),M.mutate(o,{onSuccess:()=>g.success("Re-embedding started"),onError:()=>g.error("Failed to re-embed")})},c=[{label:"Total",value:N?.total??A.length,color:"text-gm-text-primary",icon:z},{label:"Messages",value:N?.totalMessages??0,color:"text-gm-interactive-primary",icon:q},{label:"Sources",value:Object.keys(a).length,color:"text-purple-500",icon:it},{label:"Embedded",value:T.filter(s=>s.is_embedded||s.isEmbedded).length,color:"text-gm-status-success",icon:Z}];return e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gm-text-primary",children:"Conversations"}),e.jsxs("p",{className:"text-xs text-gm-text-tertiary mt-0.5",children:[T.length," conversation",T.length!==1?"s":""]})]}),e.jsxs("button",{onClick:()=>E(!0),className:"px-4 py-2 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-sm font-medium hover:bg-gm-interactive-primary-hover flex items-center gap-2 transition-colors",children:[e.jsx(oe,{className:"w-4 h-4"})," Import Conversation"]})]}),N&&e.jsx("div",{className:"grid grid-cols-4 gap-3",children:c.map(s=>{const o=s.icon;return e.jsxs("div",{className:"bg-gm-surface-primary border border-gm-border-primary rounded-xl px-4 py-3 flex items-center gap-3 hover:border-blue-600/20 transition-colors",children:[e.jsx("div",{className:y("w-9 h-9 rounded-lg flex items-center justify-center",s.label==="Total"?"bg-gm-surface-secondary":s.label==="Messages"?"bg-blue-600/10":s.label==="Sources"?"bg-purple-500/10":"bg-green-500/10"),children:e.jsx(o,{className:y("w-4.5 h-4.5",s.color)})}),e.jsxs("div",{children:[e.jsx("span",{className:y("text-xl font-bold",s.color),children:String(s.value)}),e.jsx("p",{className:"text-[10px] text-gm-text-tertiary uppercase tracking-wider",children:s.label})]})]},s.label)})}),Object.keys(a).length>0&&e.jsx("div",{className:"flex gap-2 flex-wrap",children:Object.entries(a).map(([s,o])=>e.jsxs("button",{onClick:()=>f(l===s?"":s),className:y("text-[10px] px-3 py-1.5 rounded-lg font-medium border transition-colors flex items-center gap-1.5",l===s?(ie[s]||"bg-blue-600/10 text-gm-interactive-primary")+" border-current/20":"bg-gm-surface-secondary text-gm-text-tertiary border-gm-border-primary hover:text-gm-text-primary"),children:[ne[s]||s," ",e.jsx("span",{className:"opacity-60",children:o})]},s))}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(Je,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gm-text-tertiary"}),e.jsx("input",{value:m,onChange:s=>w(s.target.value),placeholder:"Search conversations...",className:"w-full pl-9 pr-3 py-2 bg-gm-surface-secondary border border-gm-border-primary rounded-lg text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus"})]}),e.jsxs("select",{value:l,onChange:s=>f(s.target.value),className:"bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-2 text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus",children:[e.jsx("option",{value:"",children:"All sources"}),Object.entries(ne).map(([s,o])=>e.jsx("option",{value:s,children:o},s))]}),[{key:"embedded",label:"Embedded",icon:Z,activeColor:"bg-gm-status-success-bg border-green-500/30 text-gm-status-success"},{key:"not_embedded",label:"Not Embedded",icon:be,activeColor:"bg-gm-status-warning-bg border-yellow-500/30 text-gm-status-warning"},{key:"ai_processed",label:"AI Processed",icon:K,activeColor:"bg-blue-600/10 border-blue-600/30 text-gm-interactive-primary"}].map(s=>{const o=s.icon,u=j===s.key;return e.jsxs("button",{onClick:()=>F(u?"":s.key),className:y("px-2.5 py-2 rounded-lg text-xs font-medium transition-colors border flex items-center gap-1.5",u?s.activeColor:"bg-gm-surface-secondary border-gm-border-primary text-gm-text-tertiary hover:text-gm-text-primary"),children:[e.jsx(o,{className:"w-3.5 h-3.5"})," ",s.label]},s.key)})]}),D.error?e.jsx(nt,{message:"Failed to load conversations.",onRetry:()=>D.refetch()}):D.isLoading?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx(G,{className:"h-8 w-8 animate-spin text-gm-interactive-primary"})}):T.length===0?e.jsxs("div",{className:"rounded-xl border border-gm-border-primary bg-gm-surface-primary p-8 text-center text-gm-text-tertiary",children:[e.jsx(z,{className:"h-12 w-12 mx-auto mb-4 text-gray-500"}),A.length===0?"No conversations imported yet. Click 'Import Conversation' to get started.":"No conversations match your filters."]}):e.jsx("div",{className:"space-y-1.5",children:T.map(s=>{const o=s.participants?.length??s.participant_count??0,u=s.messageCount??s.message_count??s.messages_count??0,O=!!(s.is_embedded||s.isEmbedded),h=!!s.aiProcessedAt,b=String(s.sourceApp||s.source_app||""),B=String(s.summary||""),H=s.dateRange;return e.jsx("div",{className:"bg-gm-surface-primary border border-gm-border-primary rounded-xl p-3.5 hover:border-blue-600/30 transition-all cursor-pointer group",onClick:()=>S(String(s.id)),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:y("w-10 h-10 rounded-lg flex items-center justify-center shrink-0",ie[b]||"bg-blue-600/10 text-gm-interactive-primary"),children:e.jsx(z,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gm-text-primary truncate group-hover:text-gm-interactive-primary transition-colors",children:String(s.title||s.name||"Untitled Conversation")}),e.jsxs("div",{className:"flex items-center gap-3 mt-0.5",children:[b&&e.jsx("span",{className:y("text-[10px] px-2 py-0.5 rounded-full font-medium",ie[b]||"bg-gm-surface-secondary text-gm-text-tertiary"),children:ne[b]||b}),e.jsxs("span",{className:"text-[10px] text-gm-text-tertiary flex items-center gap-0.5",children:[e.jsx(X,{className:"w-3 h-3"})," ",String(o)]}),e.jsxs("span",{className:"text-[10px] text-gm-text-tertiary flex items-center gap-0.5",children:[e.jsx(q,{className:"w-3 h-3"})," ",String(u)," msgs"]}),H?.first&&e.jsxs("span",{className:"text-[10px] text-gm-text-tertiary flex items-center gap-0.5",children:[e.jsx(Ae,{className:"w-3 h-3"})," ",String(H.first).split("T")[0]]})]}),B&&e.jsx("p",{className:"text-[10px] text-gray-400 mt-0.5 truncate",children:B.substring(0,120)})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[O?e.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-gm-status-success-bg text-gm-status-success font-medium flex items-center gap-1",children:[e.jsx(Z,{className:"w-3 h-3"})," Embedded"]}):e.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-gm-status-warning-bg text-gm-status-warning font-medium flex items-center gap-1",children:[e.jsx(be,{className:"w-3 h-3"})," Not embedded"]}),h&&e.jsx(K,{className:"w-3.5 h-3.5 text-blue-500"}),e.jsx("button",{onClick:x=>_(x,String(s.id)),className:"w-7 h-7 rounded-lg hover:bg-gm-surface-hover flex items-center justify-center text-gm-text-tertiary hover:text-gm-interactive-primary transition-colors opacity-0 group-hover:opacity-100",title:"Re-embed",children:e.jsx(De,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:x=>U(x,String(s.id)),className:"w-7 h-7 rounded-lg hover:bg-gm-status-danger-bg flex items-center justify-center text-gm-text-tertiary hover:text-gm-status-danger transition-colors opacity-0 group-hover:opacity-100",title:"Delete",children:e.jsx(le,{className:"w-3.5 h-3.5"})})]})]})},String(s.id))})}),e.jsx(we,{open:k,onClose:()=>E(!1)})]})}export{zt as default};
//# sourceMappingURL=ConversationsPage-Dmi3SB1x.js.map

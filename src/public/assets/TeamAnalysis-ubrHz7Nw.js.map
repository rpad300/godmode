{"version":3,"file":"TeamAnalysis-ubrHz7Nw.js","sources":["../../frontend/components/TeamAnalysis.ts"],"sourcesContent":["/**\r\n * Team Analysis Component\r\n * Behavioral profiling and team dynamics analysis\r\n */\r\n\r\nimport { createElement, on } from '../utils/dom';\r\nimport { teamAnalysisStore, BehavioralProfile, TeamAnalysis as TeamAnalysisData } from '../stores/teamAnalysis';\r\nimport { toast } from '../services/toast';\r\nimport { http } from '../services/api';\r\n\r\n// Network visualization (vis.js)\r\ndeclare const vis: any;\r\n\r\nlet networkInstance: any = null;\r\n\r\n/**\r\n * Create Team Analysis component\r\n */\r\nexport function createTeamAnalysis(): HTMLElement {\r\n    const container = createElement('div', { className: 'team-analysis-panel' });\r\n\r\n    container.innerHTML = `\r\n        <style>\r\n            .team-analysis-panel {\r\n                padding: 24px;\r\n                min-height: 100%;\r\n            }\r\n\r\n            /* Profiles Grid */\r\n            .profiles-grid {\r\n                display: grid;\r\n                grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));\r\n                gap: 20px;\r\n                margin-top: 20px;\r\n            }\r\n\r\n            .profile-card {\r\n                background: var(--bg-secondary);\r\n                border: 1px solid var(--border-color);\r\n                border-radius: 16px;\r\n                padding: 20px;\r\n                cursor: pointer;\r\n                transition: all 0.2s;\r\n            }\r\n\r\n            .profile-card:hover {\r\n                border-color: var(--primary-color);\r\n                transform: translateY(-2px);\r\n                box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);\r\n            }\r\n\r\n            .profile-header {\r\n                display: flex;\r\n                align-items: flex-start;\r\n                gap: 16px;\r\n                margin-bottom: 16px;\r\n            }\r\n\r\n            .profile-avatar {\r\n                width: 56px;\r\n                height: 56px;\r\n                border-radius: 50%;\r\n                background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);\r\n                display: flex;\r\n                align-items: center;\r\n                justify-content: center;\r\n                color: white;\r\n                font-weight: 700;\r\n                font-size: 20px;\r\n                flex-shrink: 0;\r\n            }\r\n\r\n            .profile-info h3 {\r\n                margin: 0 0 4px;\r\n                font-size: 16px;\r\n                font-weight: 600;\r\n                color: var(--text-primary);\r\n            }\r\n\r\n            .profile-info .role {\r\n                font-size: 13px;\r\n                color: var(--text-secondary);\r\n                margin-bottom: 8px;\r\n            }\r\n\r\n            .profile-badges {\r\n                display: flex;\r\n                gap: 8px;\r\n                flex-wrap: wrap;\r\n            }\r\n\r\n            .badge {\r\n                padding: 4px 10px;\r\n                border-radius: 20px;\r\n                font-size: 11px;\r\n                font-weight: 600;\r\n                text-transform: uppercase;\r\n            }\r\n\r\n            .badge-confidence {\r\n                background: var(--bg-tertiary);\r\n                color: var(--text-secondary);\r\n            }\r\n\r\n            .badge-confidence.high, .badge-confidence.very_high {\r\n                background: rgba(39, 174, 96, 0.15);\r\n                color: #27ae60;\r\n            }\r\n\r\n            .badge-confidence.medium {\r\n                background: rgba(243, 156, 18, 0.15);\r\n                color: #f39c12;\r\n            }\r\n\r\n            .badge-confidence.low {\r\n                background: rgba(231, 76, 60, 0.15);\r\n                color: #e74c3c;\r\n            }\r\n\r\n            .profile-metrics {\r\n                display: grid;\r\n                grid-template-columns: repeat(3, 1fr);\r\n                gap: 12px;\r\n                padding-top: 16px;\r\n                border-top: 1px solid var(--border-color);\r\n            }\r\n\r\n            .metric {\r\n                text-align: center;\r\n            }\r\n\r\n            .metric-value {\r\n                font-size: 20px;\r\n                font-weight: 700;\r\n                color: var(--text-primary);\r\n            }\r\n\r\n            .metric-label {\r\n                font-size: 11px;\r\n                color: var(--text-tertiary);\r\n                text-transform: uppercase;\r\n            }\r\n\r\n            .profile-style {\r\n                margin-top: 12px;\r\n                padding: 12px;\r\n                background: var(--bg-tertiary);\r\n                border-radius: 10px;\r\n            }\r\n\r\n            .profile-style-label {\r\n                font-size: 11px;\r\n                color: var(--text-tertiary);\r\n                text-transform: uppercase;\r\n                margin-bottom: 4px;\r\n            }\r\n\r\n            .profile-style-value {\r\n                font-size: 13px;\r\n                color: var(--text-primary);\r\n            }\r\n\r\n            /* Profile Detail */\r\n            .profile-detail {\r\n                background: var(--bg-secondary);\r\n                border: 1px solid var(--border-color);\r\n                border-radius: 16px;\r\n                padding: 24px;\r\n            }\r\n\r\n            .profile-detail-header {\r\n                display: flex;\r\n                align-items: center;\r\n                justify-content: space-between;\r\n                margin-bottom: 24px;\r\n            }\r\n\r\n            .profile-detail-back {\r\n                display: flex;\r\n                align-items: center;\r\n                gap: 8px;\r\n                color: var(--text-secondary);\r\n                cursor: pointer;\r\n                font-size: 14px;\r\n            }\r\n\r\n            .profile-detail-back:hover {\r\n                color: var(--text-primary);\r\n            }\r\n\r\n            .profile-sections {\r\n                display: flex;\r\n                flex-direction: column;\r\n                gap: 24px;\r\n            }\r\n\r\n            .profile-section {\r\n                background: var(--bg-primary);\r\n                border-radius: 12px;\r\n                padding: 20px;\r\n            }\r\n\r\n            .profile-section h4 {\r\n                margin: 0 0 16px;\r\n                font-size: 14px;\r\n                font-weight: 600;\r\n                color: var(--text-primary);\r\n                display: flex;\r\n                align-items: center;\r\n                gap: 8px;\r\n            }\r\n\r\n            .profile-section h4 svg {\r\n                width: 18px;\r\n                height: 18px;\r\n                color: var(--primary-color);\r\n            }\r\n\r\n            .evidence-list {\r\n                margin-top: 12px;\r\n                display: flex;\r\n                flex-direction: column;\r\n                gap: 10px;\r\n            }\r\n\r\n            .evidence-item {\r\n                background: var(--bg-secondary);\r\n                border-radius: 8px;\r\n                padding: 12px;\r\n                font-size: 13px;\r\n            }\r\n\r\n            .evidence-quote {\r\n                color: var(--text-secondary);\r\n                font-style: italic;\r\n                border-left: 3px solid var(--primary-color);\r\n                padding-left: 12px;\r\n                margin-bottom: 8px;\r\n            }\r\n\r\n            .evidence-timestamp {\r\n                font-size: 11px;\r\n                color: var(--text-tertiary);\r\n            }\r\n\r\n            /* Team Dynamics */\r\n            .team-dynamics {\r\n                display: grid;\r\n                grid-template-columns: 1fr 1fr;\r\n                gap: 24px;\r\n            }\r\n\r\n            @media (max-width: 1200px) {\r\n                .team-dynamics {\r\n                    grid-template-columns: 1fr;\r\n                }\r\n            }\r\n\r\n            .dynamics-card {\r\n                background: var(--bg-secondary);\r\n                border: 1px solid var(--border-color);\r\n                border-radius: 16px;\r\n                padding: 20px;\r\n            }\r\n\r\n            .dynamics-card h3 {\r\n                margin: 0 0 16px;\r\n                font-size: 16px;\r\n                font-weight: 600;\r\n                display: flex;\r\n                align-items: center;\r\n                gap: 10px;\r\n            }\r\n\r\n            .dynamics-list {\r\n                display: flex;\r\n                flex-direction: column;\r\n                gap: 12px;\r\n            }\r\n\r\n            .dynamics-item {\r\n                display: flex;\r\n                align-items: center;\r\n                justify-content: space-between;\r\n                padding: 12px;\r\n                background: var(--bg-primary);\r\n                border-radius: 10px;\r\n            }\r\n\r\n            .dynamics-item-info {\r\n                display: flex;\r\n                align-items: center;\r\n                gap: 12px;\r\n            }\r\n\r\n            .dynamics-item-arrow {\r\n                color: var(--text-tertiary);\r\n            }\r\n\r\n            .strength-bar {\r\n                width: 80px;\r\n                height: 6px;\r\n                background: var(--bg-tertiary);\r\n                border-radius: 3px;\r\n                overflow: hidden;\r\n            }\r\n\r\n            .strength-fill {\r\n                height: 100%;\r\n                border-radius: 3px;\r\n                background: var(--primary-color);\r\n            }\r\n\r\n            /* Network Graph */\r\n            .network-graph-container {\r\n                height: 600px;\r\n                background: var(--bg-secondary);\r\n                border: 1px solid var(--border-color);\r\n                border-radius: 16px;\r\n                overflow: hidden;\r\n            }\r\n\r\n            .network-graph {\r\n                width: 100%;\r\n                height: 100%;\r\n            }\r\n\r\n            /* Loading & Empty States */\r\n            .loading-state, .empty-state {\r\n                display: flex;\r\n                flex-direction: column;\r\n                align-items: center;\r\n                justify-content: center;\r\n                padding: 60px;\r\n                text-align: center;\r\n            }\r\n\r\n            .loading-spinner {\r\n                width: 48px;\r\n                height: 48px;\r\n                border: 4px solid var(--border-color);\r\n                border-top-color: var(--primary-color);\r\n                border-radius: 50%;\r\n                animation: spin 1s linear infinite;\r\n            }\r\n\r\n            @keyframes spin {\r\n                to { transform: rotate(360deg); }\r\n            }\r\n\r\n            .empty-state svg {\r\n                width: 64px;\r\n                height: 64px;\r\n                color: var(--text-tertiary);\r\n                margin-bottom: 16px;\r\n            }\r\n\r\n            .empty-state h3 {\r\n                margin: 0 0 8px;\r\n                color: var(--text-primary);\r\n            }\r\n\r\n            .empty-state p {\r\n                color: var(--text-secondary);\r\n                margin: 0;\r\n            }\r\n\r\n            /* Cohesion Gauge */\r\n            .cohesion-gauge {\r\n                display: flex;\r\n                align-items: center;\r\n                gap: 16px;\r\n                padding: 16px;\r\n                background: var(--bg-primary);\r\n                border-radius: 12px;\r\n                margin-bottom: 20px;\r\n            }\r\n\r\n            .cohesion-score {\r\n                font-size: 36px;\r\n                font-weight: 700;\r\n                color: var(--text-primary);\r\n            }\r\n\r\n            .cohesion-label {\r\n                font-size: 14px;\r\n                color: var(--text-secondary);\r\n            }\r\n\r\n            .tension-indicator {\r\n                padding: 6px 12px;\r\n                border-radius: 20px;\r\n                font-size: 12px;\r\n                font-weight: 600;\r\n            }\r\n\r\n            .tension-low {\r\n                background: rgba(39, 174, 96, 0.15);\r\n                color: #27ae60;\r\n            }\r\n\r\n            .tension-medium {\r\n                background: rgba(243, 156, 18, 0.15);\r\n                color: #f39c12;\r\n            }\r\n\r\n            .tension-high {\r\n                background: rgba(231, 76, 60, 0.15);\r\n                color: #e74c3c;\r\n            }\r\n        </style>\r\n\r\n        <div id=\"team-analysis-content\">\r\n            <div class=\"loading-state\">\r\n                <div class=\"loading-spinner\"></div>\r\n                <p style=\"margin-top: 16px; color: var(--text-secondary);\">Loading team analysis...</p>\r\n            </div>\r\n        </div>\r\n    `;\r\n\r\n    // Initialize\r\n    setTimeout(() => {\r\n        initTeamAnalysis(container);\r\n    }, 0);\r\n\r\n    return container;\r\n}\r\n\r\n/**\r\n * Initialize team analysis\r\n */\r\nasync function initTeamAnalysis(container: HTMLElement): Promise<void> {\r\n    // Subscribe to store changes\r\n    teamAnalysisStore.subscribe(state => {\r\n        renderContent(container, state);\r\n    });\r\n\r\n    // Load initial data\r\n    await teamAnalysisStore.loadAll();\r\n\r\n    // Setup event listeners\r\n    setupEventListeners(container);\r\n}\r\n\r\n/**\r\n * Setup event listeners\r\n */\r\nfunction setupEventListeners(container: HTMLElement): void {\r\n    // Subtab switching\r\n    document.querySelectorAll('#team-analysis-subtabs .subtab').forEach(btn => {\r\n        btn.addEventListener('click', (e) => {\r\n            const subtab = (e.target as HTMLElement).dataset.subtab as 'profiles' | 'team' | 'graph';\r\n            if (subtab) {\r\n                switchSubtab(subtab);\r\n            }\r\n        });\r\n    });\r\n\r\n    // Refresh button\r\n    document.getElementById('team-analysis-refresh-btn')?.addEventListener('click', async () => {\r\n        await teamAnalysisStore.loadAll();\r\n        toast.success('Data refreshed');\r\n    });\r\n\r\n    // Analyze team button\r\n    document.getElementById('team-analysis-analyze-btn')?.addEventListener('click', async () => {\r\n        // If on profiles tab, show contact selection modal\r\n        const state = teamAnalysisStore.getState();\r\n        if (state.currentSubtab === 'profiles') {\r\n            await showAnalyzeContactsModal();\r\n        } else {\r\n            // Team dynamics analysis for other tabs\r\n            toast.info('Analyzing team dynamics...');\r\n            await teamAnalysisStore.analyzeTeam(true);\r\n            toast.success('Team analysis complete');\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * Show modal to select contacts for analysis\r\n */\r\nasync function showAnalyzeContactsModal(): Promise<void> {\r\n    // Create modal\r\n    const modal = document.createElement('div');\r\n    modal.className = 'modal-overlay';\r\n    modal.innerHTML = `\r\n        <div class=\"modal\" style=\"max-width: 600px; max-height: 80vh; display: flex; flex-direction: column;\">\r\n            <div class=\"modal-header\">\r\n                <h2>Analyze Team Members</h2>\r\n                <button class=\"modal-close\">&times;</button>\r\n            </div>\r\n            <div class=\"modal-body\" style=\"flex: 1; overflow-y: auto; padding: 20px;\">\r\n                <p style=\"color: var(--text-secondary); margin-bottom: 16px;\">\r\n                    Select team members to analyze. Members with existing profiles can be re-analyzed.\r\n                </p>\r\n                <div id=\"contacts-list-loading\" style=\"text-align: center; padding: 40px;\">\r\n                    <div class=\"loading-spinner\"></div>\r\n                    <p style=\"margin-top: 16px; color: var(--text-secondary);\">Loading contacts...</p>\r\n                </div>\r\n                <div id=\"contacts-list\" style=\"display: none;\"></div>\r\n            </div>\r\n            <div class=\"modal-footer\" style=\"display: flex; gap: 12px; justify-content: flex-end; padding: 16px 20px; border-top: 1px solid var(--border-color);\">\r\n                <button class=\"btn btn-secondary\" id=\"modal-cancel-btn\">Cancel</button>\r\n                <button class=\"btn btn-primary\" id=\"modal-analyze-selected-btn\" disabled>Analyze Selected (0)</button>\r\n            </div>\r\n        </div>\r\n    `;\r\n    document.body.appendChild(modal);\r\n\r\n    // Close handlers\r\n    const closeModal = () => modal.remove();\r\n    modal.querySelector('.modal-close')?.addEventListener('click', closeModal);\r\n    modal.querySelector('#modal-cancel-btn')?.addEventListener('click', closeModal);\r\n    modal.addEventListener('click', (e) => {\r\n        if (e.target === modal) closeModal();\r\n    });\r\n\r\n    // Load contacts\r\n    try {\r\n        const response = await http.get<{ contacts?: any[]; people?: any[] }>('/api/contacts');\r\n        const contacts = response.data?.contacts || response.data?.people || [];\r\n        \r\n        // Get existing profiles\r\n        const state = teamAnalysisStore.getState();\r\n        const existingProfileIds = new Set(state.profiles.map((p: any) => p.contact_id || p.person_id));\r\n\r\n        const loadingEl = modal.querySelector('#contacts-list-loading') as HTMLElement;\r\n        const listEl = modal.querySelector('#contacts-list') as HTMLElement;\r\n        \r\n        if (loadingEl) loadingEl.style.display = 'none';\r\n        if (listEl) listEl.style.display = 'block';\r\n\r\n        if (contacts.length === 0) {\r\n            listEl.innerHTML = `\r\n                <div style=\"text-align: center; padding: 40px; color: var(--text-tertiary);\">\r\n                    <p>No contacts found. Add contacts to the project first.</p>\r\n                </div>\r\n            `;\r\n            return;\r\n        }\r\n\r\n        // Sort: unanalyzed first, then by name\r\n        contacts.sort((a: any, b: any) => {\r\n            const aAnalyzed = existingProfileIds.has(a.id);\r\n            const bAnalyzed = existingProfileIds.has(b.id);\r\n            if (aAnalyzed !== bAnalyzed) return aAnalyzed ? 1 : -1;\r\n            return (a.name || '').localeCompare(b.name || '');\r\n        });\r\n\r\n        listEl.innerHTML = `\r\n            <div style=\"margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;\">\r\n                <span style=\"font-size: 13px; color: var(--text-secondary);\">\r\n                    ${contacts.length} contacts • ${existingProfileIds.size} analyzed\r\n                </span>\r\n                <button class=\"btn btn-sm btn-secondary\" id=\"select-unanalyzed-btn\" style=\"font-size: 12px; padding: 4px 10px;\">\r\n                    Select Unanalyzed\r\n                </button>\r\n            </div>\r\n            <div style=\"display: flex; flex-direction: column; gap: 8px;\">\r\n                ${contacts.map((c: any) => {\r\n                    const hasProfile = existingProfileIds.has(c.id);\r\n                    const initials = (c.name || 'U').split(' ').map((n: string) => n[0]).join('').substring(0, 2).toUpperCase();\r\n                    return `\r\n                        <label class=\"contact-item\" style=\"display: flex; align-items: center; gap: 12px; padding: 12px 16px; background: var(--bg-secondary); border-radius: 10px; cursor: pointer; transition: all 0.15s; border: 2px solid transparent;\" data-contact-id=\"${c.id}\">\r\n                            <input type=\"checkbox\" class=\"contact-checkbox\" data-id=\"${c.id}\" data-name=\"${c.name || 'Unknown'}\" style=\"width: 18px; height: 18px; accent-color: var(--primary-color);\">\r\n                            ${(c.avatar_url || c.photo_url)\r\n                                ? `<img src=\"${c.avatar_url || c.photo_url}\" alt=\"${c.name}\" style=\"width: 40px; height: 40px; border-radius: 50%; object-fit: cover;\">`\r\n                                : `<div style=\"width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 14px;\">${initials}</div>`\r\n                            }\r\n                            <div style=\"flex: 1;\">\r\n                                <div style=\"font-weight: 500; color: var(--text-primary);\">${c.name || 'Unknown'}</div>\r\n                                <div style=\"font-size: 12px; color: var(--text-secondary);\">${c.role || c.organization || 'No role'}</div>\r\n                            </div>\r\n                            ${hasProfile \r\n                                ? `<span style=\"font-size: 11px; padding: 4px 8px; background: var(--success-bg, rgba(39, 174, 96, 0.1)); color: var(--success, #27ae60); border-radius: 12px;\">Analyzed</span>`\r\n                                : `<span style=\"font-size: 11px; padding: 4px 8px; background: var(--warning-bg, rgba(243, 156, 18, 0.1)); color: var(--warning, #f39c12); border-radius: 12px;\">Not analyzed</span>`\r\n                            }\r\n                        </label>\r\n                    `;\r\n                }).join('')}\r\n            </div>\r\n        `;\r\n\r\n        // Checkbox handlers\r\n        const selectedIds = new Set<string>();\r\n        const updateButton = () => {\r\n            const btn = modal.querySelector('#modal-analyze-selected-btn') as HTMLButtonElement;\r\n            if (btn) {\r\n                btn.disabled = selectedIds.size === 0;\r\n                btn.textContent = `Analyze Selected (${selectedIds.size})`;\r\n            }\r\n        };\r\n\r\n        listEl.querySelectorAll('.contact-checkbox').forEach(checkbox => {\r\n            checkbox.addEventListener('change', (e) => {\r\n                const input = e.target as HTMLInputElement;\r\n                const id = input.dataset.id;\r\n                const label = input.closest('.contact-item') as HTMLElement;\r\n                if (id) {\r\n                    if (input.checked) {\r\n                        selectedIds.add(id);\r\n                        if (label) label.style.borderColor = 'var(--primary-color)';\r\n                    } else {\r\n                        selectedIds.delete(id);\r\n                        if (label) label.style.borderColor = 'transparent';\r\n                    }\r\n                    updateButton();\r\n                }\r\n            });\r\n        });\r\n\r\n        // Select unanalyzed button\r\n        modal.querySelector('#select-unanalyzed-btn')?.addEventListener('click', () => {\r\n            listEl.querySelectorAll('.contact-checkbox').forEach(checkbox => {\r\n                const input = checkbox as HTMLInputElement;\r\n                const id = input.dataset.id;\r\n                const label = input.closest('.contact-item') as HTMLElement;\r\n                if (id && !existingProfileIds.has(id)) {\r\n                    input.checked = true;\r\n                    selectedIds.add(id);\r\n                    if (label) label.style.borderColor = 'var(--primary-color)';\r\n                }\r\n            });\r\n            updateButton();\r\n        });\r\n\r\n        // Analyze selected button\r\n        modal.querySelector('#modal-analyze-selected-btn')?.addEventListener('click', async () => {\r\n            if (selectedIds.size === 0) return;\r\n            \r\n            const btn = modal.querySelector('#modal-analyze-selected-btn') as HTMLButtonElement;\r\n            const originalText = btn.textContent;\r\n            btn.disabled = true;\r\n            btn.textContent = 'Analyzing...';\r\n\r\n            let successCount = 0;\r\n            let errorCount = 0;\r\n\r\n            for (const id of selectedIds) {\r\n                const checkbox = listEl.querySelector(`.contact-checkbox[data-id=\"${id}\"]`) as HTMLInputElement;\r\n                const name = checkbox?.dataset.name || 'Contact';\r\n                \r\n                try {\r\n                    btn.textContent = `Analyzing ${name}...`;\r\n                    await teamAnalysisStore.analyzeProfile(id, { forceReanalysis: true });\r\n                    successCount++;\r\n                    \r\n                    // Mark as analyzed in the UI\r\n                    const label = checkbox?.closest('.contact-item') as HTMLElement;\r\n                    const badge = label?.querySelector('span:last-child');\r\n                    if (badge) {\r\n                        badge.style.background = 'var(--success-bg, rgba(39, 174, 96, 0.1))';\r\n                        badge.style.color = 'var(--success, #27ae60)';\r\n                        badge.textContent = 'Analyzed';\r\n                    }\r\n                } catch (error: any) {\r\n                    console.error(`Failed to analyze ${name}:`, error);\r\n                    errorCount++;\r\n                }\r\n            }\r\n\r\n            // Reload profiles\r\n            await teamAnalysisStore.loadProfiles();\r\n\r\n            if (successCount > 0) {\r\n                toast.success(`Successfully analyzed ${successCount} team member${successCount > 1 ? 's' : ''}`);\r\n            }\r\n            if (errorCount > 0) {\r\n                toast.error(`Failed to analyze ${errorCount} contact${errorCount > 1 ? 's' : ''}`);\r\n            }\r\n\r\n            closeModal();\r\n        });\r\n\r\n    } catch (error) {\r\n        const loadingEl = modal.querySelector('#contacts-list-loading');\r\n        if (loadingEl) {\r\n            loadingEl.innerHTML = `\r\n                <p style=\"color: var(--error);\">Failed to load contacts. Please try again.</p>\r\n            `;\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Switch subtab\r\n */\r\nasync function switchSubtab(subtab: 'profiles' | 'team' | 'graph'): Promise<void> {\r\n    // Update subtab buttons\r\n    document.querySelectorAll('#team-analysis-subtabs .subtab').forEach(btn => {\r\n        btn.classList.toggle('active', btn.getAttribute('data-subtab') === subtab);\r\n    });\r\n\r\n    // Load graph data BEFORE switching to graph tab to ensure data is available\r\n    if (subtab === 'graph') {\r\n        console.log('[TeamAnalysis] Loading graph data before switching tab...');\r\n        await teamAnalysisStore.loadGraphData();\r\n    }\r\n\r\n    // Now switch tab - this triggers re-render with the loaded data\r\n    teamAnalysisStore.setSubtab(subtab);\r\n}\r\n\r\n/**\r\n * Render content based on state\r\n */\r\nfunction renderContent(container: HTMLElement, state: any): void {\r\n    const contentEl = container.querySelector('#team-analysis-content');\r\n    if (!contentEl) return;\r\n\r\n    if (state.loading) {\r\n        contentEl.innerHTML = `\r\n            <div class=\"loading-state\">\r\n                <div class=\"loading-spinner\"></div>\r\n                <p style=\"margin-top: 16px; color: var(--text-secondary);\">Loading team analysis...</p>\r\n            </div>\r\n        `;\r\n        return;\r\n    }\r\n\r\n    if (state.analyzing) {\r\n        contentEl.innerHTML = `\r\n            <div class=\"loading-state\">\r\n                <div class=\"loading-spinner\"></div>\r\n                <p style=\"margin-top: 16px; color: var(--text-secondary);\">Analyzing... This may take a moment.</p>\r\n            </div>\r\n        `;\r\n        return;\r\n    }\r\n\r\n    // Render based on current subtab from store state\r\n    const currentSubtab = state.currentSubtab || 'profiles';\r\n    console.log('[TeamAnalysis] renderContent - currentSubtab:', currentSubtab);\r\n    \r\n    switch (currentSubtab) {\r\n        case 'profiles':\r\n            renderProfiles(contentEl, state);\r\n            break;\r\n        case 'team':\r\n            renderTeamDynamics(contentEl, state);\r\n            break;\r\n        case 'graph':\r\n            renderNetworkGraph(contentEl, state);\r\n            break;\r\n    }\r\n}\r\n\r\n/**\r\n * Render profiles grid\r\n */\r\nfunction renderProfiles(container: Element, state: any): void {\r\n    const { profiles, selectedProfile } = state;\r\n\r\n    if (selectedProfile) {\r\n        renderProfileDetail(container, selectedProfile);\r\n        return;\r\n    }\r\n\r\n    if (profiles.length === 0) {\r\n        container.innerHTML = `\r\n            <div class=\"empty-state\">\r\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                    <circle cx=\"12\" cy=\"5\" r=\"3\"/>\r\n                    <circle cx=\"5\" cy=\"19\" r=\"3\"/>\r\n                    <circle cx=\"19\" cy=\"19\" r=\"3\"/>\r\n                    <line x1=\"12\" y1=\"8\" x2=\"5\" y2=\"16\"/>\r\n                    <line x1=\"12\" y1=\"8\" x2=\"19\" y2=\"16\"/>\r\n                </svg>\r\n                <h3>No Profiles Yet</h3>\r\n                <p>Select a person to analyze, or process transcripts to build profiles automatically.</p>\r\n                <div id=\"people-list-container\" style=\"margin-top: 20px; width: 100%; max-width: 500px;\">\r\n                    <p style=\"color: var(--text-tertiary); font-size: 13px;\">Loading people...</p>\r\n                </div>\r\n            </div>\r\n        `;\r\n        \r\n        // Load people for manual analysis\r\n        loadPeopleForAnalysis(container);\r\n        return;\r\n    }\r\n\r\n    container.innerHTML = `\r\n        <div class=\"profiles-grid\">\r\n            ${profiles.map((p: BehavioralProfile) => renderProfileCard(p)).join('')}\r\n        </div>\r\n    `;\r\n\r\n    // Add click handlers\r\n    container.querySelectorAll('.profile-card').forEach(card => {\r\n        card.addEventListener('click', () => {\r\n            const personId = (card as HTMLElement).dataset.personId;\r\n            if (personId) {\r\n                teamAnalysisStore.loadProfile(personId);\r\n            }\r\n        });\r\n    });\r\n\r\n    // Add analyze buttons\r\n    container.querySelectorAll('.analyze-btn').forEach(btn => {\r\n        btn.addEventListener('click', async (e) => {\r\n            e.stopPropagation();\r\n            const personId = (btn as HTMLElement).dataset.personId;\r\n            if (personId) {\r\n                toast.info('Analyzing profile...');\r\n                await teamAnalysisStore.analyzeProfile(personId, { forceReanalysis: true });\r\n                toast.success('Profile analysis complete');\r\n            }\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n * Render a single profile card\r\n */\r\nfunction renderProfileCard(profile: BehavioralProfile): string {\r\n    const contact = (profile as any).contact || {};\r\n    const name = contact.name || 'Unknown';\r\n    const initials = name.split(' ').map((n: string) => n[0]).join('').substring(0, 2).toUpperCase();\r\n    const role = contact.role || contact.organization || 'No role';\r\n    const confidence = profile.confidence_level || 'low';\r\n    const avatarUrl = contact.avatar_url || contact.photo_url;\r\n    const contactId = (profile as any).contact_id || profile.person_id;\r\n\r\n    return `\r\n        <div class=\"profile-card\" data-person-id=\"${contactId}\">\r\n            <div class=\"profile-header\">\r\n                ${avatarUrl \r\n                    ? `<img class=\"profile-avatar\" src=\"${avatarUrl}\" alt=\"${name}\" style=\"width: 48px; height: 48px; border-radius: 50%; object-fit: cover;\" />`\r\n                    : `<div class=\"profile-avatar\">${initials}</div>`\r\n                }\r\n                <div class=\"profile-info\">\r\n                    <h3>${name}</h3>\r\n                    <div class=\"role\">${role}</div>\r\n                    <div class=\"profile-badges\">\r\n                        <span class=\"badge badge-confidence ${confidence}\">${confidence.replace('_', ' ')}</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"profile-metrics\">\r\n                <div class=\"metric\">\r\n                    <div class=\"metric-value\">${profile.influence_score || 0}</div>\r\n                    <div class=\"metric-label\">Influence</div>\r\n                </div>\r\n                <div class=\"metric\">\r\n                    <div class=\"metric-value\">${profile.transcript_count || 0}</div>\r\n                    <div class=\"metric-label\">Transcripts</div>\r\n                </div>\r\n                <div class=\"metric\">\r\n                    <div class=\"metric-value\">${profile.risk_tolerance || '-'}</div>\r\n                    <div class=\"metric-label\">Risk</div>\r\n                </div>\r\n            </div>\r\n            ${profile.communication_style ? `\r\n                <div class=\"profile-style\">\r\n                    <div class=\"profile-style-label\">Communication Style</div>\r\n                    <div class=\"profile-style-value\">${profile.communication_style}</div>\r\n                </div>\r\n            ` : ''}\r\n            <button class=\"btn btn-secondary analyze-btn\" data-person-id=\"${contactId}\" style=\"width: 100%; margin-top: 12px;\">\r\n                Re-analyze\r\n            </button>\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Render profile detail view\r\n */\r\nfunction renderProfileDetail(container: Element, profile: BehavioralProfile): void {\r\n    const contact = (profile as any).contact || {};\r\n    const name = contact.name || 'Unknown';\r\n    const data = profile.profile_data || {};\r\n\r\n    container.innerHTML = `\r\n        <div class=\"profile-detail\">\r\n            <div class=\"profile-detail-header\">\r\n                <div class=\"profile-detail-back\" id=\"back-to-profiles\">\r\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                        <polyline points=\"15 18 9 12 15 6\"/>\r\n                    </svg>\r\n                    Back to Profiles\r\n                </div>\r\n                <h2>${name}</h2>\r\n            </div>\r\n\r\n            <div class=\"profile-sections\">\r\n                ${renderCommunicationSection(data)}\r\n                ${renderMotivationsSection(data)}\r\n                ${renderPressureSection(data)}\r\n                ${renderInfluenceSection(data)}\r\n                ${renderVulnerabilitiesSection(data)}\r\n                ${renderStrategySection(data)}\r\n                ${renderWarningSection(data)}\r\n                ${renderPowerSection(data)}\r\n            </div>\r\n        </div>\r\n    `;\r\n\r\n    // Back button handler\r\n    container.querySelector('#back-to-profiles')?.addEventListener('click', () => {\r\n        teamAnalysisStore.setSelectedProfile(null);\r\n    });\r\n}\r\n\r\n/**\r\n * Render communication identity section\r\n */\r\nfunction renderCommunicationSection(data: any): string {\r\n    const comm = data.communication_identity;\r\n    if (!comm) return '';\r\n\r\n    return `\r\n        <div class=\"profile-section\">\r\n            <h4>\r\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                    <path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\"/>\r\n                </svg>\r\n                Communication Identity\r\n            </h4>\r\n            <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;\">\r\n                ${comm.dominant_style ? `<div><strong>Style:</strong> ${comm.dominant_style}</div>` : ''}\r\n                ${comm.intervention_rhythm ? `<div><strong>Rhythm:</strong> ${comm.intervention_rhythm}</div>` : ''}\r\n                ${comm.textual_body_language ? `<div><strong>Textual Cues:</strong> ${comm.textual_body_language}</div>` : ''}\r\n            </div>\r\n            ${renderEvidenceList(comm.evidence)}\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Render motivations section\r\n */\r\nfunction renderMotivationsSection(data: any): string {\r\n    const mot = data.motivations_and_priorities;\r\n    if (!mot) return '';\r\n\r\n    return `\r\n        <div class=\"profile-section\">\r\n            <h4>\r\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                    <polygon points=\"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2\"/>\r\n                </svg>\r\n                Motivations & Priorities\r\n            </h4>\r\n            ${mot.values_most?.length ? `<div><strong>Values most:</strong> ${mot.values_most.join(', ')}</div>` : ''}\r\n            ${mot.avoids?.length ? `<div style=\"margin-top: 8px;\"><strong>Avoids:</strong> ${mot.avoids.join(', ')}</div>` : ''}\r\n            <div style=\"margin-top: 8px; font-size: 12px; color: var(--text-tertiary);\">\r\n                Confidence: ${mot.confidence || 'Not specified'}\r\n            </div>\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Render behavior under pressure section\r\n */\r\nfunction renderPressureSection(data: any): string {\r\n    const behaviors = data.behavior_under_pressure;\r\n    if (!behaviors?.length) return '';\r\n\r\n    return `\r\n        <div class=\"profile-section\">\r\n            <h4>\r\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                    <path d=\"M12 22a10 10 0 1 1 0-20 10 10 0 0 1 0 20z\"/>\r\n                    <path d=\"M12 6v6l4 2\"/>\r\n                </svg>\r\n                Behavior Under Pressure\r\n            </h4>\r\n            <div class=\"evidence-list\">\r\n                ${behaviors.map((b: any) => `\r\n                    <div class=\"evidence-item\">\r\n                        <strong>${b.situation}</strong>\r\n                        <p style=\"margin: 8px 0 0; color: var(--text-secondary);\">${b.observed_behavior}</p>\r\n                        ${b.quote ? `<div class=\"evidence-quote\">\"${b.quote}\"</div>` : ''}\r\n                        ${b.timestamp ? `<div class=\"evidence-timestamp\">${b.timestamp}</div>` : ''}\r\n                    </div>\r\n                `).join('')}\r\n            </div>\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Render influence tactics section\r\n */\r\nfunction renderInfluenceSection(data: any): string {\r\n    const tactics = data.influence_tactics;\r\n    if (!tactics?.length) return '';\r\n\r\n    return `\r\n        <div class=\"profile-section\">\r\n            <h4>\r\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                    <path d=\"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2\"/>\r\n                    <circle cx=\"9\" cy=\"7\" r=\"4\"/>\r\n                    <path d=\"M23 21v-2a4 4 0 0 0-3-3.87\"/>\r\n                    <path d=\"M16 3.13a4 4 0 0 1 0 7.75\"/>\r\n                </svg>\r\n                Influence Tactics\r\n            </h4>\r\n            <div class=\"evidence-list\">\r\n                ${tactics.map((t: any) => `\r\n                    <div class=\"evidence-item\">\r\n                        <strong>${t.objective}</strong>\r\n                        <p style=\"margin: 8px 0 0; color: var(--text-secondary);\">${t.tactic}</p>\r\n                        ${t.example ? `<div class=\"evidence-quote\">${t.example}</div>` : ''}\r\n                    </div>\r\n                `).join('')}\r\n            </div>\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Render vulnerabilities section\r\n */\r\nfunction renderVulnerabilitiesSection(data: any): string {\r\n    const vuln = data.vulnerabilities;\r\n    if (!vuln) return '';\r\n\r\n    const sections = [];\r\n\r\n    if (vuln.defense_triggers?.length) {\r\n        sections.push(`\r\n            <div style=\"margin-bottom: 16px;\">\r\n                <strong style=\"color: #e74c3c;\">Defense Triggers</strong>\r\n                <ul style=\"margin: 8px 0; padding-left: 20px;\">\r\n                    ${vuln.defense_triggers.map((t: any) => `<li>${t.trigger}</li>`).join('')}\r\n                </ul>\r\n            </div>\r\n        `);\r\n    }\r\n\r\n    if (vuln.blind_spots?.length) {\r\n        sections.push(`\r\n            <div style=\"margin-bottom: 16px;\">\r\n                <strong style=\"color: #f39c12;\">Blind Spots</strong>\r\n                <ul style=\"margin: 8px 0; padding-left: 20px;\">\r\n                    ${vuln.blind_spots.map((b: any) => `<li>${b.description}</li>`).join('')}\r\n                </ul>\r\n            </div>\r\n        `);\r\n    }\r\n\r\n    if (sections.length === 0) return '';\r\n\r\n    return `\r\n        <div class=\"profile-section\">\r\n            <h4>\r\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                    <path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"/>\r\n                    <line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\"/>\r\n                    <line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"/>\r\n                </svg>\r\n                Vulnerabilities & Friction Points\r\n            </h4>\r\n            ${sections.join('')}\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Render interaction strategy section\r\n */\r\nfunction renderStrategySection(data: any): string {\r\n    const strat = data.interaction_strategy;\r\n    if (!strat) return '';\r\n\r\n    return `\r\n        <div class=\"profile-section\">\r\n            <h4>\r\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                    <path d=\"M12 20h9\"/>\r\n                    <path d=\"M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z\"/>\r\n                </svg>\r\n                Recommended Interaction Strategy\r\n            </h4>\r\n            ${strat.ideal_format ? `\r\n                <div style=\"margin-bottom: 12px;\">\r\n                    <strong>Ideal Format</strong>\r\n                    <div style=\"margin-top: 4px; color: var(--text-secondary);\">\r\n                        ${strat.ideal_format.channel ? `Channel: ${strat.ideal_format.channel}` : ''}\r\n                        ${strat.ideal_format.structure ? ` | Structure: ${strat.ideal_format.structure}` : ''}\r\n                        ${strat.ideal_format.timing ? ` | Timing: ${strat.ideal_format.timing}` : ''}\r\n                    </div>\r\n                </div>\r\n            ` : ''}\r\n            ${strat.framing_that_works?.length ? `\r\n                <div style=\"margin-bottom: 12px;\">\r\n                    <strong style=\"color: #27ae60;\">What Works</strong>\r\n                    <ul style=\"margin: 8px 0; padding-left: 20px;\">\r\n                        ${strat.framing_that_works.map((f: string) => `<li>${f}</li>`).join('')}\r\n                    </ul>\r\n                </div>\r\n            ` : ''}\r\n            ${strat.what_to_avoid?.length ? `\r\n                <div>\r\n                    <strong style=\"color: #e74c3c;\">What to Avoid</strong>\r\n                    <ul style=\"margin: 8px 0; padding-left: 20px;\">\r\n                        ${strat.what_to_avoid.map((a: string) => `<li>${a}</li>`).join('')}\r\n                    </ul>\r\n                </div>\r\n            ` : ''}\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Render early warning signs section\r\n */\r\nfunction renderWarningSection(data: any): string {\r\n    const warnings = data.early_warning_signs;\r\n    if (!warnings?.length) return '';\r\n\r\n    return `\r\n        <div class=\"profile-section\">\r\n            <h4>\r\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                    <circle cx=\"12\" cy=\"12\" r=\"10\"/>\r\n                    <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"12\"/>\r\n                    <line x1=\"12\" y1=\"16\" x2=\"12.01\" y2=\"16\"/>\r\n                </svg>\r\n                Early Warning Signs\r\n            </h4>\r\n            <div class=\"evidence-list\">\r\n                ${warnings.map((w: any) => `\r\n                    <div class=\"evidence-item\">\r\n                        <strong>${w.signal}</strong>\r\n                        <p style=\"margin: 8px 0 0; color: var(--text-secondary);\">Indicates: ${w.indicates}</p>\r\n                    </div>\r\n                `).join('')}\r\n            </div>\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Render power analysis section\r\n */\r\nfunction renderPowerSection(data: any): string {\r\n    const power = data.power_analysis;\r\n    if (!power?.length) return '';\r\n\r\n    return `\r\n        <div class=\"profile-section\">\r\n            <h4>\r\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                    <polygon points=\"13 2 3 14 12 14 11 22 21 10 12 10 13 2\"/>\r\n                </svg>\r\n                Power & Dependency Analysis\r\n            </h4>\r\n            <div class=\"evidence-list\">\r\n                ${power.map((p: any) => `\r\n                    <div class=\"evidence-item\">\r\n                        <strong>${p.factor}</strong>\r\n                        <p style=\"margin: 8px 0 0; color: var(--text-secondary);\">${p.assessment}</p>\r\n                        ${p.strategic_implication ? `<p style=\"margin: 8px 0 0; font-size: 12px; color: var(--primary-color);\">→ ${p.strategic_implication}</p>` : ''}\r\n                    </div>\r\n                `).join('')}\r\n            </div>\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Render evidence list\r\n */\r\nfunction renderEvidenceList(evidence: any[]): string {\r\n    if (!evidence?.length) return '';\r\n\r\n    return `\r\n        <div class=\"evidence-list\">\r\n            ${evidence.map(e => `\r\n                <div class=\"evidence-item\">\r\n                    ${e.quote ? `<div class=\"evidence-quote\">\"${e.quote}\"</div>` : ''}\r\n                    ${e.observation ? `<p style=\"margin: 0; color: var(--text-secondary);\">${e.observation}</p>` : ''}\r\n                    ${e.timestamp ? `<div class=\"evidence-timestamp\">${e.timestamp}</div>` : ''}\r\n                </div>\r\n            `).join('')}\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Render team dynamics view\r\n */\r\n/**\r\n * Build a name resolver that maps Person_N to real names\r\n */\r\nfunction buildNameResolver(profiles: any[]): (name: string) => { name: string; initials: string; role: string; avatarUrl?: string } {\r\n    const mapping: Record<string, { name: string; initials: string; role: string; avatarUrl?: string }> = {};\r\n    \r\n    // Map by Person_N pattern (index-based)\r\n    profiles.forEach((profile, index) => {\r\n        const contact = profile.contact || {};\r\n        const realName = contact.name || 'Unknown';\r\n        const initials = realName.split(' ').map((n: string) => n[0]).join('').substring(0, 2).toUpperCase();\r\n        const info = {\r\n            name: realName,\r\n            initials,\r\n            role: contact.role || contact.organization || '',\r\n            avatarUrl: contact.avatar_url || contact.photo_url\r\n        };\r\n        \r\n        // Map various patterns\r\n        mapping[`person_${index + 1}`] = info;\r\n        mapping[`person ${index + 1}`] = info;\r\n        mapping[`Person_${index + 1}`] = info;\r\n        mapping[`Person ${index + 1}`] = info;\r\n        mapping[realName.toLowerCase()] = info;\r\n        \r\n        // Also map by first name\r\n        const firstName = realName.split(' ')[0];\r\n        if (firstName) {\r\n            mapping[firstName.toLowerCase()] = info;\r\n        }\r\n    });\r\n    \r\n    return (name: string) => {\r\n        if (!name) return { name: 'Unknown', initials: '?', role: '' };\r\n        const normalized = name.toLowerCase().trim();\r\n        return mapping[normalized] || { \r\n            name: name.replace(/_/g, ' '), \r\n            initials: name.substring(0, 2).toUpperCase(), \r\n            role: '' \r\n        };\r\n    };\r\n}\r\n\r\n/**\r\n * Render a person chip with avatar and name\r\n */\r\nfunction renderPersonChip(personName: string, resolveName: (name: string) => any): string {\r\n    const info = resolveName(personName);\r\n    return `\r\n        <div class=\"person-chip\">\r\n            ${info.avatarUrl \r\n                ? `<img class=\"person-chip-avatar\" src=\"${info.avatarUrl}\" alt=\"${info.name}\" />`\r\n                : `<div class=\"person-chip-avatar person-chip-initials\">${info.initials}</div>`\r\n            }\r\n            <span class=\"person-chip-name\">${info.name}</span>\r\n        </div>\r\n    `;\r\n}\r\n\r\nfunction renderTeamDynamics(container: Element, state: any): void {\r\n    const { teamAnalysis, profiles } = state;\r\n\r\n    console.log('[TeamAnalysis] renderTeamDynamics called, teamAnalysis:', teamAnalysis);\r\n\r\n    if (!teamAnalysis) {\r\n        console.log('[TeamAnalysis] No teamAnalysis data, showing empty state');\r\n        container.innerHTML = `\r\n            <div class=\"empty-state\">\r\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                    <circle cx=\"12\" cy=\"5\" r=\"3\"/>\r\n                    <circle cx=\"5\" cy=\"19\" r=\"3\"/>\r\n                    <circle cx=\"19\" cy=\"19\" r=\"3\"/>\r\n                    <line x1=\"12\" y1=\"8\" x2=\"5\" y2=\"16\"/>\r\n                    <line x1=\"12\" y1=\"8\" x2=\"19\" y2=\"16\"/>\r\n                </svg>\r\n                <h3>No Team Analysis Yet</h3>\r\n                <p>Click \"Analyze Team\" to generate team dynamics analysis.</p>\r\n            </div>\r\n        `;\r\n        return;\r\n    }\r\n    \r\n    // Build name resolver from profiles\r\n    const resolveName = buildNameResolver(profiles || []);\r\n    \r\n    console.log('[TeamAnalysis] Rendering team dynamics with data:', {\r\n        cohesion: teamAnalysis.cohesion_score,\r\n        tension: teamAnalysis.tension_level,\r\n        teamSize: teamAnalysis.team_size,\r\n        influenceMapLength: teamAnalysis.influence_map?.length\r\n    });\r\n\r\n    const tensionClass = `tension-${teamAnalysis.tension_level || 'low'}`;\r\n    const cohesionColor = teamAnalysis.cohesion_score >= 70 ? '#27ae60' : \r\n                          teamAnalysis.cohesion_score >= 40 ? '#f39c12' : '#e74c3c';\r\n    \r\n    // Get additional analysis data\r\n    const analysisData = teamAnalysis.analysis_data || {};\r\n    const analysisDate = analysisData.analysis_date || teamAnalysis.last_analysis_at;\r\n    const recommendations = analysisData.recommendations || [];\r\n    const riskFactors = analysisData.risk_factors || [];\r\n    const commFlow = analysisData.communication_flow || {};\r\n    const dominantPattern = analysisData.dominant_communication_pattern || '';\r\n\r\n    container.innerHTML = `\r\n        <div class=\"team-dynamics-header\">\r\n            <div class=\"cohesion-card\">\r\n                <div class=\"cohesion-score-circle\" style=\"--score-color: ${cohesionColor}\">\r\n                    <span class=\"score-value\">${teamAnalysis.cohesion_score || 0}</span>\r\n                    <span class=\"score-label\">Cohesion</span>\r\n                </div>\r\n                <div class=\"cohesion-details\">\r\n                    <h3>Team Cohesion Score</h3>\r\n                    <span class=\"tension-badge ${tensionClass}\">\r\n                        ${teamAnalysis.tension_level || 'unknown'} tension\r\n                    </span>\r\n                </div>\r\n            </div>\r\n            <div class=\"team-size-card\">\r\n                <div class=\"team-size-value\">${teamAnalysis.team_size || 0}</div>\r\n                <div class=\"team-size-label\">Team Members</div>\r\n            </div>\r\n            <div class=\"analysis-meta-card\">\r\n                <div class=\"meta-icon\">📊</div>\r\n                <div class=\"meta-details\">\r\n                    <span class=\"meta-label\">Analysis Date</span>\r\n                    <span class=\"meta-value\">${analysisDate ? new Date(analysisDate).toLocaleDateString() : 'N/A'}</span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        ${dominantPattern ? `\r\n            <div class=\"executive-summary-section\">\r\n                <div class=\"summary-header\">\r\n                    <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                        <circle cx=\"12\" cy=\"12\" r=\"10\"/>\r\n                        <line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"12\"/>\r\n                        <line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\"/>\r\n                    </svg>\r\n                    <h3>Executive Summary</h3>\r\n                </div>\r\n                <p class=\"summary-text\">${replacePersonNames(dominantPattern, resolveName)}</p>\r\n            </div>\r\n        ` : ''}\r\n\r\n        ${renderInfluenceScoreboard(profiles || [], resolveName)}\r\n\r\n        ${renderCommunicationFlow(commFlow, resolveName)}\r\n\r\n        <div class=\"team-dynamics-grid\">\r\n            ${renderInfluenceMapV2(teamAnalysis.influence_map || [], resolveName)}\r\n            ${renderAlliancesV2(teamAnalysis.alliances || [], resolveName)}\r\n            ${renderTensionsV2(teamAnalysis.tensions || [], resolveName)}\r\n            ${renderPowerCentersV2(analysisData.power_centers || [], resolveName)}\r\n        </div>\r\n\r\n        ${renderRiskFactors(riskFactors)}\r\n        ${renderRecommendations(recommendations, resolveName)}\r\n    `;\r\n}\r\n\r\n/**\r\n * Render influence scoreboard - ranking of team members by influence\r\n */\r\nfunction renderInfluenceScoreboard(profiles: any[], resolveName: (name: string) => any): string {\r\n    if (!profiles?.length) return '';\r\n\r\n    // Sort profiles by influence score (descending)\r\n    const sortedProfiles = [...profiles]\r\n        .filter(p => p.influence_score !== undefined)\r\n        .sort((a, b) => (b.influence_score || 0) - (a.influence_score || 0));\r\n\r\n    if (sortedProfiles.length === 0) return '';\r\n\r\n    const maxScore = Math.max(...sortedProfiles.map(p => p.influence_score || 0), 100);\r\n\r\n    // Medal icons for top 3\r\n    const medals = ['🥇', '🥈', '🥉'];\r\n\r\n    return `\r\n        <div class=\"influence-scoreboard-section\">\r\n            <div class=\"scoreboard-header\">\r\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                    <path d=\"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z\"/>\r\n                </svg>\r\n                <h3>Influence Scoreboard</h3>\r\n                <span class=\"section-badge\" style=\"background: rgba(251, 191, 36, 0.15); color: #f59e0b;\">\r\n                    ${sortedProfiles.length} members ranked\r\n                </span>\r\n            </div>\r\n            <div class=\"scoreboard-list\">\r\n                ${sortedProfiles.map((profile, index) => {\r\n                    const contact = profile.contact || {};\r\n                    const name = contact.name || profile.person_name || 'Unknown';\r\n                    const role = contact.role || contact.organization || '';\r\n                    const avatarUrl = contact.avatar_url || contact.photo_url;\r\n                    const initials = name.split(' ').map((n: string) => n[0]).join('').substring(0, 2).toUpperCase();\r\n                    const score = profile.influence_score || 0;\r\n                    const barWidth = (score / maxScore) * 100;\r\n                    const rank = index + 1;\r\n                    const medal = medals[index] || '';\r\n                    const isTopThree = index < 3;\r\n                    \r\n                    // Risk indicator\r\n                    const riskLevel = profile.risk_tolerance || profile.risk_level || 'medium';\r\n                    const riskColors: Record<string, string> = {\r\n                        'low': '#10b981',\r\n                        'medium': '#f59e0b',\r\n                        'high': '#ef4444'\r\n                    };\r\n                    const riskColor = riskColors[riskLevel] || riskColors['medium'];\r\n                    \r\n                    // Communication style snippet\r\n                    const commStyle = profile.communication_style || profile.profile_data?.communication_identity?.dominant_style || '';\r\n                    const styleSnippet = commStyle.split(';')[0]?.substring(0, 50) || '';\r\n\r\n                    return `\r\n                        <div class=\"scoreboard-item ${isTopThree ? 'top-three' : ''}\">\r\n                            <div class=\"rank-badge ${isTopThree ? 'rank-' + rank : ''}\">\r\n                                ${medal || rank}\r\n                            </div>\r\n                            <div class=\"scoreboard-avatar\">\r\n                                ${avatarUrl \r\n                                    ? `<img src=\"${avatarUrl}\" alt=\"${name}\">`\r\n                                    : `<span class=\"avatar-initials\">${initials}</span>`\r\n                                }\r\n                            </div>\r\n                            <div class=\"scoreboard-info\">\r\n                                <div class=\"scoreboard-name\">${name}</div>\r\n                                <div class=\"scoreboard-role\">${role}</div>\r\n                                ${styleSnippet ? `<div class=\"scoreboard-style\">${styleSnippet}</div>` : ''}\r\n                            </div>\r\n                            <div class=\"scoreboard-metrics\">\r\n                                <div class=\"influence-meter\">\r\n                                    <div class=\"meter-label\">Influence</div>\r\n                                    <div class=\"meter-bar\">\r\n                                        <div class=\"meter-fill\" style=\"width: ${barWidth}%;\"></div>\r\n                                    </div>\r\n                                    <div class=\"meter-value\">${score}</div>\r\n                                </div>\r\n                                <div class=\"risk-indicator\" style=\"--risk-color: ${riskColor};\">\r\n                                    <span class=\"risk-dot\"></span>\r\n                                    <span class=\"risk-text\">${riskLevel} risk</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    `;\r\n                }).join('')}\r\n            </div>\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Render communication flow section\r\n */\r\nfunction renderCommunicationFlow(commFlow: any, resolveName: (name: string) => any): string {\r\n    if (!commFlow || (!commFlow.bottlenecks?.length && !commFlow.information_brokers?.length)) {\r\n        return '';\r\n    }\r\n\r\n    return `\r\n        <div class=\"communication-flow-section\">\r\n            <div class=\"flow-header\">\r\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                    <path d=\"M22 12h-4l-3 9L9 3l-3 9H2\"/>\r\n                </svg>\r\n                <h3>Communication Flow</h3>\r\n            </div>\r\n            <div class=\"flow-cards\">\r\n                ${commFlow.bottlenecks?.length ? `\r\n                    <div class=\"flow-card bottleneck-card\">\r\n                        <div class=\"flow-card-header\">\r\n                            <span class=\"flow-icon\">🚧</span>\r\n                            <h4>Bottlenecks</h4>\r\n                        </div>\r\n                        <ul class=\"flow-list\">\r\n                            ${commFlow.bottlenecks.map((b: string) => `<li>${replacePersonNames(b, resolveName)}</li>`).join('')}\r\n                        </ul>\r\n                    </div>\r\n                ` : ''}\r\n                ${commFlow.information_brokers?.length ? `\r\n                    <div class=\"flow-card broker-card\">\r\n                        <div class=\"flow-card-header\">\r\n                            <span class=\"flow-icon\">🔗</span>\r\n                            <h4>Information Brokers</h4>\r\n                        </div>\r\n                        <div class=\"broker-chips\">\r\n                            ${commFlow.information_brokers.map((b: string) => renderPersonChip(b, resolveName)).join('')}\r\n                        </div>\r\n                        <p class=\"flow-hint\">Key connectors who bridge information across the team</p>\r\n                    </div>\r\n                ` : ''}\r\n                ${commFlow.central_nodes?.length ? `\r\n                    <div class=\"flow-card central-card\">\r\n                        <div class=\"flow-card-header\">\r\n                            <span class=\"flow-icon\">⭐</span>\r\n                            <h4>Central Nodes</h4>\r\n                        </div>\r\n                        <div class=\"broker-chips\">\r\n                            ${commFlow.central_nodes.map((n: string) => renderPersonChip(n, resolveName)).join('')}\r\n                        </div>\r\n                        <p class=\"flow-hint\">Most connected team members</p>\r\n                    </div>\r\n                ` : ''}\r\n                ${commFlow.isolated_members?.length ? `\r\n                    <div class=\"flow-card isolated-card\">\r\n                        <div class=\"flow-card-header\">\r\n                            <span class=\"flow-icon\">🏝️</span>\r\n                            <h4>Isolated Members</h4>\r\n                        </div>\r\n                        <div class=\"broker-chips\">\r\n                            ${commFlow.isolated_members.map((m: string) => renderPersonChip(m, resolveName)).join('')}\r\n                        </div>\r\n                        <p class=\"flow-hint\">Members with fewer connections - may need inclusion</p>\r\n                    </div>\r\n                ` : ''}\r\n            </div>\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Replace Person_X names in text with real names\r\n */\r\nfunction replacePersonNames(text: string, resolveName: (name: string) => any): string {\r\n    return text.replace(/Person_(\\d+)/g, (match) => {\r\n        const resolved = resolveName(match);\r\n        return resolved.name || match;\r\n    });\r\n}\r\n\r\n/**\r\n * Render risk factors section\r\n */\r\nfunction renderRiskFactors(riskFactors: string[]): string {\r\n    if (!riskFactors?.length) return '';\r\n\r\n    return `\r\n        <div class=\"risk-factors-section\">\r\n            <div class=\"section-header\">\r\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                    <path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"/>\r\n                    <line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\"/>\r\n                    <line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"/>\r\n                </svg>\r\n                <h3>Risk Factors</h3>\r\n                <span class=\"section-badge risk-badge\">${riskFactors.length} identified</span>\r\n            </div>\r\n            <div class=\"risk-list\">\r\n                ${riskFactors.map((risk, i) => `\r\n                    <div class=\"risk-item\">\r\n                        <span class=\"risk-number\">${i + 1}</span>\r\n                        <p>${risk}</p>\r\n                    </div>\r\n                `).join('')}\r\n            </div>\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Render recommendations section\r\n */\r\nfunction renderRecommendations(recommendations: string[], resolveName: (name: string) => any): string {\r\n    if (!recommendations?.length) return '';\r\n\r\n    return `\r\n        <div class=\"recommendations-section\">\r\n            <div class=\"section-header\">\r\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                    <path d=\"M9 11l3 3L22 4\"/>\r\n                    <path d=\"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11\"/>\r\n                </svg>\r\n                <h3>Recommendations</h3>\r\n                <span class=\"section-badge rec-badge\">${recommendations.length} actions</span>\r\n            </div>\r\n            <div class=\"recommendations-list\">\r\n                ${recommendations.map((rec, i) => `\r\n                    <div class=\"recommendation-item\">\r\n                        <div class=\"rec-icon\">\r\n                            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                                <circle cx=\"12\" cy=\"12\" r=\"10\"/>\r\n                                <path d=\"M12 16v-4\"/>\r\n                                <path d=\"M12 8h.01\"/>\r\n                            </svg>\r\n                        </div>\r\n                        <div class=\"rec-content\">\r\n                            <span class=\"rec-number\">Action ${i + 1}</span>\r\n                            <p>${replacePersonNames(rec, resolveName)}</p>\r\n                        </div>\r\n                    </div>\r\n                `).join('')}\r\n            </div>\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Render influence map V2 with person chips\r\n */\r\nfunction renderInfluenceMapV2(influenceMap: any[], resolveName: (name: string) => any): string {\r\n    if (!influenceMap.length) return '';\r\n\r\n    // Type colors and icons\r\n    const typeConfig: Record<string, { color: string; bg: string; icon: string; desc: string }> = {\r\n        'direct': { color: '#3b82f6', bg: '#eff6ff', icon: '→', desc: 'Direct influence through communication and decisions' },\r\n        'technical': { color: '#8b5cf6', bg: '#f5f3ff', icon: '⚙', desc: 'Influence through technical expertise and knowledge' },\r\n        'political': { color: '#f59e0b', bg: '#fffbeb', icon: '♟', desc: 'Influence through organizational dynamics and alliances' },\r\n        'social': { color: '#10b981', bg: '#ecfdf5', icon: '🤝', desc: 'Influence through relationships and social capital' },\r\n        'resource': { color: '#ef4444', bg: '#fef2f2', icon: '📊', desc: 'Influence through control of resources' }\r\n    };\r\n\r\n    return `\r\n        <div class=\"dynamics-card\">\r\n            <div class=\"dynamics-card-header\">\r\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                    <path d=\"M22 11.08V12a10 10 0 1 1-5.93-9.14\"/>\r\n                    <polyline points=\"22 4 12 14.01 9 11.01\"/>\r\n                </svg>\r\n                <h3>Influence Map</h3>\r\n                <span class=\"dynamics-count\">${influenceMap.length} connections</span>\r\n            </div>\r\n            <div class=\"dynamics-list\">\r\n                ${influenceMap.slice(0, 10).map(inf => {\r\n                    const strengthPct = Math.round((inf.strength || 0.5) * 100);\r\n                    const strengthLabel = strengthPct >= 70 ? 'Strong' : strengthPct >= 40 ? 'Moderate' : 'Weak';\r\n                    const infType = (inf.influence_type || 'direct').toLowerCase();\r\n                    const config = typeConfig[infType] || typeConfig['direct'];\r\n                    const hasEvidence = inf.evidence && inf.evidence.length > 10;\r\n                    const itemId = `inf-${Math.random().toString(36).substr(2, 9)}`;\r\n                    \r\n                    return `\r\n                        <div class=\"dynamics-item influence-item expandable-item\" data-item-id=\"${itemId}\">\r\n                            <div class=\"influence-main-row\">\r\n                                <div class=\"influence-flow\">\r\n                                    ${renderPersonChip(inf.from_person, resolveName)}\r\n                                    <div class=\"influence-arrow\">\r\n                                        <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                                            <line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"/>\r\n                                            <polyline points=\"12 5 19 12 12 19\"/>\r\n                                        </svg>\r\n                                    </div>\r\n                                    ${renderPersonChip(inf.to_person, resolveName)}\r\n                                </div>\r\n                                <div class=\"influence-meta\">\r\n                                    <span class=\"type-badge\" style=\"background: ${config.bg}; color: ${config.color};\" title=\"${config.desc}\">\r\n                                        <span class=\"type-icon\">${config.icon}</span>\r\n                                        ${infType}\r\n                                    </span>\r\n                                </div>\r\n                                <div class=\"influence-strength-container\">\r\n                                    <div class=\"strength-value\">${strengthPct}%</div>\r\n                                    <div class=\"strength-bar-mini\">\r\n                                        <div class=\"strength-fill-mini\" style=\"width: ${strengthPct}%; background: ${config.color};\"></div>\r\n                                    </div>\r\n                                    <div class=\"strength-label\">${strengthLabel}</div>\r\n                                </div>\r\n                                ${hasEvidence ? `<button class=\"expand-btn\" onclick=\"this.closest('.expandable-item').classList.toggle('expanded')\" title=\"Show details\">\r\n                                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                                        <polyline points=\"6 9 12 15 18 9\"/>\r\n                                    </svg>\r\n                                </button>` : ''}\r\n                            </div>\r\n                            ${hasEvidence ? `\r\n                                <div class=\"item-details\">\r\n                                    <div class=\"evidence-text\">\r\n                                        <strong>Evidence:</strong> ${replacePersonNames(inf.evidence, resolveName)}\r\n                                    </div>\r\n                                </div>\r\n                            ` : ''}\r\n                        </div>\r\n                    `;\r\n                }).join('')}\r\n            </div>\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Render alliances V2 with person chips\r\n */\r\nfunction renderAlliancesV2(alliances: any[], resolveName: (name: string) => any): string {\r\n    if (!alliances.length) return '';\r\n\r\n    // Alliance type colors\r\n    const typeConfig: Record<string, { color: string; bg: string; icon: string; desc: string }> = {\r\n        'natural': { color: '#10b981', bg: '#ecfdf5', icon: '🌱', desc: 'Organic alliance based on shared values and goals' },\r\n        'circumstantial': { color: '#6366f1', bg: '#eef2ff', icon: '🔗', desc: 'Alliance formed due to shared circumstances or challenges' },\r\n        'strategic': { color: '#f59e0b', bg: '#fffbeb', icon: '♟', desc: 'Deliberate alliance for mutual benefit' },\r\n        'historical': { color: '#8b5cf6', bg: '#f5f3ff', icon: '📜', desc: 'Long-standing alliance based on history' }\r\n    };\r\n\r\n    return `\r\n        <div class=\"dynamics-card alliance-card\">\r\n            <div class=\"dynamics-card-header\">\r\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                    <path d=\"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2\"/>\r\n                    <circle cx=\"9\" cy=\"7\" r=\"4\"/>\r\n                    <path d=\"M23 21v-2a4 4 0 0 0-3-3.87\"/>\r\n                    <path d=\"M16 3.13a4 4 0 0 1 0 7.75\"/>\r\n                </svg>\r\n                <h3>Alliances</h3>\r\n                <span class=\"dynamics-count\">${alliances.length} groups</span>\r\n            </div>\r\n            <div class=\"dynamics-list\">\r\n                ${alliances.map(all => {\r\n                    let members = all.members || [];\r\n                    if (typeof members === 'string') {\r\n                        members = members.split(/[\\s,]+/).filter((m: string) => m.trim());\r\n                    }\r\n                    const strengthPct = Math.round((all.strength || 0.5) * 100);\r\n                    const bondLabel = strengthPct >= 70 ? 'Strong bond' : strengthPct >= 40 ? 'Moderate bond' : 'Weak bond';\r\n                    const allianceType = (all.alliance_type || 'natural').toLowerCase();\r\n                    const config = typeConfig[allianceType] || typeConfig['natural'];\r\n                    const hasEvidence = all.evidence && all.evidence.length > 10;\r\n                    const hasSharedValues = all.shared_values && all.shared_values.length > 0;\r\n                    const itemId = `all-${Math.random().toString(36).substr(2, 9)}`;\r\n                    \r\n                    return `\r\n                        <div class=\"dynamics-item alliance-item expandable-item\" data-item-id=\"${itemId}\">\r\n                            <div class=\"alliance-main-row\">\r\n                                <div class=\"alliance-members\">\r\n                                    ${members.map((m: string) => renderPersonChip(m, resolveName)).join('<span class=\"alliance-connector\">&</span>')}\r\n                                </div>\r\n                                <div class=\"alliance-meta\">\r\n                                    <span class=\"type-badge\" style=\"background: ${config.bg}; color: ${config.color};\" title=\"${config.desc}\">\r\n                                        <span class=\"type-icon\">${config.icon}</span>\r\n                                        ${allianceType}\r\n                                    </span>\r\n                                </div>\r\n                                <div class=\"alliance-strength-container\">\r\n                                    <div class=\"strength-value alliance-value\">${strengthPct}%</div>\r\n                                    <div class=\"strength-bar-mini alliance-bar\">\r\n                                        <div class=\"strength-fill-mini\" style=\"width: ${strengthPct}%; background: ${config.color};\"></div>\r\n                                    </div>\r\n                                    <div class=\"strength-label\">${bondLabel}</div>\r\n                                </div>\r\n                                ${(hasEvidence || hasSharedValues) ? `<button class=\"expand-btn\" onclick=\"this.closest('.expandable-item').classList.toggle('expanded')\" title=\"Show details\">\r\n                                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                                        <polyline points=\"6 9 12 15 18 9\"/>\r\n                                    </svg>\r\n                                </button>` : ''}\r\n                            </div>\r\n                            ${(hasEvidence || hasSharedValues) ? `\r\n                                <div class=\"item-details\">\r\n                                    ${hasSharedValues ? `\r\n                                        <div class=\"shared-values\">\r\n                                            <strong>Shared Values:</strong>\r\n                                            <ul>${all.shared_values.map((v: string) => `<li>${v}</li>`).join('')}</ul>\r\n                                        </div>\r\n                                    ` : ''}\r\n                                    ${hasEvidence ? `\r\n                                        <div class=\"evidence-text\">\r\n                                            <strong>Evidence:</strong> ${replacePersonNames(all.evidence, resolveName)}\r\n                                        </div>\r\n                                    ` : ''}\r\n                                </div>\r\n                            ` : ''}\r\n                        </div>\r\n                    `;\r\n                }).join('')}\r\n            </div>\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Render tensions V2 with person chips\r\n */\r\nfunction renderTensionsV2(tensions: any[], resolveName: (name: string) => any): string {\r\n    if (!tensions.length) return '';\r\n\r\n    // Tension type colors\r\n    const typeConfig: Record<string, { color: string; bg: string; icon: string; desc: string }> = {\r\n        'technical': { color: '#8b5cf6', bg: '#f5f3ff', icon: '⚙', desc: 'Disagreements about technical approaches or solutions' },\r\n        'resource': { color: '#f59e0b', bg: '#fffbeb', icon: '📊', desc: 'Competition for resources, time, or attention' },\r\n        'political': { color: '#ef4444', bg: '#fef2f2', icon: '♟', desc: 'Power dynamics and organizational influence conflicts' },\r\n        'communication': { color: '#3b82f6', bg: '#eff6ff', icon: '💬', desc: 'Misunderstandings or communication style clashes' },\r\n        'values': { color: '#10b981', bg: '#ecfdf5', icon: '⚖', desc: 'Differences in core values or priorities' }\r\n    };\r\n\r\n    // Level colors\r\n    const levelColors: Record<string, { color: string; bg: string }> = {\r\n        'high': { color: '#dc2626', bg: '#fef2f2' },\r\n        'medium': { color: '#f59e0b', bg: '#fffbeb' },\r\n        'low': { color: '#10b981', bg: '#ecfdf5' }\r\n    };\r\n\r\n    return `\r\n        <div class=\"dynamics-card tension-card\">\r\n            <div class=\"dynamics-card-header\">\r\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                    <path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"/>\r\n                    <line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\"/>\r\n                    <line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"/>\r\n                </svg>\r\n                <h3>Tensions</h3>\r\n                <span class=\"dynamics-count\">${tensions.length} identified</span>\r\n            </div>\r\n            <div class=\"dynamics-list\">\r\n                ${tensions.map(t => {\r\n                    let between = t.between || [];\r\n                    if (typeof between === 'string') {\r\n                        between = between.split(/[\\s,]+/).filter((m: string) => m.trim());\r\n                    }\r\n                    const level = (t.level || 'low').toLowerCase();\r\n                    const levelClass = `tension-level-${level}`;\r\n                    const levelConfig = levelColors[level] || levelColors['low'];\r\n                    const tensionType = (t.tension_type || 'communication').toLowerCase();\r\n                    const config = typeConfig[tensionType] || typeConfig['communication'];\r\n                    const hasEvidence = t.evidence && t.evidence.length > 10;\r\n                    const hasTriggers = t.triggers && t.triggers.length > 0;\r\n                    const itemId = `ten-${Math.random().toString(36).substr(2, 9)}`;\r\n                    \r\n                    return `\r\n                        <div class=\"dynamics-item tension-item expandable-item ${levelClass}\" data-item-id=\"${itemId}\">\r\n                            <div class=\"tension-main-row\">\r\n                                <div class=\"tension-parties\">\r\n                                    ${between.slice(0, 2).map((p: string) => renderPersonChip(p, resolveName)).join('<span class=\"tension-vs\">↔</span>')}\r\n                                </div>\r\n                                <div class=\"tension-meta\">\r\n                                    <span class=\"type-badge\" style=\"background: ${config.bg}; color: ${config.color};\" title=\"${config.desc}\">\r\n                                        <span class=\"type-icon\">${config.icon}</span>\r\n                                        ${tensionType}\r\n                                    </span>\r\n                                </div>\r\n                                <span class=\"tension-badge\" style=\"background: ${levelConfig.bg}; color: ${levelConfig.color};\">${level}</span>\r\n                                ${(hasEvidence || hasTriggers) ? `<button class=\"expand-btn\" onclick=\"this.closest('.expandable-item').classList.toggle('expanded')\" title=\"Show details\">\r\n                                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                                        <polyline points=\"6 9 12 15 18 9\"/>\r\n                                    </svg>\r\n                                </button>` : ''}\r\n                            </div>\r\n                            ${(hasEvidence || hasTriggers) ? `\r\n                                <div class=\"item-details\">\r\n                                    ${hasTriggers ? `\r\n                                        <div class=\"triggers-list\">\r\n                                            <strong>Triggers:</strong>\r\n                                            <ul>${t.triggers.map((tr: string) => `<li>${tr}</li>`).join('')}</ul>\r\n                                        </div>\r\n                                    ` : ''}\r\n                                    ${hasEvidence ? `\r\n                                        <div class=\"evidence-text\">\r\n                                            <strong>Evidence:</strong> ${replacePersonNames(t.evidence, resolveName)}\r\n                                        </div>\r\n                                    ` : ''}\r\n                                </div>\r\n                            ` : ''}\r\n                        </div>\r\n                    `;\r\n                }).join('')}\r\n            </div>\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Render power centers V2 with person chips\r\n */\r\nfunction renderPowerCentersV2(powerCenters: any[], resolveName: (name: string) => any): string {\r\n    if (!powerCenters.length) return '';\r\n\r\n    // Power type configuration\r\n    const typeConfig: Record<string, { color: string; bg: string; icon: string; desc: string }> = {\r\n        'technical': { color: '#8b5cf6', bg: '#f5f3ff', icon: '⚙', desc: 'Power through technical expertise and knowledge' },\r\n        'formal': { color: '#3b82f6', bg: '#eff6ff', icon: '👔', desc: 'Power through official role and authority' },\r\n        'informal': { color: '#f59e0b', bg: '#fffbeb', icon: '💬', desc: 'Power through relationships and influence' },\r\n        'social': { color: '#10b981', bg: '#ecfdf5', icon: '🤝', desc: 'Power through social connections and trust' },\r\n        'resource': { color: '#ef4444', bg: '#fef2f2', icon: '📊', desc: 'Power through control of resources' }\r\n    };\r\n\r\n    return `\r\n        <div class=\"dynamics-card power-card\">\r\n            <div class=\"dynamics-card-header\">\r\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                    <polygon points=\"13 2 3 14 12 14 11 22 21 10 12 10 13 2\"/>\r\n                </svg>\r\n                <h3>Power Centers</h3>\r\n                <span class=\"dynamics-count\">${powerCenters.length} key players</span>\r\n            </div>\r\n            <div class=\"dynamics-list\">\r\n                ${powerCenters.map(pc => {\r\n                    const reachPct = Math.round(pc.influence_reach || 50);\r\n                    const powerType = (pc.power_type || 'informal').toLowerCase();\r\n                    const config = typeConfig[powerType] || typeConfig['informal'];\r\n                    const hasDependencies = pc.dependencies && pc.dependencies.length > 0;\r\n                    const itemId = `pow-${Math.random().toString(36).substr(2, 9)}`;\r\n                    \r\n                    return `\r\n                        <div class=\"dynamics-item power-item expandable-item\" data-item-id=\"${itemId}\">\r\n                            <div class=\"power-main-row\">\r\n                                <div class=\"power-person\">\r\n                                    ${renderPersonChip(pc.person, resolveName)}\r\n                                </div>\r\n                                <div class=\"power-details\">\r\n                                    <span class=\"type-badge\" style=\"background: ${config.bg}; color: ${config.color};\" title=\"${config.desc}\">\r\n                                        <span class=\"type-icon\">${config.icon}</span>\r\n                                        ${powerType}\r\n                                    </span>\r\n                                </div>\r\n                                <div class=\"power-reach-container\">\r\n                                    <div class=\"strength-value power-value\">${reachPct}%</div>\r\n                                    <div class=\"strength-bar-mini power-bar\">\r\n                                        <div class=\"strength-fill-mini\" style=\"width: ${reachPct}%; background: ${config.color};\"></div>\r\n                                    </div>\r\n                                    <div class=\"strength-label\">reach</div>\r\n                                </div>\r\n                                ${hasDependencies ? `<button class=\"expand-btn\" onclick=\"this.closest('.expandable-item').classList.toggle('expanded')\" title=\"Show details\">\r\n                                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                                        <polyline points=\"6 9 12 15 18 9\"/>\r\n                                    </svg>\r\n                                </button>` : ''}\r\n                            </div>\r\n                            ${hasDependencies ? `\r\n                                <div class=\"item-details\">\r\n                                    <div class=\"dependencies-list\">\r\n                                        <strong>Power Sources:</strong>\r\n                                        <ul>${pc.dependencies.map((d: string) => `<li>${d}</li>`).join('')}</ul>\r\n                                    </div>\r\n                                </div>\r\n                            ` : ''}\r\n                        </div>\r\n                    `;\r\n                }).join('')}\r\n            </div>\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Render network graph\r\n */\r\nfunction renderNetworkGraph(container: Element, state: any): void {\r\n    const { graphData, profiles } = state;\r\n\r\n    console.log('[TeamAnalysis] renderNetworkGraph called, graphData:', graphData);\r\n\r\n    if (!graphData || !graphData.nodes || !graphData.nodes.length) {\r\n        console.log('[TeamAnalysis] No graph data, showing empty state');\r\n        container.innerHTML = `\r\n            <div class=\"empty-state\">\r\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                    <circle cx=\"12\" cy=\"12\" r=\"3\"/>\r\n                    <circle cx=\"19\" cy=\"5\" r=\"2\"/>\r\n                    <circle cx=\"5\" cy=\"19\" r=\"2\"/>\r\n                    <line x1=\"14.5\" y1=\"9.5\" x2=\"17.5\" y2=\"6.5\"/>\r\n                    <line x1=\"9.5\" y1=\"14.5\" x2=\"6.5\" y2=\"17.5\"/>\r\n                </svg>\r\n                <h3>No Network Data</h3>\r\n                <p>Analyze profiles to build the team network graph.</p>\r\n            </div>\r\n        `;\r\n        return;\r\n    }\r\n\r\n    // Build profile lookup for enriched node data\r\n    const profileLookup: Record<string, any> = {};\r\n    (profiles || []).forEach((p: any) => {\r\n        const id = p.contact_id || p.person_id;\r\n        if (id) profileLookup[id] = p;\r\n    });\r\n    \r\n    console.log('[TeamAnalysis] Rendering network graph with', graphData.nodes.length, 'nodes and', graphData.edges?.length || 0, 'edges');\r\n\r\n    container.innerHTML = `\r\n        <div class=\"network-graph-wrapper\">\r\n            <div class=\"network-legend\">\r\n                <div class=\"legend-item\">\r\n                    <span class=\"legend-line legend-influences\"></span>\r\n                    <span>Influences</span>\r\n                </div>\r\n                <div class=\"legend-item\">\r\n                    <span class=\"legend-line legend-alliance\"></span>\r\n                    <span>Alliance</span>\r\n                </div>\r\n                <div class=\"legend-item\">\r\n                    <span class=\"legend-line legend-tension\"></span>\r\n                    <span>Tension</span>\r\n                </div>\r\n            </div>\r\n            <div class=\"network-graph-container\">\r\n                <div id=\"team-network-graph\" class=\"network-graph\"></div>\r\n            </div>\r\n            <div class=\"network-info-panel\" id=\"network-info-panel\">\r\n                <div class=\"info-panel-placeholder\">\r\n                    <p>Click on a person to see details</p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    `;\r\n\r\n    // Initialize vis.js network with enhanced styling\r\n    setTimeout(() => {\r\n        initializeNetwork(graphData, profileLookup);\r\n    }, 100);\r\n}\r\n\r\n/**\r\n * Generate initials from a name\r\n */\r\nfunction getInitials(name: string): string {\r\n    return name.split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase();\r\n}\r\n\r\n/**\r\n * Generate a color based on a string (for consistent avatar colors)\r\n */\r\nfunction stringToColor(str: string): string {\r\n    const colors = ['#9b59b6', '#3498db', '#e74c3c', '#27ae60', '#f39c12', '#1abc9c', '#e67e22', '#34495e'];\r\n    let hash = 0;\r\n    for (let i = 0; i < str.length; i++) {\r\n        hash = str.charCodeAt(i) + ((hash << 5) - hash);\r\n    }\r\n    return colors[Math.abs(hash) % colors.length];\r\n}\r\n\r\n/**\r\n * Create SVG data URL for avatar node\r\n */\r\nfunction createAvatarSvg(name: string, avatarUrl?: string, role?: string, influenceScore?: number): string {\r\n    const initials = getInitials(name);\r\n    const bgColor = stringToColor(name);\r\n    const size = 80;\r\n    \r\n    // If there's an avatar URL, we'll use circularImage shape instead\r\n    if (avatarUrl) {\r\n        return avatarUrl;\r\n    }\r\n    \r\n    // Create SVG with initials\r\n    const svg = `\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${size}\" height=\"${size}\" viewBox=\"0 0 ${size} ${size}\">\r\n            <defs>\r\n                <linearGradient id=\"grad-${initials}\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\r\n                    <stop offset=\"0%\" style=\"stop-color:${bgColor};stop-opacity:1\" />\r\n                    <stop offset=\"100%\" style=\"stop-color:${adjustColor(bgColor, -30)};stop-opacity:1\" />\r\n                </linearGradient>\r\n            </defs>\r\n            <circle cx=\"${size/2}\" cy=\"${size/2}\" r=\"${size/2 - 2}\" fill=\"url(#grad-${initials})\" stroke=\"white\" stroke-width=\"3\"/>\r\n            <text x=\"${size/2}\" y=\"${size/2 + 8}\" font-family=\"Arial, sans-serif\" font-size=\"24\" font-weight=\"bold\" fill=\"white\" text-anchor=\"middle\">${initials}</text>\r\n        </svg>\r\n    `;\r\n    \r\n    return 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent(svg);\r\n}\r\n\r\n/**\r\n * Adjust color brightness\r\n */\r\nfunction adjustColor(color: string, amount: number): string {\r\n    const clamp = (num: number) => Math.min(255, Math.max(0, num));\r\n    const hex = color.replace('#', '');\r\n    const r = clamp(parseInt(hex.substring(0, 2), 16) + amount);\r\n    const g = clamp(parseInt(hex.substring(2, 4), 16) + amount);\r\n    const b = clamp(parseInt(hex.substring(4, 6), 16) + amount);\r\n    return `#${r.toString(16).padStart(2, '0')}${g.toString(16).padStart(2, '0')}${b.toString(16).padStart(2, '0')}`;\r\n}\r\n\r\n/**\r\n * Get edge color based on relationship type\r\n */\r\nfunction getEdgeStyle(edgeType: string): { color: string; dashes: boolean; width: number } {\r\n    switch (edgeType) {\r\n        case 'influences':\r\n            return { color: '#3498db', dashes: false, width: 2 };\r\n        case 'aligned_with':\r\n            return { color: '#27ae60', dashes: false, width: 3 };\r\n        case 'tension_with':\r\n            return { color: '#e74c3c', dashes: [5, 5] as any, width: 2 };\r\n        default:\r\n            return { color: '#95a5a6', dashes: false, width: 1 };\r\n    }\r\n}\r\n\r\n/**\r\n * Initialize vis.js network visualization with avatars\r\n */\r\nfunction initializeNetwork(graphData: { nodes: any[]; edges: any[] }, profileLookup: Record<string, any>): void {\r\n    console.log('[TeamAnalysis] initializeNetwork called with', graphData.nodes?.length, 'nodes,', graphData.edges?.length, 'edges');\r\n    \r\n    const container = document.getElementById('team-network-graph');\r\n    if (!container) {\r\n        console.error('[TeamAnalysis] Network container not found!');\r\n        return;\r\n    }\r\n\r\n    // Destroy existing network\r\n    if (networkInstance) {\r\n        console.log('[TeamAnalysis] Destroying existing network instance');\r\n        networkInstance.destroy();\r\n        networkInstance = null;\r\n    }\r\n\r\n    // Check if vis.js is available\r\n    if (typeof vis === 'undefined') {\r\n        console.error('[TeamAnalysis] vis.js library not loaded!');\r\n        container.innerHTML = `\r\n            <div style=\"display: flex; align-items: center; justify-content: center; height: 100%; color: var(--text-secondary);\">\r\n                Network visualization library not loaded\r\n            </div>\r\n        `;\r\n        return;\r\n    }\r\n    \r\n    console.log('[TeamAnalysis] vis.js is available, creating network...');\r\n\r\n    // Create enhanced nodes with avatars\r\n    const nodes = new vis.DataSet(graphData.nodes.map(n => {\r\n        const profile = profileLookup[n.id] || {};\r\n        const contact = profile.contact || {};\r\n        const name = n.label || contact.name || 'Unknown';\r\n        const avatarUrl = contact.avatar_url || contact.photo_url;\r\n        const role = contact.role || n.properties?.role || '';\r\n        const influenceScore = profile.influence_score || n.properties?.influenceScore || 50;\r\n        \r\n        // Base size on influence score\r\n        const nodeSize = 30 + (influenceScore / 10);\r\n        \r\n        return {\r\n            id: n.id,\r\n            label: name,\r\n            shape: avatarUrl ? 'circularImage' : 'image',\r\n            image: createAvatarSvg(name, avatarUrl, role, influenceScore),\r\n            size: nodeSize,\r\n            borderWidth: 3,\r\n            borderWidthSelected: 5,\r\n            color: {\r\n                border: stringToColor(name),\r\n                highlight: {\r\n                    border: '#f39c12'\r\n                },\r\n                hover: {\r\n                    border: '#f39c12'\r\n                }\r\n            },\r\n            font: {\r\n                size: 14,\r\n                color: 'var(--color-text)',\r\n                face: 'Arial',\r\n                strokeWidth: 3,\r\n                strokeColor: 'var(--color-surface)'\r\n            },\r\n            // Store extra data for click handler\r\n            _profile: profile,\r\n            _role: role,\r\n            _influenceScore: influenceScore\r\n        };\r\n    }));\r\n\r\n    // Create styled edges\r\n    const edges = new vis.DataSet(graphData.edges.map(e => {\r\n        const style = getEdgeStyle(e.label || e.relationship_type);\r\n        return {\r\n            from: e.from,\r\n            to: e.to,\r\n            label: '',\r\n            width: style.width,\r\n            dashes: style.dashes,\r\n            color: {\r\n                color: style.color,\r\n                highlight: style.color,\r\n                hover: style.color,\r\n                opacity: 0.8\r\n            },\r\n            arrows: e.label === 'influences' ? { to: { enabled: true, scaleFactor: 0.8 } } : undefined,\r\n            smooth: {\r\n                type: 'curvedCW',\r\n                roundness: 0.2\r\n            },\r\n            title: formatEdgeLabel(e.label)\r\n        };\r\n    }));\r\n\r\n    const options = {\r\n        nodes: {\r\n            shapeProperties: {\r\n                useBorderWithImage: true,\r\n                interpolation: false\r\n            },\r\n            shadow: {\r\n                enabled: true,\r\n                color: 'rgba(0,0,0,0.2)',\r\n                size: 10,\r\n                x: 3,\r\n                y: 3\r\n            }\r\n        },\r\n        edges: {\r\n            font: {\r\n                size: 11,\r\n                align: 'middle',\r\n                color: 'var(--text-secondary)'\r\n            },\r\n            smooth: {\r\n                type: 'curvedCW',\r\n                roundness: 0.2\r\n            },\r\n            hoverWidth: 2,\r\n            selectionWidth: 3\r\n        },\r\n        physics: {\r\n            enabled: true,\r\n            stabilization: {\r\n                enabled: true,\r\n                iterations: 200\r\n            },\r\n            barnesHut: {\r\n                gravitationalConstant: -3000,\r\n                springLength: 200,\r\n                springConstant: 0.04,\r\n                damping: 0.3\r\n            }\r\n        },\r\n        interaction: {\r\n            hover: true,\r\n            tooltipDelay: 100,\r\n            navigationButtons: true,\r\n            keyboard: true,\r\n            zoomView: true\r\n        },\r\n        layout: {\r\n            improvedLayout: true\r\n        }\r\n    };\r\n\r\n    networkInstance = new vis.Network(container, { nodes, edges }, options);\r\n    \r\n    // Handle node click to show details\r\n    networkInstance.on('click', (params: any) => {\r\n        if (params.nodes.length > 0) {\r\n            const nodeId = params.nodes[0];\r\n            const nodeData = nodes.get(nodeId);\r\n            showNodeDetails(nodeData, profileLookup[nodeId]);\r\n        } else {\r\n            hideNodeDetails();\r\n        }\r\n    });\r\n    \r\n    // Handle hover for cursor change\r\n    networkInstance.on('hoverNode', () => {\r\n        container.style.cursor = 'pointer';\r\n    });\r\n    \r\n    networkInstance.on('blurNode', () => {\r\n        container.style.cursor = 'default';\r\n    });\r\n}\r\n\r\n/**\r\n * Format edge label for tooltip\r\n */\r\nfunction formatEdgeLabel(label: string): string {\r\n    const labels: Record<string, string> = {\r\n        'influences': '→ Influences',\r\n        'aligned_with': '🤝 Alliance',\r\n        'tension_with': '⚡ Tension'\r\n    };\r\n    return labels[label] || label;\r\n}\r\n\r\n/**\r\n * Show node details in side panel\r\n */\r\nfunction showNodeDetails(nodeData: any, profile: any): void {\r\n    const panel = document.getElementById('network-info-panel');\r\n    if (!panel) return;\r\n    \r\n    const contact = profile?.contact || {};\r\n    const name = nodeData.label || 'Unknown';\r\n    const role = contact.role || nodeData._role || '';\r\n    const org = contact.organization || '';\r\n    const influenceScore = profile?.influence_score || nodeData._influenceScore || 0;\r\n    const commStyle = profile?.communication_style || 'Unknown';\r\n    const motivation = profile?.dominant_motivation || 'Unknown';\r\n    const initials = getInitials(name);\r\n    const avatarUrl = contact.avatar_url || contact.photo_url;\r\n    \r\n    panel.innerHTML = `\r\n        <div class=\"node-detail-card\">\r\n            <div class=\"node-detail-header\">\r\n                ${avatarUrl \r\n                    ? `<img class=\"node-avatar\" src=\"${avatarUrl}\" alt=\"${name}\" />`\r\n                    : `<div class=\"node-avatar node-initials\" style=\"background: ${stringToColor(name)}\">${initials}</div>`\r\n                }\r\n                <div class=\"node-info\">\r\n                    <h3>${name}</h3>\r\n                    ${role ? `<p class=\"node-role\">${role}</p>` : ''}\r\n                    ${org ? `<p class=\"node-org\">${org}</p>` : ''}\r\n                </div>\r\n            </div>\r\n            <div class=\"node-metrics\">\r\n                <div class=\"node-metric\">\r\n                    <span class=\"metric-label\">Influence</span>\r\n                    <div class=\"metric-bar\">\r\n                        <div class=\"metric-fill\" style=\"width: ${influenceScore}%; background: #9b59b6;\"></div>\r\n                    </div>\r\n                    <span class=\"metric-value\">${influenceScore}%</span>\r\n                </div>\r\n            </div>\r\n            <div class=\"node-traits\">\r\n                <div class=\"trait-item\">\r\n                    <span class=\"trait-label\">Communication</span>\r\n                    <span class=\"trait-value\">${commStyle}</span>\r\n                </div>\r\n                <div class=\"trait-item\">\r\n                    <span class=\"trait-label\">Motivation</span>\r\n                    <span class=\"trait-value\">${motivation}</span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Hide node details panel\r\n */\r\nfunction hideNodeDetails(): void {\r\n    const panel = document.getElementById('network-info-panel');\r\n    if (!panel) return;\r\n    \r\n    panel.innerHTML = `\r\n        <div class=\"info-panel-placeholder\">\r\n            <p>Click on a person to see details</p>\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Load people available for analysis (when no profiles exist yet)\r\n */\r\nasync function loadPeopleForAnalysis(container: Element): Promise<void> {\r\n    const listContainer = container.querySelector('#people-list-container');\r\n    if (!listContainer) return;\r\n\r\n    try {\r\n        // Fetch people from contacts/people endpoint\r\n        const response = await http.get<{ contacts?: any[]; people?: any[] }>('/api/contacts');\r\n        const people = response.data?.contacts || response.data?.people || [];\r\n        \r\n        if (people.length === 0) {\r\n            listContainer.innerHTML = `\r\n                <p style=\"color: var(--text-tertiary); font-size: 13px;\">\r\n                    No people found. Process some transcripts first to extract participants.\r\n                </p>\r\n            `;\r\n            return;\r\n        }\r\n\r\n        listContainer.innerHTML = `\r\n            <div style=\"text-align: left;\">\r\n                <p style=\"color: var(--text-secondary); font-size: 13px; margin-bottom: 12px;\">\r\n                    Select a person to analyze (${people.length} available):\r\n                </p>\r\n                <div style=\"display: flex; flex-direction: column; gap: 8px; max-height: 300px; overflow-y: auto;\">\r\n                    ${people.slice(0, 20).map((p: any) => `\r\n                        <button class=\"btn btn-secondary analyze-person-btn\" \r\n                                data-person-id=\"${p.id}\" \r\n                                data-person-name=\"${p.name || 'Unknown'}\"\r\n                                style=\"display: flex; justify-content: space-between; align-items: center; padding: 12px 16px;\">\r\n                            <span style=\"font-weight: 500;\">${p.name || 'Unknown'}</span>\r\n                            <span style=\"font-size: 12px; color: var(--text-tertiary);\">${p.role || p.organization || ''}</span>\r\n                        </button>\r\n                    `).join('')}\r\n                </div>\r\n                ${people.length > 20 ? `<p style=\"color: var(--text-tertiary); font-size: 12px; margin-top: 8px;\">Showing first 20 of ${people.length} people</p>` : ''}\r\n            </div>\r\n        `;\r\n\r\n        // Add click handlers\r\n        listContainer.querySelectorAll('.analyze-person-btn').forEach(btn => {\r\n            btn.addEventListener('click', async () => {\r\n                const personId = (btn as HTMLElement).dataset.personId;\r\n                const personName = (btn as HTMLElement).dataset.personName;\r\n                if (personId) {\r\n                    toast.info(`Analyzing ${personName}...`);\r\n                    (btn as HTMLButtonElement).disabled = true;\r\n                    (btn as HTMLButtonElement).innerHTML = '<span>Analyzing...</span>';\r\n                    \r\n                    try {\r\n                        await teamAnalysisStore.analyzeProfile(personId, { forceReanalysis: true });\r\n                        toast.success(`Profile created for ${personName}`);\r\n                        // Reload profiles\r\n                        await teamAnalysisStore.loadProfiles();\r\n                    } catch (error: any) {\r\n                        toast.error(`Failed to analyze: ${error.message || 'Unknown error'}`);\r\n                        (btn as HTMLButtonElement).disabled = false;\r\n                        (btn as HTMLButtonElement).innerHTML = `<span style=\"font-weight: 500;\">${personName}</span>`;\r\n                    }\r\n                }\r\n            });\r\n        });\r\n    } catch (error) {\r\n        listContainer.innerHTML = `\r\n            <p style=\"color: var(--error); font-size: 13px;\">\r\n                Failed to load people. Please try again.\r\n            </p>\r\n        `;\r\n    }\r\n}\r\n\r\n// Export\r\nexport default createTeamAnalysis;\r\n"],"names":["networkInstance","createTeamAnalysis","container","createElement","initTeamAnalysis","teamAnalysisStore","state","renderContent","setupEventListeners","btn","e","subtab","switchSubtab","toast","showAnalyzeContactsModal","modal","closeModal","response","http","contacts","existingProfileIds","p","loadingEl","listEl","a","b","aAnalyzed","bAnalyzed","c","hasProfile","initials","n","selectedIds","updateButton","checkbox","input","id","label","originalText","successCount","errorCount","name","badge","error","contentEl","currentSubtab","renderProfiles","renderTeamDynamics","renderNetworkGraph","profiles","selectedProfile","renderProfileDetail","loadPeopleForAnalysis","renderProfileCard","card","personId","profile","contact","role","confidence","avatarUrl","contactId","data","renderCommunicationSection","renderMotivationsSection","renderPressureSection","renderInfluenceSection","renderVulnerabilitiesSection","renderStrategySection","renderWarningSection","renderPowerSection","comm","renderEvidenceList","mot","behaviors","tactics","t","vuln","sections","strat","f","warnings","w","power","evidence","buildNameResolver","mapping","index","realName","info","firstName","normalized","renderPersonChip","personName","resolveName","teamAnalysis","tensionClass","cohesionColor","analysisData","analysisDate","recommendations","riskFactors","commFlow","dominantPattern","replacePersonNames","renderInfluenceScoreboard","renderCommunicationFlow","renderInfluenceMapV2","renderAlliancesV2","renderTensionsV2","renderPowerCentersV2","renderRiskFactors","renderRecommendations","sortedProfiles","maxScore","medals","score","barWidth","rank","medal","isTopThree","riskLevel","riskColors","riskColor","styleSnippet","m","text","match","risk","i","rec","influenceMap","typeConfig","inf","strengthPct","strengthLabel","infType","config","hasEvidence","alliances","all","members","bondLabel","allianceType","hasSharedValues","v","tensions","levelColors","between","level","levelClass","levelConfig","tensionType","hasTriggers","itemId","tr","powerCenters","pc","reachPct","powerType","hasDependencies","d","graphData","profileLookup","initializeNetwork","getInitials","stringToColor","str","colors","hash","createAvatarSvg","influenceScore","bgColor","size","svg","adjustColor","color","amount","clamp","num","hex","r","g","getEdgeStyle","edgeType","nodes","nodeSize","edges","style","formatEdgeLabel","options","params","nodeId","nodeData","showNodeDetails","hideNodeDetails","panel","org","commStyle","motivation","listContainer","people"],"mappings":"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"}
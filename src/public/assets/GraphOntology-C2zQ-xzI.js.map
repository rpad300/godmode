{"version":3,"file":"GraphOntology-C2zQ-xzI.js","sources":["../../../node_modules/lucide-react/dist/esm/icons/flask-conical.js","../../../node_modules/lucide-react/dist/esm/icons/git-branch.js","../../../node_modules/lucide-react/dist/esm/icons/power-off.js","../../../node_modules/lucide-react/dist/esm/icons/power.js","../../frontend/src/lib/graph-transformer.ts","../../frontend/src/components/graph/GraphOntology.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.564.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2\",\n      key: \"18mbvz\"\n    }\n  ],\n  [\"path\", { d: \"M6.453 15h11.094\", key: \"3shlmq\" }],\n  [\"path\", { d: \"M8.5 2h7\", key: \"csnxdl\" }]\n];\nconst FlaskConical = createLucideIcon(\"flask-conical\", __iconNode);\n\nexport { __iconNode, FlaskConical as default };\n//# sourceMappingURL=flask-conical.js.map\n","/**\n * @license lucide-react v0.564.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M15 6a9 9 0 0 0-9 9V3\", key: \"1cii5b\" }],\n  [\"circle\", { cx: \"18\", cy: \"6\", r: \"3\", key: \"1h7g24\" }],\n  [\"circle\", { cx: \"6\", cy: \"18\", r: \"3\", key: \"fqmcym\" }]\n];\nconst GitBranch = createLucideIcon(\"git-branch\", __iconNode);\n\nexport { __iconNode, GitBranch as default };\n//# sourceMappingURL=git-branch.js.map\n","/**\n * @license lucide-react v0.564.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M18.36 6.64A9 9 0 0 1 20.77 15\", key: \"dxknvb\" }],\n  [\"path\", { d: \"M6.16 6.16a9 9 0 1 0 12.68 12.68\", key: \"1x7qb5\" }],\n  [\"path\", { d: \"M12 2v4\", key: \"3427ic\" }],\n  [\"path\", { d: \"m2 2 20 20\", key: \"1ooewy\" }]\n];\nconst PowerOff = createLucideIcon(\"power-off\", __iconNode);\n\nexport { __iconNode, PowerOff as default };\n//# sourceMappingURL=power-off.js.map\n","/**\n * @license lucide-react v0.564.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M12 2v10\", key: \"mnfbl\" }],\n  [\"path\", { d: \"M18.4 6.6a9 9 0 1 1-12.77.04\", key: \"obofu9\" }]\n];\nconst Power = createLucideIcon(\"power\", __iconNode);\n\nexport { __iconNode, Power as default };\n//# sourceMappingURL=power.js.map\n","/**\r\n * Purpose:\r\n *   Transforms raw graph data from the database into a styled, de-duplicated,\r\n *   and layout-ready format for the React Flow visualisation. Implements the\r\n *   graph display specification rules for tier assignment, edge styling,\r\n *   Person/Contact merging, and edge bundling.\r\n *\r\n * Responsibilities:\r\n *   - Assign tiers (0 = Project centre, 1 = entities, 2 = details) via TIER_CONFIG\r\n *   - Assign node dimensions and colour tokens via NODE_DIMENSIONS and getNodeColorToken\r\n *   - Merge Person nodes into their linked Contact nodes (by ID, name, or alias)\r\n *     and redirect edges accordingly\r\n *   - Apply edge colour/width/opacity/dash styles from EDGE_STYLES\r\n *   - Hide \"hairball\" edges (WORKS_WITH, BELONGS_TO_PROJECT) via HIDDEN_EDGE_TYPES\r\n *   - Bundle duplicate WORKS_WITH edges between the same pair into one representative\r\n *\r\n * Key dependencies:\r\n *   - @/types/graph: GraphNode, GraphEdge\r\n *\r\n * Side effects:\r\n *   - None (pure function)\r\n *\r\n * Notes:\r\n *   - Person/Contact merging prevents duplicate nodes when both a Person and a\r\n *     Contact record exist for the same individual. Matching cascades:\r\n *     linked_person_id > normalised name > aliases.\r\n *   - BELONGS_TO_PROJECT edges have opacity 0 by default and are also in the\r\n *     hidden set -- double-guarded to keep the graph clean.\r\n *   - Edge labels are set to undefined to avoid visual clutter; the original\r\n *     label is preserved in edge.data.originalLabel for tooltips.\r\n */\r\nimport { GraphNode, GraphEdge } from '@/types/graph';\r\n\r\n// ---------------------------------------------------------------------------\r\n// CONFIGURATION MAPS (Rule 4.1 & 4.2)\r\n// ---------------------------------------------------------------------------\r\n\r\n// Tier Configuration (0 = Center/Project, 1 = Entities, 2 = Details)\r\nexport const TIER_CONFIG: Record<string, number> = {\r\n    'Project': 0,\r\n    'Company': 0,\r\n    // Tier 1\r\n    'Person': 1,\r\n    'Team': 1,\r\n    'Sprint': 1,\r\n    'Document': 1,\r\n    'Email': 1,\r\n    'CalendarEvent': 1,\r\n    'Contact': 1,\r\n    // Tier 2\r\n    'Risk': 2,\r\n    'Action': 2,\r\n    'Fact': 2,\r\n    'Decision': 2,\r\n    'Question': 2,\r\n    'UserStory': 2,\r\n    'Task': 2\r\n};\r\n\r\n// Node Dimensions by Type\r\nexport const NODE_DIMENSIONS: Record<string, { w: number, h: number }> = {\r\n    'Project': { w: 280, h: 120 },\r\n    'Company': { w: 260, h: 100 },\r\n    'Document': { w: 220, h: 90 },\r\n    'Person': { w: 200, h: 80 },\r\n    'Contact': { w: 200, h: 85 },\r\n    'Team': { w: 220, h: 85 },\r\n    'Sprint': { w: 200, h: 65 },\r\n    'Email': { w: 220, h: 80 },\r\n    'CalendarEvent': { w: 210, h: 80 },\r\n    'Fact': { w: 200, h: 80 },\r\n    'Decision': { w: 200, h: 80 },\r\n    'Risk': { w: 210, h: 95 },\r\n    'Action': { w: 220, h: 90 },\r\n    'Question': { w: 200, h: 75 },\r\n    'UserStory': { w: 210, h: 80 },\r\n    'Task': { w: 220, h: 90 },\r\n    // Default fallback\r\n    'default': { w: 200, h: 80 }\r\n};\r\n\r\n// Edge Styles by Type (Rule 4)\r\nconst EDGE_STYLES: Record<string, { stroke: string, width: number, opacity: number, dash?: string }> = {\r\n    // Structural\r\n    'BELONGS_TO_PROJECT': { stroke: '#cbd5e1', width: 1, opacity: 0.0, dash: '5 5' },\r\n    'BELONGS_TO_COMPANY': { stroke: '#0d9488', width: 1.5, opacity: 0.6, dash: '4 4' },\r\n    // Extraction/Workflow\r\n    'EXTRACTED_FROM': { stroke: '#f59e0b', width: 2, opacity: 0.8 }, // amber-500\r\n    'IMPLEMENTS': { stroke: '#3b82f6', width: 2, opacity: 0.9 }, // blue-500\r\n    'DEPENDS_ON': { stroke: '#3b82f6', width: 2, opacity: 0.9 },\r\n    // Attribution\r\n    'ASSIGNED_TO': { stroke: '#10b981', width: 1.5, opacity: 0.7 }, // emerald-500\r\n    'OWNED_BY': { stroke: '#10b981', width: 1.5, opacity: 0.7 },\r\n    'AUTHORED_BY': { stroke: '#10b981', width: 1.5, opacity: 0.7 },\r\n    // People\r\n    'MEMBER_OF_TEAM': { stroke: '#a855f7', width: 1.5, opacity: 0.7 }, // purple-500\r\n    'WORKS_WITH': { stroke: '#4ade80', width: 1, opacity: 0.4 }, // green-400, thinner, transparent\r\n    'IS_CONTACT_OF': { stroke: '#22d3ee', width: 1.5, opacity: 0.6, dash: '4 4' }, // cyan-400\r\n    'WORKS_AT': { stroke: '#0d9488', width: 1.5, opacity: 0.7 }, // teal-600\r\n    // Semantic\r\n    'SIMILAR_TO': { stroke: '#facc15', width: 1, opacity: 0.5, dash: '4 4' }, // yellow-400\r\n    // Hierarchy\r\n    'REPORTS_TO': { stroke: '#22c55e', width: 1.5, opacity: 0.7 }, // green-500\r\n    'MANAGES': { stroke: '#22c55e', width: 1.5, opacity: 0.7 },\r\n    'LEADS_TEAM': { stroke: '#a855f7', width: 2, opacity: 0.8 }, // purple-500\r\n    'PARENT_OF': { stroke: '#3b82f6', width: 1.5, opacity: 0.7 }, // blue-500\r\n    // Planning\r\n    'PLANNED_IN': { stroke: '#6366f1', width: 1.5, opacity: 0.7 }, // indigo-500\r\n    // Communication\r\n    'SENT_BY': { stroke: '#94a3b8', width: 1.5, opacity: 0.7 }, // slate-400\r\n    'SENT_TO': { stroke: '#94a3b8', width: 1.5, opacity: 0.7 },\r\n    'MENTIONS': { stroke: '#f59e0b', width: 1.5, opacity: 0.8 }, // amber-500\r\n    'INVOLVES': { stroke: '#06b6d4', width: 1.5, opacity: 0.8 }, // cyan-500\r\n    'LINKED_TO': { stroke: '#a855f7', width: 1.5, opacity: 0.7 }, // purple-500\r\n    'DERIVED_FROM': { stroke: '#94a3b8', width: 1.5, opacity: 0.7 }, // slate-400\r\n    'REPLY_TO': { stroke: '#94a3b8', width: 1, opacity: 0.5, dash: '3 3' }, // slate-400\r\n    'HAS_ATTACHMENT': { stroke: '#f59e0b', width: 1, opacity: 0.6, dash: '3 3' }, // amber-500\r\n    // Default\r\n    'default': { stroke: '#64748b', width: 1, opacity: 0.5 } // slate-500\r\n};\r\n\r\n// Canonical hex colors for each node type (used by MiniMap, legend, filter badges)\r\nexport const NODE_COLORS: Record<string, string> = {\r\n    'Project': '#6366f1', 'Company': '#0d9488', 'Person': '#22c55e',\r\n    'Contact': '#14b8a6', 'Team': '#a855f7', 'Sprint': '#6366f1',\r\n    'Document': '#f59e0b', 'Email': '#64748b', 'CalendarEvent': '#06b6d4',\r\n    'Risk': '#ef4444', 'Action': '#22c55e', 'Task': '#10b981',\r\n    'Fact': '#0ea5e9', 'Decision': '#f97316', 'Question': '#8b5cf6',\r\n    'UserStory': '#ec4899', 'Meeting': '#06b6d4', 'Technology': '#3b82f6',\r\n    'Answer': '#10b981', 'Briefing': '#6366f1', 'Client': '#1abc9c',\r\n    'Conversation': '#9c27b0', 'Organization': '#8e44ad',\r\n    'Regulation': '#e74c3c',\r\n};\r\n\r\n// ---------------------------------------------------------------------------\r\n// TRANSFORM LOGIC\r\n// ---------------------------------------------------------------------------\r\n\r\n// Edges that should NEVER be rendered to prevent hairball\r\nconst HIDDEN_EDGE_TYPES = new Set([\r\n    'WORKS_WITH',\r\n    'BELONGS_TO_PROJECT',\r\n]);\r\n\r\n/**\r\n * Transforms raw graph nodes and edges into styled, de-duplicated structures\r\n * ready for React Flow rendering. Handles Person/Contact merging, tier\r\n * assignment, edge styling, and edge bundling.\r\n *\r\n * @param rawNodes - unprocessed nodes from the database\r\n * @param rawEdges - unprocessed edges from the database\r\n * @returns {{ nodes: GraphNode[], edges: GraphEdge[] }} styled and filtered graph data\r\n */\r\nexport function transformGraphData(rawNodes: GraphNode[], rawEdges: GraphEdge[]) {\r\n\r\n    // ---------------------------------------------------------------------------\r\n    // -1. PRE-PASS: De-duplicate prefixed IDs (e.g. \"person_UUID\" vs \"UUID\")\r\n    //     Old sync runs may have created nodes with label-prefixed IDs. We keep\r\n    //     the *canonical* plain-UUID node and redirect all edges from the\r\n    //     prefixed duplicate to the canonical one.\r\n    // ---------------------------------------------------------------------------\r\n    const LABEL_PREFIXES = ['person_', 'contact_', 'document_', 'fact_', 'decision_', 'risk_', 'question_', 'team_', 'action_', 'sprint_', 'email_', 'calendarevent_', 'userstory_', 'task_', 'company_'];\r\n\r\n    const nodeIdSet = new Set(rawNodes.map(n => n.id));\r\n    const prefixRedirectMap = new Map<string, string>();\r\n    const prefixedIdsToRemove = new Set<string>();\r\n\r\n    for (const node of rawNodes) {\r\n        const id = node.id;\r\n        for (const prefix of LABEL_PREFIXES) {\r\n            if (id.startsWith(prefix)) {\r\n                const strippedId = id.slice(prefix.length);\r\n                if (nodeIdSet.has(strippedId)) {\r\n                    prefixRedirectMap.set(id, strippedId);\r\n                    prefixedIdsToRemove.add(id);\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    const deduplicatedNodes = rawNodes.filter(n => !prefixedIdsToRemove.has(n.id));\r\n\r\n    // ---------------------------------------------------------------------------\r\n    // 0. Person / Contact merging\r\n    // ---------------------------------------------------------------------------\r\n    const personToContactMap = new Map<string, string>();\r\n    const contactLinkedPersonIds = new Set<string>();\r\n    const nameToContactMap = new Map<string, string>();\r\n    const normalize = (s: string) => s?.trim().toLowerCase() || '';\r\n\r\n    deduplicatedNodes.forEach(node => {\r\n        if (node.label === 'Contact') {\r\n            const contactId = node.id;\r\n            if (node.data.linked_person_id) {\r\n                contactLinkedPersonIds.add(node.data.linked_person_id);\r\n                personToContactMap.set(node.data.linked_person_id, contactId);\r\n            }\r\n            if (node.data.name) nameToContactMap.set(normalize(node.data.name), contactId);\r\n            if (node.data.label) nameToContactMap.set(normalize(node.data.label), contactId);\r\n            if (Array.isArray(node.data.aliases)) {\r\n                node.data.aliases.forEach((alias: string) => {\r\n                    if (alias) nameToContactMap.set(normalize(alias), contactId);\r\n                });\r\n            }\r\n        }\r\n    });\r\n\r\n    // Also merge Person nodes that share the same normalised name (keeps first)\r\n    const seenPersonNames = new Map<string, string>();\r\n\r\n    // 1. Process Nodes\r\n    const nodes: GraphNode[] = [];\r\n    const processedPersonIds = new Set<string>();\r\n\r\n    deduplicatedNodes.forEach(node => {\r\n        if (node.label === 'Person') {\r\n            let shouldMerge = false;\r\n            let targetId = '';\r\n\r\n            if (contactLinkedPersonIds.has(node.id)) {\r\n                shouldMerge = true;\r\n                targetId = personToContactMap.get(node.id)!;\r\n            } else {\r\n                const normalizedLabel = normalize(node.data.label || node.data.name);\r\n                if (nameToContactMap.has(normalizedLabel)) {\r\n                    shouldMerge = true;\r\n                    targetId = nameToContactMap.get(normalizedLabel)!;\r\n                    personToContactMap.set(node.id, targetId);\r\n                } else if (normalizedLabel && seenPersonNames.has(normalizedLabel)) {\r\n                    shouldMerge = true;\r\n                    targetId = seenPersonNames.get(normalizedLabel)!;\r\n                    personToContactMap.set(node.id, targetId);\r\n                }\r\n            }\r\n\r\n            if (shouldMerge) {\r\n                processedPersonIds.add(node.id);\r\n                return;\r\n            }\r\n\r\n            const nn = normalize(node.data.label || node.data.name);\r\n            if (nn) seenPersonNames.set(nn, node.id);\r\n        }\r\n\r\n        const type = node.label || 'default';\r\n        const tier = TIER_CONFIG[type] ?? 2;\r\n        const dims = NODE_DIMENSIONS[type] ?? NODE_DIMENSIONS['default'];\r\n\r\n        nodes.push({\r\n            ...node,\r\n            width: dims.w,\r\n            height: dims.h,\r\n            data: {\r\n                ...node.data,\r\n                tier,\r\n                label: node.data.label || node.label,\r\n                _display: {\r\n                    width: dims.w,\r\n                    height: dims.h,\r\n                    colorToken: getNodeColorToken(type)\r\n                }\r\n            }\r\n        });\r\n    });\r\n\r\n    // Build a set of valid node IDs so we can drop orphan edges\r\n    const validNodeIds = new Set(nodes.map(n => n.id));\r\n\r\n    // Helper: resolve an edge endpoint through all redirect maps\r\n    const resolveId = (id: string): string => {\r\n        if (prefixRedirectMap.has(id)) id = prefixRedirectMap.get(id)!;\r\n        if (personToContactMap.has(id)) id = personToContactMap.get(id)!;\r\n        return id;\r\n    };\r\n\r\n    // 2. Filter & Process Edges\r\n    const processedEdges: GraphEdge[] = [];\r\n\r\n    rawEdges.forEach(edge => {\r\n        if (HIDDEN_EDGE_TYPES.has(edge.label || '')) return;\r\n\r\n        let source = resolveId(edge.source);\r\n        let target = resolveId(edge.target);\r\n\r\n        if (source === target) return;\r\n        if (!validNodeIds.has(source) || !validNodeIds.has(target)) return;\r\n\r\n        const styleConfig = EDGE_STYLES[edge.label || ''] || EDGE_STYLES['default'];\r\n\r\n        processedEdges.push({\r\n            ...edge,\r\n            id: edge.id || `${source}-${target}-${edge.label}`,\r\n            source,\r\n            target,\r\n            type: 'default',\r\n            style: {\r\n                stroke: styleConfig.stroke,\r\n                strokeWidth: styleConfig.width,\r\n                opacity: styleConfig.opacity,\r\n                strokeDasharray: styleConfig.dash\r\n            },\r\n            animated: edge.label === 'SIMILAR_TO' || edge.label === 'DEPENDS_ON' || edge.label === 'INVOLVES',\r\n            data: {\r\n                ...edge.data,\r\n                originalLabel: edge.label\r\n            },\r\n            label: undefined\r\n        });\r\n    });\r\n\r\n    // 4. Compute curvature offsets for parallel edges between the same node pair\r\n    const pairCounts = new Map<string, number>();\r\n    const pairIndex = new Map<string, number>();\r\n    for (const edge of processedEdges) {\r\n        const pairKey = [edge.source, edge.target].sort().join('__');\r\n        pairCounts.set(pairKey, (pairCounts.get(pairKey) || 0) + 1);\r\n    }\r\n    for (const edge of processedEdges) {\r\n        const pairKey = [edge.source, edge.target].sort().join('__');\r\n        const total = pairCounts.get(pairKey) || 1;\r\n        if (total > 1) {\r\n            const idx = pairIndex.get(pairKey) || 0;\r\n            pairIndex.set(pairKey, idx + 1);\r\n            const offset = (idx - (total - 1) / 2) * 0.3;\r\n            edge.data = { ...edge.data, curvature: offset };\r\n        }\r\n    }\r\n\r\n    return { nodes, edges: processedEdges };\r\n}\r\n\r\n/** Maps a node type to a Tailwind colour token name for consistent theming. */\r\nexport function getNodeColorToken(type: string): string {\r\n    switch (type) {\r\n        case 'Project': return 'blue';\r\n        case 'Company': return 'teal';\r\n        case 'Person': return 'green';\r\n        case 'Contact': return 'teal';\r\n        case 'Team': return 'purple';\r\n        case 'Sprint': return 'indigo';\r\n        case 'Document': return 'amber';\r\n        case 'Risk': return 'red';\r\n        case 'Action': return 'emerald';\r\n        case 'Fact': return 'sky';\r\n        case 'Decision': return 'orange';\r\n        case 'Question': return 'violet';\r\n        case 'UserStory': return 'pink';\r\n        case 'Email': return 'slate';\r\n        case 'CalendarEvent': return 'cyan';\r\n        case 'Task': return 'emerald';\r\n        default: return 'slate';\r\n    }\r\n}\r\n","import { useState, useMemo } from 'react';\r\nimport {\r\n  Loader2, Layers, GitBranch, Sparkles, CheckCircle, XCircle,\r\n  Clock, Plus, AlertTriangle, BarChart3, Cpu, Settings, Trash2,\r\n  Wand2, RefreshCw, History, Brain, Search,\r\n  Play, Power, PowerOff, Wrench, Shield, Merge, Download,\r\n  Activity, Zap, Network, Info, FlaskConical, FileText, Eye,\r\n} from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport {\r\n  useOntologySchema, useOntologyStats, useOntologyEntities, useOntologyRelations,\r\n  useOntologySuggestions, useOntologyWorkerStatus, useOntologyCompliance,\r\n  useOntologyApproveSuggestion, useOntologyRejectSuggestion,\r\n  useOntologyAddEntityType, useOntologyAddRelationType,\r\n  useOntologyWorkerTrigger, useOntologyForceSync,\r\n  useOntologyAutoApprove, useOntologyAnalyzeGraph, useOntologyChanges,\r\n  useOntologyDiff, useOntologyCleanup, useOntologyUnused, useOntologyInferRelationships,\r\n  useOntologySyncStatus, useOntologyJobs, useOntologyToggleJob,\r\n  useOntologyExtractFromGraph, useOntologyMerge, useOntologyWorkerLog,\r\n  useOntologyEnrichSuggestion,\r\n  useInferenceRules, useInferenceStats, useRunInferenceRule,\r\n  useEmbeddingsDashboard, useRegenerateEmbeddings,\r\n  useSharedOntology, useToggleEntityShared,\r\n  useOntologyVersions,\r\n  useValidateEntity, useExtractFromText, useEnrichEntity,\r\n} from '../../hooks/useGodMode';\r\nimport { cn } from '../../lib/utils';\r\n\r\ntype Tab = 'entities' | 'relations' | 'graph' | 'suggestions' | 'stats' | 'tools' | 'jobs' | 'changes' | 'inference' | 'embeddings' | 'shared' | 'versions' | 'test';\r\n\r\nimport { NODE_COLORS } from '@/lib/graph-transformer';\r\n\r\nfunction getColor(name: string, fallback?: string): string {\r\n  return NODE_COLORS[name] || fallback || '#64748b';\r\n}\r\n\r\n// ── Sync Status Badge ────────────────────────────────────────────────────────\r\n\r\nfunction SyncBadge({ status }: { status: Record<string, unknown> }) {\r\n  const graphConnected = Boolean(status.graphConnected);\r\n  const isListening = Boolean(status.isListening);\r\n  const isSyncing = Boolean(status.syncInProgress);\r\n  const isConnected = graphConnected || isListening;\r\n  const source = status.ontologySource ? String(status.ontologySource) : '';\r\n  const label = isSyncing ? 'Syncing' : isConnected ? (source === 'supabase' ? 'Synced' : 'Connected') : 'Disconnected';\r\n  return (\r\n    <div className={cn(\r\n      'flex items-center gap-1.5 px-2 py-1 rounded-full text-[10px] font-medium',\r\n      isConnected ? 'bg-gm-status-success-bg text-gm-status-success' :\r\n      isSyncing ? 'bg-gm-status-warning-bg text-gm-status-warning' :\r\n      'bg-gm-surface-secondary text-gm-text-tertiary'\r\n    )}>\r\n      <div className={cn('w-1.5 h-1.5 rounded-full', isConnected ? 'bg-gm-status-success' : isSyncing ? 'bg-gm-status-warning animate-pulse' : 'bg-gm-text-tertiary')} />\r\n      {label}\r\n    </div>\r\n  );\r\n}\r\n\r\n// ── Schema Version Badge ─────────────────────────────────────────────────────\r\n\r\nfunction VersionBadge({ schema }: { schema: Record<string, unknown> }) {\r\n  const version = schema.version || schema.schema_version || '';\r\n  const entityCount = Object.keys((schema.entityTypes || schema.entities || {}) as Record<string, unknown>).length;\r\n  const relCount = Object.keys((schema.relationTypes || schema.relations || {}) as Record<string, unknown>).length;\r\n  return (\r\n    <div className=\"flex items-center gap-2 text-[10px] text-gm-text-tertiary\">\r\n      {version && <span>v{String(version)}</span>}\r\n      <span>{entityCount}E</span>\r\n      <span>{relCount}R</span>\r\n    </div>\r\n  );\r\n}\r\n\r\n// ── Entity Detail Panel ──────────────────────────────────────────────────────\r\n\r\nfunction EntityDetailPanel({ entity, onClose }: { entity: Record<string, unknown>; onClose: () => void }) {\r\n  const name = String(entity.name || entity.type || entity.label || '');\r\n  const desc = String(entity.description || '');\r\n  const color = getColor(name, entity.color ? String(entity.color) : undefined);\r\n  const props = (entity.properties || []) as Array<Record<string, unknown>> | Record<string, unknown>;\r\n  const shared = Boolean(entity.sharedEntity || entity.shared);\r\n  const embeddingTemplate = String(entity.embeddingTemplate || '');\r\n  const count = Number(entity.count || entity.instances || 0);\r\n\r\n  const propsArray = Array.isArray(props)\r\n    ? props\r\n    : Object.entries(props).map(([k, v]) => ({ name: k, ...(typeof v === 'object' && v !== null ? v as Record<string, unknown> : { type: String(v) }) }));\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/40\" onClick={onClose}>\r\n      <div className=\"bg-gm-surface-primary border border-gm-border-primary rounded-2xl shadow-xl w-full max-w-lg max-h-[80vh] overflow-y-auto\" onClick={e => e.stopPropagation()}>\r\n        <div className=\"p-5 border-b border-gm-border-primary\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <div className=\"w-8 h-8 rounded-xl flex items-center justify-center text-white font-bold text-sm\" style={{ backgroundColor: color }}>\r\n              {name.charAt(0)}\r\n            </div>\r\n            <div className=\"flex-1\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <h3 className=\"text-sm font-bold text-gm-text-primary\">{name}</h3>\r\n                {shared && <span className=\"text-[9px] px-1.5 py-0.5 rounded-full bg-blue-600/10 text-gm-interactive-primary font-medium\">Shared</span>}\r\n                {count > 0 && <span className=\"text-[10px] text-gm-text-tertiary\">{count} instances</span>}\r\n              </div>\r\n              {desc && <p className=\"text-[11px] text-gm-text-tertiary mt-0.5\">{desc}</p>}\r\n            </div>\r\n            <button onClick={onClose} className=\"p-1.5 rounded-lg hover:bg-gm-surface-hover transition-colors\">\r\n              <XCircle className=\"w-4 h-4 text-gm-text-tertiary\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {propsArray.length > 0 && (\r\n          <div className=\"p-5 border-b border-gm-border-primary\">\r\n            <h4 className=\"text-[10px] text-gm-text-tertiary uppercase tracking-wider mb-3\">Properties ({propsArray.length})</h4>\r\n            <div className=\"space-y-1.5\">\r\n              {propsArray.map((p, i) => (\r\n                <div key={i} className=\"flex items-center gap-2 text-xs\">\r\n                  <span className=\"font-mono text-gm-text-primary w-32 shrink-0\">{String(p.name || p.key || '')}</span>\r\n                  <span className=\"text-[10px] px-1.5 py-0.5 rounded bg-gm-surface-secondary text-gm-text-tertiary\">{String(p.type || 'string')}</span>\r\n                  {p.required && <span className=\"text-[9px] text-gm-status-danger\">required</span>}\r\n                  {p.searchable && <span className=\"text-[9px] text-gm-interactive-primary\">searchable</span>}\r\n                  {p.description && <span className=\"text-[10px] text-gm-text-tertiary ml-auto truncate max-w-[150px]\">{String(p.description)}</span>}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {embeddingTemplate && (\r\n          <div className=\"p-5\">\r\n            <h4 className=\"text-[10px] text-gm-text-tertiary uppercase tracking-wider mb-2\">Embedding Template</h4>\r\n            <pre className=\"text-[10px] text-gm-text-primary bg-gm-surface-secondary rounded-lg p-3 overflow-x-auto whitespace-pre-wrap\">{embeddingTemplate}</pre>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// ── Inline Graph Visualization (SVG-based, no external deps) ─────────────────\r\n\r\nfunction OntologyGraphView({ entities, relations }: { entities: Array<Record<string, unknown>>; relations: Array<Record<string, unknown>> }) {\r\n  const layout = useMemo(() => {\r\n    const nodeMap: Record<string, { x: number; y: number; color: string }> = {};\r\n    const count = entities.length;\r\n    if (count === 0) return { nodes: nodeMap, width: 600, height: 400 };\r\n\r\n    const cols = Math.ceil(Math.sqrt(count));\r\n    const spacingX = 180;\r\n    const spacingY = 120;\r\n    entities.forEach((e, i) => {\r\n      const name = String(e.name || e.type || e.label || '');\r\n      const row = Math.floor(i / cols);\r\n      const col = i % cols;\r\n      nodeMap[name] = {\r\n        x: 60 + col * spacingX,\r\n        y: 50 + row * spacingY,\r\n        color: getColor(name, e.color ? String(e.color) : undefined),\r\n      };\r\n    });\r\n    const maxCol = Math.min(count, cols);\r\n    const maxRow = Math.ceil(count / cols);\r\n    return { nodes: nodeMap, width: Math.max(600, 60 + maxCol * spacingX + 60), height: Math.max(400, 50 + maxRow * spacingY + 60) };\r\n  }, [entities]);\r\n\r\n  const edges = useMemo(() => {\r\n    return relations.map(r => {\r\n      const from = String(r.from || r.source || r.from_type || '');\r\n      const to = String(r.to || r.target || r.to_type || '');\r\n      const name = String(r.name || r.type || r.label || '');\r\n      if (!layout.nodes[from] || !layout.nodes[to] || from === '*' || to === '*') return null;\r\n      return { from, to, name };\r\n    }).filter(Boolean) as Array<{ from: string; to: string; name: string }>;\r\n  }, [relations, layout]);\r\n\r\n  if (entities.length === 0) {\r\n    return (\r\n      <div className=\"flex items-center justify-center py-16\">\r\n        <div className=\"text-center\">\r\n          <Network className=\"w-10 h-10 mx-auto mb-3 text-gray-600\" />\r\n          <p className=\"text-xs text-gm-text-tertiary\">No entities to visualize</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"w-full overflow-auto bg-gm-surface-secondary rounded-xl border border-gm-border-primary\">\r\n      <svg viewBox={`0 0 ${layout.width} ${layout.height}`} className=\"w-full\" style={{ minHeight: 400 }}>\r\n        <defs>\r\n          <marker id=\"arrowhead\" markerWidth=\"8\" markerHeight=\"6\" refX=\"8\" refY=\"3\" orient=\"auto\">\r\n            <polygon points=\"0 0, 8 3, 0 6\" fill=\"#94a3b8\" />\r\n          </marker>\r\n        </defs>\r\n        {edges.map((edge, i) => {\r\n          const s = layout.nodes[edge.from];\r\n          const t = layout.nodes[edge.to];\r\n          if (!s || !t) return null;\r\n          const dx = t.x - s.x;\r\n          const dy = t.y - s.y;\r\n          const midX = s.x + dx / 2;\r\n          const midY = s.y + dy / 2;\r\n          const curveOffset = edge.from === edge.to ? 40 : 0;\r\n          return (\r\n            <g key={i}>\r\n              {edge.from === edge.to ? (\r\n                <path d={`M ${s.x + 30} ${s.y - 15} C ${s.x + 80} ${s.y - 60}, ${s.x - 20} ${s.y - 60}, ${s.x - 30} ${s.y - 15}`}\r\n                  fill=\"none\" stroke=\"#94a3b8\" strokeWidth=\"1.2\" markerEnd=\"url(#arrowhead)\" strokeDasharray=\"4 2\" />\r\n              ) : (\r\n                <line x1={s.x} y1={s.y} x2={t.x} y2={t.y} stroke=\"#94a3b8\" strokeWidth=\"1.2\" markerEnd=\"url(#arrowhead)\" strokeDasharray=\"4 2\" />\r\n              )}\r\n              <rect x={midX - 30 + curveOffset} y={midY - 8 - (curveOffset ? 40 : 0)} width=\"60\" height=\"14\" rx=\"4\" fill=\"var(--gm-surface-primary)\" fillOpacity=\"0.85\" />\r\n              <text x={midX + curveOffset} y={midY - (curveOffset ? 40 : 0)} textAnchor=\"middle\" fontSize=\"7\" fill=\"#94a3b8\" fontWeight=\"600\">\r\n                {edge.name.length > 12 ? edge.name.slice(0, 12) + '…' : edge.name}\r\n              </text>\r\n            </g>\r\n          );\r\n        })}\r\n        {Object.entries(layout.nodes).map(([name, node]) => (\r\n          <g key={name}>\r\n            <rect x={node.x - 45} y={node.y - 18} width=\"90\" height=\"36\" rx=\"10\" fill={node.color + '18'} stroke={node.color + '40'} strokeWidth=\"1.5\" />\r\n            <circle cx={node.x - 30} cy={node.y} r=\"5\" fill={node.color} />\r\n            <text x={node.x + 2} y={node.y + 4} textAnchor=\"middle\" fontSize=\"9\" fill=\"currentColor\" fontWeight=\"600\">\r\n              {name.length > 10 ? name.slice(0, 10) + '…' : name}\r\n            </text>\r\n          </g>\r\n        ))}\r\n      </svg>\r\n    </div>\r\n  );\r\n}\r\n\r\n// ── Relation Builder Dialog ──────────────────────────────────────────────────\r\n\r\nfunction RelationBuilderInline({\r\n  entityNames,\r\n  onSave,\r\n  onCancel,\r\n  isPending,\r\n}: {\r\n  entityNames: string[];\r\n  onSave: (data: { name: string; from: string; to: string; description: string }) => void;\r\n  onCancel: () => void;\r\n  isPending: boolean;\r\n}) {\r\n  const [source, setSource] = useState('');\r\n  const [target, setTarget] = useState('');\r\n  const [relName, setRelName] = useState('');\r\n  const [desc, setDesc] = useState('');\r\n\r\n  const formatted = relName.toUpperCase().replace(/\\s+/g, '_');\r\n\r\n  const handleSave = () => {\r\n    if (!source || !target || !relName.trim()) {\r\n      toast.error('Source, target, and name are required');\r\n      return;\r\n    }\r\n    onSave({ name: formatted, from: source, to: target, description: desc });\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border-2 border-gm-interactive-primary/20 space-y-3\">\r\n      {/* Preview */}\r\n      <div className=\"flex items-center justify-center gap-3 py-2\">\r\n        <div className={cn('px-3 py-1.5 rounded-lg text-xs font-bold transition-colors',\r\n          source ? 'text-white' : 'bg-gm-surface-secondary text-gm-text-tertiary')}\r\n          style={source ? { backgroundColor: getColor(source) } : {}}>\r\n          {source || '?'}\r\n        </div>\r\n        <div className=\"flex flex-col items-center\">\r\n          <span className=\"text-[9px] font-mono text-gm-text-tertiary\">{formatted || 'RELATION'}</span>\r\n          <span className=\"text-gm-text-tertiary\">→</span>\r\n        </div>\r\n        <div className={cn('px-3 py-1.5 rounded-lg text-xs font-bold transition-colors',\r\n          target ? 'text-white' : 'bg-gm-surface-secondary text-gm-text-tertiary')}\r\n          style={target ? { backgroundColor: getColor(target) } : {}}>\r\n          {target || '?'}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-2 gap-2\">\r\n        <select value={source} onChange={e => setSource(e.target.value)}\r\n          className=\"bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-2 py-1.5 text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus\">\r\n          <option value=\"\">Source entity...</option>\r\n          {entityNames.map(e => <option key={e} value={e}>{e}</option>)}\r\n        </select>\r\n        <select value={target} onChange={e => setTarget(e.target.value)}\r\n          className=\"bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-2 py-1.5 text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus\">\r\n          <option value=\"\">Target entity...</option>\r\n          {entityNames.map(e => <option key={e} value={e}>{e}</option>)}\r\n        </select>\r\n      </div>\r\n\r\n      <input value={relName} onChange={e => setRelName(e.target.value)} placeholder=\"Relation name (e.g. WORKS_ON, BELONGS_TO)\"\r\n        className=\"w-full bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-1.5 text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus\"\r\n        onKeyDown={e => e.key === 'Enter' && handleSave()} />\r\n\r\n      <input value={desc} onChange={e => setDesc(e.target.value)} placeholder=\"Description (optional)\"\r\n        className=\"w-full bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-1.5 text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus\" />\r\n\r\n      <div className=\"flex gap-2 justify-end\">\r\n        <button onClick={onCancel} className=\"px-3 py-1.5 rounded-lg text-xs text-gm-text-tertiary hover:bg-gm-surface-secondary transition-colors\">Cancel</button>\r\n        <button onClick={handleSave} disabled={isPending || !source || !target || !relName.trim()}\r\n          className=\"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover disabled:opacity-50 flex items-center gap-1 transition-colors\">\r\n          {isPending ? <Loader2 className=\"w-3 h-3 animate-spin\" /> : <Plus className=\"w-3 h-3\" />} Create\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// ── Main Component ───────────────────────────────────────────────────────────\r\n\r\nexport default function GraphOntology() {\r\n  const [tab, setTab] = useState<Tab>('entities');\r\n  const [search, setSearch] = useState('');\r\n  const [newEntityName, setNewEntityName] = useState('');\r\n  const [showRelBuilder, setShowRelBuilder] = useState(false);\r\n  const [selectedEntity, setSelectedEntity] = useState<Record<string, unknown> | null>(null);\r\n\r\n  // Queries\r\n  const schema = useOntologySchema();\r\n  const stats = useOntologyStats();\r\n  const entitiesQ = useOntologyEntities();\r\n  const relationsQ = useOntologyRelations();\r\n  const suggestionsQ = useOntologySuggestions();\r\n  const workerQ = useOntologyWorkerStatus();\r\n  const complianceQ = useOntologyCompliance();\r\n  const changesQ = useOntologyChanges();\r\n  const diffQ = useOntologyDiff();\r\n  const unusedQ = useOntologyUnused();\r\n  const syncStatusQ = useOntologySyncStatus();\r\n  const jobsQ = useOntologyJobs();\r\n  const workerLogQ = useOntologyWorkerLog();\r\n  const inferenceRulesQ = useInferenceRules();\r\n  const inferenceStatsQ = useInferenceStats();\r\n  const embeddingsDashQ = useEmbeddingsDashboard();\r\n  const sharedQ = useSharedOntology();\r\n  const versionsQ = useOntologyVersions();\r\n\r\n  // Mutations\r\n  const approve = useOntologyApproveSuggestion();\r\n  const reject = useOntologyRejectSuggestion();\r\n  const enrichSuggestion = useOntologyEnrichSuggestion();\r\n  const addEntity = useOntologyAddEntityType();\r\n  const addRelation = useOntologyAddRelationType();\r\n  const triggerWorker = useOntologyWorkerTrigger();\r\n  const forceSync = useOntologyForceSync();\r\n  const autoApprove = useOntologyAutoApprove();\r\n  const analyzeGraph = useOntologyAnalyzeGraph();\r\n  const cleanup = useOntologyCleanup();\r\n  const inferRels = useOntologyInferRelationships();\r\n  const toggleJob = useOntologyToggleJob();\r\n  const extractFromGraph = useOntologyExtractFromGraph();\r\n  const mergeOntology = useOntologyMerge();\r\n  const runInference = useRunInferenceRule();\r\n  const regenEmbeddings = useRegenerateEmbeddings();\r\n  const toggleShared = useToggleEntityShared();\r\n  const validateEntity = useValidateEntity();\r\n  const extractFromText = useExtractFromText();\r\n  const enrichEntity = useEnrichEntity();\r\n\r\n  // Test tab state\r\n  const [validateType, setValidateType] = useState('');\r\n  const [validateJson, setValidateJson] = useState('{\\n  \"name\": \"example\"\\n}');\r\n  const [extractText, setExtractText] = useState('');\r\n  const [enrichType, setEnrichType] = useState('');\r\n  const [enrichJson, setEnrichJson] = useState('{\\n  \"name\": \"example\"\\n}');\r\n\r\n  // Data extraction\r\n  const entities = ((entitiesQ.data as Record<string, unknown>)?.entityTypes || (entitiesQ.data as Record<string, unknown>)?.entities || (entitiesQ.data as Record<string, unknown>)?.types || []) as Array<Record<string, unknown>>;\r\n  const relations = ((relationsQ.data as Record<string, unknown>)?.relationTypes || (relationsQ.data as Record<string, unknown>)?.relations || (relationsQ.data as Record<string, unknown>)?.types || []) as Array<Record<string, unknown>>;\r\n  const suggestions = ((suggestionsQ.data as Record<string, unknown>)?.suggestions || []) as Array<Record<string, unknown>>;\r\n  const statsData = (stats.data || {}) as Record<string, unknown>;\r\n  const worker = (workerQ.data || {}) as Record<string, unknown>;\r\n  const compliance = ((complianceQ.data as Record<string, unknown>)?.compliance || complianceQ.data || {}) as Record<string, unknown>;\r\n  const complianceIssues = (compliance.issues || compliance.violations || []) as Array<Record<string, unknown>>;\r\n  const complianceScore = Number(compliance.score || compliance.compliance_score || 0);\r\n  const changes = ((changesQ.data as Record<string, unknown>)?.changes || changesQ.data || []) as Array<Record<string, unknown>>;\r\n  const diff = (diffQ.data || {}) as Record<string, unknown>;\r\n  const unused = ((unusedQ.data as Record<string, unknown>)?.unused || unusedQ.data || {}) as Record<string, unknown>;\r\n  const unusedEntities = (unused.entities || []) as string[];\r\n  const unusedRelations = (unused.relations || []) as string[];\r\n  const syncStatusData = ((syncStatusQ.data as Record<string, unknown>)?.status || syncStatusQ.data || {}) as Record<string, unknown>;\r\n  const jobs = ((jobsQ.data as Record<string, unknown>)?.jobs || []) as Array<Record<string, unknown>>;\r\n  const workerLog = ((workerLogQ.data as Record<string, unknown>)?.log || []) as Array<Record<string, unknown>>;\r\n  const schemaData = (schema.data || {}) as Record<string, unknown>;\r\n  const inferenceRules = ((inferenceRulesQ.data as Record<string, unknown>)?.rules || []) as Array<Record<string, unknown>>;\r\n  const inferenceCyphers = ((inferenceRulesQ.data as Record<string, unknown>)?.cyphers || []) as Array<Record<string, unknown>>;\r\n  const inferenceStatsData = ((inferenceStatsQ.data as Record<string, unknown>)?.stats || {}) as Record<string, unknown>;\r\n  const availableInferenceRules = ((inferenceStatsQ.data as Record<string, unknown>)?.availableRules || []) as Array<Record<string, unknown>>;\r\n  const embeddingSummary = ((embeddingsDashQ.data as Record<string, unknown>)?.summary || {}) as Record<string, unknown>;\r\n  const embeddingCoverage = ((embeddingsDashQ.data as Record<string, unknown>)?.coverageByType || {}) as Record<string, Record<string, unknown>>;\r\n  const sharedEntities = ((sharedQ.data as Record<string, unknown>)?.sharedEntities || []) as Array<Record<string, unknown>>;\r\n  const crossGraphRelations = ((sharedQ.data as Record<string, unknown>)?.crossGraphRelations || []) as Array<Record<string, unknown>>;\r\n  const versionsData = (versionsQ.data || {}) as Record<string, unknown>;\r\n  const versionHistory = ((versionsData as Record<string, unknown>)?.history || []) as Array<Record<string, unknown>>;\r\n\r\n  // Filtered lists\r\n  const searchLower = search.toLowerCase();\r\n  const filteredEntities = useMemo(() =>\r\n    search ? entities.filter(e => {\r\n      const name = String(e.name || e.type || e.label || '').toLowerCase();\r\n      const desc = String(e.description || '').toLowerCase();\r\n      return name.includes(searchLower) || desc.includes(searchLower);\r\n    }) : entities\r\n  , [entities, searchLower]);\r\n\r\n  const filteredRelations = useMemo(() =>\r\n    search ? relations.filter(r => {\r\n      const name = String(r.name || r.type || r.label || '').toLowerCase();\r\n      const from = String(r.from || r.source || '').toLowerCase();\r\n      const to = String(r.to || r.target || '').toLowerCase();\r\n      return name.includes(searchLower) || from.includes(searchLower) || to.includes(searchLower);\r\n    }) : relations\r\n  , [relations, searchLower]);\r\n\r\n  const entityNames = useMemo(() => entities.map(e => String(e.name || e.type || e.label || '')), [entities]);\r\n\r\n  const pendingSuggestions = suggestions.filter(s => String(s.status) !== 'approved' && String(s.status) !== 'rejected');\r\n\r\n  // Handlers\r\n  const handleAddEntity = () => {\r\n    if (!newEntityName.trim()) return;\r\n    addEntity.mutate({ name: newEntityName.trim() }, {\r\n      onSuccess: () => { toast.success('Entity type added'); setNewEntityName(''); },\r\n      onError: () => toast.error('Failed to add entity type'),\r\n    });\r\n  };\r\n\r\n  const handleAddRelation = (data: { name: string; from: string; to: string; description: string }) => {\r\n    addRelation.mutate(data, {\r\n      onSuccess: () => { toast.success('Relation type added'); setShowRelBuilder(false); },\r\n      onError: () => toast.error('Failed to add relation type'),\r\n    });\r\n  };\r\n\r\n  // Tabs definition\r\n  const tabs: { key: Tab; label: string; icon: typeof Layers; count?: number }[] = [\r\n    { key: 'entities', label: 'Entities', icon: Cpu, count: entities.length },\r\n    { key: 'relations', label: 'Relations', icon: GitBranch, count: relations.length },\r\n    { key: 'graph', label: 'Graph', icon: Network },\r\n    { key: 'suggestions', label: 'AI', icon: Sparkles, count: pendingSuggestions.length },\r\n    { key: 'stats', label: 'Stats', icon: BarChart3 },\r\n    { key: 'tools', label: 'Tools', icon: Wrench },\r\n    { key: 'inference', label: 'Rules', icon: Zap },\r\n    { key: 'embeddings', label: 'Embed', icon: Brain },\r\n    { key: 'shared', label: 'Shared', icon: Layers },\r\n    { key: 'jobs', label: 'Jobs', icon: Settings },\r\n    { key: 'versions', label: 'Versions', icon: History },\r\n    { key: 'changes', label: 'Log', icon: Activity },\r\n    { key: 'test', label: 'Test', icon: FlaskConical },\r\n  ];\r\n\r\n  return (\r\n    <div className=\"h-full flex flex-col\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center gap-2 px-4 py-2 border-b border-gm-border-primary bg-gm-surface-secondary shrink-0\">\r\n        <Layers className=\"w-4 h-4 text-gm-interactive-primary\" />\r\n        <span className=\"text-xs font-semibold text-gm-text-primary\">Ontology</span>\r\n        <VersionBadge schema={schemaData} />\r\n        <div className=\"ml-auto flex items-center gap-2\">\r\n          {Object.keys(syncStatusData).length > 0 && <SyncBadge status={syncStatusData} />}\r\n          <button onClick={() => forceSync.mutate(undefined, { onSuccess: () => toast.success('Sync triggered') })} disabled={forceSync.isPending}\r\n            className=\"p-1 rounded-md hover:bg-gm-surface-hover transition-colors\" title=\"Force sync\">\r\n            {forceSync.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin text-gm-text-tertiary\" /> : <RefreshCw className=\"w-3.5 h-3.5 text-gm-text-tertiary\" />}\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Tabs */}\r\n      <div className=\"flex gap-0.5 px-4 border-b border-gm-border-primary bg-gm-surface-secondary shrink-0\">\r\n        {tabs.map(t => {\r\n          const Icon = t.icon;\r\n          return (\r\n            <button key={t.key} onClick={() => setTab(t.key)}\r\n              className={cn('flex items-center gap-1 px-2.5 py-2 text-[10px] font-medium border-b-2 transition-colors',\r\n                tab === t.key ? 'border-gm-interactive-primary text-gm-interactive-primary' : 'border-transparent text-gm-text-tertiary hover:text-gm-text-primary')}>\r\n              <Icon className=\"w-3 h-3\" /> {t.label}\r\n              {t.count !== undefined && t.count > 0 && (\r\n                <span className=\"text-[9px] px-1 py-0.5 rounded-full bg-gm-surface-secondary text-gm-text-tertiary\">{t.count}</span>\r\n              )}\r\n            </button>\r\n          );\r\n        })}\r\n      </div>\r\n\r\n      {/* Search (for entities/relations tabs) */}\r\n      {(tab === 'entities' || tab === 'relations') && (\r\n        <div className=\"px-4 pt-3 shrink-0\">\r\n          <div className=\"relative\">\r\n            <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gm-text-tertiary\" />\r\n            <input value={search} onChange={e => setSearch(e.target.value)}\r\n              placeholder={`Search ${tab}...`}\r\n              className=\"w-full pl-8 pr-3 py-1.5 bg-gm-surface-secondary border border-gm-border-primary rounded-lg text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus\" />\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Content */}\r\n      <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\r\n\r\n        {/* ── Entities Tab ─────────────────────────────────────────────── */}\r\n        {tab === 'entities' && (\r\n          <>\r\n            <div className=\"flex gap-2 items-center\">\r\n              <input value={newEntityName} onChange={e => setNewEntityName(e.target.value)} placeholder=\"New entity type...\"\r\n                className=\"flex-1 bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-1.5 text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus\"\r\n                onKeyDown={e => e.key === 'Enter' && handleAddEntity()} />\r\n              <button onClick={handleAddEntity} disabled={addEntity.isPending || !newEntityName.trim()}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover disabled:opacity-50 flex items-center gap-1 transition-colors\">\r\n                <Plus className=\"w-3 h-3\" /> Add\r\n              </button>\r\n            </div>\r\n            {entitiesQ.isLoading ? <Loader2 className=\"w-5 h-5 animate-spin text-gm-interactive-primary mx-auto\" /> : (\r\n              <div className=\"grid grid-cols-3 gap-2\">\r\n                {filteredEntities.map((e, i) => {\r\n                  const name = String(e.name || e.type || e.label || '');\r\n                  const count = Number(e.count || e.instances || 0);\r\n                  const props = (e.properties || []) as Array<Record<string, unknown>> | Record<string, unknown>;\r\n                  const propsArr = Array.isArray(props) ? props : Object.entries(props).map(([k]) => ({ name: k }));\r\n                  const color = getColor(name, e.color ? String(e.color) : undefined);\r\n                  const desc = String(e.description || '');\r\n                  const shared = Boolean(e.sharedEntity || e.shared);\r\n                  return (\r\n                    <div key={i} onClick={() => setSelectedEntity(e)}\r\n                      className=\"bg-[var(--gm-surface-hover)] rounded-xl p-3 border border-gm-border-primary hover:border-blue-600/30 transition-colors cursor-pointer group\">\r\n                      <div className=\"flex items-center gap-2 mb-1.5\">\r\n                        <div className=\"w-6 h-6 rounded-lg flex items-center justify-center text-white text-[9px] font-bold shrink-0\" style={{ backgroundColor: color }}>\r\n                          {name.charAt(0)}\r\n                        </div>\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <div className=\"flex items-center gap-1.5\">\r\n                            <span className=\"text-xs font-semibold text-gm-text-primary truncate\">{name}</span>\r\n                            {shared && <span className=\"text-[8px] px-1 py-0.5 rounded bg-blue-600/10 text-gm-interactive-primary\">S</span>}\r\n                          </div>\r\n                        </div>\r\n                        {count > 0 && <span className=\"text-[10px] text-gm-text-tertiary shrink-0\">{count}</span>}\r\n                      </div>\r\n                      {desc && <p className=\"text-[9px] text-gm-text-tertiary mb-1.5 line-clamp-1\">{desc}</p>}\r\n                      {propsArr.length > 0 && (\r\n                        <div className=\"flex flex-wrap gap-1\">\r\n                          {propsArr.slice(0, 4).map((p, j) => (\r\n                            <span key={j} className=\"text-[8px] px-1 py-0.5 rounded bg-gm-surface-secondary text-gm-text-tertiary\">{String((p as Record<string, unknown>).name || p)}</span>\r\n                          ))}\r\n                          {propsArr.length > 4 && <span className=\"text-[8px] text-gm-text-tertiary\">+{propsArr.length - 4}</span>}\r\n                        </div>\r\n                      )}\r\n                      <Eye className=\"w-3 h-3 text-gm-text-tertiary opacity-0 group-hover:opacity-100 transition-opacity absolute top-2 right-2\" />\r\n                    </div>\r\n                  );\r\n                })}\r\n              </div>\r\n            )}\r\n          </>\r\n        )}\r\n\r\n        {/* ── Relations Tab ────────────────────────────────────────────── */}\r\n        {tab === 'relations' && (\r\n          <>\r\n            {showRelBuilder ? (\r\n              <RelationBuilderInline\r\n                entityNames={entityNames}\r\n                onSave={handleAddRelation}\r\n                onCancel={() => setShowRelBuilder(false)}\r\n                isPending={addRelation.isPending}\r\n              />\r\n            ) : (\r\n              <button onClick={() => setShowRelBuilder(true)}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover flex items-center gap-1 transition-colors\">\r\n                <Plus className=\"w-3 h-3\" /> New Relation\r\n              </button>\r\n            )}\r\n            {relationsQ.isLoading ? <Loader2 className=\"w-5 h-5 animate-spin text-gm-interactive-primary mx-auto\" /> : (\r\n              <div className=\"space-y-1.5\">\r\n                {filteredRelations.map((r, i) => {\r\n                  const name = String(r.name || r.type || r.label || '');\r\n                  const count = Number(r.count || r.instances || 0);\r\n                  const from = String(r.from || r.source || r.from_type || '');\r\n                  const to = String(r.to || r.target || r.to_type || '');\r\n                  const desc = String(r.description || '');\r\n                  return (\r\n                    <div key={i} className=\"flex items-center gap-2 bg-[var(--gm-surface-hover)] rounded-lg p-2.5 group\">\r\n                      {from && <span className=\"text-[10px] px-1.5 py-0.5 rounded font-medium\" style={{ backgroundColor: `${getColor(from)}20`, color: getColor(from) }}>{from}</span>}\r\n                      <span className=\"text-xs font-medium text-gm-interactive-primary\">→ {name.replace(/_/g, ' ')} →</span>\r\n                      {to && <span className=\"text-[10px] px-1.5 py-0.5 rounded font-medium\" style={{ backgroundColor: `${getColor(to)}20`, color: getColor(to) }}>{to}</span>}\r\n                      {desc && <span className=\"text-[9px] text-gm-text-tertiary truncate max-w-[150px] hidden group-hover:block\">{desc}</span>}\r\n                      {count > 0 && <span className=\"text-[10px] text-gm-text-tertiary ml-auto\">{count}</span>}\r\n                    </div>\r\n                  );\r\n                })}\r\n              </div>\r\n            )}\r\n          </>\r\n        )}\r\n\r\n        {/* ── Graph Tab ────────────────────────────────────────────────── */}\r\n        {tab === 'graph' && (\r\n          <OntologyGraphView entities={entities} relations={relations} />\r\n        )}\r\n\r\n        {/* ── AI Suggestions Tab ──────────────────────────────────────── */}\r\n        {tab === 'suggestions' && (\r\n          <>\r\n            <div className=\"flex flex-wrap gap-2 items-center\">\r\n              <button onClick={() => analyzeGraph.mutate(undefined, { onSuccess: () => toast.success('Graph analysis started') })}\r\n                disabled={analyzeGraph.isPending}\r\n                className=\"px-3 py-1.5 rounded-lg bg-blue-600/10 text-gm-interactive-primary text-xs font-medium hover:bg-blue-600/20 disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                {analyzeGraph.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Brain className=\"w-3.5 h-3.5\" />} Analyze Graph\r\n              </button>\r\n              <button onClick={() => autoApprove.mutate({ minConfidence: 0.8 }, { onSuccess: () => toast.success('High-confidence suggestions auto-approved') })}\r\n                disabled={autoApprove.isPending || pendingSuggestions.length === 0}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-status-success-bg text-gm-status-success text-xs font-medium hover:bg-green-500/20 disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                {autoApprove.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Wand2 className=\"w-3.5 h-3.5\" />} Auto-Approve (≥80%)\r\n              </button>\r\n              <button onClick={() => inferRels.mutate(undefined, { onSuccess: () => toast.success('Relationship inference started') })}\r\n                disabled={inferRels.isPending}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                {inferRels.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <GitBranch className=\"w-3.5 h-3.5\" />} Infer Relations\r\n              </button>\r\n            </div>\r\n\r\n            {suggestionsQ.isLoading ? <Loader2 className=\"w-5 h-5 animate-spin text-gm-interactive-primary mx-auto\" /> : suggestions.length === 0 ? (\r\n              <div className=\"text-center py-8\">\r\n                <Sparkles className=\"w-10 h-10 mx-auto mb-3 text-gray-600\" />\r\n                <p className=\"text-xs text-gm-text-tertiary\">No AI suggestions pending</p>\r\n                <p className=\"text-[10px] text-gm-text-tertiary mt-1\">Run \"Analyze Graph\" to generate suggestions</p>\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-2\">\r\n                {suggestions.map((s, i) => {\r\n                  const sType = String(s.type || s.suggestion_type || '');\r\n                  const name = String(s.name || s.suggested_name || s.content || '');\r\n                  const reason = String(s.reason || s.explanation || s.description || '');\r\n                  const confidence = Number(s.confidence || 0);\r\n                  const status = String(s.status || 'pending');\r\n                  const enrichment = s.enrichment as Record<string, unknown> | undefined;\r\n                  const isPending = status === 'pending';\r\n                  return (\r\n                    <div key={i} className={cn('bg-[var(--gm-surface-hover)] rounded-xl p-3 border transition-colors',\r\n                      isPending ? 'border-gm-border-primary' : status === 'approved' ? 'border-green-500/20 opacity-60' : 'border-red-500/20 opacity-60')}>\r\n                      <div className=\"flex items-start gap-2\">\r\n                        <Sparkles className=\"w-4 h-4 text-gm-interactive-primary shrink-0 mt-0.5\" />\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <div className=\"flex items-center gap-2 flex-wrap\">\r\n                            <span className=\"text-xs font-semibold text-gm-text-primary\">{name}</span>\r\n                            <span className=\"text-[10px] px-1.5 py-0.5 rounded bg-blue-600/10 text-gm-interactive-primary capitalize\">{sType.replace(/_/g, ' ')}</span>\r\n                            {confidence > 0 && (\r\n                              <span className={cn('text-[10px] font-medium',\r\n                                confidence >= 0.8 ? 'text-gm-status-success' : confidence >= 0.5 ? 'text-gm-status-warning' : 'text-gm-text-tertiary')}>\r\n                                {Math.round(confidence * 100)}%\r\n                              </span>\r\n                            )}\r\n                            {!isPending && <span className={cn('text-[9px] px-1 py-0.5 rounded', status === 'approved' ? 'bg-gm-status-success-bg text-gm-status-success' : 'bg-gm-status-danger-bg text-gm-status-danger')}>{status}</span>}\r\n                          </div>\r\n                          {reason && <p className=\"text-[10px] text-gm-text-tertiary mt-1\">{reason}</p>}\r\n                          {enrichment && (\r\n                            <div className=\"mt-2 p-2 bg-gm-surface-secondary rounded-lg space-y-1\">\r\n                              {enrichment.description && <p className=\"text-[10px] text-gm-text-primary\">{String(enrichment.description)}</p>}\r\n                              {Array.isArray(enrichment.useCases) && enrichment.useCases.length > 0 && (\r\n                                <div className=\"flex flex-wrap gap-1\">\r\n                                  {(enrichment.useCases as string[]).map((uc, j) => (\r\n                                    <span key={j} className=\"text-[9px] px-1 py-0.5 rounded bg-gm-surface-hover text-gm-text-tertiary\">{uc}</span>\r\n                                  ))}\r\n                                </div>\r\n                              )}\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                        {isPending && (\r\n                          <div className=\"flex gap-1 shrink-0\">\r\n                            <button onClick={() => enrichSuggestion.mutate(String(s.id), { onSuccess: () => toast.success('Enriched') })} disabled={enrichSuggestion.isPending}\r\n                              className=\"p-1.5 rounded-lg bg-blue-600/10 text-gm-interactive-primary hover:bg-blue-600/20 transition-colors\" title=\"AI Enrich\">\r\n                              <Brain className=\"w-3.5 h-3.5\" />\r\n                            </button>\r\n                            <button onClick={() => approve.mutate({ id: String(s.id) }, { onSuccess: () => toast.success('Approved') })} disabled={approve.isPending}\r\n                              className=\"p-1.5 rounded-lg bg-gm-status-success-bg text-gm-status-success hover:bg-green-500/20 transition-colors\">\r\n                              <CheckCircle className=\"w-3.5 h-3.5\" />\r\n                            </button>\r\n                            <button onClick={() => reject.mutate({ id: String(s.id) }, { onSuccess: () => toast.success('Rejected') })} disabled={reject.isPending}\r\n                              className=\"p-1.5 rounded-lg bg-gm-status-danger-bg text-gm-status-danger hover:bg-red-500/20 transition-colors\">\r\n                              <XCircle className=\"w-3.5 h-3.5\" />\r\n                            </button>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  );\r\n                })}\r\n              </div>\r\n            )}\r\n          </>\r\n        )}\r\n\r\n        {/* ── Stats Tab ────────────────────────────────────────────────── */}\r\n        {tab === 'stats' && (\r\n          <div className=\"space-y-4\">\r\n            {stats.isLoading ? <Loader2 className=\"w-5 h-5 animate-spin text-gm-interactive-primary mx-auto\" /> : (\r\n              <>\r\n                <div className=\"grid grid-cols-3 gap-3\">\r\n                  {Object.entries(statsData).filter(([, v]) => typeof v === 'number').slice(0, 9).map(([key, val]) => (\r\n                    <div key={key} className=\"bg-gm-surface-secondary rounded-xl p-3 border border-gm-border-primary\">\r\n                      <p className=\"text-lg font-bold text-gm-text-primary\">{String(val)}</p>\r\n                      <p className=\"text-[10px] text-gm-text-tertiary capitalize\">{key.replace(/_/g, ' ')}</p>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n\r\n                {/* Usage Bar Charts */}\r\n                {entities.length > 0 && (\r\n                  <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n                    <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\">\r\n                      <BarChart3 className=\"w-3.5 h-3.5\" /> Entity Types by Instance Count\r\n                    </h4>\r\n                    <div className=\"space-y-1.5\">\r\n                      {entities.slice(0, 10).map((e) => {\r\n                        const name = String(e.name || e.type || e.label || '?');\r\n                        const count = Number(e.count || e.instances || e.nodeCount || 0);\r\n                        const maxCount = Math.max(...entities.slice(0, 10).map(x => Number(x.count || x.instances || x.nodeCount || 0)), 1);\r\n                        return (\r\n                          <div key={name} className=\"flex items-center gap-2\">\r\n                            <span className=\"text-[10px] text-gm-text-tertiary w-24 truncate text-right\">{name}</span>\r\n                            <div className=\"flex-1 h-4 bg-gm-surface-secondary rounded overflow-hidden\">\r\n                              <div className=\"h-full rounded transition-all\" style={{\r\n                                width: `${Math.max((count / maxCount) * 100, 2)}%`,\r\n                                backgroundColor: getColor(name, '#6366f1'),\r\n                              }} />\r\n                            </div>\r\n                            <span className=\"text-[10px] font-mono text-gm-text-tertiary w-8 text-right\">{count}</span>\r\n                          </div>\r\n                        );\r\n                      })}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {relations.length > 0 && (\r\n                  <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n                    <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\">\r\n                      <GitBranch className=\"w-3.5 h-3.5\" /> Relation Types by Instance Count\r\n                    </h4>\r\n                    <div className=\"space-y-1.5\">\r\n                      {relations.slice(0, 10).map((r) => {\r\n                        const name = String(r.name || r.type || r.label || '?');\r\n                        const count = Number(r.count || r.instances || r.edgeCount || 0);\r\n                        const maxCount = Math.max(...relations.slice(0, 10).map(x => Number(x.count || x.instances || x.edgeCount || 0)), 1);\r\n                        return (\r\n                          <div key={name} className=\"flex items-center gap-2\">\r\n                            <span className=\"text-[10px] text-gm-text-tertiary w-24 truncate text-right\">{name}</span>\r\n                            <div className=\"flex-1 h-4 bg-gm-surface-secondary rounded overflow-hidden\">\r\n                              <div className=\"h-full rounded bg-gm-interactive-primary/70 transition-all\" style={{\r\n                                width: `${Math.max((count / maxCount) * 100, 2)}%`,\r\n                              }} />\r\n                            </div>\r\n                            <span className=\"text-[10px] font-mono text-gm-text-tertiary w-8 text-right\">{count}</span>\r\n                          </div>\r\n                        );\r\n                      })}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Compliance Score */}\r\n                {complianceScore > 0 && (\r\n                  <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary\">\r\n                    <div className=\"flex items-center gap-3 mb-3\">\r\n                      <Shield className=\"w-4 h-4 text-gm-interactive-primary\" />\r\n                      <h4 className=\"text-xs font-semibold text-gm-text-primary\">Compliance Score</h4>\r\n                      <span className={cn('text-sm font-bold ml-auto',\r\n                        complianceScore >= 80 ? 'text-gm-status-success' :\r\n                        complianceScore >= 50 ? 'text-gm-status-warning' : 'text-gm-status-danger')}>\r\n                        {complianceScore}%\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"w-full h-2 bg-gm-surface-secondary rounded-full overflow-hidden\">\r\n                      <div className={cn('h-full rounded-full transition-all',\r\n                        complianceScore >= 80 ? 'bg-gm-status-success' :\r\n                        complianceScore >= 50 ? 'bg-gm-status-warning' : 'bg-gm-status-danger')}\r\n                        style={{ width: `${complianceScore}%` }} />\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {complianceIssues.length > 0 && (\r\n                  <div className=\"bg-[var(--gm-status-warning-bg)] border border-yellow-500/20 rounded-xl p-4\">\r\n                    <h4 className=\"text-xs font-semibold text-gm-status-warning mb-2 flex items-center gap-1.5\">\r\n                      <AlertTriangle className=\"w-3.5 h-3.5\" /> Compliance Issues ({complianceIssues.length})\r\n                    </h4>\r\n                    <div className=\"space-y-1.5\">\r\n                      {complianceIssues.slice(0, 8).map((issue, i) => (\r\n                        <p key={i} className=\"text-xs text-gm-text-primary\">{String(issue.message || issue.description || JSON.stringify(issue))}</p>\r\n                      ))}\r\n                      {complianceIssues.length > 8 && <p className=\"text-[10px] text-gm-text-tertiary\">+{complianceIssues.length - 8} more</p>}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                <button onClick={() => complianceQ.refetch()} disabled={complianceQ.isFetching}\r\n                  className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                  {complianceQ.isFetching ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Shield className=\"w-3.5 h-3.5\" />} Check Compliance\r\n                </button>\r\n              </>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* ── Tools Tab ────────────────────────────────────────────────── */}\r\n        {tab === 'tools' && (\r\n          <div className=\"space-y-4\">\r\n            {/* Extract from Graph */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\"><Download className=\"w-3.5 h-3.5\" /> Extract Ontology from Graph</h4>\r\n              <p className=\"text-[10px] text-gm-text-tertiary\">Reverse-engineer the ontology schema from existing graph data to discover entity types and relationships that exist in practice.</p>\r\n              <button onClick={() => extractFromGraph.mutate(undefined, {\r\n                onSuccess: (data: unknown) => {\r\n                  const d = data as Record<string, unknown>;\r\n                  const notInSchema = (d.notInSchema || (d.extracted as Record<string, unknown>)?.notInSchema || []) as string[];\r\n                  toast.success(`Extraction complete${notInSchema.length ? ` — ${notInSchema.length} types not in schema` : ''}`);\r\n                },\r\n                onError: () => toast.error('Extraction failed'),\r\n              })} disabled={extractFromGraph.isPending}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                {extractFromGraph.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Download className=\"w-3.5 h-3.5\" />} Extract\r\n              </button>\r\n            </div>\r\n\r\n            {/* Diff */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\"><Activity className=\"w-3.5 h-3.5\" /> Schema vs Graph Diff</h4>\r\n              <p className=\"text-[10px] text-gm-text-tertiary\">Compare the defined ontology schema with what actually exists in the graph database.</p>\r\n              <button onClick={() => diffQ.refetch()} disabled={diffQ.isFetching}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                {diffQ.isFetching ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Activity className=\"w-3.5 h-3.5\" />} Run Diff\r\n              </button>\r\n              {!diffQ.isLoading && Object.keys(diff).length > 0 && (\r\n                <div className=\"space-y-2 text-xs mt-2\">\r\n                  {Object.entries(diff).map(([k, v]) => (\r\n                    <div key={k}>\r\n                      <span className=\"text-gm-text-tertiary capitalize font-medium\">{k.replace(/_/g, ' ')}</span>\r\n                      <pre className=\"text-[10px] text-gm-text-primary mt-1 bg-gm-surface-secondary rounded-lg p-2 overflow-x-auto max-h-40\">{typeof v === 'string' ? v : JSON.stringify(v, null, 2)}</pre>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Merge */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\"><Merge className=\"w-3.5 h-3.5\" /> Merge & Update</h4>\r\n              <p className=\"text-[10px] text-gm-text-tertiary\">Merge extracted ontology back into the schema, adding missing entity and relation types.</p>\r\n              <button onClick={() => {\r\n                extractFromGraph.mutate(undefined, {\r\n                  onSuccess: (data: unknown) => {\r\n                    const d = data as Record<string, unknown>;\r\n                    mergeOntology.mutate({ source: d.extracted || d }, {\r\n                      onSuccess: () => toast.success('Ontology merged successfully'),\r\n                      onError: () => toast.error('Merge failed'),\r\n                    });\r\n                  },\r\n                  onError: () => toast.error('Extract failed before merge'),\r\n                });\r\n              }} disabled={extractFromGraph.isPending || mergeOntology.isPending}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-status-warning-bg text-gm-status-warning text-xs font-medium hover:bg-yellow-500/20 disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                {(extractFromGraph.isPending || mergeOntology.isPending) ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Merge className=\"w-3.5 h-3.5\" />} Extract & Merge\r\n              </button>\r\n            </div>\r\n\r\n            {/* Unused Types */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\"><AlertTriangle className=\"w-3.5 h-3.5 text-gm-status-warning\" /> Unused Types</h4>\r\n              <button onClick={() => unusedQ.refetch()} disabled={unusedQ.isFetching}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors mb-2\">\r\n                {unusedQ.isFetching ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Search className=\"w-3.5 h-3.5\" />} Find Unused\r\n              </button>\r\n              {unusedEntities.length > 0 && (\r\n                <div>\r\n                  <p className=\"text-[10px] text-gm-text-tertiary uppercase tracking-wider mb-1.5\">Entities ({unusedEntities.length})</p>\r\n                  <div className=\"flex flex-wrap gap-1.5 mb-2\">\r\n                    {unusedEntities.map(e => (\r\n                      <span key={e} className=\"text-[10px] px-2 py-0.5 rounded-full bg-gm-status-warning-bg text-gm-status-warning font-medium\">{e}</span>\r\n                    ))}\r\n                  </div>\r\n                  <button onClick={() => cleanup.mutate({ entities: unusedEntities }, { onSuccess: () => toast.success('Unused entities removed') })}\r\n                    disabled={cleanup.isPending}\r\n                    className=\"px-3 py-1.5 rounded-lg bg-gm-status-danger-bg text-gm-status-danger text-xs font-medium hover:bg-red-500/20 disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                    {cleanup.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Trash2 className=\"w-3.5 h-3.5\" />} Remove Entities\r\n                  </button>\r\n                </div>\r\n              )}\r\n              {unusedRelations.length > 0 && (\r\n                <div>\r\n                  <p className=\"text-[10px] text-gm-text-tertiary uppercase tracking-wider mb-1.5\">Relations ({unusedRelations.length})</p>\r\n                  <div className=\"flex flex-wrap gap-1.5 mb-2\">\r\n                    {unusedRelations.map(r => (\r\n                      <span key={r} className=\"text-[10px] px-2 py-0.5 rounded-full bg-gm-status-warning-bg text-gm-status-warning font-medium\">{r}</span>\r\n                    ))}\r\n                  </div>\r\n                  <button onClick={() => cleanup.mutate({ relations: unusedRelations }, { onSuccess: () => toast.success('Unused relations removed') })}\r\n                    disabled={cleanup.isPending}\r\n                    className=\"px-3 py-1.5 rounded-lg bg-gm-status-danger-bg text-gm-status-danger text-xs font-medium hover:bg-red-500/20 disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                    {cleanup.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Trash2 className=\"w-3.5 h-3.5\" />} Remove Relations\r\n                  </button>\r\n                </div>\r\n              )}\r\n              {unusedEntities.length === 0 && unusedRelations.length === 0 && !unusedQ.isFetching && (\r\n                <p className=\"text-xs text-gm-text-tertiary\">All types are in use (or click \"Find Unused\" to check).</p>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* ── Jobs Tab ─────────────────────────────────────────────────── */}\r\n        {tab === 'jobs' && (\r\n          <div className=\"space-y-4\">\r\n            {/* Worker Status */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary\">\r\n              <div className=\"flex items-center gap-2 mb-3\">\r\n                <Activity className=\"w-4 h-4 text-gm-interactive-primary\" />\r\n                <h4 className=\"text-xs font-semibold text-gm-text-primary\">Background Worker</h4>\r\n                <div className={cn('ml-auto px-2 py-0.5 rounded-full text-[9px] font-medium',\r\n                  worker.status === 'running' || worker.running ? 'bg-gm-status-success-bg text-gm-status-success' : 'bg-gm-surface-secondary text-gm-text-tertiary')}>\r\n                  {String(worker.status || (worker.running ? 'Running' : 'Idle'))}\r\n                </div>\r\n              </div>\r\n              {workerQ.isLoading ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : (\r\n                <div className=\"grid grid-cols-3 gap-3 text-xs\">\r\n                  {worker.lastRun && (\r\n                    <div>\r\n                      <p className=\"text-[10px] text-gm-text-tertiary\">Last Run</p>\r\n                      <p className=\"text-gm-text-primary font-medium\">{new Date(String(worker.lastRun || worker.last_run)).toLocaleString()}</p>\r\n                    </div>\r\n                  )}\r\n                  {worker.nextRun && (\r\n                    <div>\r\n                      <p className=\"text-[10px] text-gm-text-tertiary\">Next Run</p>\r\n                      <p className=\"text-gm-text-primary font-medium\">{new Date(String(worker.nextRun || worker.next_run)).toLocaleString()}</p>\r\n                    </div>\r\n                  )}\r\n                  {(worker.totalRuns || worker.total_runs) && (\r\n                    <div>\r\n                      <p className=\"text-[10px] text-gm-text-tertiary\">Total Runs</p>\r\n                      <p className=\"text-gm-text-primary font-medium\">{String(worker.totalRuns || worker.total_runs)}</p>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Quick Actions */}\r\n            <div className=\"flex flex-wrap gap-2\">\r\n              <button onClick={() => triggerWorker.mutate({ type: 'full_analysis' }, { onSuccess: () => toast.success('Full analysis triggered') })} disabled={triggerWorker.isPending}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                {triggerWorker.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Brain className=\"w-3.5 h-3.5\" />} Full Analysis\r\n              </button>\r\n              <button onClick={() => triggerWorker.mutate({ type: 'inference' }, { onSuccess: () => toast.success('Inference triggered') })} disabled={triggerWorker.isPending}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                <Zap className=\"w-3.5 h-3.5\" /> Inference Rules\r\n              </button>\r\n              <button onClick={() => triggerWorker.mutate({ type: 'dedup' }, { onSuccess: () => toast.success('Dedup triggered') })} disabled={triggerWorker.isPending}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                <Layers className=\"w-3.5 h-3.5\" /> Deduplication\r\n              </button>\r\n              <button onClick={() => triggerWorker.mutate({ type: 'gap_detection' }, { onSuccess: () => toast.success('Gap detection triggered') })} disabled={triggerWorker.isPending}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                <Search className=\"w-3.5 h-3.5\" /> Gap Detection\r\n              </button>\r\n              <button onClick={() => forceSync.mutate(undefined, { onSuccess: () => toast.success('Sync triggered') })} disabled={forceSync.isPending}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                <RefreshCw className=\"w-3.5 h-3.5\" /> Force Sync\r\n              </button>\r\n            </div>\r\n\r\n            {/* Scheduled Jobs */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\"><Clock className=\"w-3.5 h-3.5\" /> Scheduled Jobs</h4>\r\n              {jobsQ.isLoading ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : jobs.length === 0 ? (\r\n                <p className=\"text-xs text-gm-text-tertiary\">No scheduled jobs configured</p>\r\n              ) : (\r\n                <div className=\"space-y-2\">\r\n                  {jobs.map((job, i) => {\r\n                    const name = String(job.name || job.type || job.id || '');\r\n                    const enabled = Boolean(job.enabled ?? job.active ?? true);\r\n                    const interval = String(job.interval || job.cron || job.schedule || '');\r\n                    const lastRun = job.lastRun || job.last_run;\r\n                    const jobStatus = String(job.status || (enabled ? 'active' : 'paused'));\r\n                    const totalRuns = Number(job.stats && (job.stats as Record<string, unknown>).totalRuns) || Number(job.total_runs || 0);\r\n                    return (\r\n                      <div key={i} className=\"flex items-center gap-3 bg-gm-surface-secondary rounded-lg p-2.5\">\r\n                        <button onClick={() => toggleJob.mutate(String(job.id), { onSuccess: () => toast.success(`Job ${enabled ? 'disabled' : 'enabled'}`) })}\r\n                          disabled={toggleJob.isPending}\r\n                          className={cn('p-1 rounded-md transition-colors', enabled ? 'text-gm-status-success hover:bg-green-500/10' : 'text-gm-text-tertiary hover:bg-gm-surface-hover')}>\r\n                          {enabled ? <Power className=\"w-3.5 h-3.5\" /> : <PowerOff className=\"w-3.5 h-3.5\" />}\r\n                        </button>\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <span className=\"text-xs font-medium text-gm-text-primary\">{name}</span>\r\n                            <span className={cn('text-[9px] px-1 py-0.5 rounded',\r\n                              enabled ? 'bg-gm-status-success-bg text-gm-status-success' : 'bg-gm-surface-hover text-gm-text-tertiary')}>\r\n                              {jobStatus}\r\n                            </span>\r\n                          </div>\r\n                          <div className=\"flex gap-3 text-[10px] text-gm-text-tertiary mt-0.5\">\r\n                            {interval && <span>{interval}</span>}\r\n                            {lastRun && <span>Last: {new Date(String(lastRun)).toLocaleString()}</span>}\r\n                            {totalRuns > 0 && <span>{totalRuns} runs</span>}\r\n                          </div>\r\n                        </div>\r\n                        <button onClick={() => triggerWorker.mutate({ type: String(job.type || job.id) }, { onSuccess: () => toast.success('Job triggered') })}\r\n                          disabled={triggerWorker.isPending}\r\n                          className=\"p-1.5 rounded-lg bg-gm-interactive-primary/10 text-gm-interactive-primary hover:bg-gm-interactive-primary/20 transition-colors\" title=\"Run now\">\r\n                          <Play className=\"w-3 h-3\" />\r\n                        </button>\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Execution Log */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\"><History className=\"w-3.5 h-3.5\" /> Execution Log</h4>\r\n              {workerLogQ.isLoading ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : workerLog.length === 0 ? (\r\n                <p className=\"text-xs text-gm-text-tertiary\">No execution history</p>\r\n              ) : (\r\n                <div className=\"space-y-1.5 max-h-60 overflow-y-auto\">\r\n                  {workerLog.slice(0, 20).map((entry, i) => {\r\n                    const jobType = String(entry.jobType || entry.job_type || entry.type || '');\r\n                    const status = String(entry.status || '');\r\n                    const started = entry.startedAt || entry.started_at || entry.created_at;\r\n                    const duration = Number(entry.duration || entry.elapsed_ms || 0);\r\n                    const error = String(entry.error || '');\r\n                    return (\r\n                      <div key={i} className=\"flex items-center gap-2 text-xs\">\r\n                        <div className={cn('w-1.5 h-1.5 rounded-full shrink-0',\r\n                          status === 'completed' ? 'bg-gm-status-success' :\r\n                          status === 'failed' ? 'bg-gm-status-danger' :\r\n                          status === 'started' ? 'bg-gm-status-warning animate-pulse' : 'bg-gm-text-tertiary')} />\r\n                        <span className=\"text-gm-text-primary font-medium w-24 shrink-0 truncate\">{jobType}</span>\r\n                        <span className={cn('text-[10px] w-16 shrink-0',\r\n                          status === 'completed' ? 'text-gm-status-success' : status === 'failed' ? 'text-gm-status-danger' : 'text-gm-text-tertiary')}>\r\n                          {status}\r\n                        </span>\r\n                        {duration > 0 && <span className=\"text-[10px] text-gm-text-tertiary w-16 shrink-0\">{duration > 1000 ? `${(duration / 1000).toFixed(1)}s` : `${duration}ms`}</span>}\r\n                        {started && <span className=\"text-[10px] text-gm-text-tertiary\">{new Date(String(started)).toLocaleString()}</span>}\r\n                        {error && status === 'failed' && <span className=\"text-[10px] text-gm-status-danger truncate max-w-[150px]\" title={error}>{error}</span>}\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* ── Changes/History Tab ──────────────────────────────────────── */}\r\n        {tab === 'changes' && (\r\n          <div className=\"space-y-4\">\r\n            {/* Sync Status */}\r\n            {!syncStatusQ.isLoading && Object.keys(syncStatusData).length > 0 && (\r\n              <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary\">\r\n                <h4 className=\"text-xs font-semibold text-gm-text-primary mb-2 flex items-center gap-1.5\"><RefreshCw className=\"w-3.5 h-3.5\" /> Sync Status</h4>\r\n                <div className=\"grid grid-cols-2 gap-2 text-xs\">\r\n                  {Object.entries(syncStatusData).map(([k, v]) => (\r\n                    <div key={k} className=\"flex items-center gap-2\">\r\n                      <span className=\"text-gm-text-tertiary capitalize shrink-0\">{k.replace(/_/g, ' ')}</span>\r\n                      <span className=\"text-gm-text-primary text-[10px] truncate\">{v == null ? '—' : String(v)}</span>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Change Log */}\r\n            <div>\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary mb-3 flex items-center gap-1.5\"><History className=\"w-3.5 h-3.5\" /> Change Log</h4>\r\n              {changesQ.isLoading ? <Loader2 className=\"w-5 h-5 animate-spin text-gm-interactive-primary mx-auto\" /> : changes.length === 0 ? (\r\n                <div className=\"text-center py-8\">\r\n                  <History className=\"w-10 h-10 mx-auto mb-3 text-gray-600\" />\r\n                  <p className=\"text-xs text-gm-text-tertiary\">No changes recorded</p>\r\n                </div>\r\n              ) : (\r\n                <div className=\"space-y-1.5\">\r\n                  {changes.slice(0, 50).map((c, i) => {\r\n                    const changeType = String(c.change_type || c.action || c.type || '');\r\n                    const targetName = String(c.target_name || c.target || c.entity || '');\r\n                    const reason = String(c.reason || c.description || c.message || '');\r\n                    const source = String(c.source || '');\r\n                    const changedAt = c.changed_at || c.created_at;\r\n                    const isAdd = changeType.includes('added') || changeType === 'add';\r\n                    const isRemove = changeType.includes('removed') || changeType === 'remove';\r\n                    return (\r\n                      <div key={i} className=\"flex items-start gap-2 bg-[var(--gm-surface-hover)] rounded-lg p-2.5 border border-gm-border-primary\">\r\n                        <div className={cn('w-2 h-2 rounded-full mt-1.5 shrink-0',\r\n                          isAdd ? 'bg-gm-status-success' : isRemove ? 'bg-gm-status-danger' : 'bg-gm-status-warning')} />\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <span className=\"text-[10px] px-1.5 py-0.5 rounded bg-gm-surface-secondary text-gm-text-tertiary font-medium\">{changeType.replace(/_/g, ' ')}</span>\r\n                            {targetName && <span className=\"text-xs font-medium text-gm-text-primary\">{targetName}</span>}\r\n                          </div>\r\n                          {reason && <p className=\"text-[10px] text-gm-text-tertiary mt-0.5\">{reason}</p>}\r\n                          <div className=\"flex gap-2 mt-0.5 text-[9px] text-gm-text-tertiary\">\r\n                            {source && <span>{source}</span>}\r\n                            {changedAt && <span>{new Date(String(changedAt)).toLocaleString()}</span>}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n        {/* ── Inference Rules Tab ────────────────────────────────────── */}\r\n        {tab === 'inference' && (\r\n          <div className=\"space-y-4\">\r\n            {/* Stats */}\r\n            <div className=\"grid grid-cols-4 gap-3\">\r\n              {[\r\n                { label: 'Runs', value: inferenceStatsData.runsCompleted || 0 },\r\n                { label: 'Inferred', value: inferenceStatsData.totalRelationshipsInferred || 0 },\r\n                { label: 'Errors', value: inferenceStatsData.totalErrors || 0 },\r\n                { label: 'Last Run', value: inferenceStatsData.lastRun ? new Date(String(inferenceStatsData.lastRun)).toLocaleDateString() : '—' },\r\n              ].map((s, i) => (\r\n                <div key={i} className=\"bg-gm-surface-secondary rounded-xl p-3 border border-gm-border-primary\">\r\n                  <p className=\"text-lg font-bold text-gm-text-primary\">{String(s.value)}</p>\r\n                  <p className=\"text-[10px] text-gm-text-tertiary\">{s.label}</p>\r\n                </div>\r\n              ))}\r\n            </div>\r\n\r\n            {/* Run All */}\r\n            <div className=\"flex gap-2\">\r\n              <button onClick={() => runInference.mutate(undefined, { onSuccess: () => toast.success('All inference rules executed') })}\r\n                disabled={runInference.isPending}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                {runInference.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Zap className=\"w-3.5 h-3.5\" />} Run All Rules\r\n              </button>\r\n            </div>\r\n\r\n            {/* Rules List */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\"><Zap className=\"w-3.5 h-3.5\" /> Defined Rules</h4>\r\n              {inferenceRulesQ.isLoading ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : inferenceRules.length === 0 && inferenceCyphers.length === 0 ? (\r\n                <p className=\"text-xs text-gm-text-tertiary\">No inference rules defined</p>\r\n              ) : (\r\n                <div className=\"space-y-2\">\r\n                  {inferenceRules.map((rule, i) => (\r\n                    <div key={i} className=\"flex items-center gap-3 bg-gm-surface-secondary rounded-lg p-2.5\">\r\n                      <Zap className=\"w-3.5 h-3.5 text-gm-status-warning shrink-0\" />\r\n                      <div className=\"flex-1 min-w-0\">\r\n                        <span className=\"text-xs font-medium text-gm-text-primary\">{String(rule.name || rule.id || '')}</span>\r\n                        {rule.description && <p className=\"text-[10px] text-gm-text-tertiary\">{String(rule.description)}</p>}\r\n                        {rule.type && <span className=\"text-[9px] px-1 py-0.5 rounded bg-gm-surface-hover text-gm-text-tertiary ml-1\">{String(rule.type)}</span>}\r\n                      </div>\r\n                      <button onClick={() => runInference.mutate(String(rule.name || rule.id), { onSuccess: () => toast.success(`Rule \"${rule.name}\" executed`) })}\r\n                        disabled={runInference.isPending}\r\n                        className=\"p-1.5 rounded-lg bg-gm-interactive-primary/10 text-gm-interactive-primary hover:bg-gm-interactive-primary/20 transition-colors\" title=\"Run rule\">\r\n                        <Play className=\"w-3 h-3\" />\r\n                      </button>\r\n                    </div>\r\n                  ))}\r\n                  {inferenceCyphers.map((cypher, i) => (\r\n                    <div key={`c-${i}`} className=\"bg-gm-surface-secondary rounded-lg p-2.5\">\r\n                      <div className=\"flex items-center gap-2 mb-1\">\r\n                        <span className=\"text-[9px] px-1 py-0.5 rounded bg-blue-600/10 text-gm-interactive-primary font-medium\">Cypher</span>\r\n                        <span className=\"text-xs font-medium text-gm-text-primary\">{String(cypher.name || '')}</span>\r\n                      </div>\r\n                      {cypher.description && <p className=\"text-[10px] text-gm-text-tertiary\">{String(cypher.description)}</p>}\r\n                      {cypher.cypher && <pre className=\"text-[9px] text-gm-text-tertiary mt-1 bg-gm-surface-hover rounded p-1.5 overflow-x-auto\">{String(cypher.cypher)}</pre>}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Available (runtime) rules */}\r\n            {availableInferenceRules.length > 0 && (\r\n              <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n                <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\"><Info className=\"w-3.5 h-3.5\" /> Available Runtime Rules</h4>\r\n                <div className=\"space-y-1.5\">\r\n                  {availableInferenceRules.map((r, i) => (\r\n                    <div key={i} className=\"flex items-center gap-2 text-xs\">\r\n                      <span className=\"text-gm-text-primary font-medium\">{String(r.name || '')}</span>\r\n                      {r.description && <span className=\"text-[10px] text-gm-text-tertiary\">— {String(r.description)}</span>}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* ── Embeddings Dashboard Tab ─────────────────────────────────── */}\r\n        {tab === 'embeddings' && (\r\n          <div className=\"space-y-4\">\r\n            {embeddingsDashQ.isLoading ? <Loader2 className=\"w-5 h-5 animate-spin text-gm-interactive-primary mx-auto\" /> : (\r\n              <>\r\n                {/* Summary */}\r\n                <div className=\"grid grid-cols-4 gap-3\">\r\n                  {[\r\n                    { label: 'Total Entities', value: embeddingSummary.totalEntities || 0 },\r\n                    { label: 'With Embeddings', value: embeddingSummary.totalWithEmbeddings || 0 },\r\n                    { label: 'Coverage', value: `${embeddingSummary.overallCoverage || 0}%` },\r\n                    { label: 'Model', value: String(embeddingSummary.model || 'N/A') },\r\n                  ].map((s, i) => (\r\n                    <div key={i} className=\"bg-gm-surface-secondary rounded-xl p-3 border border-gm-border-primary\">\r\n                      <p className=\"text-lg font-bold text-gm-text-primary\">{String(s.value)}</p>\r\n                      <p className=\"text-[10px] text-gm-text-tertiary\">{s.label}</p>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n\r\n                {/* Overall Progress Bar */}\r\n                <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary\">\r\n                  <div className=\"flex items-center justify-between mb-2\">\r\n                    <h4 className=\"text-xs font-semibold text-gm-text-primary\">Overall Coverage</h4>\r\n                    <span className={cn('text-sm font-bold',\r\n                      Number(embeddingSummary.overallCoverage || 0) >= 80 ? 'text-gm-status-success' :\r\n                      Number(embeddingSummary.overallCoverage || 0) >= 50 ? 'text-gm-status-warning' : 'text-gm-status-danger')}>\r\n                      {embeddingSummary.overallCoverage || 0}%\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"w-full h-3 bg-gm-surface-secondary rounded-full overflow-hidden\">\r\n                    <div className={cn('h-full rounded-full transition-all',\r\n                      Number(embeddingSummary.overallCoverage || 0) >= 80 ? 'bg-gm-status-success' :\r\n                      Number(embeddingSummary.overallCoverage || 0) >= 50 ? 'bg-gm-status-warning' : 'bg-gm-status-danger')}\r\n                      style={{ width: `${embeddingSummary.overallCoverage || 0}%` }} />\r\n                  </div>\r\n                  <div className=\"flex gap-3 mt-2 text-[10px] text-gm-text-tertiary\">\r\n                    <span>Dimensions: {String(embeddingSummary.dimensions || 1024)}</span>\r\n                    {Number(embeddingSummary.staleCount || 0) > 0 && <span className=\"text-gm-status-warning\">{embeddingSummary.staleCount} stale</span>}\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Per-Type Coverage */}\r\n                <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n                  <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\"><BarChart3 className=\"w-3.5 h-3.5\" /> Coverage by Type</h4>\r\n                  {Object.keys(embeddingCoverage).length === 0 ? (\r\n                    <p className=\"text-xs text-gm-text-tertiary\">No coverage data available</p>\r\n                  ) : (\r\n                    <div className=\"space-y-2\">\r\n                      {Object.entries(embeddingCoverage).map(([type, data]) => {\r\n                        const coverage = Number(data.coverage || 0);\r\n                        const total = Number(data.total || 0);\r\n                        const withEmb = Number(data.withEmbedding || 0);\r\n                        return (\r\n                          <div key={type} className=\"space-y-1\">\r\n                            <div className=\"flex items-center justify-between text-xs\">\r\n                              <div className=\"flex items-center gap-2\">\r\n                                <span className=\"font-medium text-gm-text-primary capitalize\">{type}</span>\r\n                                <span className=\"text-[10px] text-gm-text-tertiary\">{withEmb}/{total}</span>\r\n                              </div>\r\n                              <span className={cn('text-[10px] font-medium',\r\n                                coverage >= 80 ? 'text-gm-status-success' : coverage >= 50 ? 'text-gm-status-warning' : 'text-gm-status-danger')}>\r\n                                {coverage}%\r\n                              </span>\r\n                            </div>\r\n                            <div className=\"w-full h-1.5 bg-gm-surface-secondary rounded-full overflow-hidden\">\r\n                              <div className={cn('h-full rounded-full transition-all',\r\n                                coverage >= 80 ? 'bg-gm-status-success' : coverage >= 50 ? 'bg-gm-status-warning' : 'bg-gm-status-danger')}\r\n                                style={{ width: `${coverage}%` }} />\r\n                            </div>\r\n                          </div>\r\n                        );\r\n                      })}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Regenerate */}\r\n                <div className=\"flex gap-2\">\r\n                  <button onClick={() => regenEmbeddings.mutate(undefined, { onSuccess: () => toast.success('Embedding regeneration queued for all types') })}\r\n                    disabled={regenEmbeddings.isPending}\r\n                    className=\"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                    {regenEmbeddings.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <RefreshCw className=\"w-3.5 h-3.5\" />} Regenerate All\r\n                  </button>\r\n                </div>\r\n              </>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* ── Shared / Cross-Project Tab ───────────────────────────────── */}\r\n        {tab === 'shared' && (\r\n          <div className=\"space-y-4\">\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary mb-1\">Cross-Project Entities</h4>\r\n              <p className=\"text-[10px] text-gm-text-tertiary mb-3\">Shared entity types are visible across all projects. Toggle sharing per entity type.</p>\r\n            </div>\r\n\r\n            {/* All Entities with Share Toggle */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\"><Layers className=\"w-3.5 h-3.5\" /> Entity Types</h4>\r\n              {entitiesQ.isLoading ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : (\r\n                <div className=\"space-y-1.5\">\r\n                  {entities.map((e, i) => {\r\n                    const name = String(e.name || e.type || e.label || '');\r\n                    const isShared = Boolean(e.sharedEntity || e.shared);\r\n                    const color = getColor(name, e.color ? String(e.color) : undefined);\r\n                    return (\r\n                      <div key={i} className=\"flex items-center gap-3 bg-gm-surface-secondary rounded-lg p-2\">\r\n                        <div className=\"w-5 h-5 rounded flex items-center justify-center text-white text-[8px] font-bold\" style={{ backgroundColor: color }}>\r\n                          {name.charAt(0)}\r\n                        </div>\r\n                        <span className=\"text-xs font-medium text-gm-text-primary flex-1\">{name}</span>\r\n                        <button\r\n                          onClick={() => toggleShared.mutate({ name, shared: !isShared }, {\r\n                            onSuccess: () => toast.success(`${name} is now ${!isShared ? 'shared' : 'project-only'}`),\r\n                          })}\r\n                          disabled={toggleShared.isPending}\r\n                          className={cn('px-2 py-0.5 rounded-full text-[9px] font-medium transition-colors',\r\n                            isShared ? 'bg-gm-interactive-primary/10 text-gm-interactive-primary' : 'bg-gm-surface-hover text-gm-text-tertiary hover:bg-gm-surface-secondary')}>\r\n                          {isShared ? 'Shared' : 'Project Only'}\r\n                        </button>\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Cross-Graph Relations */}\r\n            {crossGraphRelations.length > 0 && (\r\n              <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n                <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\"><GitBranch className=\"w-3.5 h-3.5\" /> Cross-Graph Relations</h4>\r\n                <div className=\"space-y-1.5\">\r\n                  {crossGraphRelations.map((r, i) => (\r\n                    <div key={i} className=\"flex items-center gap-2 text-xs\">\r\n                      <span className=\"text-gm-text-primary font-medium\">{String(r.name || r.type || '')}</span>\r\n                      {r.from && <span className=\"text-[10px] text-gm-text-tertiary\">({String(r.from)} → {String(r.to)})</span>}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Shared Entities Summary */}\r\n            {sharedEntities.length > 0 && (\r\n              <div className=\"bg-blue-600/5 rounded-xl p-4 border border-blue-600/10\">\r\n                <h4 className=\"text-xs font-semibold text-gm-interactive-primary mb-2\">{sharedEntities.length} Shared Entity Types</h4>\r\n                <div className=\"flex flex-wrap gap-1.5\">\r\n                  {sharedEntities.map((e, i) => (\r\n                    <span key={i} className=\"text-[10px] px-2 py-0.5 rounded-full bg-gm-interactive-primary/10 text-gm-interactive-primary font-medium\">\r\n                      {String(e.name || '')}\r\n                    </span>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* ── Versions Tab ─────────────────────────────────────────────── */}\r\n        {tab === 'versions' && (\r\n          <div className=\"space-y-4\">\r\n            {/* Current Version */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <div className=\"w-10 h-10 rounded-xl bg-gm-interactive-primary/10 flex items-center justify-center\">\r\n                  <History className=\"w-5 h-5 text-gm-interactive-primary\" />\r\n                </div>\r\n                <div>\r\n                  <h4 className=\"text-sm font-bold text-gm-text-primary\">Current Version: {String(versionsData.currentVersion || '—')}</h4>\r\n                  <p className=\"text-[10px] text-gm-text-tertiary\">{String(versionsData.totalChanges || 0)} total changes recorded</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Version History */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\"><History className=\"w-3.5 h-3.5\" /> Version History</h4>\r\n              {versionsQ.isLoading ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : versionHistory.length === 0 ? (\r\n                <p className=\"text-xs text-gm-text-tertiary\">No version snapshots recorded</p>\r\n              ) : (\r\n                <div className=\"space-y-2\">\r\n                  {versionHistory.map((v, i) => (\r\n                    <div key={i} className=\"bg-gm-surface-secondary rounded-lg p-3 border border-gm-border-primary\">\r\n                      <div className=\"flex items-center gap-2 mb-1\">\r\n                        <span className=\"text-xs font-bold text-gm-text-primary\">v{String(v.version || '?')}</span>\r\n                        <span className=\"text-[10px] px-1.5 py-0.5 rounded bg-gm-surface-hover text-gm-text-tertiary\">{String(v.changeType || v.change_type || '').replace(/_/g, ' ')}</span>\r\n                        {v.source && <span className=\"text-[9px] text-gm-text-tertiary\">{String(v.source)}</span>}\r\n                      </div>\r\n                      {v.reason && <p className=\"text-[10px] text-gm-text-tertiary\">{String(v.reason)}</p>}\r\n                      <div className=\"flex gap-2 mt-1 text-[9px] text-gm-text-tertiary\">\r\n                        {v.changedBy && <span>by {String(v.changedBy)}</span>}\r\n                        {v.changedAt && <span>{new Date(String(v.changedAt)).toLocaleString()}</span>}\r\n                      </div>\r\n                      {v.diff && Object.keys(v.diff as Record<string, unknown>).length > 0 && (\r\n                        <pre className=\"text-[9px] text-gm-text-tertiary mt-2 bg-gm-surface-hover rounded p-2 overflow-x-auto max-h-20\">{JSON.stringify(v.diff, null, 2)}</pre>\r\n                      )}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* ── Test Tab ────────────────────────────────────────────────── */}\r\n        {tab === 'test' && (\r\n          <div className=\"space-y-4\">\r\n\r\n            {/* Validate Entity */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\">\r\n                <Shield className=\"w-3.5 h-3.5\" /> Validate Entity Against Schema\r\n              </h4>\r\n              <p className=\"text-[10px] text-gm-text-tertiary\">Test whether an entity object conforms to its type definition in the ontology schema.</p>\r\n              <div className=\"flex gap-2\">\r\n                <select value={validateType} onChange={e => setValidateType(e.target.value)}\r\n                  className=\"flex-shrink-0 w-40 px-2 py-1.5 text-xs bg-gm-surface-secondary border border-gm-border-primary rounded-lg text-gm-text-primary\">\r\n                  <option value=\"\">Select type...</option>\r\n                  {entities.map(e => {\r\n                    const n = String(e.name || e.type || e.label || '');\r\n                    return <option key={n} value={n}>{n}</option>;\r\n                  })}\r\n                </select>\r\n              </div>\r\n              <textarea value={validateJson} onChange={e => setValidateJson(e.target.value)} rows={5}\r\n                className=\"w-full px-3 py-2 text-xs font-mono bg-gm-surface-secondary border border-gm-border-primary rounded-lg text-gm-text-primary resize-y\"\r\n                placeholder='{\"name\": \"example\", \"description\": \"...\"}'\r\n              />\r\n              <button disabled={!validateType || validateEntity.isPending}\r\n                onClick={() => {\r\n                  try {\r\n                    const parsed = JSON.parse(validateJson);\r\n                    validateEntity.mutate({ type: validateType, entity: parsed });\r\n                  } catch { toast.error('Invalid JSON'); }\r\n                }}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-white text-xs font-medium hover:opacity-90 disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                {validateEntity.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Shield className=\"w-3.5 h-3.5\" />} Validate\r\n              </button>\r\n              {validateEntity.data && (\r\n                <div className={cn('rounded-lg p-3 border text-xs',\r\n                  (validateEntity.data as Record<string, unknown>).valid\r\n                    ? 'bg-gm-status-success/10 border-gm-status-success/30 text-gm-status-success'\r\n                    : 'bg-gm-status-danger/10 border-gm-status-danger/30 text-gm-status-danger')}>\r\n                  <div className=\"flex items-center gap-1.5 font-semibold mb-1\">\r\n                    {(validateEntity.data as Record<string, unknown>).valid\r\n                      ? <><CheckCircle className=\"w-3.5 h-3.5\" /> Valid</>\r\n                      : <><XCircle className=\"w-3.5 h-3.5\" /> Invalid</>}\r\n                  </div>\r\n                  {((validateEntity.data as Record<string, unknown>).errors as string[] || []).length > 0 && (\r\n                    <ul className=\"mt-1 space-y-0.5 text-gm-text-primary\">\r\n                      {((validateEntity.data as Record<string, unknown>).errors as string[]).map((err, i) => (\r\n                        <li key={i} className=\"text-[10px]\">- {err}</li>\r\n                      ))}\r\n                    </ul>\r\n                  )}\r\n                  {((validateEntity.data as Record<string, unknown>).missingRequired as string[] || []).length > 0 && (\r\n                    <p className=\"text-[10px] text-gm-text-primary mt-1\">Missing required: {((validateEntity.data as Record<string, unknown>).missingRequired as string[]).join(', ')}</p>\r\n                  )}\r\n                  {((validateEntity.data as Record<string, unknown>).unknownProperties as string[] || []).length > 0 && (\r\n                    <p className=\"text-[10px] text-gm-text-primary mt-1\">Unknown properties: {((validateEntity.data as Record<string, unknown>).unknownProperties as string[]).join(', ')}</p>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Extract Entities from Text */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\">\r\n                <FileText className=\"w-3.5 h-3.5\" /> Extract Entities from Text (AI)\r\n              </h4>\r\n              <p className=\"text-[10px] text-gm-text-tertiary\">Paste any text and let the AI identify entities and relationships using the current ontology schema.</p>\r\n              <textarea value={extractText} onChange={e => setExtractText(e.target.value)} rows={6}\r\n                className=\"w-full px-3 py-2 text-xs bg-gm-surface-secondary border border-gm-border-primary rounded-lg text-gm-text-primary resize-y\"\r\n                placeholder=\"Paste meeting notes, a document, or any text here...\"\r\n              />\r\n              <button disabled={!extractText.trim() || extractFromText.isPending}\r\n                onClick={() => extractFromText.mutate({\r\n                  text: extractText,\r\n                  existingEntities: entities.map(e => String(e.name || e.type || '')).filter(Boolean),\r\n                })}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-white text-xs font-medium hover:opacity-90 disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                {extractFromText.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Sparkles className=\"w-3.5 h-3.5\" />} Extract\r\n              </button>\r\n              {extractFromText.data && (\r\n                <div className=\"space-y-3\">\r\n                  {((extractFromText.data as Record<string, unknown>).entities as Array<Record<string, unknown>> || []).length > 0 && (\r\n                    <div className=\"bg-gm-surface-secondary rounded-lg p-3 border border-gm-border-primary space-y-2\">\r\n                      <h5 className=\"text-[10px] font-semibold text-gm-text-primary\">Extracted Entities ({((extractFromText.data as Record<string, unknown>).entities as unknown[]).length})</h5>\r\n                      <div className=\"flex flex-wrap gap-1.5\">\r\n                        {((extractFromText.data as Record<string, unknown>).entities as Array<Record<string, unknown>>).map((ent, i) => (\r\n                          <span key={i} className=\"px-2 py-1 rounded-lg text-[10px] font-medium border border-gm-border-primary bg-gm-surface-hover text-gm-text-primary\">\r\n                            <span className=\"inline-block w-2 h-2 rounded-full mr-1\" style={{ backgroundColor: getColor(String(ent.type || ent.entityType || ''), '#6366f1') }} />\r\n                            {String(ent.name || ent.value || '?')}\r\n                            <span className=\"ml-1 text-gm-text-tertiary\">{String(ent.type || ent.entityType || '')}</span>\r\n                          </span>\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                  {((extractFromText.data as Record<string, unknown>).relationships as Array<Record<string, unknown>> || []).length > 0 && (\r\n                    <div className=\"bg-gm-surface-secondary rounded-lg p-3 border border-gm-border-primary space-y-2\">\r\n                      <h5 className=\"text-[10px] font-semibold text-gm-text-primary\">Extracted Relationships ({((extractFromText.data as Record<string, unknown>).relationships as unknown[]).length})</h5>\r\n                      <div className=\"space-y-1\">\r\n                        {((extractFromText.data as Record<string, unknown>).relationships as Array<Record<string, unknown>>).map((rel, i) => (\r\n                          <div key={i} className=\"flex items-center gap-1.5 text-[10px] text-gm-text-primary\">\r\n                            <span className=\"font-medium\">{String(rel.from || rel.source || '?')}</span>\r\n                            <span className=\"px-1.5 py-0.5 rounded bg-gm-interactive-primary/10 text-gm-interactive-primary font-mono text-[9px]\">{String(rel.type || rel.relationship || '?')}</span>\r\n                            <span className=\"font-medium\">{String(rel.to || rel.target || '?')}</span>\r\n                            {rel.confidence && <span className=\"text-gm-text-tertiary\">({Math.round(Number(rel.confidence) * 100)}%)</span>}\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                  {((extractFromText.data as Record<string, unknown>).entities as unknown[] || []).length === 0 &&\r\n                   ((extractFromText.data as Record<string, unknown>).relationships as unknown[] || []).length === 0 && (\r\n                    <p className=\"text-xs text-gm-text-tertiary\">No entities or relationships found in the provided text.</p>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Embedding Preview */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\">\r\n                <Eye className=\"w-3.5 h-3.5\" /> Embedding Preview\r\n              </h4>\r\n              <p className=\"text-[10px] text-gm-text-tertiary\">Preview the enriched text that would be generated for an entity before converting it to a vector embedding.</p>\r\n              <div className=\"flex gap-2\">\r\n                <select value={enrichType} onChange={e => setEnrichType(e.target.value)}\r\n                  className=\"flex-shrink-0 w-40 px-2 py-1.5 text-xs bg-gm-surface-secondary border border-gm-border-primary rounded-lg text-gm-text-primary\">\r\n                  <option value=\"\">Select type...</option>\r\n                  {entities.map(e => {\r\n                    const n = String(e.name || e.type || e.label || '');\r\n                    return <option key={n} value={n}>{n}</option>;\r\n                  })}\r\n                </select>\r\n              </div>\r\n              <textarea value={enrichJson} onChange={e => setEnrichJson(e.target.value)} rows={4}\r\n                className=\"w-full px-3 py-2 text-xs font-mono bg-gm-surface-secondary border border-gm-border-primary rounded-lg text-gm-text-primary resize-y\"\r\n                placeholder='{\"name\": \"...\", \"description\": \"...\"}'\r\n              />\r\n              <button disabled={!enrichType || enrichEntity.isPending}\r\n                onClick={() => {\r\n                  try {\r\n                    const parsed = JSON.parse(enrichJson);\r\n                    enrichEntity.mutate({ type: enrichType, entity: parsed });\r\n                  } catch { toast.error('Invalid JSON'); }\r\n                }}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                {enrichEntity.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Eye className=\"w-3.5 h-3.5\" />} Preview Embedding Text\r\n              </button>\r\n              {enrichEntity.data && (enrichEntity.data as Record<string, unknown>).enrichedText && (\r\n                <div className=\"bg-gm-surface-secondary rounded-lg p-3 border border-gm-border-primary\">\r\n                  <h5 className=\"text-[10px] font-semibold text-gm-text-primary mb-2 flex items-center gap-1.5\">\r\n                    <Brain className=\"w-3 h-3\" /> Generated Embedding Text\r\n                  </h5>\r\n                  <pre className=\"text-[10px] text-gm-text-primary whitespace-pre-wrap font-mono leading-relaxed max-h-40 overflow-y-auto\">\r\n                    {String((enrichEntity.data as Record<string, unknown>).enrichedText)}\r\n                  </pre>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Entity Detail Modal */}\r\n      {selectedEntity && (\r\n        <EntityDetailPanel entity={selectedEntity} onClose={() => setSelectedEntity(null)} />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":["__iconNode","FlaskConical","createLucideIcon","GitBranch","PowerOff","Power","TIER_CONFIG","NODE_DIMENSIONS","EDGE_STYLES","NODE_COLORS","HIDDEN_EDGE_TYPES","transformGraphData","rawNodes","rawEdges","LABEL_PREFIXES","nodeIdSet","n","prefixRedirectMap","prefixedIdsToRemove","node","id","prefix","strippedId","deduplicatedNodes","personToContactMap","contactLinkedPersonIds","nameToContactMap","normalize","s","contactId","alias","seenPersonNames","nodes","processedPersonIds","shouldMerge","targetId","normalizedLabel","nn","type","tier","dims","getNodeColorToken","validNodeIds","resolveId","processedEdges","edge","source","target","styleConfig","pairCounts","pairIndex","pairKey","total","idx","offset","getColor","name","fallback","SyncBadge","status","graphConnected","isListening","isSyncing","isConnected","label","jsxs","cn","jsx","VersionBadge","schema","version","entityCount","relCount","EntityDetailPanel","entity","onClose","desc","color","props","shared","embeddingTemplate","count","propsArray","k","v","e","XCircle","i","OntologyGraphView","entities","relations","layout","useMemo","nodeMap","cols","spacingX","spacingY","row","col","maxCol","maxRow","edges","r","from","to","Network","t","dx","dy","midX","midY","curveOffset","RelationBuilderInline","entityNames","onSave","onCancel","isPending","setSource","useState","setTarget","relName","setRelName","setDesc","formatted","handleSave","toast","Loader2","Plus","GraphOntology","tab","setTab","search","setSearch","newEntityName","setNewEntityName","showRelBuilder","setShowRelBuilder","selectedEntity","setSelectedEntity","useOntologySchema","stats","useOntologyStats","entitiesQ","useOntologyEntities","relationsQ","useOntologyRelations","suggestionsQ","useOntologySuggestions","workerQ","useOntologyWorkerStatus","complianceQ","useOntologyCompliance","changesQ","useOntologyChanges","diffQ","useOntologyDiff","unusedQ","useOntologyUnused","syncStatusQ","useOntologySyncStatus","jobsQ","useOntologyJobs","workerLogQ","useOntologyWorkerLog","inferenceRulesQ","useInferenceRules","inferenceStatsQ","useInferenceStats","embeddingsDashQ","useEmbeddingsDashboard","sharedQ","useSharedOntology","versionsQ","useOntologyVersions","approve","useOntologyApproveSuggestion","reject","useOntologyRejectSuggestion","enrichSuggestion","useOntologyEnrichSuggestion","addEntity","useOntologyAddEntityType","addRelation","useOntologyAddRelationType","triggerWorker","useOntologyWorkerTrigger","forceSync","useOntologyForceSync","autoApprove","useOntologyAutoApprove","analyzeGraph","useOntologyAnalyzeGraph","cleanup","useOntologyCleanup","inferRels","useOntologyInferRelationships","toggleJob","useOntologyToggleJob","extractFromGraph","useOntologyExtractFromGraph","mergeOntology","useOntologyMerge","runInference","useRunInferenceRule","regenEmbeddings","useRegenerateEmbeddings","toggleShared","useToggleEntityShared","validateEntity","useValidateEntity","extractFromText","useExtractFromText","enrichEntity","useEnrichEntity","validateType","setValidateType","validateJson","setValidateJson","extractText","setExtractText","enrichType","setEnrichType","enrichJson","setEnrichJson","suggestions","statsData","worker","compliance","complianceIssues","complianceScore","changes","diff","unused","unusedEntities","unusedRelations","syncStatusData","jobs","workerLog","schemaData","inferenceRules","inferenceCyphers","inferenceStatsData","availableInferenceRules","embeddingSummary","embeddingCoverage","sharedEntities","crossGraphRelations","versionsData","versionHistory","searchLower","filteredEntities","filteredRelations","pendingSuggestions","handleAddEntity","handleAddRelation","data","tabs","Cpu","Sparkles","BarChart3","Wrench","Zap","Brain","Layers","Settings","History","Activity","RefreshCw","Icon","Search","Fragment","propsArr","p","j","Eye","Wand2","sType","reason","confidence","enrichment","uc","CheckCircle","key","val","maxCount","x","Shield","AlertTriangle","issue","Download","d","notInSchema","Merge","Trash2","Clock","job","enabled","interval","lastRun","jobStatus","totalRuns","Play","entry","jobType","started","duration","error","c","changeType","targetName","changedAt","isAdd","isRemove","rule","cypher","Info","coverage","withEmb","isShared","parsed","err","FileText","ent","rel"],"mappings":"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","x_google_ignoreList":[0,1,2,3]}
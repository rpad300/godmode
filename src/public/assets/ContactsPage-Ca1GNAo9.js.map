{"version":3,"file":"ContactsPage-Ca1GNAo9.js","sources":["../../../node_modules/lucide-react/dist/esm/icons/file-spreadsheet.js","../../../node_modules/lucide-react/dist/esm/icons/linkedin.js","../../../node_modules/lucide-react/dist/esm/icons/map-pin.js","../../../node_modules/lucide-react/dist/esm/icons/phone.js","../../../node_modules/lucide-react/dist/esm/icons/sticky-note.js","../../frontend/src/components/ui/label.tsx","../../frontend/src/components/ui/textarea.tsx","../../frontend/src/components/contacts/ContactForm.tsx","../../frontend/src/components/contacts/ContactDetail.tsx","../../frontend/src/pages/ContactsPage.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.564.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z\",\n      key: \"1oefj6\"\n    }\n  ],\n  [\"path\", { d: \"M14 2v5a1 1 0 0 0 1 1h5\", key: \"wfsgrz\" }],\n  [\"path\", { d: \"M8 13h2\", key: \"yr2amv\" }],\n  [\"path\", { d: \"M14 13h2\", key: \"un5t4a\" }],\n  [\"path\", { d: \"M8 17h2\", key: \"2yhykz\" }],\n  [\"path\", { d: \"M14 17h2\", key: \"10kma7\" }]\n];\nconst FileSpreadsheet = createLucideIcon(\"file-spreadsheet\", __iconNode);\n\nexport { __iconNode, FileSpreadsheet as default };\n//# sourceMappingURL=file-spreadsheet.js.map\n","/**\n * @license lucide-react v0.564.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z\",\n      key: \"c2jq9f\"\n    }\n  ],\n  [\"rect\", { width: \"4\", height: \"12\", x: \"2\", y: \"9\", key: \"mk3on5\" }],\n  [\"circle\", { cx: \"4\", cy: \"4\", r: \"2\", key: \"bt5ra8\" }]\n];\nconst Linkedin = createLucideIcon(\"linkedin\", __iconNode);\n\nexport { __iconNode, Linkedin as default };\n//# sourceMappingURL=linkedin.js.map\n","/**\n * @license lucide-react v0.564.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0\",\n      key: \"1r0f0z\"\n    }\n  ],\n  [\"circle\", { cx: \"12\", cy: \"10\", r: \"3\", key: \"ilqhr7\" }]\n];\nconst MapPin = createLucideIcon(\"map-pin\", __iconNode);\n\nexport { __iconNode, MapPin as default };\n//# sourceMappingURL=map-pin.js.map\n","/**\n * @license lucide-react v0.564.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384\",\n      key: \"9njp5v\"\n    }\n  ]\n];\nconst Phone = createLucideIcon(\"phone\", __iconNode);\n\nexport { __iconNode, Phone as default };\n//# sourceMappingURL=phone.js.map\n","/**\n * @license lucide-react v0.564.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M21 9a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 15 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2z\",\n      key: \"1dfntj\"\n    }\n  ],\n  [\"path\", { d: \"M15 3v5a1 1 0 0 0 1 1h5\", key: \"6s6qgf\" }]\n];\nconst StickyNote = createLucideIcon(\"sticky-note\", __iconNode);\n\nexport { __iconNode, StickyNote as default };\n//# sourceMappingURL=sticky-note.js.map\n","import * as React from \"react\";\r\nimport * as LabelPrimitive from \"@radix-ui/react-label\";\r\nimport { cva, type VariantProps } from \"class-variance-authority\";\r\n\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nconst labelVariants = cva(\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\");\r\n\r\nconst Label = React.forwardRef<\r\n  React.ElementRef<typeof LabelPrimitive.Root>,\r\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> & VariantProps<typeof labelVariants>\r\n>(({ className, ...props }, ref) => (\r\n  <LabelPrimitive.Root ref={ref} className={cn(labelVariants(), className)} {...props} />\r\n));\r\nLabel.displayName = LabelPrimitive.Root.displayName;\r\n\r\nexport { Label };\r\n","import * as React from \"react\";\r\n\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nexport interface TextareaProps extends React.TextareaHTMLAttributes<HTMLTextAreaElement> {}\r\n\r\nconst Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(({ className, ...props }, ref) => {\r\n  return (\r\n    <textarea\r\n      className={cn(\r\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\r\n        className,\r\n      )}\r\n      ref={ref}\r\n      {...props}\r\n    />\r\n  );\r\n});\r\nTextarea.displayName = \"Textarea\";\r\n\r\nexport { Textarea };\r\n","/**\r\n * Purpose:\r\n *   Reusable form component for creating or editing a contact, with\r\n *   dynamically loaded role templates, timezone options, and company names.\r\n *\r\n * Responsibilities:\r\n *   - Fetches role templates, timezones, and companies from the API on\r\n *     mount to populate Select dropdowns\r\n *   - Pre-fills all fields when editing an existing contact\r\n *   - Alias management: add/remove alternative names with Enter-key\r\n *     shortcut\r\n *   - Field sub-component for consistent icon+label+input rendering\r\n *   - Validates that name and role are non-empty before submission\r\n *\r\n * Key dependencies:\r\n *   - apiClient: fetches /api/role-templates, /api/timezones,\r\n *     /api/contacts/metadata/companies\r\n *   - Contact (godmode types): contact data shape\r\n *\r\n * Side effects:\r\n *   - Network: three GET requests on mount for metadata\r\n *\r\n * Notes:\r\n *   - The useEffect that fetches metadata and sets form state from the\r\n *     contact prop has `[contact]` as its dependency, meaning metadata\r\n *     will be re-fetched when the contact changes. Consider separating\r\n *     the metadata fetch (run once) from the form initialization.\r\n *   - Organization field defaults to \"Unknown\" when empty on submit.\r\n */\r\nimport { useState, useEffect } from 'react';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Plus, Save, User, Briefcase, Mail, Phone, Building2, Linkedin, MapPin, Clock, Image, StickyNote } from 'lucide-react';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\r\nimport { cn, resolveAvatarUrl } from \"@/lib/utils\";\r\nimport { apiClient } from '@/lib/api-client';\r\nimport type { Contact } from '@/types/godmode';\r\n\r\ninterface ContactFormProps {\r\n  contact?: Contact | null;\r\n  onSubmit: (data: Omit<Contact, 'id' | 'mentionCount'>) => void;\r\n  onCancel: () => void;\r\n  mode: 'add' | 'edit';\r\n}\r\n\r\ninterface RoleTemplate {\r\n  id: string;\r\n  display_name: string;\r\n  name: string;\r\n}\r\n\r\ninterface Timezone {\r\n  id: string;\r\n  name: string;\r\n  code: string;\r\n}\r\n\r\ninterface Company {\r\n  id: string;\r\n  name: string;\r\n}\r\n\r\nconst ContactForm = ({ contact, onSubmit, onCancel, mode }: ContactFormProps) => {\r\n  const [form, setForm] = useState({\r\n    name: '',\r\n    role: '',\r\n    organization: '',\r\n    email: '',\r\n    phone: '',\r\n    linkedin: '',\r\n    avatarUrl: '',\r\n    department: '',\r\n    location: '',\r\n    timezone: '',\r\n    notes: '',\r\n    aliases: [] as string[],\r\n  });\r\n  const [newAlias, setNewAlias] = useState('');\r\n\r\n  // Data sources\r\n  const [roleTemplates, setRoleTemplates] = useState<RoleTemplate[]>([]);\r\n  const [timezones, setTimezones] = useState<Timezone[]>([]);\r\n  const [companies, setCompanies] = useState<Company[]>([]);\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const [rolesData, timezonesData, companiesData] = await Promise.all([\r\n          apiClient.get<{ roles: RoleTemplate[] }>('/api/role-templates'),\r\n          apiClient.get<{ timezones: Timezone[] }>('/api/timezones'),\r\n          apiClient.get<{ companies: Company[] }>('/api/contacts/metadata/companies')\r\n        ]);\r\n\r\n        // Handle different response structures if needed\r\n        // Handle different response structures if needed\r\n        const roles = rolesData.roles || [];\r\n        const tzs = timezonesData.timezones || [];\r\n        const comps = companiesData.companies || [];\r\n\r\n        setRoleTemplates(roles);\r\n        setTimezones(tzs);\r\n        setCompanies(comps);\r\n      } catch (err) {\r\n        console.error('Failed to load metadata', err);\r\n      }\r\n    };\r\n    fetchData();\r\n\r\n    if (contact) {\r\n      setForm({\r\n        name: contact.name,\r\n        role: contact.role,\r\n        organization: contact.organization,\r\n        email: contact.email || '',\r\n        phone: contact.phone || '',\r\n        linkedin: contact.linkedin || '',\r\n        avatarUrl: resolveAvatarUrl(contact as any) || '',\r\n        department: contact.department || '',\r\n        location: contact.location || '',\r\n        timezone: contact.timezone || '',\r\n        notes: contact.notes || '',\r\n        aliases: contact.aliases || [],\r\n      });\r\n    }\r\n  }, [contact]);\r\n\r\n  const handleSubmit = () => {\r\n    if (!form.name.trim() || !form.role.trim()) return;\r\n    onSubmit({\r\n      name: form.name.trim(),\r\n      role: form.role.trim(),\r\n      organization: form.organization.trim() || 'Unknown',\r\n      email: form.email.trim() || undefined,\r\n      phone: form.phone.trim() || undefined,\r\n      linkedin: form.linkedin.trim() || undefined,\r\n      avatarUrl: form.avatarUrl.trim() || undefined,\r\n      department: form.department.trim() || undefined,\r\n      location: form.location.trim() || undefined,\r\n      timezone: form.timezone.trim() || undefined,\r\n      notes: form.notes.trim() || undefined,\r\n      aliases: form.aliases,\r\n    });\r\n  };\r\n\r\n  const update = (field: string, value: any) =>\r\n    setForm(prev => ({ ...prev, [field]: value }));\r\n\r\n  const addAlias = () => {\r\n    if (newAlias.trim() && !form.aliases.includes(newAlias.trim())) {\r\n      setForm(prev => ({ ...prev, aliases: [...prev.aliases, newAlias.trim()] }));\r\n      setNewAlias('');\r\n    }\r\n  };\r\n\r\n  const removeAlias = (alias: string) => {\r\n    setForm(prev => ({ ...prev, aliases: prev.aliases.filter(a => a !== alias) }));\r\n  };\r\n\r\n  const Field = ({ icon: Icon, label, id, placeholder, value, type = 'text', required = false }: {\r\n    icon: React.ElementType; label: string; id: string; placeholder: string; value: string; type?: string; required?: boolean;\r\n  }) => (\r\n    <div>\r\n      <Label htmlFor={id} className=\"flex items-center gap-1.5 text-xs text-muted-foreground mb-1.5\">\r\n        <Icon className=\"w-3.5 h-3.5\" /> {label} {required && '*'}\r\n      </Label>\r\n      <Input id={id} type={type} placeholder={placeholder} value={value} onChange={e => update(id, e.target.value)} />\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div className=\"space-y-4 mt-2\">\r\n      <div className=\"grid grid-cols-2 gap-x-4 gap-y-3\">\r\n        <div className=\"col-span-2 sm:col-span-1\">\r\n          <Field icon={User} label=\"Name\" id=\"name\" placeholder=\"Full name\" value={form.name} required />\r\n        </div>\r\n\r\n        {/* Role Selection */}\r\n        <div className=\"col-span-2 sm:col-span-1\">\r\n          <Label className=\"flex items-center gap-1.5 text-xs text-muted-foreground mb-1.5\">\r\n            <Briefcase className=\"w-3.5 h-3.5\" /> Role *\r\n          </Label>\r\n          <Select\r\n            value={form.role}\r\n            onValueChange={(val) => update('role', val)}\r\n          >\r\n            <SelectTrigger className=\"w-full\">\r\n              <SelectValue placeholder=\"Select role...\" />\r\n            </SelectTrigger>\r\n            <SelectContent>\r\n              {roleTemplates\r\n                .filter(r => r && (r.name || r.display_name))\r\n                .map((role) => (\r\n                  <SelectItem\r\n                    key={role.id || role.name}\r\n                    value={role.display_name || role.name || \"Unknown\"}\r\n                  >\r\n                    {role.display_name || role.name || \"Unknown Role\"}\r\n                  </SelectItem>\r\n                ))}\r\n            </SelectContent>\r\n          </Select>\r\n        </div>\r\n\r\n        <Field icon={Mail} label=\"Email\" id=\"email\" placeholder=\"email@example.com\" value={form.email} type=\"email\" />\r\n        <Field icon={Phone} label=\"Phone\" id=\"phone\" placeholder=\"+351 900 000 000\" value={form.phone} type=\"tel\" />\r\n\r\n        {/* Organization Selection */}\r\n        <div className=\"col-span-2 sm:col-span-1\">\r\n          <Label className=\"flex items-center gap-1.5 text-xs text-muted-foreground mb-1.5\">\r\n            <Building2 className=\"w-3.5 h-3.5\" /> Organization\r\n          </Label>\r\n          <Select\r\n            value={form.organization}\r\n            onValueChange={(val) => update('organization', val)}\r\n          >\r\n            <SelectTrigger className=\"w-full\">\r\n              <SelectValue placeholder=\"Select organization...\" />\r\n            </SelectTrigger>\r\n            <SelectContent>\r\n              {companies\r\n                .filter(c => c && c.name)\r\n                .map((company) => (\r\n                  <SelectItem\r\n                    key={company.id || company.name}\r\n                    value={company.name || \"Unknown\"}\r\n                  >\r\n                    {company.name || \"Unknown Company\"}\r\n                  </SelectItem>\r\n                ))}\r\n            </SelectContent>\r\n          </Select>\r\n        </div>\r\n\r\n        <Field icon={Linkedin} label=\"LinkedIn\" id=\"linkedin\" placeholder=\"https://linkedin.com/in/...\" value={form.linkedin} />\r\n\r\n        {/* Aliases Section */}\r\n        <div className=\"col-span-2\">\r\n          <Label className=\"flex items-center gap-1.5 text-xs text-muted-foreground mb-1.5\">\r\n            <User className=\"w-3.5 h-3.5\" /> Aliases\r\n          </Label>\r\n          <div className=\"flex gap-2 mb-2\">\r\n            <Input\r\n              value={newAlias}\r\n              onChange={e => setNewAlias(e.target.value)}\r\n              placeholder=\"Add alias (e.g. nickname, alternate name)\"\r\n              onKeyDown={e => e.key === 'Enter' && (e.preventDefault(), addAlias())}\r\n            />\r\n            <Button type=\"button\" size=\"sm\" onClick={addAlias} variant=\"secondary\">Add</Button>\r\n          </div>\r\n          {form.aliases.length > 0 && (\r\n            <div className=\"flex flex-wrap gap-2\">\r\n              {form.aliases.map(alias => (\r\n                <span key={alias} className=\"inline-flex items-center gap-1 px-2 py-1 rounded bg-secondary text-xs\">\r\n                  {alias}\r\n                  <button onClick={() => removeAlias(alias)} className=\"hover:text-destructive\">&times;</button>\r\n                </span>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"col-span-2\">\r\n          <Field icon={Image} label=\"Avatar URL\" id=\"avatarUrl\" placeholder=\"https://...\" value={form.avatarUrl} />\r\n          {!form.avatarUrl && (\r\n            <p className=\"text-[10px] text-muted-foreground mt-1\">Enter a URL to set the contact's profile picture</p>\r\n          )}\r\n        </div>\r\n        <Field icon={Briefcase} label=\"Department\" id=\"department\" placeholder=\"Engineering, Sales, etc.\" value={form.department} />\r\n        <Field icon={MapPin} label=\"Location\" id=\"location\" placeholder=\"e.g. Lisbon, Portugal\" value={form.location} />\r\n\r\n        {/* Timezone Selection */}\r\n        <div className=\"col-span-2 sm:col-span-1\">\r\n          <Label className=\"flex items-center gap-1.5 text-xs text-muted-foreground mb-1.5\">\r\n            <Clock className=\"w-3.5 h-3.5\" /> Timezone\r\n          </Label>\r\n          <Select\r\n            value={form.timezone}\r\n            onValueChange={(val) => update('timezone', val)}\r\n          >\r\n            <SelectTrigger className=\"w-full\">\r\n              <SelectValue placeholder=\"Select timezone...\" />\r\n            </SelectTrigger>\r\n            <SelectContent>\r\n              {timezones\r\n                .filter(tz => tz && tz.name)\r\n                .map((tz) => (\r\n                  <SelectItem\r\n                    key={tz.id || tz.code || tz.name}\r\n                    value={tz.code || tz.name}\r\n                  >\r\n                    {tz.name || \"Unknown Timezone\"} ({tz.code})\r\n                  </SelectItem>\r\n                ))}\r\n            </SelectContent>\r\n          </Select>\r\n        </div>\r\n\r\n        <div className=\"col-span-2\">\r\n          <Label htmlFor=\"notes\" className=\"flex items-center gap-1.5 text-xs text-muted-foreground mb-1.5\">\r\n            <StickyNote className=\"w-3.5 h-3.5\" /> Notes\r\n          </Label>\r\n          <Textarea id=\"notes\" placeholder=\"Additional notes...\" value={form.notes} onChange={e => update('notes', e.target.value)} rows={2} />\r\n        </div>\r\n      </div>\r\n      <div className=\"flex gap-2 pt-1\">\r\n        <Button variant=\"outline\" onClick={onCancel} className=\"flex-1\">Cancel</Button>\r\n        <Button onClick={handleSubmit} disabled={!form.name.trim() || !form.role.trim()} className=\"flex-1 gap-1.5\">\r\n          {mode === 'add' ? <><Plus className=\"w-4 h-4\" /> Add Contact</> : <><Save className=\"w-4 h-4\" /> Save Changes</>}\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ContactForm;\r\n","import { useState, useEffect, useRef, useCallback } from 'react';\r\nimport {\r\n  User, FolderOpen, Users2, Clock, Building2, Mail, Phone, Linkedin,\r\n  MapPin, Globe, Briefcase, StickyNote, CheckCircle2, AlertTriangle,\r\n  Plus, Trash2, Sparkles, ArrowRight, MessageSquare, FileText,\r\n  Loader2, X, Link2 as LinkIcon, Pencil, ArrowLeft,\r\n} from 'lucide-react';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { apiClient } from '@/lib/api-client';\r\nimport { toast } from 'sonner';\r\nimport { useEnrichContact, useDeleteRelationship, useUnlinkParticipant } from '@/hooks/useGodMode';\r\nimport type { Contact, ContactRelationship, Project, ContactMention } from '@/types/godmode';\r\nimport { CommentsPanel } from '../shared/CommentsPanel';\r\nimport { AvatarUpload } from '../shared/AvatarUpload';\r\nimport { resolveAvatarUrl, getInitials } from '../../lib/utils';\r\n\r\nconst CARD = 'rounded-xl border border-[var(--gm-border-primary)] bg-[var(--gm-surface-primary)] shadow-[var(--shadow-sm)] transition-all duration-200';\r\nconst BTN_PRIMARY = 'inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg bg-[var(--gm-interactive-primary)] text-[var(--gm-text-on-brand)] hover:bg-[var(--gm-interactive-primary-hover)] shadow-sm transition-all duration-150 disabled:opacity-50';\r\nconst BTN_SECONDARY = 'inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg bg-[var(--gm-interactive-secondary)] text-[var(--gm-text-primary)] hover:bg-[var(--gm-interactive-secondary-hover)] border border-[var(--gm-border-primary)] transition-all duration-150';\r\nconst BTN_DANGER = 'inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg bg-[var(--color-danger-500)] text-white hover:bg-[var(--color-danger-600)] shadow-sm transition-all duration-150 disabled:opacity-50';\r\n\r\nconst avatarGradients = [\r\n  'from-rose-400 to-pink-500', 'from-violet-400 to-purple-500',\r\n  'from-blue-400 to-cyan-500', 'from-emerald-400 to-teal-500',\r\n  'from-amber-400 to-orange-500', 'from-fuchsia-400 to-pink-500',\r\n];\r\n\r\nconst getGradient = (name: string) => {\r\n  let hash = 0;\r\n  for (let i = 0; i < name.length; i++) hash = name.charCodeAt(i) + ((hash << 5) - hash);\r\n  return avatarGradients[Math.abs(hash) % avatarGradients.length];\r\n};\r\n\r\ntype ContactTab = 'info' | 'projects' | 'relations' | 'mentions' | 'activity';\r\n\r\ninterface ContactDetailProps {\r\n  contact: Contact;\r\n  onBack: () => void;\r\n  onEdit: (contact: Contact) => void;\r\n  onDelete: (contactId: string) => void;\r\n  onUpdateProjects?: (contactId: string, projectIds: string[], primaryProjectId: string | null) => void;\r\n}\r\n\r\ninterface DropdownOption { id: string; label: string; value: string; }\r\n\r\nconst contactTabs: { id: ContactTab; label: string; icon: React.ElementType }[] = [\r\n  { id: 'info', label: 'Info', icon: User },\r\n  { id: 'projects', label: 'Projects', icon: FolderOpen },\r\n  { id: 'relations', label: 'Relations', icon: Users2 },\r\n  { id: 'mentions', label: 'Mentions', icon: MessageSquare },\r\n  { id: 'activity', label: 'Activity', icon: Clock },\r\n];\r\n\r\nconst InfoRow = ({ icon: Icon, label, value }: { icon: React.ElementType; label: string; value?: string }) => {\r\n  if (!value) return null;\r\n  return (\r\n    <div className=\"grid grid-cols-[140px_1fr] gap-3 py-3 border-b border-[var(--gm-border-primary)] last:border-0\">\r\n      <div className=\"flex items-center gap-2 text-sm text-[var(--gm-text-tertiary)]\">\r\n        <Icon className=\"w-4 h-4 text-[var(--gm-accent-primary)]\" /> {label}\r\n      </div>\r\n      <p className=\"text-sm text-[var(--gm-text-primary)] break-all\">{value}</p>\r\n    </div>\r\n  );\r\n};\r\n\r\ninterface EditFieldProps {\r\n  icon: React.ElementType; label: string; field: string;\r\n  placeholder: string; value: string; onChange: (field: string, value: string) => void;\r\n}\r\n\r\nconst EditInputField = ({ icon: Icon, label, field, placeholder, value, onChange, type = 'text' }: EditFieldProps & { type?: string }) => (\r\n  <div className=\"grid grid-cols-[140px_1fr] gap-3 items-center\">\r\n    <div className=\"flex items-center gap-2 text-sm text-[var(--gm-text-tertiary)]\">\r\n      <Icon className=\"w-4 h-4 text-[var(--gm-accent-primary)]\" /> {label}\r\n    </div>\r\n    <Input value={value} onChange={e => onChange(field, e.target.value)} placeholder={placeholder} type={type} className=\"h-8 text-sm\" />\r\n  </div>\r\n);\r\n\r\nconst EditSelectField = ({ icon: Icon, label, field, placeholder, value, onChange, options }: EditFieldProps & { options: DropdownOption[] }) => {\r\n  const hasMatchingOption = options.some(o => o.value === value);\r\n  return (\r\n    <div className=\"grid grid-cols-[140px_1fr] gap-3 items-center\">\r\n      <div className=\"flex items-center gap-2 text-sm text-[var(--gm-text-tertiary)]\">\r\n        <Icon className=\"w-4 h-4 text-[var(--gm-accent-primary)]\" /> {label}\r\n      </div>\r\n      {options.length > 0 ? (\r\n        <Select value={hasMatchingOption ? value : undefined} onValueChange={v => onChange(field, v)}>\r\n          <SelectTrigger className=\"h-8 text-sm\"><SelectValue placeholder={value || placeholder} /></SelectTrigger>\r\n          <SelectContent>\r\n            {!hasMatchingOption && value && <SelectItem value={value}>{value}</SelectItem>}\r\n            {options.map(o => <SelectItem key={o.id} value={o.value}>{o.label}</SelectItem>)}\r\n          </SelectContent>\r\n        </Select>\r\n      ) : (\r\n        <Input value={value} onChange={e => onChange(field, e.target.value)} placeholder={placeholder} className=\"h-8 text-sm\" />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default function ContactDetail({ contact, onBack, onEdit, onDelete, onUpdateProjects }: ContactDetailProps) {\r\n  const [activeTab, setActiveTab] = useState<ContactTab>('info');\r\n  const [loading, setLoading] = useState(false);\r\n  const [isEditing, setIsEditing] = useState(false);\r\n  const [saving, setSaving] = useState(false);\r\n  const [confirmDelete, setConfirmDelete] = useState(false);\r\n  const [deleting, setDeleting] = useState(false);\r\n\r\n  const loadedContactId = useRef<string | null>(null);\r\n\r\n  const [editForm, setEditForm] = useState({\r\n    name: '', role: '', organization: '', email: '', phone: '',\r\n    linkedin: '', department: '', location: '', timezone: '', notes: '',\r\n  });\r\n\r\n  const [roleOptions, setRoleOptions] = useState<DropdownOption[]>([]);\r\n  const [companyOptions, setCompanyOptions] = useState<DropdownOption[]>([]);\r\n  const [timezoneOptions, setTimezoneOptions] = useState<DropdownOption[]>([]);\r\n\r\n  const [projects, setProjects] = useState<Project[]>([]);\r\n  const [assignedProjectIds, setAssignedProjectIds] = useState<string[]>([]);\r\n  const [primaryProjectId, setPrimaryProjectId] = useState<string | null>(null);\r\n  const [relations, setRelations] = useState<ContactRelationship[]>([]);\r\n  const [activity, setActivity] = useState<any[]>([]);\r\n  const [mentions, setMentions] = useState<ContactMention[]>([]);\r\n  const [allContacts, setAllContacts] = useState<Contact[]>([]);\r\n\r\n  const enrichContact = useEnrichContact();\r\n  const deleteRelationship = useDeleteRelationship();\r\n  const unlinkParticipant = useUnlinkParticipant();\r\n\r\n  const [showAddRelation, setShowAddRelation] = useState(false);\r\n  const [newRelTarget, setNewRelTarget] = useState('');\r\n  const [newRelType, setNewRelType] = useState('works_with');\r\n  const [mentionFilter, setMentionFilter] = useState<string | null>(null);\r\n  const [contactAvatarUrl, setContactAvatarUrl] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (loadedContactId.current === contact.id) return;\r\n    loadedContactId.current = contact.id;\r\n    setIsEditing(false);\r\n    setActiveTab('info');\r\n    setConfirmDelete(false);\r\n    setContactAvatarUrl(resolveAvatarUrl(contact as any));\r\n    loadData();\r\n    loadDropdownMetadata();\r\n  }, [contact.id]);\r\n\r\n  useEffect(() => {\r\n    setContactAvatarUrl(resolveAvatarUrl(contact as any));\r\n  }, [contact]);\r\n\r\n  const loadDropdownMetadata = useCallback(async () => {\r\n    try {\r\n      const [rolesData, timezonesData, companiesData] = await Promise.all([\r\n        apiClient.get<any>('/api/role-templates').catch(() => ({ roles: [] })),\r\n        apiClient.get<any>('/api/timezones').catch(() => ({ timezones: [] })),\r\n        apiClient.get<any>('/api/contacts/metadata/companies').catch(() => ({ companies: [] })),\r\n      ]);\r\n      setRoleOptions((rolesData.roles || []).filter((r: any) => r && (r.name || r.display_name)).map((r: any) => ({\r\n        id: r.id || r.name, label: r.display_name || r.name, value: r.display_name || r.name,\r\n      })));\r\n      setTimezoneOptions((timezonesData.timezones || []).filter((t: any) => t && t.name).map((t: any) => ({\r\n        id: t.id || t.code || t.name, label: `${t.name} (${t.code || ''})`, value: t.code || t.name,\r\n      })));\r\n      setCompanyOptions((companiesData.companies || []).filter((c: any) => c && c.name).map((c: any) => ({\r\n        id: c.id || c.name, label: c.name, value: c.name,\r\n      })));\r\n    } catch (err) {\r\n      console.error('Failed to load dropdown metadata', err);\r\n    }\r\n  }, []);\r\n\r\n  const enterEditMode = useCallback(() => {\r\n    setEditForm({\r\n      name: contact.name || '', role: contact.role || '', organization: contact.organization || '',\r\n      email: contact.email || '', phone: contact.phone || '', linkedin: contact.linkedin || '',\r\n      department: contact.department || '', location: contact.location || '',\r\n      timezone: contact.timezone || '', notes: contact.notes || '',\r\n    });\r\n    setIsEditing(true);\r\n    setActiveTab('info');\r\n  }, [contact]);\r\n\r\n  const handleSaveInline = useCallback(async () => {\r\n    if (!editForm.name.trim()) return;\r\n    setSaving(true);\r\n    try {\r\n      const resp = await apiClient.put<any>(`/api/contacts/${contact.id}`, editForm);\r\n      if (resp.ok === false) { toast.error(resp.error || 'Failed to save contact'); return; }\r\n      toast.success('Contact updated');\r\n      setIsEditing(false);\r\n      loadedContactId.current = null;\r\n      loadData();\r\n      loadDropdownMetadata();\r\n      onEdit({ ...contact, ...editForm });\r\n    } catch (err: any) {\r\n      toast.error(err?.message || 'Failed to save contact');\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  }, [contact, editForm, onEdit, loadDropdownMetadata]);\r\n\r\n  const updateField = (field: string, value: string) =>\r\n    setEditForm(prev => ({ ...prev, [field]: value }));\r\n\r\n  const loadData = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const [projectsData, assignedData, relsData, activityData] = await Promise.all([\r\n        apiClient.get<any>('/api/projects').catch(() => ({ projects: [] })),\r\n        apiClient.get<any>(`/api/contacts/${contact.id}/projects`).catch(() => ({ projects: [] })),\r\n        apiClient.get<any>(`/api/contacts/${contact.id}/relationships`).catch(() => ({ relationships: [] })),\r\n        apiClient.get<any>(`/api/contacts/${contact.id}/activity`).catch(() => ({ activities: [] })),\r\n      ]);\r\n      setProjects(Array.isArray(projectsData) ? projectsData : (projectsData.projects || []));\r\n      const assigned = assignedData.projects || [];\r\n      const assignedIds = assigned.map((p: any) => p.id);\r\n      setAssignedProjectIds(assignedIds);\r\n      const primary = assigned.find((p: any) => p.is_primary);\r\n      setPrimaryProjectId(primary ? primary.id : (assignedIds[0] || null));\r\n      setRelations(relsData.relationships || []);\r\n      setActivity(activityData.activities || []);\r\n      try { const mentionsData = await apiClient.get<any>(`/api/contacts/${contact.id}/mentions`); setMentions(mentionsData.mentions || []); } catch { setMentions([]); }\r\n      try { const contactsResp = await apiClient.get<any>('/api/contacts'); setAllContacts((contactsResp.contacts || []).filter((c: Contact) => c.id !== contact.id)); } catch { setAllContacts([]); }\r\n    } catch (err) {\r\n      console.error('Error loading contact details:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const toggleProject = async (projectId: string) => {\r\n    const isAssigned = assignedProjectIds.includes(projectId);\r\n    try {\r\n      if (isAssigned) {\r\n        await apiClient.delete(`/api/contacts/${contact.id}/projects/${projectId}`);\r\n        const newIds = assignedProjectIds.filter(id => id !== projectId);\r\n        const newPrimary = primaryProjectId === projectId ? null : primaryProjectId;\r\n        setAssignedProjectIds(newIds);\r\n        setPrimaryProjectId(newPrimary);\r\n        onUpdateProjects?.(contact.id, newIds, newPrimary);\r\n      } else {\r\n        await apiClient.post(`/api/contacts/${contact.id}/projects`, { projectId });\r\n        const newIds = [...assignedProjectIds, projectId];\r\n        const newPrimary = primaryProjectId || projectId;\r\n        setAssignedProjectIds(newIds);\r\n        setPrimaryProjectId(newPrimary);\r\n        onUpdateProjects?.(contact.id, newIds, newPrimary);\r\n      }\r\n    } catch (err) {\r\n      console.error('Error toggling project:', err);\r\n    }\r\n  };\r\n\r\n  const setPrimary = async (projectId: string) => {\r\n    try {\r\n      await apiClient.post(`/api/contacts/${contact.id}/projects`, { projectId, isPrimary: true });\r\n      if (!assignedProjectIds.includes(projectId)) {\r\n        setAssignedProjectIds(prev => [...prev, projectId]);\r\n      }\r\n      setPrimaryProjectId(projectId);\r\n    } catch (err) {\r\n      console.error('Error setting primary project', err);\r\n    }\r\n  };\r\n\r\n  const handleAddRelationship = async () => {\r\n    if (!newRelTarget) return;\r\n    try {\r\n      const targetContact = allContacts.find(c => c.id === newRelTarget);\r\n      if (!targetContact) return;\r\n      const response = await apiClient.post<{ relationship: ContactRelationship }>(`/api/contacts/${contact.id}/relationships`, {\r\n        toContactId: targetContact.id, type: newRelType,\r\n      });\r\n      const newRel = response.relationship;\r\n      setRelations(prev => [...prev, {\r\n        id: newRel.id, type: newRelType, direction: 'forward',\r\n        other_contact: { id: targetContact.id, name: targetContact.name, role: targetContact.role, avatarUrl: targetContact.avatarUrl },\r\n      } as ContactRelationship]);\r\n      setNewRelTarget('');\r\n      setShowAddRelation(false);\r\n    } catch (err) {\r\n      console.error('Error adding relationship:', err);\r\n    }\r\n  };\r\n\r\n  const tabCounts: Record<ContactTab, number | undefined> = {\r\n    info: undefined,\r\n    projects: assignedProjectIds.length,\r\n    relations: relations.length,\r\n    mentions: mentions.length,\r\n    activity: activity.length > 0 ? activity.length : undefined,\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-4\">\r\n      {/* Back link */}\r\n      <button onClick={onBack} className=\"flex items-center gap-1.5 text-xs text-[var(--gm-text-tertiary)] hover:text-[var(--gm-text-primary)] transition-colors mb-2\">\r\n        <ArrowLeft className=\"w-3.5 h-3.5\" /> Back to Contacts\r\n      </button>\r\n\r\n      {/* Header */}\r\n      <div className={CARD}>\r\n        <div className={`bg-gradient-to-r ${getGradient(contact.name)} p-6 pb-14 rounded-t-xl relative`}>\r\n          <div className=\"flex gap-2 absolute top-4 right-4\">\r\n            <button className={BTN_SECONDARY + ' !bg-white/20 !text-white !border-0 hover:!bg-white/30 backdrop-blur-sm'}\r\n              disabled={enrichContact.isPending}\r\n              onClick={() => {\r\n                enrichContact.mutate(contact.id, {\r\n                  onSuccess: (data: any) => {\r\n                    toast.success('AI enrichment complete');\r\n                    if (data?.suggestions) {\r\n                      const s = data.suggestions;\r\n                      const fields: string[] = [];\r\n                      if (s.role) fields.push(`Role: ${s.role}`);\r\n                      if (s.department) fields.push(`Dept: ${s.department}`);\r\n                      if (s.tags) fields.push(`Tags: ${(s.tags as string[]).join(', ')}`);\r\n                      if (fields.length) toast.info(fields.join(' | '));\r\n                    }\r\n                    loadedContactId.current = null;\r\n                    loadData();\r\n                  },\r\n                  onError: () => toast.error('Enrichment failed'),\r\n                });\r\n              }}>\r\n              {enrichContact.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Sparkles className=\"w-3.5 h-3.5\" />} Enrich AI\r\n            </button>\r\n            <button className={BTN_SECONDARY + ' !bg-white/20 !text-white !border-0 hover:!bg-white/30 backdrop-blur-sm'}\r\n              disabled={unlinkParticipant.isPending}\r\n              onClick={() => {\r\n                const name = contact.display_name || contact.name || '';\r\n                if (!name) { toast.error('No participant name to unlink'); return; }\r\n                unlinkParticipant.mutate(name, {\r\n                  onSuccess: () => toast.success(`Unlinked participant \"${name}\"`),\r\n                  onError: () => toast.error('Unlink failed'),\r\n                });\r\n              }}>\r\n              {unlinkParticipant.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <LinkIcon className=\"w-3.5 h-3.5\" />} Unlink\r\n            </button>\r\n            <button\r\n              className={BTN_SECONDARY + ` !border-0 backdrop-blur-sm ${isEditing ? '!bg-blue-500/40 !text-white hover:!bg-blue-500/50' : '!bg-white/20 !text-white hover:!bg-white/30'}`}\r\n              onClick={isEditing ? () => setIsEditing(false) : enterEditMode}>\r\n              <Pencil className=\"w-3.5 h-3.5\" /> {isEditing ? 'View' : 'Edit'}\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"px-6 -mt-10 relative z-10\">\r\n          <div className=\"flex items-end gap-4\">\r\n            <AvatarUpload\r\n              currentUrl={contactAvatarUrl} name={contact.name}\r\n              uploadEndpoint={`/api/contacts/${contact.id}/avatar`}\r\n              deleteEndpoint={`/api/contacts/${contact.id}/avatar`}\r\n              onUploaded={(url) => setContactAvatarUrl(url)}\r\n              onRemoved={() => setContactAvatarUrl(null)}\r\n              size=\"md\" showUrlInput={false} className=\"!gap-0\"\r\n            />\r\n            <div className=\"pb-1\">\r\n              <h2 className=\"text-xl font-bold text-white\">{isEditing ? (editForm.name || contact.name) : contact.name || '(unnamed)'}</h2>\r\n              <p className=\"text-sm text-slate-300\">\r\n                {(isEditing ? editForm.role : contact.role) || '—'}\r\n                {(isEditing ? editForm.organization : contact.organization) && ` · ${isEditing ? editForm.organization : contact.organization}`}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Tabs */}\r\n        <div className=\"flex border-b border-[var(--gm-border-primary)] overflow-x-auto mt-4 px-6\">\r\n          {contactTabs.map(tab => (\r\n            <button key={tab.id} onClick={() => setActiveTab(tab.id)}\r\n              className={`flex items-center gap-1.5 px-3 py-2.5 text-xs font-medium transition-colors border-b-2 whitespace-nowrap ${activeTab === tab.id\r\n                ? 'text-[var(--gm-accent-primary)] border-[var(--gm-accent-primary)]'\r\n                : 'text-[var(--gm-text-tertiary)] border-transparent hover:text-[var(--gm-text-primary)]'}`}>\r\n              <tab.icon className=\"w-4 h-4\" />\r\n              {tab.label}\r\n              {tabCounts[tab.id] !== undefined && (\r\n                <span className=\"ml-1 text-[10px] px-1.5 py-0.5 rounded-full bg-[var(--gm-accent-primary)]/10 text-[var(--gm-accent-primary)] font-semibold\">\r\n                  {tabCounts[tab.id]}\r\n                </span>\r\n              )}\r\n            </button>\r\n          ))}\r\n        </div>\r\n\r\n        {/* Loading state */}\r\n        {loading && (\r\n          <div className=\"flex items-center justify-center py-12\">\r\n            <Loader2 className=\"w-6 h-6 animate-spin text-[var(--gm-accent-primary)]\" />\r\n          </div>\r\n        )}\r\n\r\n        {/* Tab content */}\r\n        {!loading && (\r\n          <div className=\"p-6\">\r\n            {/* Info Tab */}\r\n            {activeTab === 'info' && (\r\n              <>\r\n                {isEditing ? (\r\n                  <div className=\"space-y-3\">\r\n                    <EditInputField icon={User} label=\"Name *\" field=\"name\" placeholder=\"Full name\" value={editForm.name} onChange={updateField} />\r\n                    <EditSelectField icon={Briefcase} label=\"Role\" field=\"role\" options={roleOptions} placeholder=\"Select role...\" value={editForm.role} onChange={updateField} />\r\n                    <EditInputField icon={Mail} label=\"Email\" field=\"email\" placeholder=\"email@example.com\" type=\"email\" value={editForm.email} onChange={updateField} />\r\n                    <EditInputField icon={Phone} label=\"Phone\" field=\"phone\" placeholder=\"+351 900 000 000\" type=\"tel\" value={editForm.phone} onChange={updateField} />\r\n                    <EditSelectField icon={Building2} label=\"Organization\" field=\"organization\" options={companyOptions} placeholder=\"Select organization...\" value={editForm.organization} onChange={updateField} />\r\n                    <EditInputField icon={Linkedin} label=\"LinkedIn\" field=\"linkedin\" placeholder=\"https://linkedin.com/in/...\" value={editForm.linkedin} onChange={updateField} />\r\n                    <EditInputField icon={Briefcase} label=\"Department\" field=\"department\" placeholder=\"Engineering, Sales...\" value={editForm.department} onChange={updateField} />\r\n                    <EditInputField icon={MapPin} label=\"Location\" field=\"location\" placeholder=\"Lisbon, Portugal\" value={editForm.location} onChange={updateField} />\r\n                    <EditSelectField icon={Globe} label=\"Timezone\" field=\"timezone\" options={timezoneOptions} placeholder=\"Select timezone...\" value={editForm.timezone} onChange={updateField} />\r\n                    <div className=\"grid grid-cols-[140px_1fr] gap-3 items-start\">\r\n                      <div className=\"flex items-center gap-2 text-sm text-[var(--gm-text-tertiary)] pt-1.5\">\r\n                        <StickyNote className=\"w-4 h-4 text-[var(--gm-accent-primary)]\" /> Notes\r\n                      </div>\r\n                      <textarea value={editForm.notes} onChange={e => updateField('notes', e.target.value)}\r\n                        placeholder=\"Additional notes...\" rows={3}\r\n                        className=\"flex w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\" />\r\n                    </div>\r\n                    <div className=\"flex justify-end gap-2 pt-3\">\r\n                      <button className={BTN_SECONDARY} onClick={() => setIsEditing(false)}>Cancel</button>\r\n                      <button className={BTN_PRIMARY} disabled={saving || !editForm.name.trim()} onClick={handleSaveInline}>\r\n                        {saving ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <CheckCircle2 className=\"w-3.5 h-3.5\" />}\r\n                        {saving ? 'Saving...' : 'Save Changes'}\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                ) : (\r\n                  <div>\r\n                    <InfoRow icon={User} label=\"Name\" value={contact.name} />\r\n                    <InfoRow icon={Briefcase} label=\"Role\" value={contact.role} />\r\n                    <InfoRow icon={Mail} label=\"Email\" value={contact.email} />\r\n                    <InfoRow icon={Phone} label=\"Phone\" value={contact.phone} />\r\n                    <InfoRow icon={Building2} label=\"Organization\" value={contact.organization} />\r\n                    <InfoRow icon={Linkedin} label=\"LinkedIn\" value={contact.linkedin} />\r\n                    <InfoRow icon={Briefcase} label=\"Department\" value={contact.department} />\r\n                    <InfoRow icon={MapPin} label=\"Location\" value={contact.location} />\r\n                    <InfoRow icon={Globe} label=\"Timezone\" value={contact.timezone} />\r\n                    {contact.aliases && contact.aliases.length > 0 && (\r\n                      <div className=\"grid grid-cols-[140px_1fr] gap-3 py-3 border-b border-[var(--gm-border-primary)] last:border-0\">\r\n                        <div className=\"flex items-center gap-2 text-sm text-[var(--gm-text-tertiary)]\">\r\n                          <User className=\"w-4 h-4 text-[var(--gm-accent-primary)]\" /> Aliases\r\n                        </div>\r\n                        <div className=\"flex flex-wrap gap-1\">\r\n                          {contact.aliases.map(a => (\r\n                            <span key={a} className=\"text-xs px-1.5 py-0.5 bg-[var(--gm-bg-tertiary)] rounded text-[var(--gm-text-tertiary)]\">{a}</span>\r\n                          ))}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                    {contact.notes && <InfoRow icon={StickyNote} label=\"Notes\" value={contact.notes} />}\r\n                  </div>\r\n                )}\r\n              </>\r\n            )}\r\n\r\n            {/* Projects Tab */}\r\n            {activeTab === 'projects' && (\r\n              <div className=\"space-y-1\">\r\n                {projects.map((p) => {\r\n                  const isAssigned = assignedProjectIds.includes(p.id);\r\n                  const isPrimary = primaryProjectId === p.id;\r\n                  return (\r\n                    <div key={p.id} className=\"flex items-center justify-between py-3 border-b border-[var(--gm-border-primary)] last:border-0 hover:bg-[var(--gm-surface-hover)] px-2 rounded\">\r\n                      <div className=\"flex items-center gap-3 cursor-pointer flex-1\" onClick={() => toggleProject(p.id)}>\r\n                        <div className={`w-5 h-5 rounded border-2 flex items-center justify-center transition-colors ${isAssigned ? 'border-[var(--gm-accent-primary)] bg-[var(--gm-interactive-primary)]' : 'border-[var(--gm-border-primary)] hover:border-[var(--gm-text-tertiary)]'}`}>\r\n                          {isAssigned && <CheckCircle2 className=\"w-3 h-3 text-white\" />}\r\n                        </div>\r\n                        <div className=\"flex flex-col\">\r\n                          <span className={`text-sm ${isAssigned ? 'text-[var(--gm-text-primary)]' : 'text-[var(--gm-text-tertiary)]'}`}>{p.name}</span>\r\n                          {p.description && <span className=\"text-[10px] text-[var(--gm-text-tertiary)] truncate max-w-[300px]\">{p.description}</span>}\r\n                        </div>\r\n                      </div>\r\n                      {isPrimary ? (\r\n                        <span className=\"text-[10px] px-2 py-0.5 rounded bg-[var(--gm-interactive-primary)] text-[var(--gm-text-on-brand)] font-semibold\">Primary</span>\r\n                      ) : isAssigned ? (\r\n                        <button onClick={(e) => { e.stopPropagation(); setPrimary(p.id); }}\r\n                          className=\"text-[10px] px-2 py-0.5 rounded bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-tertiary)] hover:text-[var(--gm-text-primary)] transition-colors\">\r\n                          Set Primary\r\n                        </button>\r\n                      ) : null}\r\n                    </div>\r\n                  );\r\n                })}\r\n              </div>\r\n            )}\r\n\r\n            {/* Relations Tab */}\r\n            {activeTab === 'relations' && (\r\n              <>\r\n                {relations.length > 0 ? (\r\n                  <div className=\"space-y-2\">\r\n                    {relations.map((r, i) => {\r\n                      const label = (r.type || '').replace('_', ' ');\r\n                      const otherName = r.other_contact?.name || 'Unknown';\r\n                      return (\r\n                        <div key={i} className=\"flex items-center gap-3 py-3 border-b border-[var(--gm-border-primary)] last:border-0 group/rel\">\r\n                          <Users2 className=\"w-4 h-4 text-[var(--gm-text-tertiary)]\" />\r\n                          <div className=\"flex-1 flex items-center gap-2 text-sm\">\r\n                            <span className=\"font-medium text-[var(--gm-text-primary)]\">{contact.name}</span>\r\n                            <span className=\"text-[var(--gm-text-tertiary)] text-xs px-1 bg-[var(--gm-bg-tertiary)] rounded\">{label}</span>\r\n                            <span className=\"font-medium text-[var(--gm-text-primary)]\">{otherName}</span>\r\n                          </div>\r\n                          <button className=\"opacity-0 group-hover/rel:opacity-100 transition-opacity text-red-400/60 hover:text-red-400\"\r\n                            title=\"Remove relationship\"\r\n                            onClick={() => {\r\n                              if (!r.other_contact?.id) return;\r\n                              deleteRelationship.mutate(\r\n                                { contactId: contact.id, toContactId: r.other_contact.id, type: r.type },\r\n                                {\r\n                                  onSuccess: () => { setRelations(prev => prev.filter((_, idx) => idx !== i)); toast.success('Relationship removed'); },\r\n                                  onError: () => toast.error('Failed to remove relationship'),\r\n                                },\r\n                              );\r\n                            }}>\r\n                            <X className=\"w-3.5 h-3.5\" />\r\n                          </button>\r\n                        </div>\r\n                      );\r\n                    })}\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"flex flex-col items-center py-8 text-[var(--gm-text-tertiary)]\">\r\n                    <Users2 className=\"w-10 h-10 mb-2 opacity-40\" />\r\n                    <p className=\"text-sm\">No relationships yet</p>\r\n                  </div>\r\n                )}\r\n\r\n                {showAddRelation ? (\r\n                  <div className=\"mt-3 p-3 rounded-lg border border-[var(--gm-border-primary)] bg-[var(--gm-bg-tertiary)] space-y-3\">\r\n                    <div className=\"grid grid-cols-2 gap-2\">\r\n                      <Select value={newRelTarget} onValueChange={setNewRelTarget}>\r\n                        <SelectTrigger className=\"text-sm\"><SelectValue placeholder=\"Select contact\" /></SelectTrigger>\r\n                        <SelectContent>{allContacts.map(c => <SelectItem key={c.id} value={c.id}>{c.name}</SelectItem>)}</SelectContent>\r\n                      </Select>\r\n                      <Select value={newRelType} onValueChange={setNewRelType}>\r\n                        <SelectTrigger className=\"text-sm\"><SelectValue /></SelectTrigger>\r\n                        <SelectContent>\r\n                          <SelectItem value=\"reports_to\">Reports to</SelectItem>\r\n                          <SelectItem value=\"manages\">Manages</SelectItem>\r\n                          <SelectItem value=\"leads\">Leads</SelectItem>\r\n                          <SelectItem value=\"works_with\">Works with</SelectItem>\r\n                        </SelectContent>\r\n                      </Select>\r\n                    </div>\r\n                    <div className=\"flex gap-2\">\r\n                      <button className={BTN_SECONDARY + ' flex-1'} onClick={() => { setShowAddRelation(false); setNewRelTarget(''); }}>Cancel</button>\r\n                      <button className={BTN_PRIMARY + ' flex-1'} disabled={!newRelTarget} onClick={handleAddRelationship}>Add</button>\r\n                    </div>\r\n                  </div>\r\n                ) : (\r\n                  <button onClick={() => setShowAddRelation(true)} className=\"flex items-center gap-1.5 text-sm text-[var(--gm-text-tertiary)] hover:text-[var(--gm-text-primary)] mt-4 transition-colors\">\r\n                    <Plus className=\"w-4 h-4\" /> Add Relationship\r\n                  </button>\r\n                )}\r\n              </>\r\n            )}\r\n\r\n            {/* Mentions Tab */}\r\n            {activeTab === 'mentions' && (\r\n              <>\r\n                {mentions.length > 0 ? (\r\n                  <div className=\"space-y-4\">\r\n                    <div className=\"flex gap-2 pb-2 overflow-x-auto\">\r\n                      {['all', 'document', 'email', 'conversation'].map(type => (\r\n                        <button key={type} onClick={() => setMentionFilter(type === 'all' ? null : type)}\r\n                          className={`text-xs px-2.5 py-1 rounded-full border transition-colors ${(mentionFilter === type || (mentionFilter === null && type === 'all'))\r\n                            ? 'bg-[var(--gm-accent-primary)]/10 text-[var(--gm-accent-primary)] border-[var(--gm-accent-primary)]/20'\r\n                            : 'bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-tertiary)] border-transparent hover:bg-[var(--gm-surface-hover)] hover:text-[var(--gm-text-primary)]'}`}>\r\n                          {type.charAt(0).toUpperCase() + type.slice(1)}s\r\n                        </button>\r\n                      ))}\r\n                    </div>\r\n                    <div className=\"space-y-2 pr-2\">\r\n                      {mentions.filter(m => !mentionFilter || m.type === mentionFilter).map((mention) => (\r\n                        <div key={mention.id} className=\"flex gap-3 py-3 border-b border-[var(--gm-border-primary)] last:border-0 group\">\r\n                          <div className=\"mt-0.5\">\r\n                            {mention.type === 'email' ? <Mail className=\"w-3.5 h-3.5 text-blue-400\" /> :\r\n                              mention.type === 'conversation' ? <MessageSquare className=\"w-3.5 h-3.5 text-violet-400\" /> :\r\n                                <FileText className=\"w-3.5 h-3.5 text-amber-400\" />}\r\n                          </div>\r\n                          <div className=\"flex-1 space-y-1\">\r\n                            <div className=\"flex justify-between items-start\">\r\n                              <span className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">{mention.source || '—'}</span>\r\n                              <span className=\"text-[10px] text-[var(--gm-text-tertiary)] whitespace-nowrap ml-2\">\r\n                                {mention.date ? new Date(mention.date).toLocaleDateString() : '—'}\r\n                              </span>\r\n                            </div>\r\n                            <p className=\"text-sm text-[var(--gm-text-primary)] line-clamp-2 bg-[var(--gm-bg-tertiary)] p-2 rounded border border-[var(--gm-border-primary)] italic\">\r\n                              \"{mention.text}\"\r\n                            </p>\r\n                            {mention.link && (\r\n                              <a href={mention.link} target=\"_blank\" rel=\"noopener noreferrer\"\r\n                                className=\"text-xs text-[var(--gm-accent-primary)] hover:underline inline-flex items-center gap-1 mt-1 font-medium transition-colors\">\r\n                                View Context <ArrowRight className=\"w-3 h-3\" />\r\n                              </a>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                      ))}\r\n                      {mentions.filter(m => !mentionFilter || m.type === mentionFilter).length === 0 && (\r\n                        <p className=\"text-center text-sm text-[var(--gm-text-tertiary)] py-8\">No mentions found for this filter</p>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"flex flex-col items-center py-8 text-[var(--gm-text-tertiary)]\">\r\n                    <MessageSquare className=\"w-10 h-10 mb-2 opacity-40\" />\r\n                    <p className=\"text-sm\">No mentions found</p>\r\n                  </div>\r\n                )}\r\n              </>\r\n            )}\r\n\r\n            {/* Activity Tab */}\r\n            {activeTab === 'activity' && (\r\n              <>\r\n                {activity.length > 0 ? (\r\n                  <div className=\"space-y-2\">\r\n                    {activity.map((item) => (\r\n                      <div key={`${item.type}-${item.id}`} className=\"flex items-center gap-3 py-3 border-b border-[var(--gm-border-primary)] last:border-0\">\r\n                        {item.status === 'completed' || item.status === 'approved' ? (\r\n                          <CheckCircle2 className=\"w-4 h-4 text-emerald-500 shrink-0\" />\r\n                        ) : item.status === 'overdue' || item.status === 'rejected' ? (\r\n                          <AlertTriangle className=\"w-4 h-4 text-red-400 shrink-0\" />\r\n                        ) : (\r\n                          <Clock className=\"w-4 h-4 text-[var(--gm-text-tertiary)] shrink-0\" />\r\n                        )}\r\n                        <span className=\"text-sm text-[var(--gm-text-primary)] flex-1 truncate\">{item.description}</span>\r\n                        <span className=\"text-[10px] text-[var(--gm-text-tertiary)] shrink-0\">\r\n                          {item.date ? new Date(item.date).toLocaleDateString() : '—'}\r\n                        </span>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"flex flex-col items-center py-8 text-[var(--gm-text-tertiary)]\">\r\n                    <Clock className=\"w-10 h-10 mb-2 opacity-40\" />\r\n                    <p className=\"text-sm\">No activity recorded yet</p>\r\n                  </div>\r\n                )}\r\n              </>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Footer: Danger Zone */}\r\n        <div className=\"px-6 py-4 border-t border-[var(--gm-border-primary)]\">\r\n          <div className=\"p-4 rounded-lg border border-red-500/20 bg-red-500/5\">\r\n            <p className=\"text-xs font-semibold text-red-500 mb-1\">Danger Zone</p>\r\n            <p className=\"text-xs text-[var(--gm-text-tertiary)] mb-3\">Deleting this contact will remove all associated data.</p>\r\n            {!confirmDelete ? (\r\n              <button className={BTN_DANGER.replace('bg-[var(--color-danger-500)]', 'bg-red-500/10').replace('text-white', 'text-red-500') + ' border border-red-500/30'}\r\n                onClick={() => setConfirmDelete(true)}>\r\n                <Trash2 className=\"w-3.5 h-3.5\" /> Delete Contact\r\n              </button>\r\n            ) : (\r\n              <div className=\"flex items-center gap-2\">\r\n                <button className={BTN_DANGER} disabled={deleting} onClick={() => { setDeleting(true); onDelete(contact.id); }}>\r\n                  {deleting ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Trash2 className=\"w-3.5 h-3.5\" />} Confirm Delete\r\n                </button>\r\n                <button className={BTN_SECONDARY} onClick={() => setConfirmDelete(false)}>Cancel</button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Comments */}\r\n      <div className={CARD}>\r\n        <CommentsPanel targetType=\"contact\" targetId={contact.id} />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","/**\n * Purpose:\n *   Full CRUD management page for project contacts with favorites, filters,\n *   multi-select merge, duplicate detection, AI enrichment, import/export,\n *   and unmatched participant linking.\n *\n * Key dependencies:\n *   - useContacts / useCreateContact / useUpdateContact / useDeleteContact\n *   - useContactDuplicates / useMergeContacts / useEnrichContact\n *   - useExportContacts / useImportContacts\n *   - useUnmatchedParticipants / useLinkParticipant / useSyncPeopleToContacts\n *   - ContactForm / ContactDetail\n */\nimport { useState, useRef, useMemo } from 'react';\nimport {\n  Users, Search, Plus, Loader2, Mail, Phone, Building2,\n  Briefcase, X, Star, Filter, Download, Upload, Sparkles,\n  AlertTriangle, Merge, CheckSquare, Square, UserPlus, Link2, RefreshCw,\n  FileJson, FileSpreadsheet, ChevronDown,\n} from 'lucide-react';\nimport { toast } from 'sonner';\nimport {\n  useContacts, useCreateContact, useUpdateContact, useDeleteContact,\n  useContactDuplicates, useMergeContacts, useEnrichContact,\n  useExportContacts, useImportContacts,\n  useUnmatchedParticipants, useLinkParticipant, useSyncPeopleToContacts,\n} from '../hooks/useGodMode';\nimport ContactForm from '../components/contacts/ContactForm';\nimport ContactDetail from '../components/contacts/ContactDetail';\nimport { cn, isValidAvatarUrl, getInitials, resolveAvatarUrl } from '../lib/utils';\nimport type { Contact } from '../types/godmode';\n\nconst CARD = 'rounded-xl border border-[var(--gm-border-primary)] bg-[var(--gm-surface-primary)] shadow-[var(--shadow-sm)] transition-all duration-200';\nconst INPUT = 'w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] placeholder:text-[var(--gm-text-placeholder)] focus:outline-none focus:border-[var(--gm-border-focus)] focus:shadow-[var(--shadow-focus)] transition-all duration-150';\nconst BTN_PRIMARY = 'inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg bg-[var(--gm-interactive-primary)] text-[var(--gm-text-on-brand)] hover:bg-[var(--gm-interactive-primary-hover)] shadow-sm transition-all duration-150 disabled:opacity-50';\nconst BTN_SECONDARY = 'inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg bg-[var(--gm-interactive-secondary)] text-[var(--gm-text-primary)] hover:bg-[var(--gm-interactive-secondary-hover)] border border-[var(--gm-border-primary)] transition-all duration-150';\nconst SECTION_TITLE = 'text-[10px] font-bold text-[var(--gm-accent-primary)] uppercase tracking-[0.1em]';\nconst LABEL = 'text-[10px] font-bold text-[var(--gm-text-tertiary)] uppercase tracking-wider mb-1 flex items-center gap-1.5';\n\nconst avatarGradients = [\n  'from-rose-400 to-pink-500',\n  'from-violet-400 to-purple-500',\n  'from-blue-400 to-cyan-500',\n  'from-emerald-400 to-teal-500',\n  'from-amber-400 to-orange-500',\n  'from-fuchsia-400 to-pink-500',\n];\n\nconst getGradient = (name: string) => {\n  let hash = 0;\n  for (let i = 0; i < name.length; i++) hash = name.charCodeAt(i) + ((hash << 5) - hash);\n  return avatarGradients[Math.abs(hash) % avatarGradients.length];\n};\n\nfunction ContactAvatarImg({ contact, size = 'md' }: { contact: Record<string, unknown>; size?: 'sm' | 'md' | 'lg' }) {\n  const name = String(contact.name || '?');\n  const url = resolveAvatarUrl(contact);\n  const dim = size === 'sm' ? 'w-7 h-7' : size === 'lg' ? 'w-16 h-16' : 'w-10 h-10';\n  const textSz = size === 'sm' ? 'text-[9px]' : size === 'lg' ? 'text-lg' : 'text-xs';\n  return (\n    <div className={`${dim} rounded-full bg-gradient-to-br ${getGradient(name)} flex items-center justify-center flex-shrink-0 overflow-hidden`}>\n      {url ? (\n        <img src={url} alt={name} className=\"w-full h-full rounded-full object-cover\" onError={(e) => { (e.target as HTMLImageElement).style.display = 'none'; }} />\n      ) : (\n        <span className={`${textSz} font-bold text-white`}>{getInitials(name)}</span>\n      )}\n    </div>\n  );\n}\n\nexport default function ContactsPage() {\n  const [search, setSearch] = useState('');\n  const [showForm, setShowForm] = useState(false);\n  const [editContact, setEditContact] = useState<Contact | null>(null);\n  const [detailContact, setDetailContact] = useState<Contact | null>(null);\n\n  // Filters\n  const [orgFilter, setOrgFilter] = useState('');\n  const [tagFilter, setTagFilter] = useState('');\n  const [showFavoritesOnly, setShowFavoritesOnly] = useState(false);\n  const [showFilters, setShowFilters] = useState(false);\n\n  // Multi-select\n  const [selectedIds, setSelectedIds] = useState<Set<string>>(new Set());\n  const [selectMode, setSelectMode] = useState(false);\n\n  // Duplicates\n  const [showDuplicates, setShowDuplicates] = useState(false);\n  const [mergePrimary, setMergePrimary] = useState<Record<number, string>>({});\n\n  // Import\n  const [showImport, setShowImport] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Unmatched\n  const [showUnmatched, setShowUnmatched] = useState(false);\n  const [linkTarget, setLinkTarget] = useState<Record<string, string>>({});\n\n  // Queries & mutations\n  const contactsQuery = useContacts({ search: search || undefined, organization: orgFilter || undefined });\n  const createContact = useCreateContact();\n  const updateContact = useUpdateContact();\n  const deleteContact = useDeleteContact();\n  const duplicatesQuery = useContactDuplicates();\n  const mergeContacts = useMergeContacts();\n  const enrichContact = useEnrichContact();\n  const exportContacts = useExportContacts();\n  const importContacts = useImportContacts();\n  const unmatchedQuery = useUnmatchedParticipants();\n  const linkParticipant = useLinkParticipant();\n  const syncPeople = useSyncPeopleToContacts();\n\n  const rawData = contactsQuery.data;\n  const allContacts: Contact[] = Array.isArray(rawData)\n    ? rawData as unknown as Contact[]\n    : (rawData?.contacts as unknown as Contact[] ?? []);\n\n  // Derive org and tag lists for filter dropdowns\n  const organizations = useMemo(() => {\n    const orgs = new Set<string>();\n    allContacts.forEach(c => { if (c.organization) orgs.add(c.organization); });\n    return Array.from(orgs).sort();\n  }, [allContacts]);\n\n  const allTags = useMemo(() => {\n    const tags = new Set<string>();\n    allContacts.forEach(c => {\n      const ct = c.tags;\n      if (Array.isArray(ct)) ct.forEach((t: string) => tags.add(t));\n    });\n    return Array.from(tags).sort();\n  }, [allContacts]);\n\n  // Client-side filtering (tag, favorites) on top of API-side search/org filtering\n  const contacts = useMemo(() => {\n    let result = allContacts;\n    if (tagFilter) {\n      result = result.filter(c => {\n        return Array.isArray(c.tags) && c.tags.includes(tagFilter);\n      });\n    }\n    if (showFavoritesOnly) {\n      result = result.filter(c => c.is_favorite || c.isFavorite);\n    }\n    return result;\n  }, [allContacts, tagFilter, showFavoritesOnly]);\n\n  const favorites = useMemo(\n    () => allContacts.filter(c => c.is_favorite || c.isFavorite),\n    [allContacts]\n  );\n\n  const duplicates: any[] = (duplicatesQuery.data as any)?.duplicates || [];\n\n  const unmatched: { name: string; count?: number }[] = (unmatchedQuery.data as any)?.unmatched || [];\n\n  // Handlers\n  const handleCreate = (data: Omit<Contact, 'id' | 'mentionCount'>) => {\n    createContact.mutate(data as Record<string, unknown>, {\n      onSuccess: () => { toast.success('Contact created'); setShowForm(false); },\n      onError: () => toast.error('Failed to create contact'),\n    });\n  };\n\n  const handleUpdate = (data: Omit<Contact, 'id' | 'mentionCount'>) => {\n    if (!editContact) return;\n    updateContact.mutate({ id: editContact.id, ...data } as { id: string; [key: string]: unknown }, {\n      onSuccess: () => { toast.success('Contact updated'); setEditContact(null); setShowForm(false); },\n      onError: () => toast.error('Failed to update contact'),\n    });\n  };\n\n  const handleDelete = (id: string) => {\n    deleteContact.mutate(id, {\n      onSuccess: () => { toast.success('Contact deleted'); setDetailContact(null); },\n      onError: () => toast.error('Failed to delete contact'),\n    });\n  };\n\n  const handleEditFromDetail = (_contact: Contact) => {\n    // Refresh the contacts list to reflect inline edits from the detail modal\n    contactsQuery.refetch();\n  };\n\n  const toggleFavorite = (contact: Contact) => {\n    const isFav = contact.is_favorite || contact.isFavorite;\n    updateContact.mutate({ id: contact.id, is_favorite: !isFav } as { id: string; [key: string]: unknown }, {\n      onSuccess: () => toast.success(isFav ? 'Removed from favorites' : 'Added to favorites'),\n      onError: () => toast.error('Failed to update'),\n    });\n  };\n\n  const toggleSelect = (id: string) => {\n    setSelectedIds(prev => {\n      const next = new Set(prev);\n      if (next.has(id)) next.delete(id); else next.add(id);\n      return next;\n    });\n  };\n\n  const handleMergeSelected = () => {\n    if (selectedIds.size < 2) { toast.error('Select at least 2 contacts to merge'); return; }\n    mergeContacts.mutate(Array.from(selectedIds), {\n      onSuccess: () => { toast.success('Contacts merged'); setSelectedIds(new Set()); setSelectMode(false); },\n      onError: () => toast.error('Merge failed'),\n    });\n  };\n\n  const handleMergeDuplicateGroup = (groupIndex: number, group: any[]) => {\n    const primary = mergePrimary[groupIndex];\n    if (!primary) { toast.error('Select a primary contact'); return; }\n    const ids = group.map((c: any) => c.id);\n    mergeContacts.mutate(ids, {\n      onSuccess: () => { toast.success('Duplicates merged'); duplicatesQuery.refetch(); },\n      onError: () => toast.error('Merge failed'),\n    });\n  };\n\n  const handleEnrich = (id: string) => {\n    enrichContact.mutate(id, {\n      onSuccess: (data: any) => {\n        toast.success('AI enrichment complete');\n        if (data?.suggestions) {\n          const s = data.suggestions;\n          const fields: string[] = [];\n          if (s.role) fields.push(`Role: ${s.role}`);\n          if (s.department) fields.push(`Dept: ${s.department}`);\n          if (s.tags) fields.push(`Tags: ${(s.tags as string[]).join(', ')}`);\n          if (fields.length) toast.info(fields.join(' | '));\n        }\n        contactsQuery.refetch();\n      },\n      onError: () => toast.error('Enrichment failed'),\n    });\n  };\n\n  const handleImportFile = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n    const reader = new FileReader();\n    reader.onload = () => {\n      const text = reader.result as string;\n      const isCSV = file.name.endsWith('.csv');\n      if (isCSV) {\n        importContacts.mutate({ format: 'csv', data: text }, {\n          onSuccess: (r: any) => { toast.success(`Imported ${r?.added || 0} contacts`); setShowImport(false); },\n          onError: () => toast.error('Import failed'),\n        });\n      } else {\n        try {\n          const json = JSON.parse(text);\n          importContacts.mutate({ format: 'json', data: json }, {\n            onSuccess: (r: any) => { toast.success(`Imported ${r?.added || 0} contacts`); setShowImport(false); },\n            onError: () => toast.error('Import failed'),\n          });\n        } catch { toast.error('Invalid JSON file'); }\n      }\n    };\n    reader.readAsText(file);\n    e.target.value = '';\n  };\n\n  const handleLinkParticipant = (name: string, contactId: string) => {\n    linkParticipant.mutate({ participantName: name, contactId }, {\n      onSuccess: () => toast.success(`Linked \"${name}\"`),\n      onError: () => toast.error('Link failed'),\n    });\n  };\n\n  // Detail view (replaces list)\n  if (detailContact) {\n    return (\n      <ContactDetail\n        contact={detailContact}\n        onBack={() => setDetailContact(null)}\n        onEdit={handleEditFromDetail}\n        onDelete={handleDelete}\n      />\n    );\n  }\n\n  // Form view (add or edit)\n  if (showForm) {\n    return (\n      <div className=\"p-6 max-w-2xl\">\n        <div className=\"flex items-center gap-3 mb-4\">\n          <button\n            onClick={() => { setShowForm(false); setEditContact(null); }}\n            className=\"w-8 h-8 rounded-lg bg-[var(--gm-bg-tertiary)] flex items-center justify-center hover:bg-[var(--gm-surface-hover)]\"\n          >\n            <X className=\"w-4 h-4 text-[var(--gm-text-tertiary)]\" />\n          </button>\n          <h1 className=\"text-2xl font-bold text-[var(--gm-text-primary)]\">\n            {editContact ? 'Edit Contact' : 'Add Contact'}\n          </h1>\n        </div>\n        <div className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-5\">\n          <ContactForm\n            contact={editContact}\n            mode={editContact ? 'edit' : 'add'}\n            onSubmit={editContact ? handleUpdate : handleCreate}\n            onCancel={() => { setShowForm(false); setEditContact(null); }}\n          />\n        </div>\n      </div>\n    );\n  }\n\n  // Main list view\n  return (\n    <div className=\"p-6 space-y-4\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between flex-wrap gap-2\">\n        <h1 className=\"text-2xl font-bold text-[var(--gm-text-primary)]\">Contacts</h1>\n        <div className=\"flex items-center gap-2 flex-wrap\">\n          {/* Sync people */}\n          <button\n            onClick={() => syncPeople.mutate(undefined, {\n              onSuccess: (r: any) => toast.success(`Synced: ${r?.added || 0} added`),\n              onError: () => toast.error('Sync failed'),\n            })}\n            className=\"px-2.5 py-1.5 rounded-lg bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-tertiary)] text-xs hover:bg-[var(--gm-surface-hover)] flex items-center gap-1.5\"\n            title=\"Sync people from documents to contacts\"\n          >\n            <RefreshCw className={`w-3.5 h-3.5 ${syncPeople.isPending ? 'animate-spin' : ''}`} /> Sync People\n          </button>\n\n          {/* Unmatched */}\n          {unmatched.length > 0 && (\n            <button\n              onClick={() => setShowUnmatched(!showUnmatched)}\n              className=\"px-2.5 py-1.5 rounded-lg bg-amber-500/10 text-amber-600 text-xs hover:bg-amber-500/20 flex items-center gap-1.5\"\n            >\n              <UserPlus className=\"w-3.5 h-3.5\" /> {unmatched.length} Unmatched\n            </button>\n          )}\n\n          {/* Duplicates */}\n          {duplicates.length > 0 && (\n            <button\n              onClick={() => setShowDuplicates(!showDuplicates)}\n              className=\"px-2.5 py-1.5 rounded-lg bg-orange-500/10 text-orange-600 text-xs hover:bg-orange-500/20 flex items-center gap-1.5\"\n            >\n              <AlertTriangle className=\"w-3.5 h-3.5\" /> {duplicates.length} Duplicate groups\n            </button>\n          )}\n\n          {/* Select mode */}\n          <button\n            onClick={() => { setSelectMode(!selectMode); setSelectedIds(new Set()); }}\n            className={`px-2.5 py-1.5 rounded-lg text-xs flex items-center gap-1.5 ${selectMode ? 'bg-[var(--gm-interactive-primary)] text-[var(--gm-text-on-brand)]' : 'bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-tertiary)] hover:bg-[var(--gm-surface-hover)]'}`}\n          >\n            <CheckSquare className=\"w-3.5 h-3.5\" /> Select\n          </button>\n\n          {/* Export */}\n          <div className=\"relative group\">\n            <button className=\"px-2.5 py-1.5 rounded-lg bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-tertiary)] text-xs hover:bg-[var(--gm-surface-hover)] flex items-center gap-1.5\">\n              <Download className=\"w-3.5 h-3.5\" /> Export <ChevronDown className=\"w-3 h-3\" />\n            </button>\n            <div className=\"absolute right-0 top-full mt-1 bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-20 min-w-[120px]\">\n              <button onClick={() => exportContacts.mutate('json')} className=\"w-full px-3 py-2 text-xs text-left hover:bg-[var(--gm-surface-hover)] flex items-center gap-2 rounded-t-lg\">\n                <FileJson className=\"w-3.5 h-3.5\" /> JSON\n              </button>\n              <button onClick={() => exportContacts.mutate('csv')} className=\"w-full px-3 py-2 text-xs text-left hover:bg-[var(--gm-surface-hover)] flex items-center gap-2 rounded-b-lg\">\n                <FileSpreadsheet className=\"w-3.5 h-3.5\" /> CSV\n              </button>\n            </div>\n          </div>\n\n          {/* Import */}\n          <button\n            onClick={() => fileInputRef.current?.click()}\n            className=\"px-2.5 py-1.5 rounded-lg bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-tertiary)] text-xs hover:bg-[var(--gm-surface-hover)] flex items-center gap-1.5\"\n          >\n            <Upload className=\"w-3.5 h-3.5\" /> Import\n          </button>\n          <input ref={fileInputRef} type=\"file\" accept=\".json,.csv\" className=\"hidden\" onChange={handleImportFile} />\n\n          {/* Add */}\n          <button\n            onClick={() => { setEditContact(null); setShowForm(true); }}\n            className=\"px-3 py-1.5 rounded-lg bg-[var(--gm-interactive-primary)] text-[var(--gm-text-on-brand)] text-xs font-medium hover:bg-[var(--gm-interactive-primary-hover)] flex items-center gap-1.5\"\n          >\n            <Plus className=\"w-3.5 h-3.5\" /> Add Contact\n          </button>\n        </div>\n      </div>\n\n      {/* Search + Filters row */}\n      <div className=\"flex items-center gap-2 flex-wrap\">\n        <div className=\"relative max-w-sm flex-1 min-w-[200px]\">\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-[var(--gm-text-tertiary)]\" />\n          <input\n            value={search}\n            onChange={e => setSearch(e.target.value)}\n            placeholder=\"Search contacts...\"\n            className=\"w-full pl-9 pr-3 py-1.5 bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg text-xs text-[var(--gm-text-primary)] focus:outline-none focus:border-[var(--gm-border-focus)] focus:shadow-[var(--shadow-focus)]\"\n          />\n        </div>\n\n        <button\n          onClick={() => setShowFilters(!showFilters)}\n          className={`px-2.5 py-1.5 rounded-lg text-xs flex items-center gap-1.5 ${(orgFilter || tagFilter || showFavoritesOnly) ? 'bg-[var(--gm-interactive-primary)]/10 text-[var(--gm-accent-primary)] border border-[var(--gm-accent-primary)]/30' : 'bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-tertiary)] hover:bg-[var(--gm-surface-hover)]'}`}\n        >\n          <Filter className=\"w-3.5 h-3.5\" /> Filters\n          {(orgFilter || tagFilter || showFavoritesOnly) && (\n            <span className=\"px-1.5 py-0.5 rounded-full bg-[var(--gm-interactive-primary)] text-[var(--gm-text-on-brand)] text-[10px]\">\n              {[orgFilter, tagFilter, showFavoritesOnly].filter(Boolean).length}\n            </span>\n          )}\n        </button>\n\n        <button\n          onClick={() => setShowFavoritesOnly(!showFavoritesOnly)}\n          className={`px-2.5 py-1.5 rounded-lg text-xs flex items-center gap-1.5 ${showFavoritesOnly ? 'bg-amber-500/10 text-amber-500 border border-amber-500/30' : 'bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-tertiary)] hover:bg-[var(--gm-surface-hover)]'}`}\n        >\n          <Star className={`w-3.5 h-3.5 ${showFavoritesOnly ? 'fill-amber-500' : ''}`} /> Favorites {favorites.length > 0 && `(${favorites.length})`}\n        </button>\n      </div>\n\n      {/* Filter dropdowns */}\n      {showFilters && (\n        <div className=\"flex items-center gap-3 p-3 rounded-lg bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] flex-wrap\">\n          <div className=\"flex items-center gap-2\">\n            <label className=\"text-xs text-[var(--gm-text-tertiary)]\">Organization:</label>\n            <select\n              value={orgFilter}\n              onChange={e => setOrgFilter(e.target.value)}\n              className=\"px-2 py-1 bg-[var(--gm-bg-primary)] border border-[var(--gm-border-primary)] rounded text-xs text-[var(--gm-text-primary)]\"\n            >\n              <option value=\"\">All</option>\n              {organizations.map(org => <option key={org} value={org}>{org}</option>)}\n            </select>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <label className=\"text-xs text-[var(--gm-text-tertiary)]\">Tag:</label>\n            <select\n              value={tagFilter}\n              onChange={e => setTagFilter(e.target.value)}\n              className=\"px-2 py-1 bg-[var(--gm-bg-primary)] border border-[var(--gm-border-primary)] rounded text-xs text-[var(--gm-text-primary)]\"\n            >\n              <option value=\"\">All</option>\n              {allTags.map(tag => <option key={tag} value={tag}>{tag}</option>)}\n            </select>\n          </div>\n          {(orgFilter || tagFilter) && (\n            <button\n              onClick={() => { setOrgFilter(''); setTagFilter(''); }}\n              className=\"text-xs text-[var(--gm-accent-primary)] hover:underline\"\n            >\n              Clear filters\n            </button>\n          )}\n        </div>\n      )}\n\n      {/* Selection bar */}\n      {selectMode && selectedIds.size > 0 && (\n        <div className=\"flex items-center gap-3 p-3 rounded-lg bg-[var(--gm-interactive-primary)]/5 border border-[var(--gm-accent-primary)]/20\">\n          <span className=\"text-xs text-[var(--gm-accent-primary)] font-medium\">{selectedIds.size} selected</span>\n          <button\n            onClick={handleMergeSelected}\n            disabled={selectedIds.size < 2 || mergeContacts.isPending}\n            className=\"px-2.5 py-1 rounded bg-[var(--gm-interactive-primary)] text-[var(--gm-text-on-brand)] text-xs flex items-center gap-1.5 disabled:opacity-50\"\n          >\n            <Merge className=\"w-3.5 h-3.5\" /> Merge Selected\n          </button>\n          <button onClick={() => { setSelectedIds(new Set()); setSelectMode(false); }} className=\"text-xs text-[var(--gm-text-tertiary)] hover:text-[var(--gm-text-primary)]\">\n            Cancel\n          </button>\n        </div>\n      )}\n\n      {/* Unmatched panel */}\n      {showUnmatched && unmatched.length > 0 && (\n        <div className=\"p-4 rounded-xl border border-amber-500/30 bg-amber-500/5 space-y-3\">\n          <div className=\"flex items-center justify-between\">\n            <h3 className=\"text-sm font-semibold text-[var(--gm-text-primary)] flex items-center gap-2\">\n              <UserPlus className=\"w-4 h-4 text-amber-500\" /> Unmatched Participants ({unmatched.length})\n            </h3>\n            <button onClick={() => setShowUnmatched(false)} className=\"text-[var(--gm-text-tertiary)] hover:text-[var(--gm-text-primary)]\"><X className=\"w-4 h-4\" /></button>\n          </div>\n          <p className=\"text-[11px] text-[var(--gm-text-tertiary)]\">These names were found in documents but don't match any contact. Link them to existing contacts.</p>\n          <div className=\"space-y-2 max-h-48 overflow-y-auto\">\n            {unmatched.map((u) => (\n              <div key={u.name} className=\"flex items-center gap-2 p-2 rounded bg-[var(--gm-bg-primary)] border border-[var(--gm-border-primary)]\">\n                <span className=\"text-xs font-medium text-[var(--gm-text-primary)] flex-1\">{u.name}</span>\n                {u.count && <span className=\"text-[10px] text-[var(--gm-text-tertiary)]\">{u.count} mentions</span>}\n                <select\n                  value={linkTarget[u.name] || ''}\n                  onChange={e => setLinkTarget(prev => ({ ...prev, [u.name]: e.target.value }))}\n                  className=\"px-2 py-1 bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded text-xs max-w-[150px]\"\n                >\n                  <option value=\"\">Link to...</option>\n                  {allContacts.map(c => <option key={c.id} value={c.id}>{c.name}</option>)}\n                </select>\n                <button\n                  disabled={!linkTarget[u.name]}\n                  onClick={() => linkTarget[u.name] && handleLinkParticipant(u.name, linkTarget[u.name])}\n                  className=\"px-2 py-1 rounded bg-[var(--gm-interactive-primary)] text-[var(--gm-text-on-brand)] text-[10px] disabled:opacity-40 flex items-center gap-1\"\n                >\n                  <Link2 className=\"w-3 h-3\" /> Link\n                </button>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* Duplicates panel */}\n      {showDuplicates && duplicates.length > 0 && (\n        <div className=\"p-4 rounded-xl border border-orange-500/30 bg-orange-500/5 space-y-3\">\n          <div className=\"flex items-center justify-between\">\n            <h3 className=\"text-sm font-semibold text-[var(--gm-text-primary)] flex items-center gap-2\">\n              <AlertTriangle className=\"w-4 h-4 text-orange-500\" /> Duplicate Groups ({duplicates.length})\n            </h3>\n            <button onClick={() => setShowDuplicates(false)} className=\"text-[var(--gm-text-tertiary)] hover:text-[var(--gm-text-primary)]\"><X className=\"w-4 h-4\" /></button>\n          </div>\n          <div className=\"space-y-3 max-h-60 overflow-y-auto\">\n            {duplicates.map((group: any, gi: number) => {\n              const items = Array.isArray(group) ? group : group.contacts || [group];\n              return (\n                <div key={gi} className=\"p-3 rounded-lg bg-[var(--gm-bg-primary)] border border-[var(--gm-border-primary)] space-y-2\">\n                  <p className=\"text-[10px] text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Group {gi + 1} — Select primary</p>\n                  {items.map((c: any) => (\n                    <label key={c.id} className=\"flex items-center gap-2 cursor-pointer p-1 rounded hover:bg-[var(--gm-surface-hover)]\">\n                      <input\n                        type=\"radio\"\n                        name={`merge-group-${gi}`}\n                        checked={mergePrimary[gi] === c.id}\n                        onChange={() => setMergePrimary(prev => ({ ...prev, [gi]: c.id }))}\n                        className=\"accent-primary\"\n                      />\n                      <span className=\"text-xs text-[var(--gm-text-primary)]\">{c.name}</span>\n                      {c.email && <span className=\"text-[10px] text-[var(--gm-text-tertiary)]\">({c.email})</span>}\n                    </label>\n                  ))}\n                  <button\n                    onClick={() => handleMergeDuplicateGroup(gi, items)}\n                    disabled={!mergePrimary[gi] || mergeContacts.isPending}\n                    className=\"px-2.5 py-1 rounded bg-orange-500 text-white text-xs disabled:opacity-50 flex items-center gap-1\"\n                  >\n                    <Merge className=\"w-3 h-3\" /> Merge Group\n                  </button>\n                </div>\n              );\n            })}\n          </div>\n        </div>\n      )}\n\n      {/* Favorites horizontal scroll */}\n      {favorites.length > 0 && !showFavoritesOnly && (\n        <div>\n          <p className=\"text-xs text-[var(--gm-text-tertiary)] mb-2 flex items-center gap-1\">\n            <Star className=\"w-3 h-3 fill-amber-500 text-amber-500\" /> Favorites\n          </p>\n          <div className=\"flex gap-2 overflow-x-auto pb-2\">\n            {favorites.map(c => (\n              <button\n                key={c.id}\n                onClick={() => setDetailContact(c)}\n                className=\"flex items-center gap-2 px-3 py-2 rounded-lg bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] hover:border-[var(--gm-accent-primary)]/30 flex-shrink-0\"\n              >\n                <ContactAvatarImg contact={c as unknown as Record<string, unknown>} size=\"sm\" />\n                <div className=\"text-left\">\n                  <p className=\"text-xs font-medium text-[var(--gm-text-primary)]\">{c.name}</p>\n                  {c.role && <p className=\"text-[10px] text-[var(--gm-text-tertiary)]\">{c.role}</p>}\n                </div>\n              </button>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* Count */}\n      <p className=\"text-xs text-[var(--gm-text-tertiary)]\">{contacts.length} contact{contacts.length !== 1 ? 's' : ''}</p>\n\n      {/* List */}\n      {contactsQuery.isLoading ? (\n        <div className=\"flex items-center justify-center h-32\">\n          <Loader2 className=\"h-8 w-8 animate-spin text-[var(--gm-accent-primary)]\" />\n        </div>\n      ) : contacts.length === 0 ? (\n        <div className=\"rounded-xl border border-[var(--gm-border-primary)] bg-[var(--gm-surface-primary)] p-8 text-center text-[var(--gm-text-tertiary)]\">\n          <Users className=\"h-12 w-12 mx-auto mb-4 text-[var(--gm-text-tertiary)]/40\" />\n          {search || orgFilter || tagFilter ? 'No contacts match your filters.' : 'No contacts found. Add one to get started.'}\n        </div>\n      ) : (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3\">\n          {contacts.map((contact) => {\n            const isFav = contact.is_favorite || contact.isFavorite;\n            const isSelected = selectedIds.has(contact.id);\n            return (\n              <div\n                key={contact.id}\n                className={`bg-[var(--gm-surface-primary)] border rounded-xl p-4 hover:border-[var(--gm-accent-primary)]/30 transition-colors cursor-pointer group relative ${isSelected ? 'border-[var(--gm-accent-primary)] bg-[var(--gm-interactive-primary)]/5' : 'border-[var(--gm-border-primary)]'}`}\n                onClick={() => selectMode ? toggleSelect(contact.id) : setDetailContact(contact)}\n              >\n                {/* Select checkbox */}\n                {selectMode && (\n                  <div className=\"absolute top-3 left-3 z-10\">\n                    {isSelected ? (\n                      <CheckSquare className=\"w-4 h-4 text-[var(--gm-accent-primary)]\" />\n                    ) : (\n                      <Square className=\"w-4 h-4 text-[var(--gm-text-tertiary)]\" />\n                    )}\n                  </div>\n                )}\n\n                {/* Favorite star */}\n                <button\n                  className=\"absolute top-3 right-3 z-10 opacity-0 group-hover:opacity-100 transition-opacity\"\n                  onClick={(e) => { e.stopPropagation(); toggleFavorite(contact); }}\n                  title={isFav ? 'Remove from favorites' : 'Add to favorites'}\n                >\n                  <Star className={`w-4 h-4 ${isFav ? 'fill-amber-500 text-amber-500' : 'text-[var(--gm-text-tertiary)] hover:text-amber-500'}`} />\n                </button>\n\n                {/* AI Enrich button */}\n                <button\n                  className=\"absolute top-3 right-9 z-10 opacity-0 group-hover:opacity-100 transition-opacity\"\n                  onClick={(e) => { e.stopPropagation(); handleEnrich(contact.id); }}\n                  title=\"Enrich with AI\"\n                >\n                  <Sparkles className={`w-4 h-4 text-violet-400 hover:text-violet-300 ${enrichContact.isPending ? 'animate-pulse' : ''}`} />\n                </button>\n\n                <div className={`flex items-center gap-3 ${selectMode ? 'ml-5' : ''}`}>\n                  <div className={`w-10 h-10 rounded-full bg-gradient-to-br ${getGradient(contact.name)} flex items-center justify-center flex-shrink-0 overflow-hidden`}>\n                    {resolveAvatarUrl(contact as any) ? (\n                      <img src={resolveAvatarUrl(contact as any)!} alt={contact.name} className=\"w-full h-full rounded-full object-cover\" />\n                    ) : (\n                      <span className=\"text-xs font-bold text-white\">{getInitials(contact.name)}</span>\n                    )}\n                  </div>\n                  <div className=\"min-w-0 flex-1\">\n                    <p className=\"text-sm font-medium text-[var(--gm-text-primary)] truncate group-hover:text-[var(--gm-accent-primary)] transition-colors\">\n                      {contact.name || '(unnamed)'}\n                      {isFav && <Star className=\"w-3 h-3 inline ml-1 fill-amber-500 text-amber-500\" />}\n                    </p>\n                    {contact.role && (\n                      <div className=\"flex items-center gap-1 mt-0.5\">\n                        <Briefcase className=\"w-3 h-3 text-[var(--gm-text-tertiary)]\" />\n                        <span className=\"text-[10px] text-[var(--gm-text-tertiary)] truncate\">{contact.role}</span>\n                      </div>\n                    )}\n                  </div>\n                </div>\n                <div className=\"mt-3 space-y-1\">\n                  {contact.organization && (\n                    <div className=\"flex items-center gap-1.5 text-[10px] text-[var(--gm-text-tertiary)]\">\n                      <Building2 className=\"w-3 h-3\" />\n                      <span className=\"truncate\">{contact.organization}</span>\n                    </div>\n                  )}\n                  {contact.email && (\n                    <div className=\"flex items-center gap-1.5 text-[10px] text-[var(--gm-text-tertiary)]\">\n                      <Mail className=\"w-3 h-3\" />\n                      <span className=\"truncate\">{contact.email}</span>\n                    </div>\n                  )}\n                  {contact.phone && (\n                    <div className=\"flex items-center gap-1.5 text-[10px] text-[var(--gm-text-tertiary)]\">\n                      <Phone className=\"w-3 h-3\" />\n                      <span className=\"truncate\">{contact.phone}</span>\n                    </div>\n                  )}\n                  {contact.tags && contact.tags.length > 0 && (\n                    <div className=\"flex flex-wrap gap-1 mt-1\">\n                      {contact.tags.slice(0, 4).map(tag => (\n                        <span key={tag} className=\"text-[9px] px-1.5 py-0.5 rounded-full bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-tertiary)]\">{tag}</span>\n                      ))}\n                      {contact.tags.length > 4 && (\n                        <span className=\"text-[9px] text-[var(--gm-text-tertiary)]\">+{contact.tags.length - 4}</span>\n                      )}\n                    </div>\n                  )}\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      )}\n\n    </div>\n  );\n}\n"],"names":["__iconNode","FileSpreadsheet","createLucideIcon","Linkedin","MapPin","Phone","StickyNote","labelVariants","cva","Label","React.forwardRef","className","props","ref","jsx","LabelPrimitive.Root","cn","Textarea","ContactForm","contact","onSubmit","onCancel","mode","form","setForm","useState","newAlias","setNewAlias","roleTemplates","setRoleTemplates","timezones","setTimezones","companies","setCompanies","useEffect","rolesData","timezonesData","companiesData","apiClient","roles","tzs","comps","err","resolveAvatarUrl","handleSubmit","update","field","value","prev","addAlias","removeAlias","alias","a","Field","Icon","label","id","placeholder","type","required","jsxs","Input","e","User","Briefcase","Select","val","SelectTrigger","SelectValue","SelectContent","r","role","SelectItem","Mail","Building2","c","company","Button","Image","Clock","tz","Fragment","Plus","Save","CARD","BTN_PRIMARY","BTN_SECONDARY","BTN_DANGER","avatarGradients","getGradient","name","hash","i","contactTabs","FolderOpen","Users2","MessageSquare","InfoRow","EditInputField","onChange","EditSelectField","options","hasMatchingOption","o","v","ContactDetail","onBack","onEdit","onDelete","onUpdateProjects","activeTab","setActiveTab","loading","setLoading","isEditing","setIsEditing","saving","setSaving","confirmDelete","setConfirmDelete","deleting","setDeleting","loadedContactId","useRef","editForm","setEditForm","roleOptions","setRoleOptions","companyOptions","setCompanyOptions","timezoneOptions","setTimezoneOptions","projects","setProjects","assignedProjectIds","setAssignedProjectIds","primaryProjectId","setPrimaryProjectId","relations","setRelations","activity","setActivity","mentions","setMentions","allContacts","setAllContacts","enrichContact","useEnrichContact","deleteRelationship","useDeleteRelationship","unlinkParticipant","useUnlinkParticipant","showAddRelation","setShowAddRelation","newRelTarget","setNewRelTarget","newRelType","setNewRelType","mentionFilter","setMentionFilter","contactAvatarUrl","setContactAvatarUrl","loadData","loadDropdownMetadata","useCallback","t","enterEditMode","handleSaveInline","resp","toast","updateField","projectsData","assignedData","relsData","activityData","assigned","assignedIds","p","primary","mentionsData","contactsResp","toggleProject","projectId","isAssigned","newIds","newPrimary","setPrimary","handleAddRelationship","targetContact","newRel","tabCounts","ArrowLeft","data","fields","Loader2","Sparkles","LinkIcon","Pencil","AvatarUpload","url","tab","Globe","CheckCircle2","isPrimary","otherName","_","idx","X","m","mention","FileText","ArrowRight","item","AlertTriangle","Trash2","CommentsPanel","ContactAvatarImg","size","dim","textSz","getInitials","ContactsPage","search","setSearch","showForm","setShowForm","editContact","setEditContact","detailContact","setDetailContact","orgFilter","setOrgFilter","tagFilter","setTagFilter","showFavoritesOnly","setShowFavoritesOnly","showFilters","setShowFilters","selectedIds","setSelectedIds","selectMode","setSelectMode","showDuplicates","setShowDuplicates","mergePrimary","setMergePrimary","showImport","setShowImport","fileInputRef","showUnmatched","setShowUnmatched","linkTarget","setLinkTarget","contactsQuery","useContacts","createContact","useCreateContact","updateContact","useUpdateContact","deleteContact","useDeleteContact","duplicatesQuery","useContactDuplicates","mergeContacts","useMergeContacts","exportContacts","useExportContacts","importContacts","useImportContacts","unmatchedQuery","useUnmatchedParticipants","linkParticipant","useLinkParticipant","syncPeople","useSyncPeopleToContacts","rawData","organizations","useMemo","orgs","allTags","tags","ct","contacts","result","favorites","duplicates","unmatched","handleCreate","handleUpdate","handleDelete","handleEditFromDetail","_contact","toggleFavorite","isFav","toggleSelect","next","handleMergeSelected","handleMergeDuplicateGroup","groupIndex","group","ids","handleEnrich","s","handleImportFile","file","reader","text","json","handleLinkParticipant","contactId","RefreshCw","UserPlus","CheckSquare","Download","ChevronDown","FileJson","Upload","Search","Filter","Star","org","tag","Merge","u","Link2","gi","items","Users","isSelected","Square"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4]}
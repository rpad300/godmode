{"version":3,"file":"GraphAnalytics-B6w8UFxS.js","sources":["../../frontend/components/graph/GraphAnalytics.ts"],"sourcesContent":["/**\r\n * GraphAnalytics - Analytics and insights dashboard\r\n * \r\n * Features:\r\n * - Stats cards with key metrics\r\n * - Community visualization\r\n * - Centrality ranking\r\n * - Key people list\r\n * - Bridge nodes\r\n * - AI-generated insights\r\n */\r\n\r\nimport { createElement, on } from '../../utils/dom';\r\nimport { graphService, GraphStats, Community, CentralityMetrics, BridgeNode, GraphInsight } from '../../services/graph';\r\nimport { toast } from '../../services/toast';\r\n\r\nexport interface GraphAnalyticsProps {\r\n  onNodeSelect?: (nodeId: string) => void;\r\n}\r\n\r\ninterface AnalyticsState {\r\n  stats: GraphStats | null;\r\n  communities: Community[];\r\n  centrality: CentralityMetrics;\r\n  bridges: BridgeNode[];\r\n  insights: GraphInsight[];\r\n  isLoading: boolean;\r\n}\r\n\r\n/**\r\n * Create the graph analytics component\r\n */\r\nexport function createGraphAnalytics(props: GraphAnalyticsProps = {}): HTMLElement {\r\n  const state: AnalyticsState = {\r\n    stats: null,\r\n    communities: [],\r\n    centrality: { topNodes: [] },\r\n    bridges: [],\r\n    insights: [],\r\n    isLoading: true,\r\n  };\r\n\r\n  const container = createElement('div', { className: 'graph-analytics' });\r\n  \r\n  container.innerHTML = `\r\n    <div class=\"analytics-grid\">\r\n      <!-- Stats Cards Row -->\r\n      <div class=\"stats-cards\" id=\"stats-cards\">\r\n        <div class=\"stat-card\">\r\n          <div class=\"stat-icon\">\r\n            <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n              <circle cx=\"12\" cy=\"12\" r=\"10\"/>\r\n            </svg>\r\n          </div>\r\n          <div class=\"stat-content\">\r\n            <div class=\"stat-value\" id=\"stat-nodes\">-</div>\r\n            <div class=\"stat-label\">Total Nodes</div>\r\n          </div>\r\n        </div>\r\n        <div class=\"stat-card\">\r\n          <div class=\"stat-icon\">\r\n            <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n              <path d=\"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6\"/>\r\n              <polyline points=\"15 3 21 3 21 9\"/>\r\n              <line x1=\"10\" y1=\"14\" x2=\"21\" y2=\"3\"/>\r\n            </svg>\r\n          </div>\r\n          <div class=\"stat-content\">\r\n            <div class=\"stat-value\" id=\"stat-edges\">-</div>\r\n            <div class=\"stat-label\">Total Edges</div>\r\n          </div>\r\n        </div>\r\n        <div class=\"stat-card\">\r\n          <div class=\"stat-icon\">\r\n            <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n              <circle cx=\"12\" cy=\"12\" r=\"10\"/>\r\n              <circle cx=\"12\" cy=\"12\" r=\"6\"/>\r\n              <circle cx=\"12\" cy=\"12\" r=\"2\"/>\r\n            </svg>\r\n          </div>\r\n          <div class=\"stat-content\">\r\n            <div class=\"stat-value\" id=\"stat-communities\">-</div>\r\n            <div class=\"stat-label\">Communities</div>\r\n          </div>\r\n        </div>\r\n        <div class=\"stat-card\">\r\n          <div class=\"stat-icon\">\r\n            <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n              <path d=\"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2\"/>\r\n              <circle cx=\"9\" cy=\"7\" r=\"4\"/>\r\n              <path d=\"M23 21v-2a4 4 0 0 0-3-3.87\"/>\r\n              <path d=\"M16 3.13a4 4 0 0 1 0 7.75\"/>\r\n            </svg>\r\n          </div>\r\n          <div class=\"stat-content\">\r\n            <div class=\"stat-value\" id=\"stat-people\">-</div>\r\n            <div class=\"stat-label\">People</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Main Grid -->\r\n      <div class=\"analytics-main\">\r\n        <!-- Left Column -->\r\n        <div class=\"analytics-column\">\r\n          <!-- Entity Types Distribution -->\r\n          <div class=\"analytics-card\">\r\n            <div class=\"card-header\">\r\n              <h3 class=\"card-title\">\r\n                <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                  <rect x=\"3\" y=\"3\" width=\"7\" height=\"7\"/>\r\n                  <rect x=\"14\" y=\"3\" width=\"7\" height=\"7\"/>\r\n                  <rect x=\"14\" y=\"14\" width=\"7\" height=\"7\"/>\r\n                  <rect x=\"3\" y=\"14\" width=\"7\" height=\"7\"/>\r\n                </svg>\r\n                Entity Distribution\r\n              </h3>\r\n            </div>\r\n            <div class=\"card-content\" id=\"entity-distribution\">\r\n              <div class=\"loading-state\"><div class=\"loading-spinner\"></div></div>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Communities -->\r\n          <div class=\"analytics-card\">\r\n            <div class=\"card-header\">\r\n              <h3 class=\"card-title\">\r\n                <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                  <circle cx=\"12\" cy=\"12\" r=\"10\"/>\r\n                  <circle cx=\"12\" cy=\"12\" r=\"6\"/>\r\n                  <circle cx=\"12\" cy=\"12\" r=\"2\"/>\r\n                </svg>\r\n                Communities\r\n              </h3>\r\n              <button class=\"card-action\" id=\"btn-detect-communities\">\r\n                <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                  <path d=\"M21 2v6h-6\"/>\r\n                  <path d=\"M3 12a9 9 0 0 1 15-6.7L21 8\"/>\r\n                </svg>\r\n                Detect\r\n              </button>\r\n            </div>\r\n            <div class=\"card-content\" id=\"communities-list\">\r\n              <div class=\"loading-state\"><div class=\"loading-spinner\"></div></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Center Column -->\r\n        <div class=\"analytics-column\">\r\n          <!-- Key People -->\r\n          <div class=\"analytics-card\">\r\n            <div class=\"card-header\">\r\n              <h3 class=\"card-title\">\r\n                <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                  <path d=\"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2\"/>\r\n                  <circle cx=\"9\" cy=\"7\" r=\"4\"/>\r\n                  <path d=\"M23 21v-2a4 4 0 0 0-3-3.87\"/>\r\n                  <path d=\"M16 3.13a4 4 0 0 1 0 7.75\"/>\r\n                </svg>\r\n                Key People (by Centrality)\r\n              </h3>\r\n            </div>\r\n            <div class=\"card-content\" id=\"key-people\">\r\n              <div class=\"loading-state\"><div class=\"loading-spinner\"></div></div>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Bridge Nodes -->\r\n          <div class=\"analytics-card\">\r\n            <div class=\"card-header\">\r\n              <h3 class=\"card-title\">\r\n                <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                  <path d=\"M6 9H4.5a2.5 2.5 0 0 1 0-5H6\"/>\r\n                  <path d=\"M18 9h1.5a2.5 2.5 0 0 0 0-5H18\"/>\r\n                  <path d=\"M4 22h16\"/>\r\n                  <path d=\"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22\"/>\r\n                  <path d=\"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22\"/>\r\n                  <path d=\"M18 2H6v7a6 6 0 0 0 12 0V2Z\"/>\r\n                </svg>\r\n                Bridge Nodes\r\n              </h3>\r\n            </div>\r\n            <div class=\"card-content\" id=\"bridge-nodes\">\r\n              <div class=\"loading-state\"><div class=\"loading-spinner\"></div></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Right Column -->\r\n        <div class=\"analytics-column\">\r\n          <!-- AI Insights -->\r\n          <div class=\"analytics-card analytics-card-full\">\r\n            <div class=\"card-header\">\r\n              <h3 class=\"card-title\">\r\n                <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                  <circle cx=\"12\" cy=\"12\" r=\"10\"/>\r\n                  <path d=\"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3\"/>\r\n                  <line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"/>\r\n                </svg>\r\n                AI Insights\r\n              </h3>\r\n              <button class=\"card-action\" id=\"btn-generate-insights\">\r\n                <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                  <polygon points=\"13 2 3 14 12 14 11 22 21 10 12 10 13 2\"/>\r\n                </svg>\r\n                Generate\r\n              </button>\r\n            </div>\r\n            <div class=\"card-content\" id=\"ai-insights\">\r\n              <div class=\"loading-state\"><div class=\"loading-spinner\"></div></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  `;\r\n\r\n  // Initialize\r\n  initAnalytics(container, state, props);\r\n\r\n  return container;\r\n}\r\n\r\n/**\r\n * Initialize analytics\r\n */\r\nasync function initAnalytics(\r\n  container: HTMLElement,\r\n  state: AnalyticsState,\r\n  props: GraphAnalyticsProps\r\n): Promise<void> {\r\n  // Bind actions\r\n  const btnDetectCommunities = container.querySelector('#btn-detect-communities');\r\n  if (btnDetectCommunities) {\r\n    on(btnDetectCommunities as HTMLElement, 'click', async () => {\r\n      toast.info('Detecting communities...');\r\n      const communities = await graphService.getCommunities();\r\n      state.communities = communities;\r\n      renderCommunities(container, state, props);\r\n      toast.success(`Found ${communities.length} communities`);\r\n    });\r\n  }\r\n\r\n  const btnGenerateInsights = container.querySelector('#btn-generate-insights');\r\n  if (btnGenerateInsights) {\r\n    on(btnGenerateInsights as HTMLElement, 'click', async () => {\r\n      toast.info('Generating AI insights...');\r\n      const insights = await graphService.getInsights();\r\n      state.insights = insights;\r\n      renderInsights(container, state);\r\n      toast.success(`Generated ${insights.length} insights`);\r\n    });\r\n  }\r\n\r\n  // Load data\r\n  await loadAnalyticsData(container, state, props);\r\n}\r\n\r\n/**\r\n * Load all analytics data\r\n */\r\nasync function loadAnalyticsData(\r\n  container: HTMLElement,\r\n  state: AnalyticsState,\r\n  props: GraphAnalyticsProps\r\n): Promise<void> {\r\n  try {\r\n    const [stats, communities, centrality, bridges, insights] = await Promise.all([\r\n      graphService.getStats(),\r\n      graphService.getCommunities(),\r\n      graphService.getCentrality(),\r\n      graphService.getBridges(),\r\n      graphService.getInsights(),\r\n    ]);\r\n\r\n    state.stats = stats;\r\n    state.communities = communities;\r\n    state.centrality = centrality;\r\n    state.bridges = bridges;\r\n    state.insights = insights;\r\n    state.isLoading = false;\r\n\r\n    // Render all sections\r\n    renderStats(container, state);\r\n    renderEntityDistribution(container, state);\r\n    renderCommunities(container, state, props);\r\n    renderKeyPeople(container, state, props);\r\n    renderBridgeNodes(container, state, props);\r\n    renderInsights(container, state);\r\n\r\n  } catch (error) {\r\n    console.error('[GraphAnalytics] Failed to load:', error);\r\n    state.isLoading = false;\r\n  }\r\n}\r\n\r\n/**\r\n * Render stats cards\r\n */\r\nfunction renderStats(container: HTMLElement, state: AnalyticsState): void {\r\n  const stats = state.stats;\r\n  if (!stats) return;\r\n\r\n  const nodeCount = container.querySelector('#stat-nodes');\r\n  const edgeCount = container.querySelector('#stat-edges');\r\n  const communityCount = container.querySelector('#stat-communities');\r\n  const peopleCount = container.querySelector('#stat-people');\r\n\r\n  if (nodeCount) nodeCount.textContent = formatNumber(stats.nodeCount);\r\n  if (edgeCount) edgeCount.textContent = formatNumber(stats.edgeCount);\r\n  if (communityCount) communityCount.textContent = formatNumber(state.communities.length);\r\n  if (peopleCount) {\r\n    const people = stats.nodeTypes?.Person || stats.nodeTypes?.person || 0;\r\n    peopleCount.textContent = formatNumber(people);\r\n  }\r\n}\r\n\r\n/**\r\n * Render entity distribution\r\n */\r\nfunction renderEntityDistribution(container: HTMLElement, state: AnalyticsState): void {\r\n  const el = container.querySelector('#entity-distribution');\r\n  if (!el || !state.stats?.nodeTypes) {\r\n    if (el) el.innerHTML = '<div class=\"empty-state-small\">No data available</div>';\r\n    return;\r\n  }\r\n\r\n  const types = Object.entries(state.stats.nodeTypes)\r\n    .sort((a, b) => b[1] - a[1])\r\n    .slice(0, 10);\r\n\r\n  const total = types.reduce((sum, [, count]) => sum + count, 0);\r\n  const maxCount = Math.max(...types.map(([, count]) => count));\r\n\r\n  el.innerHTML = `\r\n    <div class=\"distribution-chart\">\r\n      ${types.map(([type, count]) => {\r\n        const percentage = total > 0 ? (count / total * 100).toFixed(1) : 0;\r\n        const width = maxCount > 0 ? (count / maxCount * 100) : 0;\r\n        return `\r\n          <div class=\"distribution-row\">\r\n            <div class=\"distribution-label\">\r\n              <span class=\"type-dot\" style=\"background: ${getTypeColor(type)}\"></span>\r\n              <span class=\"type-name\">${escapeHtml(type)}</span>\r\n            </div>\r\n            <div class=\"distribution-bar-container\">\r\n              <div class=\"distribution-bar\" style=\"width: ${width}%; background: ${getTypeColor(type)}\"></div>\r\n            </div>\r\n            <div class=\"distribution-value\">${count} (${percentage}%)</div>\r\n          </div>\r\n        `;\r\n      }).join('')}\r\n    </div>\r\n  `;\r\n}\r\n\r\n/**\r\n * Render communities\r\n */\r\nfunction renderCommunities(\r\n  container: HTMLElement,\r\n  state: AnalyticsState,\r\n  props: GraphAnalyticsProps\r\n): void {\r\n  const el = container.querySelector('#communities-list');\r\n  if (!el) return;\r\n\r\n  if (state.communities.length === 0) {\r\n    el.innerHTML = `\r\n      <div class=\"empty-state-small\">\r\n        <p>No communities detected</p>\r\n        <p class=\"text-muted\">Click \"Detect\" to find communities</p>\r\n      </div>\r\n    `;\r\n    return;\r\n  }\r\n\r\n  const colors = ['#6366f1', '#22c55e', '#f59e0b', '#ef4444', '#8b5cf6', '#06b6d4', '#ec4899', '#84cc16'];\r\n\r\n  el.innerHTML = `\r\n    <div class=\"communities-grid\">\r\n      ${state.communities.slice(0, 6).map((community, i) => `\r\n        <div class=\"community-card\" data-id=\"${community.id}\">\r\n          <div class=\"community-header\">\r\n            <div class=\"community-color\" style=\"background: ${colors[i % colors.length]}\"></div>\r\n            <span class=\"community-name\">${community.hub?.name || `Community ${i + 1}`}</span>\r\n          </div>\r\n          <div class=\"community-stats\">\r\n            <span class=\"community-size\">${community.size} members</span>\r\n          </div>\r\n          ${community.members.slice(0, 3).map(m => `\r\n            <div class=\"community-member\">\r\n              <span class=\"member-type\" style=\"color: ${getTypeColor(m.type)}\">${m.type}</span>\r\n              <span class=\"member-name\">${escapeHtml(m.name)}</span>\r\n            </div>\r\n          `).join('')}\r\n          ${community.members.length > 3 ? `<div class=\"community-more\">+${community.members.length - 3} more</div>` : ''}\r\n        </div>\r\n      `).join('')}\r\n    </div>\r\n    ${state.communities.length > 6 ? `<div class=\"show-more\">+${state.communities.length - 6} more communities</div>` : ''}\r\n  `;\r\n\r\n  // Bind click events\r\n  el.querySelectorAll('.community-card').forEach(card => {\r\n    on(card as HTMLElement, 'click', () => {\r\n      const id = card.getAttribute('data-id');\r\n      if (id) {\r\n        toast.info(`Filtering by community ${id}`);\r\n        // TODO: Filter graph by community\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\n/**\r\n * Render key people\r\n */\r\nfunction renderKeyPeople(\r\n  container: HTMLElement,\r\n  state: AnalyticsState,\r\n  props: GraphAnalyticsProps\r\n): void {\r\n  const el = container.querySelector('#key-people');\r\n  if (!el) return;\r\n\r\n  if (!state.centrality.topNodes || state.centrality.topNodes.length === 0) {\r\n    el.innerHTML = '<div class=\"empty-state-small\">No centrality data available</div>';\r\n    return;\r\n  }\r\n\r\n  const maxConnections = Math.max(...state.centrality.topNodes.map(n => n.connections));\r\n\r\n  el.innerHTML = `\r\n    <div class=\"key-people-list\">\r\n      ${state.centrality.topNodes.slice(0, 10).map((person, i) => `\r\n        <div class=\"key-person\" data-id=\"${person.id}\">\r\n          <div class=\"person-rank\">${i + 1}</div>\r\n          <div class=\"person-avatar\">\r\n            ${person.avatarUrl\r\n              ? `<img src=\"${person.avatarUrl}\" alt=\"\" onerror=\"this.style.display='none'\">`\r\n              : `<div class=\"avatar-placeholder\">${getInitials(person.name)}</div>`\r\n            }\r\n          </div>\r\n          <div class=\"person-info\">\r\n            <div class=\"person-name\">${escapeHtml(person.name)}</div>\r\n            <div class=\"person-type\">${person.type}</div>\r\n          </div>\r\n          <div class=\"person-metrics\">\r\n            <div class=\"connections-bar-container\">\r\n              <div class=\"connections-bar\" style=\"width: ${(person.connections / maxConnections) * 100}%\"></div>\r\n            </div>\r\n            <span class=\"connections-count\">${person.connections}</span>\r\n          </div>\r\n        </div>\r\n      `).join('')}\r\n    </div>\r\n  `;\r\n\r\n  // Bind click events\r\n  el.querySelectorAll('.key-person').forEach(item => {\r\n    on(item as HTMLElement, 'click', () => {\r\n      const id = item.getAttribute('data-id');\r\n      if (id) props.onNodeSelect?.(id);\r\n    });\r\n  });\r\n}\r\n\r\n/**\r\n * Render bridge nodes\r\n */\r\nfunction renderBridgeNodes(\r\n  container: HTMLElement,\r\n  state: AnalyticsState,\r\n  props: GraphAnalyticsProps\r\n): void {\r\n  const el = container.querySelector('#bridge-nodes');\r\n  if (!el) return;\r\n\r\n  if (state.bridges.length === 0) {\r\n    el.innerHTML = '<div class=\"empty-state-small\">No bridge nodes detected</div>';\r\n    return;\r\n  }\r\n\r\n  el.innerHTML = `\r\n    <div class=\"bridge-nodes-list\">\r\n      ${state.bridges.slice(0, 8).map(bridge => `\r\n        <div class=\"bridge-node\" data-id=\"${bridge.id}\">\r\n          <div class=\"bridge-info\">\r\n            <span class=\"bridge-name\">${escapeHtml(bridge.name)}</span>\r\n            <span class=\"bridge-connections\">Connects ${bridge.connects} groups</span>\r\n          </div>\r\n          ${bridge.org1 && bridge.org2 ? `\r\n            <div class=\"bridge-path\">\r\n              <span class=\"org\">${escapeHtml(bridge.org1)}</span>\r\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                <path d=\"M5 12h14M12 5l7 7-7 7\"/>\r\n              </svg>\r\n              <span class=\"org\">${escapeHtml(bridge.org2)}</span>\r\n            </div>\r\n          ` : ''}\r\n        </div>\r\n      `).join('')}\r\n    </div>\r\n  `;\r\n\r\n  // Bind click events\r\n  el.querySelectorAll('.bridge-node').forEach(item => {\r\n    on(item as HTMLElement, 'click', () => {\r\n      const id = item.getAttribute('data-id');\r\n      if (id) props.onNodeSelect?.(id);\r\n    });\r\n  });\r\n}\r\n\r\n/**\r\n * Render AI insights\r\n */\r\nfunction renderInsights(container: HTMLElement, state: AnalyticsState): void {\r\n  const el = container.querySelector('#ai-insights');\r\n  if (!el) return;\r\n\r\n  if (state.insights.length === 0) {\r\n    el.innerHTML = `\r\n      <div class=\"empty-state-small\">\r\n        <p>No insights available</p>\r\n        <p class=\"text-muted\">Click \"Generate\" to create AI insights</p>\r\n      </div>\r\n    `;\r\n    return;\r\n  }\r\n\r\n  el.innerHTML = `\r\n    <div class=\"insights-list\">\r\n      ${state.insights.map(insight => `\r\n        <div class=\"insight-card insight-${insight.importance}\">\r\n          <div class=\"insight-header\">\r\n            <span class=\"insight-type\">${insight.type}</span>\r\n            <span class=\"insight-importance\">${insight.importance}</span>\r\n          </div>\r\n          <h4 class=\"insight-title\">${escapeHtml(insight.title)}</h4>\r\n          <p class=\"insight-description\">${escapeHtml(insight.description)}</p>\r\n        </div>\r\n      `).join('')}\r\n    </div>\r\n  `;\r\n}\r\n\r\n/**\r\n * Get type color\r\n */\r\nfunction getTypeColor(type: string): string {\r\n  const colors: Record<string, string> = {\r\n    Person: '#6366f1',\r\n    Project: '#22c55e',\r\n    Document: '#8b5cf6',\r\n    Decision: '#06b6d4',\r\n    Risk: '#ef4444',\r\n    Question: '#f59e0b',\r\n    Fact: '#84cc16',\r\n    Meeting: '#ec4899',\r\n    Task: '#3b82f6',\r\n    Technology: '#f97316',\r\n    Organization: '#a855f7',\r\n    Client: '#14b8a6',\r\n  };\r\n  return colors[type] || '#6b7280';\r\n}\r\n\r\n/**\r\n * Get initials\r\n */\r\nfunction getInitials(name: string): string {\r\n  return name\r\n    .split(' ')\r\n    .map(part => part.charAt(0))\r\n    .join('')\r\n    .substring(0, 2)\r\n    .toUpperCase();\r\n}\r\n\r\n/**\r\n * Format number\r\n */\r\nfunction formatNumber(num: number): string {\r\n  if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';\r\n  if (num >= 1000) return (num / 1000).toFixed(1) + 'K';\r\n  return String(num);\r\n}\r\n\r\n/**\r\n * Escape HTML\r\n */\r\nfunction escapeHtml(text: string): string {\r\n  const div = document.createElement('div');\r\n  div.textContent = text;\r\n  return div.innerHTML;\r\n}\r\n\r\nexport default createGraphAnalytics;\r\n"],"names":["createGraphAnalytics","props","state","container","createElement","initAnalytics","btnDetectCommunities","on","toast","communities","graphService","renderCommunities","btnGenerateInsights","insights","renderInsights","loadAnalyticsData","stats","centrality","bridges","renderStats","renderEntityDistribution","renderKeyPeople","renderBridgeNodes","error","nodeCount","edgeCount","communityCount","peopleCount","formatNumber","people","el","types","a","b","total","sum","count","maxCount","type","percentage","width","getTypeColor","escapeHtml","colors","community","i","m","card","id","maxConnections","n","person","getInitials","item","bridge","insight","name","part","num","text","div"],"mappings":"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"}
{"version":3,"file":"TranscriptComposer-DdklGiRc.js","sources":["../../frontend/components/TranscriptComposer.ts"],"sourcesContent":["/**\r\n * Transcript Composer Component - SOTA UI\r\n * Multi-mode transcript input: paste text or upload file\r\n */\r\n\r\nimport { createElement, on } from '../utils/dom';\r\nimport { toast } from '../services/toast';\r\nimport { fetchWithProject } from '../services/api';\r\nimport { getSprints } from '../services/sprints';\r\nimport { getActions } from '../services/actions';\r\n\r\nexport interface TranscriptComposerProps {\r\n  onImport?: (document: unknown) => void;\r\n  onClose?: () => void;\r\n}\r\n\r\ntype InputMode = 'paste' | 'upload';\r\nlet currentMode: InputMode = 'paste';\r\n\r\n/**\r\n * Show transcript composer modal\r\n */\r\nexport function showTranscriptComposer(props: TranscriptComposerProps = {}): void {\r\n  const existing = document.getElementById('transcript-composer-overlay');\r\n  if (existing) existing.remove();\r\n\r\n  const overlay = createElement('div', { \r\n    id: 'transcript-composer-overlay',\r\n    className: 'composer-overlay' \r\n  });\r\n\r\n  const dialog = createTranscriptComposer(props);\r\n  overlay.appendChild(dialog);\r\n  document.body.appendChild(overlay);\r\n\r\n  on(overlay, 'click', (e) => {\r\n    if (e.target === overlay) {\r\n      closeTranscriptComposer();\r\n      props.onClose?.();\r\n    }\r\n  });\r\n\r\n  // Animate in\r\n  requestAnimationFrame(() => {\r\n    overlay.classList.add('visible');\r\n  });\r\n}\r\n\r\n/**\r\n * Close transcript composer\r\n */\r\nexport function closeTranscriptComposer(): void {\r\n  const overlay = document.getElementById('transcript-composer-overlay');\r\n  if (overlay) {\r\n    overlay.classList.remove('visible');\r\n    setTimeout(() => overlay.remove(), 200);\r\n  }\r\n}\r\n\r\n/**\r\n * Create transcript composer\r\n */\r\nfunction createTranscriptComposer(props: TranscriptComposerProps): HTMLElement {\r\n  const container = createElement('div', { className: 'composer-modal' });\r\n\r\n  container.innerHTML = `\r\n    <style>\r\n      .composer-overlay {\r\n        position: fixed;\r\n        inset: 0;\r\n        background: rgba(0, 0, 0, 0.5);\r\n        backdrop-filter: blur(8px);\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        z-index: 10000;\r\n        opacity: 0;\r\n        transition: opacity 0.2s ease;\r\n      }\r\n      .composer-overlay.visible {\r\n        opacity: 1;\r\n      }\r\n      .composer-overlay.visible .composer-modal {\r\n        transform: translateY(0) scale(1);\r\n        opacity: 1;\r\n      }\r\n      .composer-modal {\r\n        width: 640px;\r\n        max-width: 95vw;\r\n        max-height: 85vh;\r\n        background: var(--bg-primary);\r\n        border-radius: 16px;\r\n        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);\r\n        display: flex;\r\n        flex-direction: column;\r\n        overflow: hidden;\r\n        transform: translateY(20px) scale(0.98);\r\n        opacity: 0;\r\n        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\r\n      }\r\n      \r\n      /* Header */\r\n      .composer-header {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: space-between;\r\n        padding: 20px 24px;\r\n        border-bottom: 1px solid var(--border-color);\r\n      }\r\n      .composer-header h2 {\r\n        margin: 0;\r\n        font-size: 18px;\r\n        font-weight: 600;\r\n        color: var(--text-primary);\r\n      }\r\n      .composer-close {\r\n        width: 32px;\r\n        height: 32px;\r\n        border: none;\r\n        background: var(--bg-secondary);\r\n        border-radius: 8px;\r\n        cursor: pointer;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        color: var(--text-secondary);\r\n        transition: all 0.15s ease;\r\n      }\r\n      .composer-close:hover {\r\n        background: var(--bg-tertiary);\r\n        color: var(--text-primary);\r\n      }\r\n      \r\n      /* Tabs */\r\n      .composer-tabs {\r\n        display: flex;\r\n        padding: 0 24px;\r\n        border-bottom: 1px solid var(--border-color);\r\n        background: var(--bg-secondary);\r\n      }\r\n      .composer-tab {\r\n        padding: 14px 20px;\r\n        font-size: 14px;\r\n        font-weight: 500;\r\n        color: var(--text-secondary);\r\n        background: none;\r\n        border: none;\r\n        cursor: pointer;\r\n        position: relative;\r\n        transition: color 0.15s ease;\r\n      }\r\n      .composer-tab:hover {\r\n        color: var(--text-primary);\r\n      }\r\n      .composer-tab.active {\r\n        color: var(--primary);\r\n      }\r\n      .composer-tab.active::after {\r\n        content: '';\r\n        position: absolute;\r\n        bottom: 0;\r\n        left: 0;\r\n        right: 0;\r\n        height: 2px;\r\n        background: var(--primary);\r\n        border-radius: 2px 2px 0 0;\r\n      }\r\n      \r\n      /* Content */\r\n      .composer-body {\r\n        flex: 1;\r\n        padding: 24px;\r\n        overflow-y: auto;\r\n      }\r\n      \r\n      /* Paste Mode */\r\n      .paste-section label {\r\n        display: block;\r\n        font-size: 14px;\r\n        font-weight: 500;\r\n        color: var(--text-primary);\r\n        margin-bottom: 12px;\r\n      }\r\n      .paste-section textarea {\r\n        width: 100%;\r\n        min-height: 280px;\r\n        padding: 16px;\r\n        border: 1px solid var(--border-color);\r\n        border-radius: 12px;\r\n        background: var(--bg-secondary);\r\n        color: var(--text-primary);\r\n        font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;\r\n        font-size: 13px;\r\n        line-height: 1.6;\r\n        resize: vertical;\r\n        transition: border-color 0.15s ease, box-shadow 0.15s ease;\r\n      }\r\n      .paste-section textarea:focus {\r\n        outline: none;\r\n        border-color: var(--primary);\r\n        box-shadow: 0 0 0 3px rgba(var(--primary-rgb), 0.1);\r\n      }\r\n      .paste-section textarea::placeholder {\r\n        color: var(--text-tertiary);\r\n      }\r\n      .paste-hint {\r\n        margin-top: 12px;\r\n        font-size: 13px;\r\n        color: var(--text-tertiary);\r\n      }\r\n      \r\n      /* Source Select */\r\n      .source-row {\r\n        margin-top: 20px;\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 12px;\r\n      }\r\n      .source-row label {\r\n        font-size: 13px;\r\n        color: var(--text-secondary);\r\n        white-space: nowrap;\r\n      }\r\n      .source-row select {\r\n        flex: 1;\r\n        max-width: 200px;\r\n        padding: 10px 14px;\r\n        border: 1px solid var(--border-color);\r\n        border-radius: 8px;\r\n        background: var(--bg-secondary);\r\n        color: var(--text-primary);\r\n        font-size: 13px;\r\n        cursor: pointer;\r\n      }\r\n      .source-row select:focus {\r\n        outline: none;\r\n        border-color: var(--primary);\r\n      }\r\n      \r\n      /* Upload Mode */\r\n      .upload-section .dropzone {\r\n        border: 2px dashed var(--border-color);\r\n        border-radius: 16px;\r\n        padding: 60px 40px;\r\n        text-align: center;\r\n        cursor: pointer;\r\n        transition: all 0.2s ease;\r\n        background: var(--bg-secondary);\r\n      }\r\n      .upload-section .dropzone:hover,\r\n      .upload-section .dropzone.dragover {\r\n        border-color: var(--primary);\r\n        background: rgba(var(--primary-rgb), 0.03);\r\n      }\r\n      .dropzone-icon {\r\n        font-size: 48px;\r\n        margin-bottom: 16px;\r\n      }\r\n      .dropzone-title {\r\n        font-size: 16px;\r\n        font-weight: 500;\r\n        color: var(--text-primary);\r\n        margin-bottom: 8px;\r\n      }\r\n      .dropzone-hint {\r\n        font-size: 13px;\r\n        color: var(--text-tertiary);\r\n      }\r\n      \r\n      /* Selected File */\r\n      .selected-file {\r\n        display: none;\r\n        align-items: center;\r\n        gap: 16px;\r\n        margin-top: 20px;\r\n        padding: 16px;\r\n        background: var(--bg-secondary);\r\n        border-radius: 12px;\r\n        border: 1px solid var(--border-color);\r\n      }\r\n      .selected-file.visible {\r\n        display: flex;\r\n      }\r\n      .file-icon {\r\n        width: 48px;\r\n        height: 48px;\r\n        background: linear-gradient(135deg, var(--primary), color-mix(in srgb, var(--primary) 70%, white));\r\n        border-radius: 12px;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        font-size: 24px;\r\n      }\r\n      .file-info {\r\n        flex: 1;\r\n        min-width: 0;\r\n      }\r\n      .file-name {\r\n        font-size: 14px;\r\n        font-weight: 500;\r\n        color: var(--text-primary);\r\n        white-space: nowrap;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n      }\r\n      .file-size {\r\n        font-size: 12px;\r\n        color: var(--text-tertiary);\r\n        margin-top: 2px;\r\n      }\r\n      .file-remove {\r\n        width: 32px;\r\n        height: 32px;\r\n        border: none;\r\n        background: transparent;\r\n        border-radius: 8px;\r\n        cursor: pointer;\r\n        color: var(--text-tertiary);\r\n        font-size: 18px;\r\n        transition: all 0.15s ease;\r\n      }\r\n      .file-remove:hover {\r\n        background: rgba(239, 68, 68, 0.1);\r\n        color: #ef4444;\r\n      }\r\n      \r\n      /* Footer */\r\n      .composer-footer {\r\n        display: flex;\r\n        justify-content: flex-end;\r\n        gap: 12px;\r\n        padding: 16px 24px;\r\n        border-top: 1px solid var(--border-color);\r\n        background: var(--bg-secondary);\r\n      }\r\n      .composer-footer .btn {\r\n        padding: 10px 20px;\r\n        border-radius: 10px;\r\n        font-size: 14px;\r\n        font-weight: 500;\r\n        cursor: pointer;\r\n        transition: all 0.15s ease;\r\n        border: none;\r\n      }\r\n      .composer-footer .btn-secondary {\r\n        background: var(--bg-primary);\r\n        color: var(--text-primary);\r\n        border: 1px solid var(--border-color);\r\n      }\r\n      .composer-footer .btn-secondary:hover {\r\n        background: var(--bg-tertiary);\r\n      }\r\n      .composer-footer .btn-primary {\r\n        background: var(--primary);\r\n        color: white;\r\n      }\r\n      .composer-footer .btn-primary:hover:not(:disabled) {\r\n        opacity: 0.9;\r\n        transform: translateY(-1px);\r\n      }\r\n      .composer-footer .btn-primary:disabled {\r\n        opacity: 0.5;\r\n        cursor: not-allowed;\r\n      }\r\n    </style>\r\n    \r\n    <div class=\"composer-header\">\r\n      <h2>Import Transcript</h2>\r\n      <button class=\"composer-close\" id=\"close-btn\">\r\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n          <path d=\"M18 6L6 18M6 6l12 12\"/>\r\n        </svg>\r\n      </button>\r\n    </div>\r\n    \r\n    <div class=\"composer-tabs\">\r\n      <button class=\"composer-tab active\" data-mode=\"paste\">Paste Text</button>\r\n      <button class=\"composer-tab\" data-mode=\"upload\">Upload File</button>\r\n    </div>\r\n    \r\n    <div class=\"composer-body\" id=\"composer-body\">\r\n      ${renderPasteMode()}\r\n    </div>\r\n    \r\n    <div class=\"composer-association\" style=\"padding: 12px 24px; border-top: 1px solid var(--border-color); display: flex; flex-wrap: wrap; gap: 12px; align-items: center;\">\r\n      <span style=\"font-size: 13px; font-weight: 500; color: var(--text-secondary);\">Associate with (optional)</span>\r\n      <select id=\"transcript-sprint-select\" class=\"form-select\" style=\"min-width: 140px;\"><option value=\"\">No sprint</option></select>\r\n      <select id=\"transcript-action-select\" class=\"form-select\" style=\"min-width: 180px;\"><option value=\"\">No task</option></select>\r\n    </div>\r\n    \r\n    <div class=\"composer-footer\">\r\n      <button class=\"btn btn-secondary\" id=\"cancel-btn\">Cancel</button>\r\n      <button class=\"btn btn-primary\" id=\"import-btn\" disabled>Process Transcript</button>\r\n    </div>\r\n  `;\r\n\r\n  // Bind tabs\r\n  container.querySelectorAll('.composer-tab').forEach(tab => {\r\n    on(tab as HTMLElement, 'click', () => {\r\n      container.querySelectorAll('.composer-tab').forEach(t => t.classList.remove('active'));\r\n      tab.classList.add('active');\r\n      currentMode = tab.getAttribute('data-mode') as InputMode;\r\n      renderMode(container);\r\n    });\r\n  });\r\n\r\n  // Bind close\r\n  on(container.querySelector('#close-btn') as HTMLElement, 'click', () => {\r\n    closeTranscriptComposer();\r\n    props.onClose?.();\r\n  });\r\n\r\n  // Bind cancel\r\n  on(container.querySelector('#cancel-btn') as HTMLElement, 'click', () => {\r\n    closeTranscriptComposer();\r\n    props.onClose?.();\r\n  });\r\n\r\n  // Bind import\r\n  const importBtn = container.querySelector('#import-btn') as HTMLButtonElement;\r\n  on(importBtn, 'click', () => handleImport(container, props));\r\n\r\n  // Initial binding\r\n  bindPasteMode(container);\r\n  initTranscriptSprintTask(container);\r\n\r\n  return container;\r\n}\r\n\r\nasync function initTranscriptSprintTask(container: HTMLElement): Promise<void> {\r\n  const sprintSelect = container.querySelector('#transcript-sprint-select') as HTMLSelectElement;\r\n  const actionSelect = container.querySelector('#transcript-action-select') as HTMLSelectElement;\r\n  if (!sprintSelect || !actionSelect) return;\r\n  try {\r\n    const sprints = await getSprints();\r\n    sprints.forEach(s => {\r\n      const opt = document.createElement('option');\r\n      opt.value = s.id;\r\n      opt.textContent = s.name;\r\n      sprintSelect.appendChild(opt);\r\n    });\r\n    on(sprintSelect, 'change', async () => {\r\n      const sprintId = sprintSelect.value || '';\r\n      actionSelect.innerHTML = '<option value=\"\">No task</option>';\r\n      if (!sprintId) return;\r\n      try {\r\n        const actions = await getActions(undefined, sprintId);\r\n        actions.forEach(a => {\r\n          const opt = document.createElement('option');\r\n          opt.value = String(a.id);\r\n          opt.textContent = (a.content || a.task || String(a.id)).slice(0, 60) + ((a.content || a.task || '').length > 60 ? '‚Ä¶' : '');\r\n          actionSelect.appendChild(opt);\r\n        });\r\n      } catch {\r\n        // ignore\r\n      }\r\n    });\r\n  } catch {\r\n    // ignore\r\n  }\r\n}\r\n\r\nfunction renderMode(container: HTMLElement): void {\r\n  const body = container.querySelector('#composer-body') as HTMLElement;\r\n  body.innerHTML = currentMode === 'paste' ? renderPasteMode() : renderUploadMode();\r\n  \r\n  if (currentMode === 'paste') {\r\n    bindPasteMode(container);\r\n  } else {\r\n    bindUploadMode(container);\r\n  }\r\n}\r\n\r\nfunction renderPasteMode(): string {\r\n  return `\r\n    <div class=\"paste-section\">\r\n      <label>Paste meeting transcript:</label>\r\n      <textarea id=\"transcript-input\" placeholder=\"Paste your meeting transcript here...\r\n\r\nSupported formats:\r\n‚Ä¢ Krisp transcripts\r\n‚Ä¢ Otter.ai transcripts  \r\n‚Ä¢ Zoom meeting transcripts\r\n‚Ä¢ Google Meet transcripts\r\n‚Ä¢ Microsoft Teams transcripts\r\n\r\nExample:\r\nSpeaker 1 (00:00:05):\r\nHello everyone, welcome to today's meeting.\r\n\r\nSpeaker 2 (00:00:12):\r\nThanks for having us. Let's get started.\"></textarea>\r\n      <p class=\"paste-hint\">Include speaker names and timestamps if available for better parsing.</p>\r\n      <div class=\"source-row\">\r\n        <label>Source:</label>\r\n        <select id=\"source-select\">\r\n          <option value=\"\">Auto-detect</option>\r\n          <option value=\"krisp\">Krisp</option>\r\n          <option value=\"otter\">Otter.ai</option>\r\n          <option value=\"zoom\">Zoom</option>\r\n          <option value=\"meet\">Google Meet</option>\r\n          <option value=\"teams\">Microsoft Teams</option>\r\n        </select>\r\n      </div>\r\n    </div>\r\n  `;\r\n}\r\n\r\nfunction bindPasteMode(container: HTMLElement): void {\r\n  const textarea = container.querySelector('#transcript-input') as HTMLTextAreaElement;\r\n  const importBtn = container.querySelector('#import-btn') as HTMLButtonElement;\r\n\r\n  if (textarea) {\r\n    on(textarea, 'input', () => {\r\n      importBtn.disabled = textarea.value.trim().length < 20;\r\n    });\r\n  }\r\n}\r\n\r\nfunction renderUploadMode(): string {\r\n  return `\r\n    <div class=\"upload-section\">\r\n      <div class=\"dropzone\" id=\"file-dropzone\">\r\n        <div class=\"dropzone-icon\">üéôÔ∏è</div>\r\n        <p class=\"dropzone-title\">Drop transcript file here</p>\r\n        <p class=\"dropzone-hint\">or click to browse ‚Ä¢ .txt, .md, .srt, .vtt</p>\r\n        <input type=\"file\" id=\"file-input\" accept=\".txt,.md,.srt,.vtt,.json\" hidden>\r\n      </div>\r\n      <div class=\"selected-file\" id=\"selected-file\">\r\n        <div class=\"file-icon\">üìÑ</div>\r\n        <div class=\"file-info\">\r\n          <div class=\"file-name\" id=\"file-name\"></div>\r\n          <div class=\"file-size\" id=\"file-size\"></div>\r\n        </div>\r\n        <button class=\"file-remove\" id=\"file-remove\">√ó</button>\r\n      </div>\r\n    </div>\r\n  `;\r\n}\r\n\r\nfunction bindUploadMode(container: HTMLElement): void {\r\n  const dropzone = container.querySelector('#file-dropzone') as HTMLElement;\r\n  const input = container.querySelector('#file-input') as HTMLInputElement;\r\n  const selectedFile = container.querySelector('#selected-file') as HTMLElement;\r\n  const importBtn = container.querySelector('#import-btn') as HTMLButtonElement;\r\n\r\n  on(dropzone, 'click', () => input.click());\r\n\r\n  on(dropzone, 'dragover', (e) => {\r\n    e.preventDefault();\r\n    dropzone.classList.add('dragover');\r\n  });\r\n\r\n  on(dropzone, 'dragleave', () => dropzone.classList.remove('dragover'));\r\n\r\n  on(dropzone, 'drop', (e) => {\r\n    e.preventDefault();\r\n    dropzone.classList.remove('dragover');\r\n    const file = e.dataTransfer?.files[0];\r\n    if (file) selectFile(file, container);\r\n  });\r\n\r\n  on(input, 'change', () => {\r\n    if (input.files?.[0]) selectFile(input.files[0], container);\r\n  });\r\n\r\n  on(container.querySelector('#file-remove') as HTMLElement, 'click', () => {\r\n    selectedFile.classList.remove('visible');\r\n    (container as any)._fileContent = null;\r\n    importBtn.disabled = true;\r\n  });\r\n}\r\n\r\nfunction selectFile(file: File, container: HTMLElement): void {\r\n  const selectedFile = container.querySelector('#selected-file') as HTMLElement;\r\n  const importBtn = container.querySelector('#import-btn') as HTMLButtonElement;\r\n  \r\n  container.querySelector('#file-name')!.textContent = file.name;\r\n  container.querySelector('#file-size')!.textContent = formatFileSize(file.size);\r\n  selectedFile.classList.add('visible');\r\n\r\n  const reader = new FileReader();\r\n  reader.onload = () => {\r\n    (container as any)._fileContent = reader.result;\r\n    importBtn.disabled = false;\r\n  };\r\n  reader.readAsText(file);\r\n}\r\n\r\nfunction getContent(container: HTMLElement): string {\r\n  if (currentMode === 'paste') {\r\n    return (container.querySelector('#transcript-input') as HTMLTextAreaElement)?.value || '';\r\n  }\r\n  return (container as any)._fileContent || '';\r\n}\r\n\r\nasync function handleImport(container: HTMLElement, props: TranscriptComposerProps): Promise<void> {\r\n  const importBtn = container.querySelector('#import-btn') as HTMLButtonElement;\r\n  const cancelBtn = container.querySelector('#cancel-btn') as HTMLButtonElement;\r\n  const content = getContent(container);\r\n  if (!content) return;\r\n\r\n  // Prevent double-click\r\n  if (importBtn.disabled) return;\r\n  \r\n  importBtn.disabled = true;\r\n  cancelBtn.disabled = true;\r\n  \r\n  // Show processing state in footer\r\n  const footer = container.querySelector('.composer-footer') as HTMLElement;\r\n  const originalFooter = footer.innerHTML;\r\n  \r\n  footer.innerHTML = `\r\n    <div class=\"transcript-status-row\">\r\n      <div class=\"processing-spinner\"></div>\r\n      <div class=\"transcript-status-fill\">\r\n        <div class=\"transcript-status-title\" id=\"processing-status\">Uploading transcript...</div>\r\n        <div class=\"transcript-status-detail\" id=\"processing-detail\">Please wait</div>\r\n      </div>\r\n    </div>\r\n  `;\r\n  \r\n  const statusEl = footer.querySelector('#processing-status') as HTMLElement;\r\n  const detailEl = footer.querySelector('#processing-detail') as HTMLElement;\r\n\r\n  try {\r\n    const sourceSelect = container.querySelector('#source-select') as HTMLSelectElement;\r\n    const formData = new FormData();\r\n    const filename = `transcript_${Date.now()}.txt`;\r\n    formData.append('file', new Blob([content], { type: 'text/plain' }), filename);\r\n    formData.append('folder', 'newtranscripts');\r\n    if (sourceSelect?.value) formData.append('source', sourceSelect.value);\r\n    const sprintSelect = container.querySelector('#transcript-sprint-select') as HTMLSelectElement;\r\n    const actionSelect = container.querySelector('#transcript-action-select') as HTMLSelectElement;\r\n    if (sprintSelect?.value) formData.append('sprintId', sprintSelect.value);\r\n    if (actionSelect?.value) formData.append('actionId', actionSelect.value);\r\n\r\n    // Step 1: Upload\r\n    statusEl.textContent = 'Uploading transcript...';\r\n    detailEl.textContent = `${formatFileSize(content.length)} ‚Ä¢ ${filename}`;\r\n    \r\n    const response = await fetchWithProject('/api/upload', {\r\n      method: 'POST',\r\n      body: formData,\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const errorData = await response.json().catch(() => ({}));\r\n      throw new Error(errorData.error || `Upload failed (${response.status})`);\r\n    }\r\n\r\n    const result = await response.json();\r\n    \r\n    // Step 2: Processing started\r\n    statusEl.textContent = 'Transcript uploaded!';\r\n    detailEl.textContent = 'AI processing will start automatically';\r\n    \r\n    // Show success state briefly\r\n    footer.innerHTML = `\r\n      <div class=\"transcript-status-row\">\r\n        <div class=\"transcript-success-icon\">‚úì</div>\r\n        <div class=\"transcript-status-fill\">\r\n          <div class=\"transcript-success-title\">Transcript imported successfully!</div>\r\n          <div class=\"transcript-status-detail\">AI extraction will process in the background</div>\r\n        </div>\r\n      </div>\r\n      <button class=\"btn btn-primary transcript-done-btn\" id=\"done-btn\">Done</button>\r\n    `;\r\n    \r\n    // Bind done button\r\n    footer.querySelector('#done-btn')?.addEventListener('click', () => {\r\n      props.onImport?.(result);\r\n      closeTranscriptComposer();\r\n    });\r\n    \r\n    // Auto-close after 3 seconds\r\n    setTimeout(() => {\r\n      props.onImport?.(result);\r\n      closeTranscriptComposer();\r\n    }, 3000);\r\n    \r\n  } catch (err) {\r\n    console.error('[TranscriptComposer] Error:', err);\r\n    \r\n    // Show error state\r\n    footer.innerHTML = `\r\n      <div class=\"transcript-status-row\">\r\n        <div class=\"transcript-error-icon\">‚úï</div>\r\n        <div class=\"transcript-status-fill\">\r\n          <div class=\"transcript-error-title\">Import failed</div>\r\n          <div class=\"transcript-status-detail\">${err instanceof Error ? err.message : 'Unknown error'}</div>\r\n        </div>\r\n      </div>\r\n      <button type=\"button\" class=\"btn btn-secondary transcript-retry-btn\" id=\"retry-btn\">Try Again</button>\r\n    `;\r\n    \r\n    // Bind retry button\r\n    footer.querySelector('#retry-btn')?.addEventListener('click', () => {\r\n      footer.innerHTML = originalFooter;\r\n      const newImportBtn = footer.querySelector('#import-btn') as HTMLButtonElement;\r\n      const newCancelBtn = footer.querySelector('#cancel-btn') as HTMLButtonElement;\r\n      if (newImportBtn) {\r\n        newImportBtn.disabled = false;\r\n        newImportBtn.addEventListener('click', () => handleImport(container, props));\r\n      }\r\n      if (newCancelBtn) {\r\n        newCancelBtn.disabled = false;\r\n        newCancelBtn.addEventListener('click', () => {\r\n          closeTranscriptComposer();\r\n          props.onClose?.();\r\n        });\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction formatFileSize(bytes: number): string {\r\n  if (bytes < 1024) return `${bytes} B`;\r\n  if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;\r\n  return `${(bytes / (1024 * 1024)).toFixed(1)} MB`;\r\n}\r\n\r\nexport default showTranscriptComposer;\r\n"],"names":["currentMode","showTranscriptComposer","props","existing","overlay","createElement","dialog","createTranscriptComposer","on","e","closeTranscriptComposer","container","renderPasteMode","tab","t","renderMode","importBtn","handleImport","bindPasteMode","initTranscriptSprintTask","sprintSelect","actionSelect","getSprints","s","opt","sprintId","getActions","a","body","renderUploadMode","bindUploadMode","textarea","dropzone","input","selectedFile","file","selectFile","formatFileSize","reader","getContent","cancelBtn","content","footer","originalFooter","statusEl","detailEl","sourceSelect","formData","filename","response","fetchWithProject","errorData","result","err","newImportBtn","newCancelBtn","bytes"],"mappings":"gHAiBA,IAAIA,EAAyB,QAKtB,SAASC,EAAuBC,EAAiC,GAAU,CAChF,MAAMC,EAAW,SAAS,eAAe,6BAA6B,EAClEA,KAAmB,OAAA,EAEvB,MAAMC,EAAUC,EAAc,MAAO,CACnC,GAAI,8BACJ,UAAW,kBAAA,CACZ,EAEKC,EAASC,EAAyBL,CAAK,EAC7CE,EAAQ,YAAYE,CAAM,EAC1B,SAAS,KAAK,YAAYF,CAAO,EAEjCI,EAAGJ,EAAS,QAAUK,GAAM,CACtBA,EAAE,SAAWL,IACfM,EAAA,EACAR,EAAM,UAAA,EAEV,CAAC,EAGD,sBAAsB,IAAM,CAC1BE,EAAQ,UAAU,IAAI,SAAS,CACjC,CAAC,CACH,CAKO,SAASM,GAAgC,CAC9C,MAAMN,EAAU,SAAS,eAAe,6BAA6B,EACjEA,IACFA,EAAQ,UAAU,OAAO,SAAS,EAClC,WAAW,IAAMA,EAAQ,OAAA,EAAU,GAAG,EAE1C,CAKA,SAASG,EAAyBL,EAA6C,CAC7E,MAAMS,EAAYN,EAAc,MAAO,CAAE,UAAW,iBAAkB,EAEtEM,EAAU,UAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QA4ThBC,GAAiB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAgBvBD,EAAU,iBAAiB,eAAe,EAAE,QAAQE,GAAO,CACzDL,EAAGK,EAAoB,QAAS,IAAM,CACpCF,EAAU,iBAAiB,eAAe,EAAE,WAAaG,EAAE,UAAU,OAAO,QAAQ,CAAC,EACrFD,EAAI,UAAU,IAAI,QAAQ,EAC1Bb,EAAca,EAAI,aAAa,WAAW,EAC1CE,EAAWJ,CAAS,CACtB,CAAC,CACH,CAAC,EAGDH,EAAGG,EAAU,cAAc,YAAY,EAAkB,QAAS,IAAM,CACtED,EAAA,EACAR,EAAM,UAAA,CACR,CAAC,EAGDM,EAAGG,EAAU,cAAc,aAAa,EAAkB,QAAS,IAAM,CACvED,EAAA,EACAR,EAAM,UAAA,CACR,CAAC,EAGD,MAAMc,EAAYL,EAAU,cAAc,aAAa,EACvD,OAAAH,EAAGQ,EAAW,QAAS,IAAMC,EAAaN,EAAWT,CAAK,CAAC,EAG3DgB,EAAcP,CAAS,EACvBQ,EAAyBR,CAAS,EAE3BA,CACT,CAEA,eAAeQ,EAAyBR,EAAuC,CAC7E,MAAMS,EAAeT,EAAU,cAAc,2BAA2B,EAClEU,EAAeV,EAAU,cAAc,2BAA2B,EACxE,GAAI,GAACS,GAAgB,CAACC,GACtB,GAAI,EACc,MAAMC,EAAA,GACd,QAAQC,GAAK,CACnB,MAAMC,EAAM,SAAS,cAAc,QAAQ,EAC3CA,EAAI,MAAQD,EAAE,GACdC,EAAI,YAAcD,EAAE,KACpBH,EAAa,YAAYI,CAAG,CAC9B,CAAC,EACDhB,EAAGY,EAAc,SAAU,SAAY,CACrC,MAAMK,EAAWL,EAAa,OAAS,GAEvC,GADAC,EAAa,UAAY,oCACrB,EAACI,EACL,GAAI,EACc,MAAMC,EAAW,OAAWD,CAAQ,GAC5C,QAAQE,GAAK,CACnB,MAAMH,EAAM,SAAS,cAAc,QAAQ,EAC3CA,EAAI,MAAQ,OAAOG,EAAE,EAAE,EACvBH,EAAI,aAAeG,EAAE,SAAWA,EAAE,MAAQ,OAAOA,EAAE,EAAE,GAAG,MAAM,EAAG,EAAE,IAAMA,EAAE,SAAWA,EAAE,MAAQ,IAAI,OAAS,GAAK,IAAM,IACxHN,EAAa,YAAYG,CAAG,CAC9B,CAAC,CACH,MAAQ,CAER,CACF,CAAC,CACH,MAAQ,CAER,CACF,CAEA,SAAST,EAAWJ,EAA8B,CAChD,MAAMiB,EAAOjB,EAAU,cAAc,gBAAgB,EACrDiB,EAAK,UAAY5B,IAAgB,QAAUY,EAAA,EAAoBiB,EAAA,EAE3D7B,IAAgB,QAClBkB,EAAcP,CAAS,EAEvBmB,EAAenB,CAAS,CAE5B,CAEA,SAASC,GAA0B,CACjC,MAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAgCT,CAEA,SAASM,EAAcP,EAA8B,CACnD,MAAMoB,EAAWpB,EAAU,cAAc,mBAAmB,EACtDK,EAAYL,EAAU,cAAc,aAAa,EAEnDoB,GACFvB,EAAGuB,EAAU,QAAS,IAAM,CAC1Bf,EAAU,SAAWe,EAAS,MAAM,KAAA,EAAO,OAAS,EACtD,CAAC,CAEL,CAEA,SAASF,GAA2B,CAClC,MAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAkBT,CAEA,SAASC,EAAenB,EAA8B,CACpD,MAAMqB,EAAWrB,EAAU,cAAc,gBAAgB,EACnDsB,EAAQtB,EAAU,cAAc,aAAa,EAC7CuB,EAAevB,EAAU,cAAc,gBAAgB,EACvDK,EAAYL,EAAU,cAAc,aAAa,EAEvDH,EAAGwB,EAAU,QAAS,IAAMC,EAAM,OAAO,EAEzCzB,EAAGwB,EAAU,WAAavB,GAAM,CAC9BA,EAAE,eAAA,EACFuB,EAAS,UAAU,IAAI,UAAU,CACnC,CAAC,EAEDxB,EAAGwB,EAAU,YAAa,IAAMA,EAAS,UAAU,OAAO,UAAU,CAAC,EAErExB,EAAGwB,EAAU,OAASvB,GAAM,CAC1BA,EAAE,eAAA,EACFuB,EAAS,UAAU,OAAO,UAAU,EACpC,MAAMG,EAAO1B,EAAE,cAAc,MAAM,CAAC,EAChC0B,GAAMC,EAAWD,EAAMxB,CAAS,CACtC,CAAC,EAEDH,EAAGyB,EAAO,SAAU,IAAM,CACpBA,EAAM,QAAQ,CAAC,KAAcA,EAAM,MAAM,CAAC,EAAGtB,CAAS,CAC5D,CAAC,EAEDH,EAAGG,EAAU,cAAc,cAAc,EAAkB,QAAS,IAAM,CACxEuB,EAAa,UAAU,OAAO,SAAS,EACtCvB,EAAkB,aAAe,KAClCK,EAAU,SAAW,EACvB,CAAC,CACH,CAEA,SAASoB,EAAWD,EAAYxB,EAA8B,CAC5D,MAAMuB,EAAevB,EAAU,cAAc,gBAAgB,EACvDK,EAAYL,EAAU,cAAc,aAAa,EAEvDA,EAAU,cAAc,YAAY,EAAG,YAAcwB,EAAK,KAC1DxB,EAAU,cAAc,YAAY,EAAG,YAAc0B,EAAeF,EAAK,IAAI,EAC7ED,EAAa,UAAU,IAAI,SAAS,EAEpC,MAAMI,EAAS,IAAI,WACnBA,EAAO,OAAS,IAAM,CACnB3B,EAAkB,aAAe2B,EAAO,OACzCtB,EAAU,SAAW,EACvB,EACAsB,EAAO,WAAWH,CAAI,CACxB,CAEA,SAASI,EAAW5B,EAAgC,CAClD,OAAIX,IAAgB,QACVW,EAAU,cAAc,mBAAmB,GAA2B,OAAS,GAEjFA,EAAkB,cAAgB,EAC5C,CAEA,eAAeM,EAAaN,EAAwBT,EAA+C,CACjG,MAAMc,EAAYL,EAAU,cAAc,aAAa,EACjD6B,EAAY7B,EAAU,cAAc,aAAa,EACjD8B,EAAUF,EAAW5B,CAAS,EAIpC,GAHI,CAAC8B,GAGDzB,EAAU,SAAU,OAExBA,EAAU,SAAW,GACrBwB,EAAU,SAAW,GAGrB,MAAME,EAAS/B,EAAU,cAAc,kBAAkB,EACnDgC,EAAiBD,EAAO,UAE9BA,EAAO,UAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAUnB,MAAME,EAAWF,EAAO,cAAc,oBAAoB,EACpDG,EAAWH,EAAO,cAAc,oBAAoB,EAE1D,GAAI,CACF,MAAMI,EAAenC,EAAU,cAAc,gBAAgB,EACvDoC,EAAW,IAAI,SACfC,EAAW,cAAc,KAAK,IAAA,CAAK,OACzCD,EAAS,OAAO,OAAQ,IAAI,KAAK,CAACN,CAAO,EAAG,CAAE,KAAM,YAAA,CAAc,EAAGO,CAAQ,EAC7ED,EAAS,OAAO,SAAU,gBAAgB,EACtCD,GAAc,OAAOC,EAAS,OAAO,SAAUD,EAAa,KAAK,EACrE,MAAM1B,EAAeT,EAAU,cAAc,2BAA2B,EAClEU,EAAeV,EAAU,cAAc,2BAA2B,EACpES,GAAc,OAAO2B,EAAS,OAAO,WAAY3B,EAAa,KAAK,EACnEC,GAAc,OAAO0B,EAAS,OAAO,WAAY1B,EAAa,KAAK,EAGvEuB,EAAS,YAAc,0BACvBC,EAAS,YAAc,GAAGR,EAAeI,EAAQ,MAAM,CAAC,MAAMO,CAAQ,GAEtE,MAAMC,EAAW,MAAMC,EAAiB,cAAe,CACrD,OAAQ,OACR,KAAMH,CAAA,CACP,EAED,GAAI,CAACE,EAAS,GAAI,CAChB,MAAME,EAAY,MAAMF,EAAS,KAAA,EAAO,MAAM,KAAO,CAAA,EAAG,EACxD,MAAM,IAAI,MAAME,EAAU,OAAS,kBAAkBF,EAAS,MAAM,GAAG,CACzE,CAEA,MAAMG,EAAS,MAAMH,EAAS,KAAA,EAG9BL,EAAS,YAAc,uBACvBC,EAAS,YAAc,yCAGvBH,EAAO,UAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAYnBA,EAAO,cAAc,WAAW,GAAG,iBAAiB,QAAS,IAAM,CACjExC,EAAM,WAAWkD,CAAM,EACvB1C,EAAA,CACF,CAAC,EAGD,WAAW,IAAM,CACfR,EAAM,WAAWkD,CAAM,EACvB1C,EAAA,CACF,EAAG,GAAI,CAET,OAAS2C,EAAK,CACZ,QAAQ,MAAM,8BAA+BA,CAAG,EAGhDX,EAAO,UAAY;AAAA;AAAA;AAAA;AAAA;AAAA,kDAK2BW,aAAe,MAAQA,EAAI,QAAU,eAAe;AAAA;AAAA;AAAA;AAAA,MAOlGX,EAAO,cAAc,YAAY,GAAG,iBAAiB,QAAS,IAAM,CAClEA,EAAO,UAAYC,EACnB,MAAMW,EAAeZ,EAAO,cAAc,aAAa,EACjDa,EAAeb,EAAO,cAAc,aAAa,EACnDY,IACFA,EAAa,SAAW,GACxBA,EAAa,iBAAiB,QAAS,IAAMrC,EAAaN,EAAWT,CAAK,CAAC,GAEzEqD,IACFA,EAAa,SAAW,GACxBA,EAAa,iBAAiB,QAAS,IAAM,CAC3C7C,EAAA,EACAR,EAAM,UAAA,CACR,CAAC,EAEL,CAAC,CACH,CACF,CAEA,SAASmC,EAAemB,EAAuB,CAC7C,OAAIA,EAAQ,KAAa,GAAGA,CAAK,KAC7BA,EAAQ,KAAO,KAAa,IAAIA,EAAQ,MAAM,QAAQ,CAAC,CAAC,MACrD,IAAIA,GAAS,KAAO,OAAO,QAAQ,CAAC,CAAC,KAC9C"}
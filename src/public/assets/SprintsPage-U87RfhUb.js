import{c as $,v as I,r as k,j as e,aj as Q,ai as T,N as h,an as Z,a as c,ae as q,C as H,eL as K,eM as V,eN as X,eO as J,eP as W,eQ as ee,eR as te,Y as se,Z as E,K as ae,eS as re,O as o}from"./main-DPJZnN-g.js";import{E as ne}from"./ErrorState-CGhToI5I.js";import{P as U}from"./plus-D_qMNj9L.js";import{C as D}from"./circle-check-big-B1jdWUHQ.js";import{C as R}from"./circle-BenonAoa.js";import{A as ie}from"./arrow-left-zNkLqbte.js";const le=[["path",{d:"M2 3h20",key:"91anmk"}],["path",{d:"M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3",key:"2k9sn8"}],["path",{d:"m7 21 5-5 5 5",key:"bip4we"}]],ce=$("presentation",le),y="rounded-xl border border-[var(--gm-border-primary)] bg-[var(--gm-surface-primary)] shadow-[var(--shadow-sm)]",_="inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg bg-[var(--gm-accent-primary)] text-white hover:opacity-90 transition-opacity disabled:opacity-50",A="inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg bg-[var(--gm-interactive-secondary)] text-[var(--gm-text-primary)] hover:bg-[var(--gm-interactive-secondary-hover)] border border-[var(--gm-border-primary)] disabled:opacity-50",f="bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]",w="text-[10px] font-bold text-[var(--gm-accent-primary)] uppercase tracking-[0.1em]";function L(r){return r&&typeof r=="object"?r:{}}function oe({onCreated:r}){const p=re(),[n,m]=k.useState({name:"",start_date:"",end_date:"",context:"",goals:""}),b=i=>{if(i.preventDefault(),!n.name||!n.start_date||!n.end_date){o.error("Name, start date, and end date are required");return}p.mutate({name:n.name,start_date:n.start_date,end_date:n.end_date,context:n.context||void 0,goals:n.goals?n.goals.split(`
`).filter(a=>a.trim()):void 0},{onSuccess:()=>{o.success("Sprint created"),m({name:"",start_date:"",end_date:"",context:"",goals:""}),r()},onError:a=>o.error(a.message)})};return e.jsxs("form",{onSubmit:b,className:c(y,"p-5 space-y-4"),children:[e.jsx("h3",{className:w,children:"New Sprint"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-medium text-[var(--gm-text-tertiary)] mb-1",children:"Name *"}),e.jsx("input",{value:n.name,onChange:i=>m(a=>({...a,name:i.target.value})),className:c(f,"w-full"),placeholder:"Sprint 1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-medium text-[var(--gm-text-tertiary)] mb-1",children:"Start Date *"}),e.jsx("input",{type:"date",value:n.start_date,onChange:i=>m(a=>({...a,start_date:i.target.value})),className:c(f,"w-full")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-medium text-[var(--gm-text-tertiary)] mb-1",children:"End Date *"}),e.jsx("input",{type:"date",value:n.end_date,onChange:i=>m(a=>({...a,end_date:i.target.value})),className:c(f,"w-full")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-medium text-[var(--gm-text-tertiary)] mb-1",children:"Context (optional)"}),e.jsx("input",{value:n.context,onChange:i=>m(a=>({...a,context:i.target.value})),className:c(f,"w-full"),placeholder:"Focus areas, constraints..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-medium text-[var(--gm-text-tertiary)] mb-1",children:"Goals (one per line, optional)"}),e.jsx("textarea",{value:n.goals,onChange:i=>m(a=>({...a,goals:i.target.value})),rows:3,className:c(f,"w-full resize-none"),placeholder:"Complete feature X\\nFix bug Y\\nDeploy to production"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{type:"submit",disabled:p.isPending,className:_,children:[p.isPending?e.jsx(h,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(U,{className:"w-3.5 h-3.5"}),"Create Sprint"]})})]})}function me({sprintId:r,onBack:p}){const{data:n,isLoading:m}=K(r),{data:b}=V(r),i=X(),a=J(),u=W(),N=ee(),s=te(),[d,S]=k.useState([]),[C,G]=k.useState(""),x=L(n?.sprint??n),P=L(b).tasks??[],z=()=>{i.mutate(r,{onSuccess:t=>{const l=t?.tasks??[];S(l),o.success(`Generated ${l.length} tasks`)},onError:t=>o.error(t.message)})},O=()=>{if(d.length===0){o.error("Generate tasks first");return}a.mutate({sprintId:r,tasks:d},{onSuccess:()=>{o.success("Tasks applied to sprint"),S([])},onError:t=>o.error(t.message)})},B=()=>{u.mutate(r,{onSuccess:t=>{const l=t?.analysis??"";G(l),o.success("Analysis complete")},onError:t=>o.error(t.message)})},F=()=>{N.mutate({sprintId:r},{onSuccess:t=>{const l=t?.html??"";if(l){const v=new Blob([l],{type:"text/html"}),g=URL.createObjectURL(v),j=document.createElement("a");j.href=g,j.download=`sprint-${r}-report.html`,j.click(),URL.revokeObjectURL(g),o.success("Document downloaded")}},onError:t=>o.error(t.message)})},M=()=>{s.mutate(r,{onSuccess:t=>{const l=t?.html??"";if(l){const v=new Blob([l],{type:"text/html"}),g=URL.createObjectURL(v),j=document.createElement("a");j.href=g,j.download=`sprint-${r}-presentation.html`,j.click(),URL.revokeObjectURL(g),o.success("Presentation downloaded")}},onError:t=>o.error(t.message)})};if(m)return e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx(h,{className:"w-6 h-6 animate-spin text-[var(--gm-accent-primary)]"})});const Y=t=>t==="active"?"bg-green-500/10 text-green-400 border-green-500/30":t==="completed"?"bg-blue-500/10 text-blue-400 border-blue-500/30":"bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-tertiary)] border-[var(--gm-border-primary)]";return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:p,className:"w-8 h-8 rounded-lg bg-[var(--gm-interactive-secondary)] flex items-center justify-center hover:bg-[var(--gm-surface-hover)]",children:e.jsx(ie,{className:"w-4 h-4 text-[var(--gm-text-tertiary)]"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-lg font-bold text-[var(--gm-text-primary)]",children:x.name||"Sprint"}),e.jsxs("p",{className:"text-xs text-[var(--gm-text-tertiary)]",children:[x.start_date?new Date(x.start_date).toLocaleDateString():"?"," — ",x.end_date?new Date(x.end_date).toLocaleDateString():"?"]})]}),e.jsx("span",{className:c("text-[10px] font-medium px-2.5 py-1 rounded-full border capitalize",Y(x.status||"planned")),children:x.status||"planned"})]}),Array.isArray(x.goals)&&x.goals.length>0&&e.jsxs("div",{className:c(y,"p-4"),children:[e.jsx("h3",{className:w,children:"Goals"}),e.jsx("ul",{className:"mt-2 space-y-1.5",children:x.goals.map((t,l)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm text-[var(--gm-text-secondary)]",children:[e.jsx(se,{className:"w-3.5 h-3.5 text-[var(--gm-accent-primary)] mt-0.5 shrink-0"}),t]},l))})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:z,disabled:i.isPending,className:_,children:[i.isPending?e.jsx(h,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(E,{className:"w-3.5 h-3.5"}),"Generate Tasks (AI)"]}),d.length>0&&e.jsxs("button",{onClick:O,disabled:a.isPending,className:_,children:[a.isPending?e.jsx(h,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(D,{className:"w-3.5 h-3.5"}),"Apply ",d.length," Tasks"]}),e.jsxs("button",{onClick:B,disabled:u.isPending,className:A,children:[u.isPending?e.jsx(h,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(E,{className:"w-3.5 h-3.5"}),"AI Analysis"]}),e.jsxs("button",{onClick:F,disabled:N.isPending,className:A,children:[N.isPending?e.jsx(h,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(ae,{className:"w-3.5 h-3.5"}),"Export Document"]}),e.jsxs("button",{onClick:M,disabled:s.isPending,className:A,children:[s.isPending?e.jsx(h,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(ce,{className:"w-3.5 h-3.5"}),"Export Presentation"]})]}),d.length>0&&e.jsxs("div",{className:c(y,"p-4"),children:[e.jsx("h3",{className:w,children:"Generated Tasks (Preview)"}),e.jsx("div",{className:"mt-2 space-y-2",children:d.map((t,l)=>e.jsxs("div",{className:"flex items-start gap-2 p-2 rounded-lg bg-[var(--gm-bg-tertiary)]",children:[e.jsx(R,{className:"w-3.5 h-3.5 text-[var(--gm-text-tertiary)] mt-0.5 shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("span",{className:"text-xs font-medium text-[var(--gm-text-primary)]",children:t.title||t.task||t.name||"—"}),t.description&&e.jsx("p",{className:"text-[10px] text-[var(--gm-text-tertiary)] mt-0.5",children:t.description})]}),t.priority&&e.jsx("span",{className:"text-[9px] font-medium px-2 py-0.5 rounded-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] text-[var(--gm-text-tertiary)] capitalize shrink-0",children:t.priority})]},l))})]}),C&&e.jsxs("div",{className:c(y,"p-4"),children:[e.jsx("h3",{className:w,children:"AI Analysis"}),e.jsx("div",{className:"mt-2 prose prose-sm dark:prose-invert max-w-none text-[var(--gm-text-secondary)] whitespace-pre-wrap text-xs",children:C})]}),P.length>0&&e.jsxs("div",{className:c(y,"p-4"),children:[e.jsxs("h3",{className:w,children:["Sprint Tasks (",P.length,")"]}),e.jsx("div",{className:"mt-2 space-y-1.5",children:P.map((t,l)=>{const v=t.status||"pending",g=v==="completed"||v==="done";return e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg hover:bg-[var(--gm-surface-hover)]",children:[g?e.jsx(D,{className:"w-3.5 h-3.5 text-green-400 shrink-0"}):e.jsx(R,{className:"w-3.5 h-3.5 text-[var(--gm-text-tertiary)] shrink-0"}),e.jsx("span",{className:c("text-xs flex-1",g?"line-through text-[var(--gm-text-tertiary)]":"text-[var(--gm-text-primary)]"),children:t.title||t.task||t.name||"—"}),e.jsx("span",{className:"text-[9px] text-[var(--gm-text-tertiary)] capitalize",children:v})]},l)})})]})]})}function je(){const r=I(),{data:p,isLoading:n}=r,[m,b]=k.useState(null),[i,a]=k.useState(!1),u=p?.sprints??(Array.isArray(p)?p:[]);if(m)return e.jsx("div",{className:"p-6",children:e.jsx(me,{sprintId:m,onBack:()=>b(null)})});const N=s=>s==="active"?e.jsx(H,{className:"w-3.5 h-3.5 text-green-400"}):s==="completed"?e.jsx(D,{className:"w-3.5 h-3.5 text-blue-400"}):e.jsx(R,{className:"w-3.5 h-3.5 text-[var(--gm-text-tertiary)]"});return e.jsxs("div",{className:"p-6 space-y-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-[var(--gm-text-primary)]",children:"Sprints"}),e.jsxs("p",{className:"text-xs text-[var(--gm-text-tertiary)]",children:[u.length," sprints"]})]}),e.jsxs("button",{onClick:()=>a(!i),className:_,children:[e.jsx(U,{className:"w-3.5 h-3.5"})," New Sprint"]})]}),e.jsx(Q,{children:i&&e.jsx(T.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:e.jsx(oe,{onCreated:()=>a(!1)})})}),r.error?e.jsx(ne,{message:"Failed to load sprints.",onRetry:()=>r.refetch()}):n?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx(h,{className:"w-6 h-6 animate-spin text-[var(--gm-accent-primary)]"})}):u.length===0?e.jsxs("div",{className:c(y,"p-12 text-center"),children:[e.jsx(Z,{className:"w-10 h-10 mx-auto text-[var(--gm-text-tertiary)] mb-3"}),e.jsx("p",{className:"text-sm text-[var(--gm-text-tertiary)]",children:"No sprints yet. Create your first sprint to get started."})]}):e.jsx("div",{className:"space-y-3",children:u.map(s=>{const d=s.status||"planned";return e.jsxs(T.div,{layout:!0,className:c(y,"p-4 hover:border-[var(--gm-accent-primary)]/30 transition-colors cursor-pointer"),onClick:()=>b(String(s.id)),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[N(d),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-sm font-semibold text-[var(--gm-text-primary)]",children:s.name||"Unnamed Sprint"}),e.jsxs("p",{className:"text-[10px] text-[var(--gm-text-tertiary)]",children:[s.start_date?new Date(s.start_date).toLocaleDateString():"?"," — ",s.end_date?new Date(s.end_date).toLocaleDateString():"?",s.context&&e.jsxs("span",{className:"ml-2",children:["· ",s.context.substring(0,60),s.context.length>60?"...":""]})]})]}),e.jsx("span",{className:c("text-[10px] font-medium px-2.5 py-1 rounded-full border capitalize",d==="active"?"bg-green-500/10 text-green-400 border-green-500/30":d==="completed"?"bg-blue-500/10 text-blue-400 border-blue-500/30":"bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-tertiary)] border-[var(--gm-border-primary)]"),children:d}),e.jsx(q,{className:"w-4 h-4 text-[var(--gm-text-tertiary)]"})]}),Array.isArray(s.goals)&&s.goals.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1.5 mt-2 ml-7",children:[s.goals.slice(0,3).map((S,C)=>e.jsx("span",{className:"text-[9px] px-2 py-0.5 rounded-full bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-tertiary)]",children:S},C)),s.goals.length>3&&e.jsxs("span",{className:"text-[9px] text-[var(--gm-text-tertiary)]",children:["+",s.goals.length-3," more"]})]})]},String(s.id))})})]})}export{je as default};
//# sourceMappingURL=SprintsPage-U87RfhUb.js.map

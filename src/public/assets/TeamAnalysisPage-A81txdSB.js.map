{"version":3,"file":"TeamAnalysisPage-A81txdSB.js","sources":["../../frontend/src/components/team/ProfileDetailModal.tsx","../../frontend/src/pages/TeamAnalysisPage.tsx"],"sourcesContent":["import { useState } from 'react';\r\nimport { Dialog, DialogContent, DialogTitle } from '@/components/ui/Dialog';\r\nimport {\r\n  ArrowLeft, MessageSquare, Star, AlertTriangle, Shield, Zap,\r\n  Target, Eye, Loader2, RotateCw, Clock, FileText,\r\n} from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport { useAnalyzeProfile } from '../../hooks/useGodMode';\r\n\r\ninterface Props {\r\n  profile: Record<string, unknown> | null;\r\n  open: boolean;\r\n  onClose: () => void;\r\n}\r\n\r\nfunction AvatarWithFallback({ url, name, initials }: { url: string | null; name: string; initials: string }) {\r\n  const [failed, setFailed] = useState(false);\r\n  if (url && !failed) {\r\n    return (\r\n      <img src={url} alt={name} referrerPolicy=\"no-referrer\"\r\n        onError={() => setFailed(true)}\r\n        className=\"w-14 h-14 rounded-full object-cover border-2 border-blue-600/30\" />\r\n    );\r\n  }\r\n  return (\r\n    <div className=\"w-14 h-14 rounded-full flex items-center justify-center text-lg font-bold text-white border-2 border-white/20\"\r\n      style={{ background: `linear-gradient(135deg, ${stringToColor(name)}, ${adjustColor(stringToColor(name), -30)})` }}>\r\n      {initials}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function ProfileDetailModal({ profile, open, onClose }: Props) {\r\n  const analyzeProfile = useAnalyzeProfile();\r\n\r\n  if (!profile) return null;\r\n\r\n  const contact = (profile.contact ?? {}) as Record<string, unknown>;\r\n  const name = String(contact.name || profile.person_name || 'Unknown');\r\n  const role = String(contact.role || contact.organization || '');\r\n  const initials = name.split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase();\r\n  const avatarRaw = contact.avatar_url || contact.photo_url;\r\n  const avatarUrl = typeof avatarRaw === 'string' && avatarRaw.length > 0 && avatarRaw !== 'undefined' && avatarRaw !== 'null' ? avatarRaw : null;\r\n  const data = (profile.profile_data ?? {}) as Record<string, unknown>;\r\n  const confidence = String(profile.confidence_level || 'low');\r\n  const contactId = String(profile.contact_id || profile.person_id || '');\r\n  const speakingTime = Number(profile.total_speaking_time_seconds || 0);\r\n  const limitations = (profile.limitations ?? []) as string[];\r\n  const lastAnalysis = profile.last_analysis_at ? new Date(String(profile.last_analysis_at)).toLocaleString() : 'â€”';\r\n\r\n  const handleReanalyze = () => {\r\n    if (!contactId) return;\r\n    analyzeProfile.mutate({ personId: contactId, forceReanalysis: true }, {\r\n      onSuccess: () => toast.success(`Re-analysis started for ${name}`),\r\n      onError: () => toast.error('Failed to start re-analysis'),\r\n    });\r\n  };\r\n\r\n  const formatTime = (seconds: number) => {\r\n    if (!seconds) return 'â€”';\r\n    const m = Math.floor(seconds / 60);\r\n    const s = seconds % 60;\r\n    return m > 0 ? `${m}m ${s}s` : `${s}s`;\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={o => !o && onClose()}>\r\n      <DialogContent className=\"max-w-3xl p-0 overflow-hidden\">\r\n        <DialogTitle className=\"sr-only\">Profile: {name}</DialogTitle>\r\n\r\n        {/* Header */}\r\n        <div className=\"p-5\" style={{ background: 'linear-gradient(to right, rgba(37,99,235,0.25), rgba(37,99,235,0.08))' }}>\r\n          <div className=\"flex items-center gap-3\">\r\n            <button onClick={onClose} className=\"text-slate-400 hover:text-slate-200 transition-colors\">\r\n              <ArrowLeft className=\"w-5 h-5\" />\r\n            </button>\r\n            <AvatarWithFallback url={avatarUrl} name={name} initials={initials} />\r\n            <div className=\"flex-1 min-w-0\">\r\n              <h2 className=\"text-lg font-bold text-white\">{name}</h2>\r\n              <div className=\"flex items-center gap-2 mt-0.5 flex-wrap\">\r\n                {role && <span className=\"text-xs text-slate-300\">{role}</span>}\r\n                <span className={`text-[10px] px-2 py-0.5 rounded-full font-medium capitalize ${\r\n                  confidence === 'high' || confidence === 'very_high' ? 'bg-green-500/20 text-green-400' :\r\n                  confidence === 'medium' ? 'bg-yellow-500/20 text-yellow-400' :\r\n                  'bg-white/10 text-slate-300'\r\n                }`}>{confidence.replace('_', ' ')} confidence</span>\r\n              </div>\r\n            </div>\r\n            <button onClick={handleReanalyze} disabled={analyzeProfile.isPending}\r\n              className=\"px-3 py-1.5 rounded-lg bg-blue-600 text-white text-xs font-medium hover:bg-blue-700 flex items-center gap-1.5 disabled:opacity-50 transition-colors\">\r\n              {analyzeProfile.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <RotateCw className=\"w-3.5 h-3.5\" />}\r\n              Re-analyze\r\n            </button>\r\n          </div>\r\n\r\n          {/* Metrics row */}\r\n          <div className=\"flex gap-3 mt-4\">\r\n            <MetricPill label=\"Influence\" value={String(profile.influence_score || 0)} />\r\n            <MetricPill label=\"Transcripts\" value={String(profile.transcript_count || 0)} />\r\n            <MetricPill label=\"Risk\" value={String(profile.risk_tolerance || 'â€”')} />\r\n            <MetricPill label=\"Speaking Time\" value={formatTime(speakingTime)} />\r\n            <MetricPill label=\"Last Analysis\" value={lastAnalysis} />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Profile sections */}\r\n        <div className=\"p-5 max-h-[60vh] overflow-y-auto space-y-4 bg-[var(--gm-surface-primary)]\" style={{ backgroundColor: 'var(--gm-surface-primary)' }}>\r\n          {/* Communication style summary */}\r\n          {profile.communication_style && (\r\n            <div className=\"bg-blue-600/5 border border-blue-600/10 rounded-xl p-4\">\r\n              <h4 className=\"text-[10px] text-gm-interactive-primary font-semibold uppercase tracking-wider mb-1\">Communication Style</h4>\r\n              <p className=\"text-sm text-gm-text-primary\">{String(profile.communication_style)}</p>\r\n            </div>\r\n          )}\r\n\r\n          {/* Dominant motivation */}\r\n          {profile.dominant_motivation && (\r\n            <div className=\"bg-[var(--gm-status-success-bg)] border border-green-500/10 rounded-xl p-4\">\r\n              <h4 className=\"text-[10px] text-gm-status-success font-semibold uppercase tracking-wider mb-1\">Dominant Motivation</h4>\r\n              <p className=\"text-sm text-gm-text-primary\">{String(profile.dominant_motivation)}</p>\r\n            </div>\r\n          )}\r\n\r\n          <CommunicationSection data={data} />\r\n          <MotivationsSection data={data} />\r\n          <PressureSection data={data} />\r\n          <InfluenceTacticsSection data={data} />\r\n          <VulnerabilitiesSection data={data} />\r\n          <StrategySection data={data} />\r\n          <WarningSection data={data} />\r\n          <PowerSection data={data} />\r\n\r\n          {/* Limitations */}\r\n          {limitations.length > 0 && (\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4\">\r\n              <SectionHeader icon={FileText} title=\"Limitations\" />\r\n              <ul className=\"space-y-1\">\r\n                {limitations.map((l, i) => (\r\n                  <li key={i} className=\"text-xs text-gm-text-tertiary flex items-start gap-2\">\r\n                    <span className=\"text-gray-500 mt-0.5\">â€¢</span> {l}\r\n                  </li>\r\n                ))}\r\n              </ul>\r\n            </div>\r\n          )}\r\n\r\n          {Object.keys(data).length === 0 && !profile.communication_style && (\r\n            <div className=\"text-center py-8 text-gm-text-tertiary\">\r\n              <Eye className=\"w-10 h-10 mx-auto mb-3 text-gray-500\" />\r\n              <p className=\"text-sm\">No detailed profile data available yet.</p>\r\n              <p className=\"text-xs mt-1\">Click \"Re-analyze\" to generate AI insights.</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nfunction MetricPill({ label, value }: { label: string; value: string }) {\r\n  return (\r\n    <div className=\"backdrop-blur rounded-lg px-3 py-1.5 text-center\" style={{ backgroundColor: 'rgba(255,255,255,0.1)' }}>\r\n      <p className=\"text-sm font-bold text-white\">{value}</p>\r\n      <p className=\"text-[9px] text-slate-300 uppercase tracking-wider\">{label}</p>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction SectionHeader({ icon: Icon, title }: { icon: typeof MessageSquare; title: string }) {\r\n  return (\r\n    <h4 className=\"flex items-center gap-2 text-sm font-semibold text-gm-text-primary mb-3\">\r\n      <Icon className=\"w-4 h-4 text-gm-interactive-primary\" /> {title}\r\n    </h4>\r\n  );\r\n}\r\n\r\nfunction CommunicationSection({ data }: { data: Record<string, unknown> }) {\r\n  const comm = data.communication_identity as Record<string, unknown> | undefined;\r\n  if (!comm) return null;\r\n  return (\r\n    <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4\">\r\n      <SectionHeader icon={MessageSquare} title=\"Communication Identity\" />\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3\">\r\n        {comm.dominant_style && <InfoBlock label=\"Style\" value={String(comm.dominant_style)} />}\r\n        {comm.intervention_rhythm && <InfoBlock label=\"Rhythm\" value={String(comm.intervention_rhythm)} />}\r\n        {comm.textual_body_language && <InfoBlock label=\"Textual Cues\" value={String(comm.textual_body_language)} />}\r\n      </div>\r\n      <EvidenceList evidence={comm.evidence as Array<Record<string, unknown>> | undefined} />\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction MotivationsSection({ data }: { data: Record<string, unknown> }) {\r\n  const mot = data.motivations_and_priorities as Record<string, unknown> | undefined;\r\n  if (!mot) return null;\r\n  const values = (mot.values_most ?? []) as string[];\r\n  const avoids = (mot.avoids ?? []) as string[];\r\n  return (\r\n    <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4\">\r\n      <SectionHeader icon={Star} title=\"Motivations & Priorities\" />\r\n      {values.length > 0 && (\r\n        <div className=\"mb-2\">\r\n          <span className=\"text-[10px] text-gm-text-tertiary font-medium\">Values most:</span>\r\n          <div className=\"flex flex-wrap gap-1.5 mt-1\">\r\n            {values.map((v, i) => <span key={i} className=\"text-[10px] px-2 py-0.5 rounded-full bg-gm-status-success-bg text-gm-status-success\">{v}</span>)}\r\n          </div>\r\n        </div>\r\n      )}\r\n      {avoids.length > 0 && (\r\n        <div className=\"mb-2\">\r\n          <span className=\"text-[10px] text-gm-text-tertiary font-medium\">Avoids:</span>\r\n          <div className=\"flex flex-wrap gap-1.5 mt-1\">\r\n            {avoids.map((a, i) => <span key={i} className=\"text-[10px] px-2 py-0.5 rounded-full bg-gm-status-danger-bg text-gm-status-danger\">{a}</span>)}\r\n          </div>\r\n        </div>\r\n      )}\r\n      {mot.based_on && <p className=\"text-[10px] text-gm-text-tertiary mt-1\">Based on: {String(mot.based_on)}</p>}\r\n      {mot.confidence && <p className=\"text-[10px] text-gm-text-tertiary\">Confidence: {String(mot.confidence)}</p>}\r\n      <EvidenceList evidence={mot.evidence as Array<Record<string, unknown>> | undefined} />\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction PressureSection({ data }: { data: Record<string, unknown> }) {\r\n  const behaviors = data.behavior_under_pressure as Array<Record<string, unknown>> | undefined;\r\n  if (!behaviors?.length) return null;\r\n  return (\r\n    <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4\">\r\n      <SectionHeader icon={Clock} title=\"Behavior Under Pressure\" />\r\n      <div className=\"space-y-2\">\r\n        {behaviors.map((b, i) => (\r\n          <div key={i} className=\"bg-gm-surface-secondary rounded-lg p-3\">\r\n            <p className=\"text-xs font-medium text-gm-text-primary\">{String(b.situation)}</p>\r\n            <p className=\"text-xs text-gm-text-tertiary mt-0.5\">{String(b.observed_behavior)}</p>\r\n            {b.quote && <p className=\"text-xs italic text-gm-text-tertiary mt-1 border-l-2 border-blue-600/30 pl-2\">\"{String(b.quote)}\"</p>}\r\n            {b.timestamp && <p className=\"text-[10px] text-gray-400 mt-1\">{String(b.timestamp)}</p>}\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction InfluenceTacticsSection({ data }: { data: Record<string, unknown> }) {\r\n  const tactics = data.influence_tactics as Array<Record<string, unknown>> | undefined;\r\n  if (!tactics?.length) return null;\r\n  return (\r\n    <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4\">\r\n      <SectionHeader icon={Target} title=\"Influence Tactics\" />\r\n      <div className=\"space-y-2\">\r\n        {tactics.map((t, i) => (\r\n          <div key={i} className=\"bg-gm-surface-secondary rounded-lg p-3\">\r\n            <p className=\"text-xs font-medium text-gm-text-primary\">{String(t.objective)}</p>\r\n            <p className=\"text-xs text-gm-text-tertiary mt-0.5\">{String(t.tactic)}</p>\r\n            {t.example && <p className=\"text-xs italic text-gm-text-tertiary mt-1 border-l-2 border-blue-600/30 pl-2\">{String(t.example)}</p>}\r\n            {t.timestamp && <p className=\"text-[10px] text-gray-400 mt-1\">{String(t.timestamp)}</p>}\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction VulnerabilitiesSection({ data }: { data: Record<string, unknown> }) {\r\n  const vuln = data.vulnerabilities as Record<string, unknown> | undefined;\r\n  if (!vuln) return null;\r\n  const triggers = (vuln.defense_triggers ?? []) as Array<Record<string, unknown>>;\r\n  const blindSpots = (vuln.blind_spots ?? []) as Array<Record<string, unknown>>;\r\n  const inconsistencies = (vuln.discourse_action_inconsistencies ?? []) as Array<Record<string, unknown>>;\r\n  const riskPatterns = (vuln.risk_patterns ?? []) as Array<Record<string, unknown>>;\r\n  if (!triggers.length && !blindSpots.length && !inconsistencies.length && !riskPatterns.length) return null;\r\n\r\n  return (\r\n    <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4\">\r\n      <SectionHeader icon={Shield} title=\"Vulnerabilities & Friction Points\" />\r\n      {inconsistencies.length > 0 && (\r\n        <VulnBlock label=\"Discourse-Action Inconsistencies\" color=\"text-gm-status-danger\" items={inconsistencies} field=\"description\" evidenceField=\"evidence\" />\r\n      )}\r\n      {triggers.length > 0 && (\r\n        <VulnBlock label=\"Defense Triggers\" color=\"text-gm-status-danger\" items={triggers} field=\"trigger\" evidenceField=\"evidence\" />\r\n      )}\r\n      {blindSpots.length > 0 && (\r\n        <VulnBlock label=\"Blind Spots\" color=\"text-gm-status-warning\" items={blindSpots} field=\"description\" evidenceField=\"evidence\" />\r\n      )}\r\n      {riskPatterns.length > 0 && (\r\n        <VulnBlock label=\"Risk Patterns\" color=\"text-gm-status-warning\" items={riskPatterns} field=\"pattern\" evidenceField=\"evidence\" />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction VulnBlock({ label, color, items, field, evidenceField }: {\r\n  label: string; color: string;\r\n  items: Array<Record<string, unknown>>; field: string; evidenceField: string;\r\n}) {\r\n  return (\r\n    <div className=\"mb-3 last:mb-0\">\r\n      <p className={`text-[10px] font-semibold uppercase tracking-wider mb-1.5 ${color}`}>{label}</p>\r\n      <div className=\"space-y-1.5\">\r\n        {items.map((item, i) => (\r\n          <div key={i} className=\"bg-gm-surface-secondary rounded-lg p-2.5\">\r\n            <p className=\"text-xs text-gm-text-primary\">{String(item[field] || item.text || item)}</p>\r\n            {item[evidenceField] && <p className=\"text-[10px] text-gm-text-tertiary mt-0.5 italic\">{String(item[evidenceField])}</p>}\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction StrategySection({ data }: { data: Record<string, unknown> }) {\r\n  const strat = data.interaction_strategy as Record<string, unknown> | undefined;\r\n  if (!strat) return null;\r\n  const works = (strat.framing_that_works ?? []) as string[];\r\n  const avoid = (strat.what_to_avoid ?? []) as string[];\r\n  const cooperation = (strat.cooperation_triggers ?? []) as string[];\r\n  const format = strat.ideal_format as Record<string, unknown> | undefined;\r\n  return (\r\n    <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4\">\r\n      <SectionHeader icon={MessageSquare} title=\"Recommended Interaction Strategy\" />\r\n      {format && (\r\n        <div className=\"flex flex-wrap gap-2 mb-3\">\r\n          {format.channel && <span className=\"text-[10px] px-2 py-0.5 rounded-full bg-blue-600/10 text-gm-interactive-primary\">Channel: {String(format.channel)}</span>}\r\n          {format.structure && <span className=\"text-[10px] px-2 py-0.5 rounded-full bg-blue-600/10 text-gm-interactive-primary\">Structure: {String(format.structure)}</span>}\r\n          {format.timing && <span className=\"text-[10px] px-2 py-0.5 rounded-full bg-blue-600/10 text-gm-interactive-primary\">Timing: {String(format.timing)}</span>}\r\n        </div>\r\n      )}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3\">\r\n        {works.length > 0 && (\r\n          <div className=\"bg-gm-surface-secondary rounded-lg p-3\">\r\n            <p className=\"text-[10px] text-gm-status-success font-semibold uppercase tracking-wider mb-1\">What Works</p>\r\n            <ul className=\"space-y-0.5\">{works.map((f, i) => <li key={i} className=\"text-xs text-gm-text-primary\">+ {f}</li>)}</ul>\r\n          </div>\r\n        )}\r\n        {avoid.length > 0 && (\r\n          <div className=\"bg-gm-surface-secondary rounded-lg p-3\">\r\n            <p className=\"text-[10px] text-gm-status-danger font-semibold uppercase tracking-wider mb-1\">What to Avoid</p>\r\n            <ul className=\"space-y-0.5\">{avoid.map((a, i) => <li key={i} className=\"text-xs text-gm-text-primary\">- {a}</li>)}</ul>\r\n          </div>\r\n        )}\r\n        {cooperation.length > 0 && (\r\n          <div className=\"bg-gm-surface-secondary rounded-lg p-3\">\r\n            <p className=\"text-[10px] text-gm-interactive-primary font-semibold uppercase tracking-wider mb-1\">Cooperation Triggers</p>\r\n            <ul className=\"space-y-0.5\">{cooperation.map((c, i) => <li key={i} className=\"text-xs text-gm-text-primary\">â†’ {c}</li>)}</ul>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction WarningSection({ data }: { data: Record<string, unknown> }) {\r\n  const warnings = data.early_warning_signs as Array<Record<string, unknown>> | undefined;\r\n  if (!warnings?.length) return null;\r\n  return (\r\n    <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4\">\r\n      <SectionHeader icon={AlertTriangle} title=\"Early Warning Signs\" />\r\n      <div className=\"space-y-2\">\r\n        {warnings.map((w, i) => (\r\n          <div key={i} className=\"bg-[var(--gm-status-warning-bg)] rounded-lg p-3\">\r\n            <p className=\"text-xs font-medium text-gm-text-primary\">{String(w.signal)}</p>\r\n            <p className=\"text-xs text-gm-text-tertiary mt-0.5\">Indicates: {String(w.indicates)}</p>\r\n            {w.comparison_evidence && <p className=\"text-[10px] text-gray-400 mt-1 italic\">Evidence: {String(w.comparison_evidence)}</p>}\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction PowerSection({ data }: { data: Record<string, unknown> }) {\r\n  const power = data.power_analysis as Array<Record<string, unknown>> | undefined;\r\n  if (!power?.length) return null;\r\n  return (\r\n    <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4\">\r\n      <SectionHeader icon={Zap} title=\"Power & Dependency Analysis\" />\r\n      <div className=\"space-y-2\">\r\n        {power.map((p, i) => (\r\n          <div key={i} className=\"bg-gm-surface-secondary rounded-lg p-3\">\r\n            <p className=\"text-xs font-medium text-gm-text-primary\">{String(p.factor)}</p>\r\n            <p className=\"text-xs text-gm-text-tertiary mt-0.5\">{String(p.assessment)}</p>\r\n            {p.strategic_implication && <p className=\"text-xs text-gm-interactive-primary mt-1\">â†’ {String(p.strategic_implication)}</p>}\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction InfoBlock({ label, value }: { label: string; value: string }) {\r\n  return (\r\n    <div className=\"bg-gm-surface-secondary rounded-lg p-3\">\r\n      <span className=\"text-[10px] text-gm-text-tertiary uppercase tracking-wider\">{label}</span>\r\n      <p className=\"text-xs text-gm-text-primary mt-0.5\">{value}</p>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction EvidenceList({ evidence }: { evidence?: Array<Record<string, unknown>> }) {\r\n  if (!evidence?.length) return null;\r\n  return (\r\n    <div className=\"mt-3 space-y-1.5\">\r\n      <p className=\"text-[10px] text-gm-text-tertiary font-medium uppercase tracking-wider\">Evidence</p>\r\n      {evidence.slice(0, 5).map((e, i) => (\r\n        <div key={i} className=\"text-xs bg-[var(--gm-surface-hover)] rounded p-2\">\r\n          {e.quote && <p className=\"italic text-gm-text-tertiary border-l-2 border-blue-600/30 pl-2\">\"{String(e.quote)}\"</p>}\r\n          {e.observation && <p className=\"text-gm-text-tertiary mt-0.5\">{String(e.observation)}</p>}\r\n          {e.timestamp && <p className=\"text-[10px] text-gray-400 mt-0.5\">{String(e.timestamp)}</p>}\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction stringToColor(str: string): string {\r\n  const colors = ['#9b59b6', '#3498db', '#e74c3c', '#27ae60', '#f59e0b', '#1abc9c', '#e67e22', '#34495e'];\r\n  let hash = 0;\r\n  for (let i = 0; i < str.length; i++) hash = str.charCodeAt(i) + ((hash << 5) - hash);\r\n  return colors[Math.abs(hash) % colors.length];\r\n}\r\n\r\nfunction adjustColor(color: string, amount: number): string {\r\n  const clamp = (n: number) => Math.min(255, Math.max(0, n));\r\n  const hex = color.replace('#', '');\r\n  const r = clamp(parseInt(hex.substring(0, 2), 16) + amount);\r\n  const g = clamp(parseInt(hex.substring(2, 4), 16) + amount);\r\n  const b = clamp(parseInt(hex.substring(4, 6), 16) + amount);\r\n  return `#${r.toString(16).padStart(2, '0')}${g.toString(16).padStart(2, '0')}${b.toString(16).padStart(2, '0')}`;\r\n}\r\n\r\nexport { stringToColor, adjustColor };\r\n","import { useState, useMemo, useCallback, useEffect, useRef } from 'react';\nimport {\n  Users, Loader2, Network, BarChart3, ArrowRight, TrendingUp,\n  RotateCw, Play, RefreshCw, Zap, Shield, AlertTriangle,\n  CheckCircle, ChevronDown, ChevronUp, Search, Calendar,\n} from 'lucide-react';\nimport { toast } from 'sonner';\nimport {\n  useTeamProfiles, useTeamDynamics, useTeamRelationships,\n  useRunTeamAnalysis, useAnalyzeProfile, useTeamGraph,\n  useSyncTeamGraph, useContacts,\n} from '../hooks/useGodMode';\nimport { Dialog, DialogContent, DialogTitle } from '../components/ui/Dialog';\nimport ProfileDetailModal, { stringToColor, adjustColor } from '../components/team/ProfileDetailModal';\nimport { ErrorState } from '../components/shared/ErrorState';\nimport { isValidAvatarUrl, getInitials } from '../lib/utils';\n\nfunction ContactAvatar({ url, name, size = 'md', className = '' }: {\n  url: string | null | undefined; name: string; size?: 'sm' | 'md' | 'lg'; className?: string;\n}) {\n  const [failed, setFailed] = useState(false);\n  const initials = getInitials(name);\n  const dims = size === 'sm' ? 'w-5 h-5' : size === 'lg' ? 'w-14 h-14' : 'w-8 h-8';\n  const textSize = size === 'sm' ? 'text-[8px]' : size === 'lg' ? 'text-lg' : 'text-[10px]';\n  const borderCls = size === 'lg' ? 'border-2 border-white/20' : '';\n\n  if (url && !failed) {\n    return (\n      <img src={url} alt={name} referrerPolicy=\"no-referrer\"\n        onError={() => setFailed(true)}\n        className={`${dims} rounded-full object-cover flex-shrink-0 ${className}`} />\n    );\n  }\n\n  return (\n    <div className={`${dims} rounded-full flex items-center justify-center ${textSize} font-bold text-white flex-shrink-0 ${borderCls} ${className}`}\n      style={{ background: `linear-gradient(135deg, ${stringToColor(name)}, ${adjustColor(stringToColor(name), -30)})` }}>\n      {initials}\n    </div>\n  );\n}\n\ntype Tab = 'profiles' | 'team' | 'relationships' | 'graph';\n\n/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n   Name Resolution - Maps Person_N â†’ real names\n   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\ninterface PersonInfo {\n  name: string;\n  initials: string;\n  role: string;\n  avatarUrl?: string;\n}\n\nfunction buildNameResolver(profiles: Array<Record<string, unknown>>): (name: string) => PersonInfo {\n  const mapping: Record<string, PersonInfo> = {};\n\n  profiles.forEach((profile, index) => {\n    const contact = (profile.contact ?? {}) as Record<string, unknown>;\n    const realName = String(contact.name || profile.person_name || 'Unknown');\n    const avatarRaw = contact.avatar_url || contact.photo_url;\n    const info: PersonInfo = {\n      name: realName,\n      initials: getInitials(realName),\n      role: String(contact.role || contact.organization || ''),\n      avatarUrl: avatarRaw ? String(avatarRaw) : undefined,\n    };\n\n    mapping[`person_${index + 1}`] = info;\n    mapping[`person ${index + 1}`] = info;\n    mapping[realName.toLowerCase()] = info;\n    const firstName = realName.split(' ')[0];\n    if (firstName) mapping[firstName.toLowerCase()] = info;\n\n    const contactId = String(profile.contact_id || profile.person_id || '');\n    if (contactId) mapping[contactId] = info;\n  });\n\n  return (name: string) => {\n    if (!name) return { name: 'Unknown', initials: '?', role: '' };\n    const normalized = name.toLowerCase().trim();\n    return mapping[normalized] || mapping[name] || {\n      name: name.replace(/_/g, ' '),\n      initials: getInitials(name),\n      role: '',\n    };\n  };\n}\n\nfunction replacePersonNames(text: string, resolve: (n: string) => PersonInfo): string {\n  return text.replace(/Person_(\\d+)/gi, (match) => resolve(match).name);\n}\n\n/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n   Person Chip - avatar + name inline element\n   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\nfunction PersonChip({ name, resolve }: { name: string; resolve: (n: string) => PersonInfo }) {\n  const info = resolve(name);\n  return (\n    <div className=\"inline-flex items-center gap-1.5 bg-gm-surface-primary border border-gm-border-primary rounded-full px-2.5 py-1\">\n      <ContactAvatar url={isValidAvatarUrl(info.avatarUrl) ? info.avatarUrl : null} name={info.name} size=\"sm\" />\n      <span className=\"text-[10px] font-medium text-gm-text-primary whitespace-nowrap\">{info.name}</span>\n    </div>\n  );\n}\n\n/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n   Type Configs for dynamics cards\n   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\nconst influenceTypes: Record<string, { color: string; bg: string; icon: string }> = {\n  direct: { color: '#3b82f6', bg: '#eff6ff', icon: 'â†’' },\n  technical: { color: '#8b5cf6', bg: '#f5f3ff', icon: 'âš™' },\n  political: { color: '#f59e0b', bg: '#fffbeb', icon: 'â™Ÿ' },\n  social: { color: '#10b981', bg: '#ecfdf5', icon: 'ğŸ¤' },\n  resource: { color: '#ef4444', bg: '#fef2f2', icon: 'ğŸ“Š' },\n};\n\nconst allianceTypes: Record<string, { color: string; bg: string; icon: string }> = {\n  natural: { color: '#10b981', bg: '#ecfdf5', icon: 'ğŸŒ±' },\n  circumstantial: { color: '#6366f1', bg: '#eef2ff', icon: 'ğŸ”—' },\n  strategic: { color: '#f59e0b', bg: '#fffbeb', icon: 'â™Ÿ' },\n  historical: { color: '#8b5cf6', bg: '#f5f3ff', icon: 'ğŸ“œ' },\n};\n\nconst tensionTypes: Record<string, { color: string; bg: string; icon: string }> = {\n  technical: { color: '#8b5cf6', bg: '#f5f3ff', icon: 'âš™' },\n  resource: { color: '#f59e0b', bg: '#fffbeb', icon: 'ğŸ“Š' },\n  political: { color: '#ef4444', bg: '#fef2f2', icon: 'â™Ÿ' },\n  communication: { color: '#3b82f6', bg: '#eff6ff', icon: 'ğŸ’¬' },\n  values: { color: '#10b981', bg: '#ecfdf5', icon: 'âš–' },\n};\n\nconst powerTypes: Record<string, { color: string; bg: string; icon: string }> = {\n  technical: { color: '#8b5cf6', bg: '#f5f3ff', icon: 'âš™' },\n  formal: { color: '#3b82f6', bg: '#eff6ff', icon: 'ğŸ‘”' },\n  informal: { color: '#f59e0b', bg: '#fffbeb', icon: 'ğŸ’¬' },\n  social: { color: '#10b981', bg: '#ecfdf5', icon: 'ğŸ¤' },\n  resource: { color: '#ef4444', bg: '#fef2f2', icon: 'ğŸ“Š' },\n};\n\n/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n   Main Page Component\n   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\nexport default function TeamAnalysisPage() {\n  const [tab, setTab] = useState<Tab>('profiles');\n  const [selectedProfile, setSelectedProfile] = useState<Record<string, unknown> | null>(null);\n  const [showAnalyzeModal, setShowAnalyzeModal] = useState(false);\n\n  const profiles = useTeamProfiles();\n  const dynamics = useTeamDynamics();\n  const relationships = useTeamRelationships();\n  const graphQuery = useTeamGraph();\n  const runTeamAnalysis = useRunTeamAnalysis();\n  const syncGraph = useSyncTeamGraph();\n\n  const profileList = useMemo(() =>\n    (profiles.data?.profiles ?? []) as Array<Record<string, unknown>>,\n    [profiles.data]\n  );\n\n  const resolveName = useMemo(() => buildNameResolver(profileList), [profileList]);\n\n  if (profiles.error) {\n    return <div className=\"p-6\"><ErrorState message=\"Failed to load team profiles.\" onRetry={() => profiles.refetch()} /></div>;\n  }\n\n  const tabs: { key: Tab; label: string; icon: typeof Users }[] = [\n    { key: 'profiles', label: 'Profiles', icon: Users },\n    { key: 'team', label: 'Team Dynamics', icon: BarChart3 },\n    { key: 'relationships', label: 'Relationships', icon: ArrowRight },\n    { key: 'graph', label: 'Network Graph', icon: Network },\n  ];\n\n  const handleRunAnalysis = () => {\n    runTeamAnalysis.mutate({ forceReanalysis: true }, {\n      onSuccess: () => toast.success('Team analysis started'),\n      onError: () => toast.error('Failed to start team analysis'),\n    });\n  };\n\n  const handleSyncGraph = () => {\n    syncGraph.mutate(undefined, {\n      onSuccess: () => { toast.success('Graph synced'); graphQuery.refetch(); },\n      onError: () => toast.error('Failed to sync graph'),\n    });\n  };\n\n  return (\n    <div className=\"p-6 space-y-4\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <h1 className=\"text-2xl font-bold text-gm-text-primary\">Team Analysis</h1>\n        <div className=\"flex gap-2\">\n          <button onClick={() => setShowAnalyzeModal(true)}\n            className=\"px-3 py-1.5 rounded-lg bg-gm-interactive-secondary text-gm-text-primary text-xs font-medium hover:bg-gm-interactive-secondary-hover flex items-center gap-1.5 transition-colors\">\n            <Users className=\"w-3.5 h-3.5\" /> Analyze Members\n          </button>\n          <button onClick={handleRunAnalysis} disabled={runTeamAnalysis.isPending}\n            className=\"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover flex items-center gap-1.5 disabled:opacity-50 transition-colors\">\n            {runTeamAnalysis.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Play className=\"w-3.5 h-3.5\" />}\n            Run Team Analysis\n          </button>\n          <button onClick={handleSyncGraph} disabled={syncGraph.isPending}\n            className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover flex items-center gap-1.5 disabled:opacity-50 transition-colors border border-gm-border-primary\">\n            {syncGraph.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <RefreshCw className=\"w-3.5 h-3.5\" />}\n            Sync Graph\n          </button>\n        </div>\n      </div>\n\n      {/* Tabs */}\n      <div className=\"flex gap-1 bg-gm-surface-secondary rounded-xl p-1\">\n        {tabs.map(t => {\n          const Icon = t.icon;\n          return (\n            <button key={t.key} onClick={() => setTab(t.key)}\n              className={`flex-1 flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${\n                tab === t.key ? 'bg-gm-surface-primary text-gm-text-primary shadow-sm' : 'text-gm-text-tertiary hover:text-gm-text-primary'\n              }`}>\n              <Icon className=\"w-3.5 h-3.5\" /> {t.label}\n            </button>\n          );\n        })}\n      </div>\n\n      {tab === 'profiles' && (\n        <ProfilesTab profiles={profileList} isLoading={profiles.isLoading} onSelectProfile={setSelectedProfile} />\n      )}\n      {tab === 'team' && (\n        <TeamDynamicsTab data={(dynamics.data as Record<string, unknown>)?.analysis ?? dynamics.data} isLoading={dynamics.isLoading} profiles={profileList} resolveName={resolveName} />\n      )}\n      {tab === 'relationships' && (\n        <RelationshipsTab data={relationships.data} isLoading={relationships.isLoading} profiles={profileList} resolveName={resolveName} />\n      )}\n      {tab === 'graph' && (\n        <NetworkGraphTab data={graphQuery.data} isLoading={graphQuery.isLoading} profiles={profileList} resolveName={resolveName} />\n      )}\n\n      <ProfileDetailModal profile={selectedProfile} open={!!selectedProfile} onClose={() => setSelectedProfile(null)} />\n      <AnalyzeContactsModal\n        open={showAnalyzeModal}\n        onClose={() => setShowAnalyzeModal(false)}\n        existingProfileIds={new Set(profileList.map(p => String(p.contact_id || p.person_id || '')))}\n      />\n    </div>\n  );\n}\n\n/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n   Profiles Tab\n   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\nfunction ProfilesTab({ profiles, isLoading, onSelectProfile }: {\n  profiles: Array<Record<string, unknown>>;\n  isLoading: boolean;\n  onSelectProfile: (p: Record<string, unknown>) => void;\n}) {\n  const analyzeProfile = useAnalyzeProfile();\n\n  if (isLoading) return <Spinner />;\n  if (profiles.length === 0) return (\n    <EmptyState icon={Users} message=\"No team profiles available. Click 'Analyze Members' to generate AI behavioral profiles.\" />\n  );\n\n  const sorted = [...profiles].sort((a, b) => (Number(b.influence_score) || 0) - (Number(a.influence_score) || 0));\n\n  const handleReanalyze = (e: React.MouseEvent, profile: Record<string, unknown>) => {\n    e.stopPropagation();\n    const contactId = String(profile.contact_id || profile.person_id || '');\n    if (!contactId) return;\n    const contact = (profile.contact ?? {}) as Record<string, unknown>;\n    const name = String(contact.name || profile.person_name || 'Unknown');\n    analyzeProfile.mutate({ personId: contactId, forceReanalysis: true }, {\n      onSuccess: () => toast.success(`Re-analysis started for ${name}`),\n      onError: () => toast.error('Failed to start re-analysis'),\n    });\n  };\n\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n      {sorted.map((profile, i) => {\n        const contact = (profile.contact ?? {}) as Record<string, unknown>;\n        const name = String(contact.name || profile.person_name || 'Unknown');\n        const role = String(contact.role || contact.organization || '');\n        const avatarUrl = isValidAvatarUrl(contact.avatar_url) ? contact.avatar_url : isValidAvatarUrl(contact.photo_url) ? contact.photo_url : null;\n        const confidence = String(profile.confidence_level || 'low');\n        const commStyle = String(profile.communication_style || '');\n        const speakingTime = Number(profile.total_speaking_time_seconds || 0);\n        const speakingMins = speakingTime ? `${Math.floor(speakingTime / 60)}m` : '';\n\n        return (\n          <div key={i} onClick={() => onSelectProfile(profile)}\n            className=\"bg-gm-surface-primary border border-gm-border-primary rounded-xl p-4 hover:border-blue-600/30 hover:-translate-y-0.5 transition-all cursor-pointer group shadow-sm hover:shadow-md\">\n            {/* Header with avatar */}\n            <div className=\"flex items-start gap-3 mb-3\">\n              <ContactAvatar url={avatarUrl} name={name} size=\"lg\" className=\"border-2 border-gm-surface-secondary\" />\n              <div className=\"min-w-0 flex-1\">\n                <p className=\"text-sm font-semibold text-gm-text-primary truncate group-hover:text-gm-interactive-primary transition-colors\">{name}</p>\n                {role && <p className=\"text-[10px] text-gm-text-tertiary mt-0.5\">{role}</p>}\n                <div className=\"flex flex-wrap gap-1 mt-1.5\">\n                  <span className={`text-[10px] px-2 py-0.5 rounded-full font-medium capitalize ${\n                    confidence === 'high' || confidence === 'very_high' ? 'bg-gm-status-success-bg text-gm-status-success' :\n                    confidence === 'medium' ? 'bg-gm-status-warning-bg text-gm-status-warning' :\n                    'bg-gm-surface-secondary text-gm-text-tertiary'\n                  }`}>{confidence.replace('_', ' ')}</span>\n                </div>\n              </div>\n            </div>\n\n            {/* Metrics grid */}\n            <div className=\"grid grid-cols-3 gap-2 py-3 border-t border-[var(--gm-border-primary)]\">\n              <div className=\"text-center\">\n                <p className=\"text-base font-bold text-gm-text-primary\">{String(profile.influence_score || 0)}</p>\n                <p className=\"text-[9px] text-gm-text-tertiary uppercase tracking-wider\">Influence</p>\n              </div>\n              <div className=\"text-center\">\n                <p className=\"text-base font-bold text-gm-text-primary\">{String(profile.transcript_count || 0)}</p>\n                <p className=\"text-[9px] text-gm-text-tertiary uppercase tracking-wider\">Transcripts</p>\n              </div>\n              <div className=\"text-center\">\n                <p className=\"text-base font-bold text-gm-text-primary capitalize\">{String(profile.risk_tolerance || 'â€”')}</p>\n                <p className=\"text-[9px] text-gm-text-tertiary uppercase tracking-wider\">Risk</p>\n              </div>\n            </div>\n\n            {/* Communication style */}\n            {commStyle && (\n              <div className=\"mt-2 bg-gm-surface-secondary rounded-lg p-2.5\">\n                <p className=\"text-[9px] text-gm-text-tertiary uppercase tracking-wider mb-0.5\">Communication Style</p>\n                <p className=\"text-xs text-gm-text-primary line-clamp-2\">{commStyle}</p>\n              </div>\n            )}\n\n            {/* Speaking time + Re-analyze button */}\n            <div className=\"flex items-center justify-between mt-3\">\n              {speakingMins && <span className=\"text-[10px] text-gm-text-tertiary\">{speakingMins} speaking time</span>}\n              <button onClick={(e) => handleReanalyze(e, profile)}\n                disabled={analyzeProfile.isPending}\n                className=\"ml-auto px-2.5 py-1 rounded-lg bg-gm-surface-secondary text-gm-text-primary text-[10px] font-medium hover:bg-gm-surface-hover flex items-center gap-1 transition-colors border border-gm-border-primary disabled:opacity-50\">\n                <RotateCw className=\"w-3 h-3\" /> Re-analyze\n              </button>\n            </div>\n          </div>\n        );\n      })}\n    </div>\n  );\n}\n\n/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n   Team Dynamics Tab\n   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\nfunction TeamDynamicsTab({ data, isLoading, profiles, resolveName }: {\n  data: unknown;\n  isLoading: boolean;\n  profiles: Array<Record<string, unknown>>;\n  resolveName: (n: string) => PersonInfo;\n}) {\n  if (isLoading) return <Spinner />;\n  const d = data as Record<string, unknown> | null;\n  if (!d) return <EmptyState icon={BarChart3} message=\"No team dynamics data. Click 'Run Team Analysis' to generate insights.\" />;\n\n  const cohesion = Number(d.cohesion_score ?? 0);\n  const tensionLevel = String(d.tension_level || 'unknown');\n  const teamSize = Number(d.team_size ?? profiles.length ?? 0);\n  const analysisData = (d.analysis_data ?? {}) as Record<string, unknown>;\n  const dominantPattern = String(analysisData.dominant_communication_pattern || d.summary || '');\n  const influenceMap = (d.influence_map ?? []) as Array<Record<string, unknown>>;\n  const alliances = (d.alliances ?? []) as Array<Record<string, unknown>>;\n  const tensions = (d.tensions ?? []) as Array<Record<string, unknown>>;\n  const powerCenters = (analysisData.power_centers ?? []) as Array<Record<string, unknown>>;\n  const riskFactors = (analysisData.risk_factors ?? []) as string[];\n  const recommendations = (analysisData.recommendations ?? []) as string[];\n  const commFlow = (analysisData.communication_flow ?? {}) as Record<string, unknown>;\n  const dynamicsList = (d.dynamics ?? []) as Array<Record<string, unknown>>;\n  const analysisDate = String(analysisData.analysis_date || d.last_analysis_at || '');\n\n  const cohesionColor = cohesion >= 70 ? '#22c55e' : cohesion >= 40 ? '#f59e0b' : '#ef4444';\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Top stats */}\n      <div className=\"grid grid-cols-3 gap-3\">\n        <div className=\"bg-gm-surface-primary border border-gm-border-primary rounded-xl p-5 flex items-center gap-4\">\n          <div className=\"relative w-16 h-16\">\n            <svg viewBox=\"0 0 36 36\" className=\"w-full h-full -rotate-90\">\n              <path d=\"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831\" fill=\"none\" stroke=\"var(--gm-border-primary)\" strokeWidth=\"3\" />\n              <path d=\"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831\" fill=\"none\" stroke={cohesionColor} strokeWidth=\"3\" strokeDasharray={`${cohesion}, 100`} strokeLinecap=\"round\" />\n            </svg>\n            <div className=\"absolute inset-0 flex flex-col items-center justify-center\">\n              <span className=\"text-lg font-bold text-gm-text-primary\">{cohesion}</span>\n            </div>\n          </div>\n          <div>\n            <p className=\"text-sm font-semibold text-gm-text-primary\">Team Cohesion</p>\n            <span className={`text-[10px] px-2 py-0.5 rounded-full font-medium capitalize ${\n              tensionLevel === 'low' ? 'bg-gm-status-success-bg text-gm-status-success' :\n              tensionLevel === 'medium' ? 'bg-gm-status-warning-bg text-gm-status-warning' :\n              'bg-gm-status-danger-bg text-gm-status-danger'\n            }`}>{tensionLevel} tension</span>\n          </div>\n        </div>\n        <div className=\"bg-gm-surface-primary border border-gm-border-primary rounded-xl p-5 flex flex-col items-center justify-center\">\n          <p className=\"text-3xl font-bold text-gm-text-primary\">{teamSize}</p>\n          <p className=\"text-xs text-gm-text-tertiary\">Team Members</p>\n        </div>\n        <div className=\"bg-gm-surface-primary border border-gm-border-primary rounded-xl p-5 flex items-center gap-3 justify-center\">\n          <Calendar className=\"w-5 h-5 text-gm-text-tertiary\" />\n          <div>\n            <p className=\"text-xs text-gm-text-tertiary\">Analysis Date</p>\n            <p className=\"text-sm font-semibold text-gm-text-primary\">\n              {analysisDate ? new Date(analysisDate).toLocaleDateString() : 'N/A'}\n            </p>\n          </div>\n        </div>\n      </div>\n\n      {/* Executive Summary with name resolution */}\n      {dominantPattern && (\n        <div className=\"bg-blue-600/5 border border-blue-600/10 rounded-xl p-4\">\n          <h3 className=\"text-xs font-semibold text-gm-interactive-primary uppercase tracking-wider mb-2\">Executive Summary</h3>\n          <p className=\"text-sm text-gm-text-primary leading-relaxed\">{replacePersonNames(dominantPattern, resolveName)}</p>\n        </div>\n      )}\n\n      {/* Influence Scoreboard */}\n      {profiles.length > 0 && <InfluenceScoreboard profiles={profiles} />}\n\n      {/* Communication Flow with person chips */}\n      {(commFlow.bottlenecks || commFlow.information_brokers || commFlow.central_nodes || commFlow.isolated_members) && (\n        <CommunicationFlowSection flow={commFlow} resolveName={resolveName} />\n      )}\n\n      {/* Dynamics cards with person chips and type configs */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n        {influenceMap.length > 0 && <InfluenceMapCard items={influenceMap} resolveName={resolveName} />}\n        {alliances.length > 0 && <AlliancesCard items={alliances} resolveName={resolveName} />}\n        {tensions.length > 0 && <TensionsCard items={tensions} resolveName={resolveName} />}\n        {powerCenters.length > 0 && <PowerCentersCard items={powerCenters} resolveName={resolveName} />}\n      </div>\n\n      {/* Dynamic scores */}\n      {dynamicsList.length > 0 && (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n          {dynamicsList.map((item, i) => (\n            <div key={i} className=\"bg-gm-surface-primary border border-gm-border-primary rounded-xl p-4\">\n              <div className=\"flex items-center gap-2 mb-2\">\n                <TrendingUp className=\"w-4 h-4 text-gm-interactive-primary\" />\n                <span className=\"text-sm font-medium text-gm-text-primary\">{String(item.aspect || item.name || `Dynamic #${i + 1}`)}</span>\n              </div>\n              <p className=\"text-xs text-gm-text-tertiary\">{replacePersonNames(String(item.description || item.summary || ''), resolveName)}</p>\n              {item.score !== undefined && (\n                <div className=\"mt-2 flex items-center gap-2\">\n                  <div className=\"flex-1 h-1.5 bg-gm-surface-secondary rounded-full\">\n                    <div className=\"h-1.5 bg-gm-interactive-primary rounded-full\" style={{ width: `${Math.min(100, Number(item.score))}%` }} />\n                  </div>\n                  <span className=\"text-[10px] font-mono text-gm-text-tertiary\">{String(item.score)}%</span>\n                </div>\n              )}\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Risk Factors */}\n      {riskFactors.length > 0 && (\n        <div className=\"bg-gm-surface-primary border border-gm-border-primary rounded-xl p-4\">\n          <h3 className=\"text-xs font-semibold text-gm-status-danger uppercase tracking-wider mb-3 flex items-center gap-2\">\n            <AlertTriangle className=\"w-4 h-4\" /> Risk Factors\n            <span className=\"text-[10px] px-2 py-0.5 rounded-full bg-gm-status-danger-bg text-gm-status-danger ml-auto\">{riskFactors.length} identified</span>\n          </h3>\n          <div className=\"space-y-2\">\n            {riskFactors.map((r, i) => (\n              <div key={i} className=\"flex items-start gap-2\">\n                <span className=\"text-[10px] text-gm-status-danger font-bold mt-0.5 flex-shrink-0\">{i + 1}</span>\n                <p className=\"text-xs text-gm-text-primary\">{replacePersonNames(r, resolveName)}</p>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* Recommendations */}\n      {recommendations.length > 0 && (\n        <div className=\"bg-gm-surface-primary border border-gm-border-primary rounded-xl p-4\">\n          <h3 className=\"text-xs font-semibold text-gm-status-success uppercase tracking-wider mb-3 flex items-center gap-2\">\n            <CheckCircle className=\"w-4 h-4\" /> Recommendations\n            <span className=\"text-[10px] px-2 py-0.5 rounded-full bg-gm-status-success-bg text-gm-status-success ml-auto\">{recommendations.length} actions</span>\n          </h3>\n          <div className=\"space-y-2\">\n            {recommendations.map((r, i) => (\n              <div key={i} className=\"flex items-start gap-2\">\n                <span className=\"text-[10px] text-gm-status-success font-bold mt-0.5 flex-shrink-0\">Action {i + 1}</span>\n                <p className=\"text-xs text-gm-text-primary\">{replacePersonNames(r, resolveName)}</p>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\n/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n   Influence Scoreboard\n   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\nfunction InfluenceScoreboard({ profiles }: { profiles: Array<Record<string, unknown>> }) {\n  const sorted = [...profiles]\n    .filter(p => p.influence_score !== undefined)\n    .sort((a, b) => (Number(b.influence_score) || 0) - (Number(a.influence_score) || 0));\n  if (sorted.length === 0) return null;\n  const maxScore = Math.max(...sorted.map(p => Number(p.influence_score) || 0), 100);\n  const medals = ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰'];\n\n  return (\n    <div className=\"bg-gm-surface-primary border border-gm-border-primary rounded-xl p-4\">\n      <h3 className=\"text-xs font-semibold text-gm-text-primary uppercase tracking-wider mb-3 flex items-center gap-2\">\n        <TrendingUp className=\"w-4 h-4 text-gm-interactive-primary\" /> Influence Scoreboard\n        <span className=\"text-[10px] px-2 py-0.5 rounded-full bg-gm-status-warning-bg text-gm-status-warning ml-auto\">{sorted.length} ranked</span>\n      </h3>\n      <div className=\"space-y-2\">\n        {sorted.map((profile, i) => {\n          const contact = (profile.contact ?? {}) as Record<string, unknown>;\n          const name = String(contact.name || profile.person_name || 'Unknown');\n          const role = String(contact.role || contact.organization || '');\n          const avatarUrl = isValidAvatarUrl(contact.avatar_url) ? contact.avatar_url : isValidAvatarUrl(contact.photo_url) ? contact.photo_url : null;\n          const score = Number(profile.influence_score) || 0;\n          const barWidth = (score / maxScore) * 100;\n          const risk = String(profile.risk_tolerance || 'medium');\n          const commStyle = String(profile.communication_style || '');\n          const styleSnippet = commStyle.split(';')[0]?.substring(0, 50) || '';\n\n          return (\n            <div key={i} className={`flex items-center gap-3 py-1.5 ${i < 3 ? 'bg-[var(--gm-surface-hover)] rounded-lg px-2' : ''}`}>\n              <span className=\"w-6 text-center text-sm\">{medals[i] || String(i + 1)}</span>\n              <ContactAvatar url={avatarUrl} name={name} size=\"md\" />\n              <div className=\"flex-1 min-w-0\">\n                <p className=\"text-xs font-medium text-gm-text-primary truncate\">{name}</p>\n                {role && <p className=\"text-[10px] text-gm-text-tertiary truncate\">{role}</p>}\n                {styleSnippet && <p className=\"text-[9px] text-gray-400 truncate italic\">{styleSnippet}</p>}\n              </div>\n              <div className=\"w-32 flex items-center gap-1.5\">\n                <div className=\"flex-1 h-1.5 bg-gm-surface-secondary rounded-full\">\n                  <div className=\"h-1.5 bg-gm-interactive-primary rounded-full transition-all\" style={{ width: `${barWidth}%` }} />\n                </div>\n                <span className=\"text-[10px] font-mono text-gm-text-tertiary w-6 text-right\">{score}</span>\n              </div>\n              <span className={`text-[10px] px-1.5 py-0.5 rounded-full capitalize ${\n                risk === 'low' ? 'bg-gm-status-success-bg text-gm-status-success' :\n                risk === 'high' ? 'bg-gm-status-danger-bg text-gm-status-danger' :\n                'bg-gm-status-warning-bg text-gm-status-warning'\n              }`}>{risk}</span>\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n\n/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n   Communication Flow with Person Chips\n   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\nfunction CommunicationFlowSection({ flow, resolveName }: {\n  flow: Record<string, unknown>;\n  resolveName: (n: string) => PersonInfo;\n}) {\n  const bottlenecks = (flow.bottlenecks ?? []) as string[];\n  const brokers = (flow.information_brokers ?? []) as string[];\n  const central = (flow.central_nodes ?? []) as string[];\n  const isolated = (flow.isolated_members ?? []) as string[];\n\n  return (\n    <div className=\"bg-gm-surface-primary border border-gm-border-primary rounded-xl p-4\">\n      <h3 className=\"text-xs font-semibold text-gm-text-primary uppercase tracking-wider mb-3\">Communication Flow</h3>\n      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\n        {bottlenecks.length > 0 && (\n          <div className=\"bg-[var(--gm-surface-hover)] rounded-lg p-3\">\n            <div className=\"flex items-center gap-1.5 mb-2\">\n              <span>ğŸš§</span>\n              <span className=\"text-[10px] font-semibold uppercase tracking-wider text-gm-status-danger\">Bottlenecks</span>\n            </div>\n            <div className=\"flex flex-wrap gap-1.5\">\n              {bottlenecks.map((b, i) => <PersonChip key={i} name={b} resolve={resolveName} />)}\n            </div>\n          </div>\n        )}\n        {brokers.length > 0 && (\n          <div className=\"bg-[var(--gm-surface-hover)] rounded-lg p-3\">\n            <div className=\"flex items-center gap-1.5 mb-2\">\n              <span>ğŸ”—</span>\n              <span className=\"text-[10px] font-semibold uppercase tracking-wider text-gm-interactive-primary\">Info Brokers</span>\n            </div>\n            <div className=\"flex flex-wrap gap-1.5\">\n              {brokers.map((b, i) => <PersonChip key={i} name={b} resolve={resolveName} />)}\n            </div>\n            <p className=\"text-[9px] text-gm-text-tertiary mt-2\">Key connectors who bridge information across the team</p>\n          </div>\n        )}\n        {central.length > 0 && (\n          <div className=\"bg-[var(--gm-surface-hover)] rounded-lg p-3\">\n            <div className=\"flex items-center gap-1.5 mb-2\">\n              <span>â­</span>\n              <span className=\"text-[10px] font-semibold uppercase tracking-wider text-gm-status-success\">Central Nodes</span>\n            </div>\n            <div className=\"flex flex-wrap gap-1.5\">\n              {central.map((c, i) => <PersonChip key={i} name={c} resolve={resolveName} />)}\n            </div>\n            <p className=\"text-[9px] text-gm-text-tertiary mt-2\">Most connected team members</p>\n          </div>\n        )}\n        {isolated.length > 0 && (\n          <div className=\"bg-[var(--gm-surface-hover)] rounded-lg p-3\">\n            <div className=\"flex items-center gap-1.5 mb-2\">\n              <span>ğŸï¸</span>\n              <span className=\"text-[10px] font-semibold uppercase tracking-wider text-gm-status-warning\">Isolated</span>\n            </div>\n            <div className=\"flex flex-wrap gap-1.5\">\n              {isolated.map((m, i) => <PersonChip key={i} name={m} resolve={resolveName} />)}\n            </div>\n            <p className=\"text-[9px] text-gm-text-tertiary mt-2\">Members with fewer connections â€” may need inclusion</p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\n/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n   Influence Map Card - with person chips + type colors\n   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\nfunction InfluenceMapCard({ items, resolveName }: {\n  items: Array<Record<string, unknown>>;\n  resolveName: (n: string) => PersonInfo;\n}) {\n  const [expanded, setExpanded] = useState<Set<number>>(new Set());\n  const toggle = (i: number) => setExpanded(prev => { const n = new Set(prev); n.has(i) ? n.delete(i) : n.add(i); return n; });\n\n  return (\n    <div className=\"bg-gm-surface-primary border border-gm-border-primary rounded-xl p-4\">\n      <h3 className=\"text-xs font-semibold text-gm-text-primary uppercase tracking-wider mb-3 flex items-center gap-2\">\n        <TrendingUp className=\"w-4 h-4 text-gm-interactive-primary\" /> Influence Map\n        <span className=\"text-[10px] px-2 py-0.5 rounded-full bg-gm-surface-secondary text-gm-text-tertiary ml-auto\">{items.length} connections</span>\n      </h3>\n      <div className=\"space-y-2 max-h-72 overflow-y-auto\">\n        {items.slice(0, 10).map((inf, i) => {\n          const infType = String(inf.influence_type || 'direct').toLowerCase();\n          const config = influenceTypes[infType] || influenceTypes.direct;\n          const strengthPct = Math.round((Number(inf.strength) || 0.5) * (Number(inf.strength) <= 1 ? 100 : 1));\n          const hasEvidence = !!inf.evidence && String(inf.evidence).length > 10;\n\n          return (\n            <div key={i} className=\"bg-[var(--gm-surface-hover)] rounded-lg p-3\">\n              <div className=\"flex items-center gap-2 flex-wrap\">\n                <PersonChip name={String(inf.from_person || inf.from || '?')} resolve={resolveName} />\n                <ArrowRight className=\"w-3.5 h-3.5 text-gm-text-tertiary flex-shrink-0\" />\n                <PersonChip name={String(inf.to_person || inf.to || '?')} resolve={resolveName} />\n                <span className=\"text-[10px] px-1.5 py-0.5 rounded capitalize ml-auto\" style={{ background: config.bg, color: config.color }}>\n                  {config.icon} {infType}\n                </span>\n                <div className=\"flex items-center gap-1 w-20\">\n                  <div className=\"flex-1 h-1 rounded-full bg-gm-surface-secondary\">\n                    <div className=\"h-1 rounded-full transition-all\" style={{ width: `${strengthPct}%`, background: config.color }} />\n                  </div>\n                  <span className=\"text-[10px] font-mono text-gm-text-tertiary\">{strengthPct}%</span>\n                </div>\n                {hasEvidence && (\n                  <button onClick={() => toggle(i)} className=\"text-gm-text-tertiary hover:text-gm-text-primary\">\n                    {expanded.has(i) ? <ChevronUp className=\"w-3.5 h-3.5\" /> : <ChevronDown className=\"w-3.5 h-3.5\" />}\n                  </button>\n                )}\n              </div>\n              {expanded.has(i) && hasEvidence && (\n                <div className=\"mt-2 pt-2 border-t border-[var(--gm-border-primary)]\">\n                  <p className=\"text-[10px] text-gm-text-tertiary\"><strong>Evidence:</strong> {replacePersonNames(String(inf.evidence), resolveName)}</p>\n                </div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n\n/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n   Alliances Card\n   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\nfunction AlliancesCard({ items, resolveName }: {\n  items: Array<Record<string, unknown>>;\n  resolveName: (n: string) => PersonInfo;\n}) {\n  const [expanded, setExpanded] = useState<Set<number>>(new Set());\n  const toggle = (i: number) => setExpanded(prev => { const n = new Set(prev); n.has(i) ? n.delete(i) : n.add(i); return n; });\n\n  return (\n    <div className=\"bg-gm-surface-primary border border-gm-border-primary rounded-xl p-4\">\n      <h3 className=\"text-xs font-semibold text-gm-text-primary uppercase tracking-wider mb-3 flex items-center gap-2\">\n        <Users className=\"w-4 h-4 text-gm-interactive-primary\" /> Alliances\n        <span className=\"text-[10px] px-2 py-0.5 rounded-full bg-gm-surface-secondary text-gm-text-tertiary ml-auto\">{items.length} groups</span>\n      </h3>\n      <div className=\"space-y-2 max-h-72 overflow-y-auto\">\n        {items.slice(0, 10).map((all, i) => {\n          let members = all.members as string[] | string;\n          if (typeof members === 'string') members = members.split(/[\\s,]+/).filter(Boolean);\n          if (!Array.isArray(members)) members = [];\n          const aType = String(all.alliance_type || 'natural').toLowerCase();\n          const config = allianceTypes[aType] || allianceTypes.natural;\n          const strengthPct = Math.round((Number(all.strength) || 0.5) * (Number(all.strength) <= 1 ? 100 : 1));\n          const hasExpand = (all.evidence && String(all.evidence).length > 10) || (Array.isArray(all.shared_values) && (all.shared_values as string[]).length > 0);\n\n          return (\n            <div key={i} className=\"bg-[var(--gm-surface-hover)] rounded-lg p-3\">\n              <div className=\"flex items-center gap-2 flex-wrap\">\n                <div className=\"flex items-center gap-1.5 flex-wrap\">\n                  {(members as string[]).map((m, j) => (\n                    <span key={j} className=\"contents\">\n                      {j > 0 && <span className=\"text-[10px] text-gm-text-tertiary\">&</span>}\n                      <PersonChip name={m} resolve={resolveName} />\n                    </span>\n                  ))}\n                </div>\n                <span className=\"text-[10px] px-1.5 py-0.5 rounded capitalize ml-auto\" style={{ background: config.bg, color: config.color }}>\n                  {config.icon} {aType}\n                </span>\n                <div className=\"flex items-center gap-1 w-20\">\n                  <div className=\"flex-1 h-1 rounded-full bg-gm-surface-secondary\">\n                    <div className=\"h-1 rounded-full transition-all\" style={{ width: `${strengthPct}%`, background: config.color }} />\n                  </div>\n                  <span className=\"text-[10px] font-mono text-gm-text-tertiary\">{strengthPct}%</span>\n                </div>\n                {hasExpand && (\n                  <button onClick={() => toggle(i)} className=\"text-gm-text-tertiary hover:text-gm-text-primary\">\n                    {expanded.has(i) ? <ChevronUp className=\"w-3.5 h-3.5\" /> : <ChevronDown className=\"w-3.5 h-3.5\" />}\n                  </button>\n                )}\n              </div>\n              {expanded.has(i) && (\n                <div className=\"mt-2 pt-2 border-t border-[var(--gm-border-primary)] space-y-1\">\n                  {Array.isArray(all.shared_values) && (all.shared_values as string[]).length > 0 && (\n                    <p className=\"text-[10px] text-gm-text-tertiary\"><strong>Shared Values:</strong> {(all.shared_values as string[]).join(', ')}</p>\n                  )}\n                  {all.evidence && <p className=\"text-[10px] text-gm-text-tertiary\"><strong>Evidence:</strong> {replacePersonNames(String(all.evidence), resolveName)}</p>}\n                </div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n\n/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n   Tensions Card\n   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\nfunction TensionsCard({ items, resolveName }: {\n  items: Array<Record<string, unknown>>;\n  resolveName: (n: string) => PersonInfo;\n}) {\n  const [expanded, setExpanded] = useState<Set<number>>(new Set());\n  const toggle = (i: number) => setExpanded(prev => { const n = new Set(prev); n.has(i) ? n.delete(i) : n.add(i); return n; });\n\n  return (\n    <div className=\"bg-gm-surface-primary border border-gm-border-primary rounded-xl p-4\">\n      <h3 className=\"text-xs font-semibold text-gm-text-primary uppercase tracking-wider mb-3 flex items-center gap-2\">\n        <AlertTriangle className=\"w-4 h-4 text-gm-status-danger\" /> Tensions\n        <span className=\"text-[10px] px-2 py-0.5 rounded-full bg-gm-status-danger-bg text-gm-status-danger ml-auto\">{items.length} identified</span>\n      </h3>\n      <div className=\"space-y-2 max-h-72 overflow-y-auto\">\n        {items.slice(0, 10).map((t, i) => {\n          let between = t.between as string[] | string;\n          if (typeof between === 'string') between = between.split(/[\\s,]+/).filter(Boolean);\n          if (!Array.isArray(between)) between = [];\n          const level = String(t.level || 'low').toLowerCase();\n          const tType = String(t.tension_type || 'communication').toLowerCase();\n          const config = tensionTypes[tType] || tensionTypes.communication;\n          const hasExpand = (t.evidence && String(t.evidence).length > 10) || (Array.isArray(t.triggers) && (t.triggers as string[]).length > 0);\n\n          return (\n            <div key={i} className=\"bg-[var(--gm-surface-hover)] rounded-lg p-3\">\n              <div className=\"flex items-center gap-2 flex-wrap\">\n                <div className=\"flex items-center gap-1.5 flex-wrap\">\n                  {(between as string[]).slice(0, 2).map((p, j) => (\n                    <span key={j} className=\"contents\">\n                      {j > 0 && <span className=\"text-[10px] text-gm-text-tertiary\">â†”</span>}\n                      <PersonChip name={p} resolve={resolveName} />\n                    </span>\n                  ))}\n                </div>\n                <span className=\"text-[10px] px-1.5 py-0.5 rounded capitalize ml-auto\" style={{ background: config.bg, color: config.color }}>\n                  {config.icon} {tType}\n                </span>\n                <span className={`text-[10px] px-1.5 py-0.5 rounded-full capitalize ${\n                  level === 'high' ? 'bg-gm-status-danger-bg text-gm-status-danger' :\n                  level === 'medium' ? 'bg-gm-status-warning-bg text-gm-status-warning' :\n                  'bg-gm-status-success-bg text-gm-status-success'\n                }`}>{level}</span>\n                {hasExpand && (\n                  <button onClick={() => toggle(i)} className=\"text-gm-text-tertiary hover:text-gm-text-primary\">\n                    {expanded.has(i) ? <ChevronUp className=\"w-3.5 h-3.5\" /> : <ChevronDown className=\"w-3.5 h-3.5\" />}\n                  </button>\n                )}\n              </div>\n              {expanded.has(i) && (\n                <div className=\"mt-2 pt-2 border-t border-[var(--gm-border-primary)] space-y-1\">\n                  {Array.isArray(t.triggers) && (t.triggers as string[]).length > 0 && (\n                    <p className=\"text-[10px] text-gm-text-tertiary\"><strong>Triggers:</strong> {(t.triggers as string[]).join(', ')}</p>\n                  )}\n                  {t.evidence && <p className=\"text-[10px] text-gm-text-tertiary\"><strong>Evidence:</strong> {replacePersonNames(String(t.evidence), resolveName)}</p>}\n                </div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n\n/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n   Power Centers Card\n   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\nfunction PowerCentersCard({ items, resolveName }: {\n  items: Array<Record<string, unknown>>;\n  resolveName: (n: string) => PersonInfo;\n}) {\n  const [expanded, setExpanded] = useState<Set<number>>(new Set());\n  const toggle = (i: number) => setExpanded(prev => { const n = new Set(prev); n.has(i) ? n.delete(i) : n.add(i); return n; });\n\n  return (\n    <div className=\"bg-gm-surface-primary border border-gm-border-primary rounded-xl p-4\">\n      <h3 className=\"text-xs font-semibold text-gm-text-primary uppercase tracking-wider mb-3 flex items-center gap-2\">\n        <Zap className=\"w-4 h-4 text-gm-interactive-primary\" /> Power Centers\n        <span className=\"text-[10px] px-2 py-0.5 rounded-full bg-gm-surface-secondary text-gm-text-tertiary ml-auto\">{items.length} key players</span>\n      </h3>\n      <div className=\"space-y-2 max-h-72 overflow-y-auto\">\n        {items.slice(0, 10).map((pc, i) => {\n          const pType = String(pc.power_type || 'informal').toLowerCase();\n          const config = powerTypes[pType] || powerTypes.informal;\n          const reachPct = Math.round(Number(pc.influence_reach ?? 50));\n          const hasDeps = Array.isArray(pc.dependencies) && (pc.dependencies as string[]).length > 0;\n\n          return (\n            <div key={i} className=\"bg-[var(--gm-surface-hover)] rounded-lg p-3\">\n              <div className=\"flex items-center gap-2 flex-wrap\">\n                <PersonChip name={String(pc.person || '?')} resolve={resolveName} />\n                <span className=\"text-[10px] px-1.5 py-0.5 rounded capitalize ml-auto\" style={{ background: config.bg, color: config.color }}>\n                  {config.icon} {pType}\n                </span>\n                <div className=\"flex items-center gap-1 w-20\">\n                  <div className=\"flex-1 h-1 rounded-full bg-gm-surface-secondary\">\n                    <div className=\"h-1 rounded-full transition-all\" style={{ width: `${reachPct}%`, background: config.color }} />\n                  </div>\n                  <span className=\"text-[10px] font-mono text-gm-text-tertiary\">{reachPct}%</span>\n                </div>\n                {hasDeps && (\n                  <button onClick={() => toggle(i)} className=\"text-gm-text-tertiary hover:text-gm-text-primary\">\n                    {expanded.has(i) ? <ChevronUp className=\"w-3.5 h-3.5\" /> : <ChevronDown className=\"w-3.5 h-3.5\" />}\n                  </button>\n                )}\n              </div>\n              {expanded.has(i) && hasDeps && (\n                <div className=\"mt-2 pt-2 border-t border-[var(--gm-border-primary)]\">\n                  <p className=\"text-[10px] text-gm-text-tertiary\"><strong>Power Sources:</strong> {(pc.dependencies as string[]).join(', ')}</p>\n                </div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n\n/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n   Relationships Tab\n   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\nfunction RelationshipsTab({ data, isLoading, profiles, resolveName }: {\n  data: unknown;\n  isLoading: boolean;\n  profiles: Array<Record<string, unknown>>;\n  resolveName: (n: string) => PersonInfo;\n}) {\n  if (isLoading) return <Spinner />;\n  const rels = ((data as Record<string, unknown>)?.relationships ?? []) as Array<Record<string, unknown>>;\n  if (rels.length === 0) return <EmptyState icon={Network} message=\"No relationship data. Process documents to discover team relationships.\" />;\n\n  const edgeColors: Record<string, string> = {\n    influences: '#3b82f6',\n    aligned_with: '#22c55e',\n    tension_with: '#ef4444',\n    collaborates: '#8b5cf6',\n  };\n\n  const resolveRelName = (rel: Record<string, unknown>, direction: 'from' | 'to'): string => {\n    const contactObj = rel[`${direction}_contact`] as Record<string, unknown> | undefined;\n    if (contactObj && typeof contactObj === 'object' && contactObj.name) return String(contactObj.name);\n    const personObj = rel[`${direction}_person`] as Record<string, unknown> | undefined;\n    if (personObj && typeof personObj === 'object' && personObj.name) return String(personObj.name);\n    const directName = rel[direction] || rel[`${direction}_person`] || rel[`${direction}_contact`];\n    if (directName && typeof directName === 'string') return directName;\n    const contactId = rel[`${direction}_contact_id`] || rel[`${direction}_person_id`];\n    if (contactId) {\n      const profile = profiles.find(p => String(p.contact_id || p.person_id) === String(contactId));\n      if (profile) {\n        const contact = (profile.contact ?? {}) as Record<string, unknown>;\n        return String(contact.name || profile.person_name || contactId);\n      }\n    }\n    return '?';\n  };\n\n  return (\n    <div className=\"space-y-2\">\n      {rels.map((rel, i) => {\n        const relType = String(rel.type || rel.relationship_type || rel.label || 'related');\n        const edgeColor = edgeColors[relType] || '#6b7280';\n        const fromName = resolveRelName(rel, 'from');\n        const toName = resolveRelName(rel, 'to');\n        const evidence = rel.evidence as Array<Record<string, unknown>> | string | undefined;\n        const evidenceCount = Number(rel.evidence_count || (Array.isArray(evidence) ? evidence.length : 0));\n\n        return (\n          <div key={i} className=\"bg-gm-surface-primary border border-gm-border-primary rounded-xl p-4\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"flex items-center gap-2 flex-1 min-w-0 flex-wrap\">\n                <PersonChip name={fromName} resolve={resolveName} />\n                <ArrowRight className=\"w-4 h-4 flex-shrink-0\" style={{ color: edgeColor }} />\n                <PersonChip name={toName} resolve={resolveName} />\n              </div>\n              <span className=\"text-[10px] px-2 py-0.5 rounded-full capitalize flex-shrink-0\" style={{ background: edgeColor + '15', color: edgeColor }}>\n                {relType.replace(/_/g, ' ')}\n              </span>\n              {rel.strength !== undefined && (\n                <div className=\"flex items-center gap-1.5 w-24\">\n                  <div className=\"flex-1 h-1.5 bg-gm-surface-secondary rounded-full\">\n                    <div className=\"h-1.5 rounded-full\" style={{ width: `${Math.round(Number(rel.strength) * (Number(rel.strength) <= 1 ? 100 : 1))}%`, background: edgeColor }} />\n                  </div>\n                  <span className=\"text-[10px] font-mono text-gm-text-tertiary\">{Math.round(Number(rel.strength) * (Number(rel.strength) <= 1 ? 100 : 1))}%</span>\n                </div>\n              )}\n              {rel.confidence && (\n                <span className=\"text-[10px] px-1.5 py-0.5 rounded-full bg-gm-surface-secondary text-gm-text-tertiary capitalize\">{String(rel.confidence)}</span>\n              )}\n            </div>\n            {/* Evidence and extra info */}\n            {(evidenceCount > 0 || (typeof evidence === 'string' && evidence.length > 0)) && (\n              <div className=\"mt-2 pt-2 border-t border-[var(--gm-border-primary)]\">\n                {typeof evidence === 'string' && evidence.length > 0 && (\n                  <p className=\"text-[10px] text-gm-text-tertiary\">{evidence}</p>\n                )}\n                {Array.isArray(evidence) && evidence.length > 0 && (\n                  <div className=\"space-y-1\">\n                    {evidence.slice(0, 3).map((e, j) => (\n                      <p key={j} className=\"text-[10px] text-gm-text-tertiary\">\n                        {e.quote && <span className=\"italic\">\"{String(e.quote)}\" </span>}\n                        {e.observation && <span>{String(e.observation)}</span>}\n                        {e.timestamp && <span className=\"text-gray-400 ml-1\">({String(e.timestamp)})</span>}\n                      </p>\n                    ))}\n                    {evidence.length > 3 && <p className=\"text-[9px] text-gray-500\">+{evidence.length - 3} more evidence items</p>}\n                  </div>\n                )}\n                {evidenceCount > 0 && !evidence && (\n                  <p className=\"text-[10px] text-gm-text-tertiary\">{evidenceCount} evidence items</p>\n                )}\n              </div>\n            )}\n          </div>\n        );\n      })}\n    </div>\n  );\n}\n\n/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n   Network Graph Tab - Enhanced with legend, info panel, edge styles\n   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\nfunction NetworkGraphTab({ data, isLoading, profiles, resolveName }: {\n  data: unknown;\n  isLoading: boolean;\n  profiles: Array<Record<string, unknown>>;\n  resolveName: (n: string) => PersonInfo;\n}) {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const [selectedNode, setSelectedNode] = useState<Record<string, unknown> | null>(null);\n  const graphData = data as { nodes?: Array<Record<string, unknown>>; edges?: Array<Record<string, unknown>> } | null;\n  const nodes = graphData?.nodes ?? [];\n  const edges = graphData?.edges ?? [];\n\n  const profileLookup = useMemo(() => {\n    const map: Record<string, Record<string, unknown>> = {};\n    profiles.forEach(p => {\n      const id = String(p.contact_id || p.person_id || '');\n      if (id) map[id] = p;\n    });\n    return map;\n  }, [profiles]);\n\n  const positionsRef = useRef<Array<{ x: number; y: number }>>([]);\n\n  const edgeStyleMap: Record<string, { color: string; dash: boolean }> = {\n    influences: { color: '#3b82f6', dash: false },\n    aligned_with: { color: '#22c55e', dash: false },\n    tension_with: { color: '#ef4444', dash: true },\n  };\n\n  const drawGraph = useCallback(() => {\n    if (!canvasRef.current || nodes.length === 0) return;\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    if (!ctx) return;\n\n    const w = canvas.width = canvas.parentElement?.clientWidth ?? 800;\n    const h = canvas.height = 500;\n    const nodeById = new Map<string, number>();\n    nodes.forEach((n, i) => nodeById.set(String(n.id), i));\n\n    // Circular layout with influence-based spacing\n    const positions = nodes.map((node, i) => {\n      const props = (node.properties ?? {}) as Record<string, unknown>;\n      const influence = Number(props.influenceScore ?? node.influence_score ?? node.size ?? 50);\n      const radiusFactor = 0.32 + (influence / 500);\n      return {\n        x: w / 2 + (w * radiusFactor) * Math.cos((2 * Math.PI * i) / nodes.length),\n        y: h / 2 + (h * radiusFactor) * Math.sin((2 * Math.PI * i) / nodes.length),\n      };\n    });\n    positionsRef.current = positions;\n\n    ctx.clearRect(0, 0, w, h);\n\n    // Draw edges\n    edges.forEach(edge => {\n      const fromIdx = nodeById.get(String(edge.from ?? edge.source));\n      const toIdx = nodeById.get(String(edge.to ?? edge.target));\n      if (fromIdx === undefined || toIdx === undefined) return;\n      const edgeType = String(edge.type || edge.label || edge.relationship_type || '');\n      const style = edgeStyleMap[edgeType] || { color: '#94a3b8', dash: false };\n\n      ctx.beginPath();\n      ctx.setLineDash(style.dash ? [5, 5] : []);\n      ctx.moveTo(positions[fromIdx].x, positions[fromIdx].y);\n      ctx.lineTo(positions[toIdx].x, positions[toIdx].y);\n      ctx.strokeStyle = style.color + '80';\n      ctx.lineWidth = Math.max(1, Number(edge.strength ?? edge.value ?? 0.5) * 4);\n      ctx.stroke();\n      ctx.setLineDash([]);\n\n      // Arrow for \"influences\"\n      if (edgeType === 'influences') {\n        const dx = positions[toIdx].x - positions[fromIdx].x;\n        const dy = positions[toIdx].y - positions[fromIdx].y;\n        const angle = Math.atan2(dy, dx);\n        const len = 8;\n        const toProps = (nodes[toIdx].properties ?? {}) as Record<string, unknown>;\n        const toR = 22 + (Number(toProps.influenceScore ?? nodes[toIdx].influence_score ?? 50) / 10);\n        const arrowX = positions[toIdx].x - Math.cos(angle) * toR;\n        const arrowY = positions[toIdx].y - Math.sin(angle) * toR;\n        ctx.beginPath();\n        ctx.moveTo(arrowX, arrowY);\n        ctx.lineTo(arrowX - len * Math.cos(angle - Math.PI / 6), arrowY - len * Math.sin(angle - Math.PI / 6));\n        ctx.lineTo(arrowX - len * Math.cos(angle + Math.PI / 6), arrowY - len * Math.sin(angle + Math.PI / 6));\n        ctx.closePath();\n        ctx.fillStyle = style.color;\n        ctx.fill();\n      }\n    });\n\n    // Draw nodes with avatar-style circles\n    nodes.forEach((node, i) => {\n      const { x, y } = positions[i];\n      const nodeProps = (node.properties ?? {}) as Record<string, unknown>;\n      const influence = Number(nodeProps.influenceScore ?? node.influence_score ?? node.size ?? 50);\n      const r = 20 + (influence / 10);\n      const label = String(node.label || node.name || '?');\n      const color = stringToColor(label);\n\n      // Shadow\n      ctx.shadowColor = 'rgba(0,0,0,0.15)';\n      ctx.shadowBlur = 8;\n      ctx.shadowOffsetX = 2;\n      ctx.shadowOffsetY = 2;\n\n      // Gradient fill\n      const grad = ctx.createRadialGradient(x - r * 0.3, y - r * 0.3, 0, x, y, r);\n      grad.addColorStop(0, color);\n      grad.addColorStop(1, adjustColor(color, -40));\n      ctx.beginPath();\n      ctx.arc(x, y, r, 0, 2 * Math.PI);\n      ctx.fillStyle = grad;\n      ctx.fill();\n\n      // Border\n      ctx.shadowColor = 'transparent';\n      ctx.strokeStyle = selectedNode && String(selectedNode.id) === String(node.id) ? '#f59e0b' : 'rgba(255,255,255,0.6)';\n      ctx.lineWidth = selectedNode && String(selectedNode.id) === String(node.id) ? 3 : 2;\n      ctx.stroke();\n\n      // Initials\n      const initials = getInitials(label);\n      ctx.fillStyle = '#fff';\n      ctx.font = `bold ${Math.max(11, r * 0.55)}px Inter, system-ui, sans-serif`;\n      ctx.textAlign = 'center';\n      ctx.textBaseline = 'middle';\n      ctx.fillText(initials, x, y);\n\n      // Label below\n      const textColor = getComputedStyle(document.documentElement).getPropertyValue('--gm-text-primary').trim() || '#0f172a';\n      ctx.fillStyle = textColor;\n      ctx.font = '11px Inter, system-ui, sans-serif';\n      ctx.fillText(label, x, y + r + 14);\n    });\n  }, [nodes, edges, selectedNode]);\n\n  useEffect(() => { drawGraph(); }, [drawGraph]);\n\n  const handleCanvasClick = useCallback((e: React.MouseEvent<HTMLCanvasElement>) => {\n    if (!canvasRef.current || nodes.length === 0) return;\n    const rect = canvasRef.current.getBoundingClientRect();\n    const mx = e.clientX - rect.left;\n    const my = e.clientY - rect.top;\n\n    for (let i = 0; i < nodes.length; i++) {\n      const pos = positionsRef.current[i];\n      if (!pos) continue;\n      const clickProps = (nodes[i].properties ?? {}) as Record<string, unknown>;\n      const r = 20 + (Number(clickProps.influenceScore ?? nodes[i].influence_score ?? nodes[i].size ?? 50) / 10);\n      const dx = mx - pos.x;\n      const dy = my - pos.y;\n      if (dx * dx + dy * dy <= r * r) {\n        setSelectedNode(nodes[i]);\n        return;\n      }\n    }\n    setSelectedNode(null);\n  }, [nodes]);\n\n  if (isLoading) return <Spinner />;\n  if (nodes.length === 0) return <EmptyState icon={Network} message=\"No network data. Analyze profiles and sync graph to build the network.\" />;\n\n  const selectedProfile = selectedNode ? profileLookup[String(selectedNode.id)] : null;\n\n  return (\n    <div className=\"flex gap-3\">\n      {/* Graph */}\n      <div className=\"flex-1 bg-gm-surface-primary border border-gm-border-primary rounded-xl p-4\">\n        <div className=\"flex items-center justify-between mb-3\">\n          <h3 className=\"text-xs font-semibold text-gm-text-primary uppercase tracking-wider flex items-center gap-2\">\n            <Network className=\"w-4 h-4 text-gm-interactive-primary\" /> Team Network\n            <span className=\"text-[10px] px-2 py-0.5 rounded-full bg-gm-surface-secondary text-gm-text-tertiary\">{nodes.length} nodes, {edges.length} edges</span>\n          </h3>\n        </div>\n\n        {/* Legend */}\n        <div className=\"flex gap-4 mb-3\">\n          <div className=\"flex items-center gap-1.5\">\n            <div className=\"w-6 h-0.5 bg-[#3b82f6] rounded\" />\n            <span className=\"text-[10px] text-gm-text-tertiary\">Influences</span>\n          </div>\n          <div className=\"flex items-center gap-1.5\">\n            <div className=\"w-6 h-0.5 bg-[#22c55e] rounded\" />\n            <span className=\"text-[10px] text-gm-text-tertiary\">Alliance</span>\n          </div>\n          <div className=\"flex items-center gap-1.5\">\n            <div className=\"w-6 h-0.5 border-t-2 border-dashed border-[#ef4444]\" />\n            <span className=\"text-[10px] text-gm-text-tertiary\">Tension</span>\n          </div>\n        </div>\n\n        <div className=\"bg-[var(--gm-surface-hover)] rounded-lg overflow-hidden cursor-pointer\">\n          <canvas ref={canvasRef} className=\"w-full\" style={{ height: 500 }} onClick={handleCanvasClick} />\n        </div>\n      </div>\n\n      {/* Info Panel */}\n      <div className=\"w-64 bg-gm-surface-primary border border-gm-border-primary rounded-xl p-4 flex-shrink-0\">\n        {selectedNode ? (\n          <NodeDetailPanel node={selectedNode} profile={selectedProfile} resolveName={resolveName} />\n        ) : (\n          <div className=\"flex flex-col items-center justify-center h-full text-gm-text-tertiary\">\n            <Users className=\"w-8 h-8 mb-2 text-gray-500\" />\n            <p className=\"text-xs text-center\">Click on a person to see details</p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\n/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n   Node Detail Panel (Graph side panel)\n   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\nfunction NodeDetailPanel({ node, profile, resolveName }: {\n  node: Record<string, unknown>;\n  profile: Record<string, unknown> | undefined;\n  resolveName: (n: string) => PersonInfo;\n}) {\n  const nodeProps = (node.properties ?? {}) as Record<string, unknown>;\n  const name = String(node.label || node.name || 'Unknown');\n  const contact = profile ? (profile.contact ?? {}) as Record<string, unknown> : {};\n  const role = String(contact.role || contact.organization || nodeProps.role || '');\n  const org = String(contact.organization || nodeProps.organization || '');\n  const influenceScore = Number(profile?.influence_score ?? nodeProps.influenceScore ?? node.influence_score ?? 0);\n  const commStyle = String(profile?.communication_style || nodeProps.communicationStyle || '');\n  const motivation = String(profile?.dominant_motivation || nodeProps.dominantMotivation || '');\n  const avatarUrl = isValidAvatarUrl(contact.avatar_url) ? String(contact.avatar_url) : isValidAvatarUrl(contact.photo_url) ? String(contact.photo_url) : null;\n\n  return (\n    <div className=\"space-y-3\">\n      <div className=\"flex items-center gap-3\">\n        <ContactAvatar url={avatarUrl} name={name} size=\"lg\" />\n        <div className=\"min-w-0\">\n          <p className=\"text-sm font-semibold text-gm-text-primary truncate\">{name}</p>\n          {role && <p className=\"text-[10px] text-gm-text-tertiary\">{role}</p>}\n          {org && org !== role && <p className=\"text-[10px] text-gm-text-tertiary\">{org}</p>}\n        </div>\n      </div>\n\n      {/* Influence meter */}\n      <div>\n        <p className=\"text-[10px] text-gm-text-tertiary uppercase tracking-wider mb-1\">Influence</p>\n        <div className=\"flex items-center gap-2\">\n          <div className=\"flex-1 h-2 bg-gm-surface-secondary rounded-full\">\n            <div className=\"h-2 bg-gm-interactive-primary rounded-full\" style={{ width: `${Math.min(100, influenceScore)}%` }} />\n          </div>\n          <span className=\"text-xs font-bold text-gm-text-primary\">{influenceScore}%</span>\n        </div>\n      </div>\n\n      {commStyle && (\n        <div>\n          <p className=\"text-[10px] text-gm-text-tertiary uppercase tracking-wider mb-0.5\">Communication</p>\n          <p className=\"text-xs text-gm-text-primary\">{commStyle.substring(0, 100)}</p>\n        </div>\n      )}\n\n      {motivation && (\n        <div>\n          <p className=\"text-[10px] text-gm-text-tertiary uppercase tracking-wider mb-0.5\">Motivation</p>\n          <p className=\"text-xs text-gm-text-primary\">{motivation}</p>\n        </div>\n      )}\n    </div>\n  );\n}\n\n/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n   Analyze Contacts Modal\n   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\nfunction AnalyzeContactsModal({ open, onClose, existingProfileIds }: {\n  open: boolean; onClose: () => void; existingProfileIds: Set<string>;\n}) {\n  const [search, setSearch] = useState('');\n  const [selected, setSelected] = useState<Set<string>>(new Set());\n  const contacts = useContacts();\n  const analyzeProfile = useAnalyzeProfile();\n  const [analyzing, setAnalyzing] = useState(false);\n  const [progress, setProgress] = useState({ done: 0, total: 0, current: '' });\n\n  const contactList = useMemo(() => {\n    const list = (contacts.data?.contacts ?? []) as Array<Record<string, unknown>>;\n    const sorted = [...list].sort((a, b) => {\n      const aAnalyzed = existingProfileIds.has(String(a.id));\n      const bAnalyzed = existingProfileIds.has(String(b.id));\n      if (aAnalyzed !== bAnalyzed) return aAnalyzed ? 1 : -1;\n      return String(a.name || '').localeCompare(String(b.name || ''));\n    });\n    if (!search) return sorted;\n    return sorted.filter(c => JSON.stringify(c).toLowerCase().includes(search.toLowerCase()));\n  }, [contacts.data, search, existingProfileIds]);\n\n  const toggleContact = (id: string) => setSelected(prev => {\n    const next = new Set(prev);\n    if (next.has(id)) next.delete(id); else next.add(id);\n    return next;\n  });\n\n  const selectUnanalyzed = () => {\n    const ids = contactList.filter(c => !existingProfileIds.has(String(c.id))).map(c => String(c.id));\n    setSelected(new Set(ids));\n  };\n\n  const handleAnalyze = async () => {\n    if (selected.size === 0) return;\n    setAnalyzing(true);\n    const ids = Array.from(selected);\n    setProgress({ done: 0, total: ids.length, current: '' });\n    let success = 0, errors = 0;\n\n    for (const id of ids) {\n      const contact = contactList.find(c => String(c.id) === id);\n      const name = String(contact?.name || 'Contact');\n      setProgress(p => ({ ...p, current: name }));\n      try {\n        await analyzeProfile.mutateAsync({ personId: id, forceReanalysis: true });\n        success++;\n      } catch {\n        errors++;\n      }\n      setProgress(p => ({ ...p, done: p.done + 1 }));\n    }\n\n    setAnalyzing(false);\n    if (success > 0) toast.success(`Analyzed ${success} member${success > 1 ? 's' : ''}`);\n    if (errors > 0) toast.error(`Failed for ${errors} member${errors > 1 ? 's' : ''}`);\n    setSelected(new Set());\n    onClose();\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={o => !o && !analyzing && onClose()}>\n      <DialogContent className=\"max-w-lg p-0 overflow-hidden\">\n        <DialogTitle className=\"sr-only\">Analyze Team Members</DialogTitle>\n        <div className=\"px-5 pt-5 pb-3\">\n          <h2 className=\"text-base font-bold text-gm-text-primary\">Analyze Team Members</h2>\n          <p className=\"text-xs text-gm-text-tertiary mt-1\">Select members to analyze with AI behavioral profiling.</p>\n          <p className=\"text-[10px] text-gm-text-tertiary mt-0.5\">\n            {contactList.length} contacts &middot; {existingProfileIds.size} analyzed\n          </p>\n        </div>\n\n        <div className=\"px-5 pb-3 flex gap-2\">\n          <div className=\"relative flex-1\">\n            <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gm-text-tertiary\" />\n            <input value={search} onChange={e => setSearch(e.target.value)} placeholder=\"Search contacts...\"\n              className=\"w-full pl-9 pr-3 py-1.5 bg-gm-surface-secondary border border-gm-border-primary rounded-lg text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus\" />\n          </div>\n          <button onClick={selectUnanalyzed}\n            className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary text-gm-text-primary text-xs hover:bg-gm-surface-hover transition-colors border border-gm-border-primary whitespace-nowrap\">\n            Select Unanalyzed\n          </button>\n        </div>\n\n        <div className=\"max-h-64 overflow-y-auto px-5 space-y-1\">\n          {contacts.isLoading && <Spinner />}\n          {contactList.map(contact => {\n            const id = String(contact.id);\n            const name = String(contact.name || 'Unknown');\n            const role = String(contact.role || contact.organization || '');\n            const avatarUrl = isValidAvatarUrl(contact.avatar_url) ? String(contact.avatar_url) : isValidAvatarUrl(contact.photo_url) ? String(contact.photo_url) : null;\n            const hasProfile = existingProfileIds.has(id);\n            const isSelected = selected.has(id);\n            return (\n              <label key={id} className={`flex items-center gap-3 p-2.5 rounded-lg cursor-pointer transition-colors ${isSelected ? 'bg-blue-600/5 border border-blue-600/20' : 'hover:bg-gm-surface-hover border border-transparent'}`}>\n                <input type=\"checkbox\" checked={isSelected} onChange={() => toggleContact(id)}\n                  className=\"w-3.5 h-3.5 rounded accent-gm-interactive-primary\" />\n                <ContactAvatar url={avatarUrl} name={name} size=\"md\" />\n                <div className=\"flex-1 min-w-0\">\n                  <p className=\"text-xs font-medium text-gm-text-primary truncate\">{name}</p>\n                  {role && <p className=\"text-[10px] text-gm-text-tertiary\">{role}</p>}\n                </div>\n                <span className={`text-[10px] px-2 py-0.5 rounded-full font-medium ${hasProfile ? 'bg-gm-status-success-bg text-gm-status-success' : 'bg-gm-surface-secondary text-gm-text-tertiary'}`}>\n                  {hasProfile ? 'Analyzed' : 'Not analyzed'}\n                </span>\n              </label>\n            );\n          })}\n          {!contacts.isLoading && contactList.length === 0 && (\n            <p className=\"text-xs text-gm-text-tertiary text-center py-4\">No contacts found.</p>\n          )}\n        </div>\n\n        {analyzing && (\n          <div className=\"px-5 py-3 border-t border-gm-border-primary\">\n            <div className=\"flex items-center justify-between mb-1\">\n              <span className=\"text-xs text-gm-text-primary\">{progress.current}...</span>\n              <span className=\"text-[10px] text-gm-text-tertiary\">{progress.done}/{progress.total}</span>\n            </div>\n            <div className=\"w-full bg-gm-surface-secondary rounded-full h-1.5\">\n              <div className=\"bg-gm-interactive-primary h-1.5 rounded-full transition-all\" style={{ width: `${(progress.done / progress.total) * 100}%` }} />\n            </div>\n          </div>\n        )}\n\n        <div className=\"px-5 py-3 border-t border-gm-border-primary flex items-center justify-between\">\n          <span className=\"text-xs text-gm-text-tertiary\">{selected.size} selected</span>\n          <div className=\"flex gap-2\">\n            <button onClick={onClose} disabled={analyzing}\n              className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary text-gm-text-primary text-xs hover:bg-gm-surface-hover transition-colors\">Cancel</button>\n            <button onClick={handleAnalyze} disabled={selected.size === 0 || analyzing}\n              className=\"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\n              {analyzing ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Play className=\"w-3.5 h-3.5\" />}\n              {analyzing ? `Analyzing ${progress.done}/${progress.total}...` : `Analyze Selected (${selected.size})`}\n            </button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\n/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n   Shared UI Components\n   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\nfunction Spinner() {\n  return (\n    <div className=\"flex items-center justify-center h-32\">\n      <Loader2 className=\"h-8 w-8 animate-spin text-gm-interactive-primary\" />\n    </div>\n  );\n}\n\nfunction EmptyState({ icon: Icon, message }: { icon: typeof Users; message: string }) {\n  return (\n    <div className=\"rounded-xl border border-gm-border-primary bg-gm-surface-primary p-8 text-center text-gm-text-tertiary\">\n      <Icon className=\"h-12 w-12 mx-auto mb-4 text-gray-500\" />\n      {message}\n    </div>\n  );\n}\n"],"names":["AvatarWithFallback","url","name","initials","failed","setFailed","useState","jsx","stringToColor","adjustColor","ProfileDetailModal","profile","open","onClose","analyzeProfile","useAnalyzeProfile","contact","role","n","avatarRaw","avatarUrl","data","confidence","contactId","speakingTime","limitations","lastAnalysis","handleReanalyze","toast","formatTime","seconds","m","s","Dialog","o","jsxs","DialogContent","DialogTitle","ArrowLeft","Loader2","RotateCw","MetricPill","CommunicationSection","MotivationsSection","PressureSection","InfluenceTacticsSection","VulnerabilitiesSection","StrategySection","WarningSection","PowerSection","SectionHeader","FileText","l","i","Eye","label","value","Icon","title","comm","MessageSquare","InfoBlock","EvidenceList","mot","values","avoids","Star","v","a","behaviors","Clock","b","tactics","Target","t","vuln","triggers","blindSpots","inconsistencies","riskPatterns","Shield","VulnBlock","color","items","field","evidenceField","item","strat","works","avoid","cooperation","format","f","c","warnings","AlertTriangle","w","power","Zap","p","evidence","e","str","colors","hash","amount","clamp","hex","r","g","ContactAvatar","size","className","getInitials","dims","textSize","borderCls","buildNameResolver","profiles","mapping","index","realName","info","firstName","normalized","replacePersonNames","text","resolve","match","PersonChip","isValidAvatarUrl","influenceTypes","allianceTypes","tensionTypes","powerTypes","TeamAnalysisPage","tab","setTab","selectedProfile","setSelectedProfile","showAnalyzeModal","setShowAnalyzeModal","useTeamProfiles","dynamics","useTeamDynamics","relationships","useTeamRelationships","graphQuery","useTeamGraph","runTeamAnalysis","useRunTeamAnalysis","syncGraph","useSyncTeamGraph","profileList","useMemo","resolveName","ErrorState","tabs","Users","BarChart3","ArrowRight","Network","handleRunAnalysis","handleSyncGraph","Play","RefreshCw","ProfilesTab","TeamDynamicsTab","RelationshipsTab","NetworkGraphTab","AnalyzeContactsModal","isLoading","onSelectProfile","Spinner","EmptyState","sorted","commStyle","speakingMins","d","cohesion","tensionLevel","teamSize","analysisData","dominantPattern","influenceMap","alliances","tensions","powerCenters","riskFactors","recommendations","commFlow","dynamicsList","analysisDate","cohesionColor","Calendar","InfluenceScoreboard","CommunicationFlowSection","InfluenceMapCard","AlliancesCard","TensionsCard","PowerCentersCard","TrendingUp","CheckCircle","maxScore","medals","score","barWidth","risk","styleSnippet","flow","bottlenecks","brokers","central","isolated","expanded","setExpanded","toggle","prev","inf","infType","config","strengthPct","hasEvidence","ChevronUp","ChevronDown","all","members","aType","hasExpand","j","between","level","tType","pc","pType","reachPct","hasDeps","rels","edgeColors","resolveRelName","rel","direction","contactObj","personObj","directName","relType","edgeColor","fromName","toName","evidenceCount","canvasRef","useRef","selectedNode","setSelectedNode","graphData","nodes","edges","profileLookup","map","id","positionsRef","edgeStyleMap","drawGraph","useCallback","canvas","ctx","h","nodeById","positions","node","props","radiusFactor","edge","fromIdx","toIdx","edgeType","style","dx","dy","angle","len","toProps","toR","arrowX","arrowY","x","y","nodeProps","grad","textColor","useEffect","handleCanvasClick","rect","mx","my","pos","clickProps","NodeDetailPanel","org","influenceScore","motivation","existingProfileIds","search","setSearch","selected","setSelected","contacts","useContacts","analyzing","setAnalyzing","progress","setProgress","contactList","aAnalyzed","bAnalyzed","toggleContact","next","selectUnanalyzed","ids","handleAnalyze","success","errors","Search","hasProfile","isSelected","message"],"mappings":"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"}
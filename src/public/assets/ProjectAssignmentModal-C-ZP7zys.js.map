{"version":3,"file":"ProjectAssignmentModal-C-ZP7zys.js","sources":["../../frontend/components/modals/ProjectAssignmentModal.ts"],"sourcesContent":["/**\n * Project Assignment Modal\n * Assign a Krisp transcript to a project manually\n */\n\nimport { createElement, on } from '../../utils/dom';\nimport { createModal, openModal, closeModal } from '../Modal';\nimport { toast } from '../../services/toast';\nimport { http } from '../../services/api';\nimport * as krispService from '../../services/krisp';\nimport type { KrispTranscript, ProjectCandidate, TranscriptSummary } from '../../services/krisp';\n\nconst MODAL_ID = 'project-assignment-modal';\n\ninterface Project {\n  id: string;\n  name: string;\n  project_number?: string;\n}\n\nexport interface ProjectAssignmentModalProps {\n  transcript: KrispTranscript;\n  onAssign?: () => void;\n  onClose?: () => void;\n}\n\nlet currentProps: ProjectAssignmentModalProps | null = null;\nlet userProjects: Project[] = [];\n\n/**\n * Show project assignment modal\n */\nexport async function showProjectAssignmentModal(props: ProjectAssignmentModalProps): Promise<void> {\n  currentProps = props;\n  const { transcript } = props;\n\n  // Remove existing modal\n  const existing = document.querySelector(`[data-modal-id=\"${MODAL_ID}\"]`);\n  if (existing) existing.remove();\n\n  const content = createElement('div', { className: 'project-assignment' });\n\n  content.innerHTML = `\n    <style>\n      .project-assignment {\n        padding: 16px 0;\n      }\n      .assignment-info {\n        margin-bottom: 24px;\n        padding: 16px;\n        background: var(--bg-secondary, #f8fafc);\n        border-radius: 8px;\n      }\n      .assignment-title {\n        font-weight: 600;\n        margin-bottom: 8px;\n        color: var(--text-primary, #1e293b);\n      }\n      .assignment-reason {\n        display: flex;\n        align-items: center;\n        gap: 8px;\n        color: #f59e0b;\n        font-size: 14px;\n        margin-bottom: 12px;\n      }\n      .assignment-reason svg {\n        width: 18px;\n        height: 18px;\n        flex-shrink: 0;\n      }\n      .speakers-list {\n        font-size: 13px;\n        color: var(--text-secondary, #64748b);\n      }\n      .speakers-list strong {\n        color: var(--text-primary, #1e293b);\n      }\n      .candidates-section {\n        margin-bottom: 24px;\n      }\n      .candidates-section h4 {\n        font-size: 14px;\n        font-weight: 500;\n        margin-bottom: 12px;\n        color: var(--text-secondary, #64748b);\n      }\n      .candidate-list {\n        display: flex;\n        flex-direction: column;\n        gap: 8px;\n      }\n      .candidate-item {\n        display: flex;\n        align-items: center;\n        gap: 12px;\n        padding: 12px 16px;\n        border: 2px solid var(--border-color, #e2e8f0);\n        border-radius: 8px;\n        cursor: pointer;\n        transition: all 0.2s;\n      }\n      .candidate-item:hover {\n        border-color: var(--primary-light, #fda4af);\n        background: var(--bg-secondary, #f8fafc);\n      }\n      .candidate-item.selected {\n        border-color: var(--primary, #e11d48);\n        background: #fef2f2;\n      }\n      .candidate-radio {\n        width: 20px;\n        height: 20px;\n        border: 2px solid var(--border-color, #e2e8f0);\n        border-radius: 50%;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        flex-shrink: 0;\n      }\n      .candidate-item.selected .candidate-radio {\n        border-color: var(--primary, #e11d48);\n      }\n      .candidate-item.selected .candidate-radio::after {\n        content: '';\n        width: 10px;\n        height: 10px;\n        background: var(--primary, #e11d48);\n        border-radius: 50%;\n      }\n      .candidate-info {\n        flex: 1;\n      }\n      .candidate-name {\n        font-weight: 500;\n        color: var(--text-primary, #1e293b);\n      }\n      .candidate-code {\n        font-size: 12px;\n        color: var(--text-secondary, #64748b);\n      }\n      .candidate-confidence {\n        font-size: 13px;\n        padding: 4px 10px;\n        background: var(--bg-tertiary, #f1f5f9);\n        border-radius: 12px;\n        color: var(--text-secondary, #64748b);\n      }\n      .project-select-section {\n        margin-bottom: 24px;\n      }\n      .project-select-section h4 {\n        font-size: 14px;\n        font-weight: 500;\n        margin-bottom: 12px;\n        color: var(--text-secondary, #64748b);\n      }\n      .project-select {\n        width: 100%;\n        padding: 12px;\n        border: 1px solid var(--border-color, #e2e8f0);\n        border-radius: 8px;\n        font-size: 14px;\n        background: white;\n      }\n      .action-buttons {\n        display: flex;\n        justify-content: flex-end;\n        gap: 12px;\n        padding-top: 16px;\n        border-top: 1px solid var(--border-color, #e2e8f0);\n      }\n      .btn {\n        padding: 10px 20px;\n        border-radius: 8px;\n        font-size: 14px;\n        font-weight: 500;\n        cursor: pointer;\n        transition: all 0.2s;\n        border: none;\n      }\n      .btn-secondary {\n        background: var(--bg-secondary, #f1f5f9);\n        color: var(--text-primary, #1e293b);\n      }\n      .btn-secondary:hover {\n        background: var(--bg-tertiary, #e2e8f0);\n      }\n      .btn-primary {\n        background: var(--primary, #e11d48);\n        color: white;\n      }\n      .btn-primary:hover {\n        opacity: 0.9;\n      }\n      .btn-primary:disabled {\n        opacity: 0.5;\n        cursor: not-allowed;\n      }\n      .btn-danger {\n        background: transparent;\n        color: #dc2626;\n        border: 1px solid #dc2626;\n      }\n      .btn-danger:hover {\n        background: #fef2f2;\n      }\n      [data-theme=\"dark\"] .assignment-info {\n        background: rgba(30,41,59,0.5);\n      }\n      [data-theme=\"dark\"] .candidate-item.selected {\n        background: rgba(225,29,72,0.1);\n      }\n      [data-theme=\"dark\"] .project-select {\n        background: rgba(30,41,59,0.8);\n        color: white;\n      }\n      \n      /* Meeting Summary Styles */\n      .meeting-summary {\n        margin-bottom: 24px;\n        padding: 16px;\n        background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);\n        border-radius: 12px;\n        border: 1px solid #bae6fd;\n      }\n      [data-theme=\"dark\"] .meeting-summary {\n        background: linear-gradient(135deg, rgba(14,165,233,0.1) 0%, rgba(56,189,248,0.05) 100%);\n        border-color: rgba(56,189,248,0.2);\n      }\n      .summary-header {\n        display: flex;\n        align-items: center;\n        gap: 8px;\n        margin-bottom: 12px;\n        font-weight: 600;\n        color: #0369a1;\n      }\n      [data-theme=\"dark\"] .summary-header {\n        color: #38bdf8;\n      }\n      .summary-header svg {\n        width: 18px;\n        height: 18px;\n      }\n      .summary-topic {\n        font-size: 15px;\n        color: var(--text-primary, #1e293b);\n        margin-bottom: 12px;\n        line-height: 1.5;\n      }\n      .summary-section {\n        margin-bottom: 12px;\n      }\n      .summary-section:last-child {\n        margin-bottom: 0;\n      }\n      .summary-section-title {\n        font-size: 12px;\n        font-weight: 600;\n        text-transform: uppercase;\n        color: #0369a1;\n        margin-bottom: 6px;\n        letter-spacing: 0.5px;\n      }\n      [data-theme=\"dark\"] .summary-section-title {\n        color: #7dd3fc;\n      }\n      .summary-list {\n        list-style: none;\n        padding: 0;\n        margin: 0;\n      }\n      .summary-list li {\n        position: relative;\n        padding-left: 16px;\n        font-size: 13px;\n        color: var(--text-secondary, #475569);\n        margin-bottom: 4px;\n        line-height: 1.4;\n      }\n      .summary-list li::before {\n        content: 'â€¢';\n        position: absolute;\n        left: 0;\n        color: #0ea5e9;\n      }\n      .summary-loading {\n        display: flex;\n        align-items: center;\n        gap: 12px;\n        color: var(--text-secondary, #64748b);\n        font-size: 14px;\n      }\n      .summary-loading .spinner {\n        width: 20px;\n        height: 20px;\n        border: 2px solid #e2e8f0;\n        border-top-color: #0ea5e9;\n        border-radius: 50%;\n        animation: spin 1s linear infinite;\n      }\n      @keyframes spin {\n        to { transform: rotate(360deg); }\n      }\n      .refresh-summary-btn {\n        background: transparent;\n        border: none;\n        padding: 4px;\n        cursor: pointer;\n        color: #0369a1;\n        border-radius: 4px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        transition: all 0.2s;\n      }\n      .refresh-summary-btn:hover {\n        background: rgba(3, 105, 161, 0.1);\n      }\n      [data-theme=\"dark\"] .refresh-summary-btn {\n        color: #38bdf8;\n      }\n      [data-theme=\"dark\"] .refresh-summary-btn:hover {\n        background: rgba(56, 189, 248, 0.1);\n      }\n      .summary-source {\n        font-size: 11px;\n        color: var(--text-tertiary, #94a3b8);\n        text-align: right;\n        margin-top: 8px;\n      }\n    </style>\n    \n    <!-- Meeting Summary Section -->\n    <div class=\"meeting-summary\" id=\"meeting-summary\">\n      <div class=\"summary-loading\">\n        <div class=\"spinner\"></div>\n        <span>Generating meeting summary...</span>\n      </div>\n    </div>\n    \n    <div class=\"assignment-info\">\n      <div class=\"assignment-title\">${escapeHtml(transcript.krisp_title || 'Untitled Meeting')}</div>\n      ${transcript.status_reason ? `\n        <div class=\"assignment-reason\">\n          <svg fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\"/>\n          </svg>\n          ${escapeHtml(transcript.status_reason)}\n        </div>\n      ` : ''}\n      <div class=\"speakers-list\">\n        <strong>Speakers:</strong> ${transcript.speakers?.join(', ') || 'None identified'}\n      </div>\n    </div>\n    \n    <div id=\"assignment-content\">\n      <div class=\"loading-spinner\"></div>\n    </div>\n    \n    <div class=\"action-buttons\">\n      <button type=\"button\" class=\"btn btn-danger\" id=\"skip-btn\">Skip Transcript</button>\n      <div style=\"flex: 1;\"></div>\n      <button type=\"button\" class=\"btn btn-secondary\" id=\"cancel-btn\">Cancel</button>\n      <button type=\"button\" class=\"btn btn-primary\" id=\"assign-btn\" disabled>Assign to Project</button>\n    </div>\n  `;\n\n  const modal = createModal({\n    id: MODAL_ID,\n    title: 'Assign to Project',\n    content,\n    size: 'md',\n  });\n\n  document.body.appendChild(modal);\n  openModal(MODAL_ID);\n\n  // Bind button events\n  bindButtonEvents(content);\n\n  // Load summary and projects in parallel\n  loadMeetingSummary(content, transcript);\n  await loadProjectOptions(content, transcript);\n}\n\n/**\n * Bind button events\n */\nfunction bindButtonEvents(container: HTMLElement): void {\n  const cancelBtn = container.querySelector('#cancel-btn');\n  if (cancelBtn) {\n    on(cancelBtn as HTMLElement, 'click', () => {\n      closeModal(MODAL_ID);\n      currentProps?.onClose?.();\n    });\n  }\n\n  const skipBtn = container.querySelector('#skip-btn');\n  if (skipBtn) {\n    on(skipBtn as HTMLElement, 'click', async () => {\n      if (!currentProps?.transcript) return;\n      \n      if (!confirm('Are you sure you want to skip this transcript? It will not be processed.')) return;\n\n      const success = await krispService.skipTranscript(currentProps.transcript.id, 'Manually skipped');\n      \n      if (success) {\n        toast.success('Transcript skipped');\n        closeModal(MODAL_ID);\n        currentProps?.onAssign?.();\n      } else {\n        toast.error('Failed to skip transcript');\n      }\n    });\n  }\n\n  const assignBtn = container.querySelector('#assign-btn');\n  if (assignBtn) {\n    on(assignBtn as HTMLElement, 'click', async () => {\n      const selected = container.querySelector('.candidate-item.selected, .project-select') as HTMLElement;\n      let projectId: string | null = null;\n\n      // Check if a candidate is selected\n      const selectedCandidate = container.querySelector('.candidate-item.selected');\n      if (selectedCandidate) {\n        projectId = selectedCandidate.getAttribute('data-project-id');\n      } else {\n        // Check the dropdown\n        const selectEl = container.querySelector('.project-select') as HTMLSelectElement;\n        if (selectEl?.value) {\n          projectId = selectEl.value;\n        }\n      }\n\n      if (!projectId || !currentProps?.transcript) {\n        toast.error('Please select a project');\n        return;\n      }\n\n      (assignBtn as HTMLButtonElement).disabled = true;\n      assignBtn.textContent = 'Assigning...';\n\n      const success = await krispService.assignProject(currentProps.transcript.id, projectId);\n\n      if (success) {\n        toast.success('Transcript assigned to project');\n        closeModal(MODAL_ID);\n        currentProps?.onAssign?.();\n      } else {\n        toast.error('Failed to assign project');\n        (assignBtn as HTMLButtonElement).disabled = false;\n        assignBtn.textContent = 'Assign to Project';\n      }\n    });\n  }\n}\n\n/**\n * Load project options\n */\nasync function loadProjectOptions(container: HTMLElement, transcript: KrispTranscript): Promise<void> {\n  const contentEl = container.querySelector('#assignment-content');\n  if (!contentEl) return;\n\n  try {\n    // Load user's projects\n    const response = await http.get<{ projects: Project[] }>('/api/projects');\n    userProjects = response.data.projects || [];\n\n    // Get candidates from transcript\n    const candidates = transcript.project_candidates || [];\n\n    let html = '';\n\n    // Show candidates if available\n    if (candidates.length > 0) {\n      html += `\n        <div class=\"candidates-section\">\n          <h4>Suggested Projects (based on speakers)</h4>\n          <div class=\"candidate-list\">\n            ${candidates.map((c: ProjectCandidate) => `\n              <div class=\"candidate-item\" data-project-id=\"${c.projectId}\">\n                <div class=\"candidate-radio\"></div>\n                <div class=\"candidate-info\">\n                  <div class=\"candidate-name\">${escapeHtml(c.projectName || 'Unknown')}</div>\n                  <div class=\"candidate-code\">${escapeHtml(c.projectNumber || '')}</div>\n                </div>\n                <div class=\"candidate-confidence\">${Math.round(c.percentage * 100)}% match</div>\n              </div>\n            `).join('')}\n          </div>\n        </div>\n      `;\n    }\n\n    // Show project dropdown for other projects\n    html += `\n      <div class=\"project-select-section\">\n        <h4>${candidates.length > 0 ? 'Or select another project' : 'Select a project'}</h4>\n        <select class=\"project-select\">\n          <option value=\"\">Choose a project...</option>\n          ${userProjects.map(p => `\n            <option value=\"${p.id}\">${p.project_number ? `${p.project_number} - ` : ''}${escapeHtml(p.name)}</option>\n          `).join('')}\n        </select>\n      </div>\n    `;\n\n    contentEl.innerHTML = html;\n\n    // Bind candidate selection\n    contentEl.querySelectorAll('.candidate-item').forEach(item => {\n      on(item as HTMLElement, 'click', () => {\n        // Deselect all\n        contentEl.querySelectorAll('.candidate-item').forEach(i => i.classList.remove('selected'));\n        // Select this one\n        item.classList.add('selected');\n        // Clear dropdown\n        const select = contentEl.querySelector('.project-select') as HTMLSelectElement;\n        if (select) select.value = '';\n        // Enable assign button\n        const assignBtn = container.querySelector('#assign-btn') as HTMLButtonElement;\n        if (assignBtn) assignBtn.disabled = false;\n      });\n    });\n\n    // Bind dropdown change\n    const select = contentEl.querySelector('.project-select');\n    if (select) {\n      on(select as HTMLElement, 'change', () => {\n        // Deselect candidates\n        contentEl.querySelectorAll('.candidate-item').forEach(i => i.classList.remove('selected'));\n        // Enable/disable assign button\n        const assignBtn = container.querySelector('#assign-btn') as HTMLButtonElement;\n        if (assignBtn) {\n          assignBtn.disabled = !(select as HTMLSelectElement).value;\n        }\n      });\n    }\n\n  } catch (error) {\n    console.error('[ProjectAssignmentModal] Error loading projects:', error);\n    contentEl.innerHTML = '<p style=\"color: #dc2626;\">Failed to load projects. Please try again.</p>';\n  }\n}\n\n/**\n * Load and display meeting summary\n */\nasync function loadMeetingSummary(\n  container: HTMLElement, \n  transcript: KrispTranscript,\n  forceRegenerate = false\n): Promise<void> {\n  const summaryEl = container.querySelector('#meeting-summary');\n  if (!summaryEl) return;\n\n  // Show loading state\n  if (forceRegenerate) {\n    summaryEl.innerHTML = `\n      <div class=\"summary-loading\">\n        <div class=\"spinner\"></div>\n        <span>Regenerating summary...</span>\n      </div>\n    `;\n  }\n\n  try {\n    const summary = await krispService.generateSummary(transcript.id, { forceRegenerate });\n\n    if (!summary) {\n      summaryEl.innerHTML = `\n        <div class=\"summary-header\">\n          <svg fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"/>\n          </svg>\n          Meeting Summary\n          <button class=\"refresh-summary-btn\" title=\"Regenerate summary\">\n            <svg fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" width=\"16\" height=\"16\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"/>\n            </svg>\n          </button>\n        </div>\n        <p style=\"color: var(--text-secondary); font-size: 13px;\">Unable to generate summary.</p>\n      `;\n      bindRefreshButton(container, transcript);\n      return;\n    }\n\n    // Build summary HTML with refresh button\n    let html = `\n      <div class=\"summary-header\">\n        <svg fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n          <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"/>\n        </svg>\n        <span style=\"flex: 1;\">Meeting Summary</span>\n        <button class=\"refresh-summary-btn\" title=\"Regenerate summary\">\n          <svg fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" width=\"16\" height=\"16\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"/>\n          </svg>\n        </button>\n      </div>\n    `;\n\n    // Topic/main subject\n    if (summary.topic) {\n      html += `<div class=\"summary-topic\">${escapeHtml(summary.topic)}</div>`;\n    } else if (summary.notes) {\n      html += `<div class=\"summary-topic\">${escapeHtml(summary.notes)}</div>`;\n    }\n\n    // Key Points\n    if (summary.keyPoints && summary.keyPoints.length > 0) {\n      html += `\n        <div class=\"summary-section\">\n          <div class=\"summary-section-title\">Key Points</div>\n          <ul class=\"summary-list\">\n            ${summary.keyPoints.slice(0, 5).map(point => `<li>${escapeHtml(String(point))}</li>`).join('')}\n          </ul>\n        </div>\n      `;\n    }\n\n    // Action Items\n    if (summary.actionItems && summary.actionItems.length > 0) {\n      html += `\n        <div class=\"summary-section\">\n          <div class=\"summary-section-title\">Action Items</div>\n          <ul class=\"summary-list\">\n            ${summary.actionItems.slice(0, 5).map(item => `<li>${escapeHtml(String(item))}</li>`).join('')}\n          </ul>\n        </div>\n      `;\n    }\n\n    // Decisions\n    if (summary.decisions && summary.decisions.length > 0) {\n      html += `\n        <div class=\"summary-section\">\n          <div class=\"summary-section-title\">Decisions</div>\n          <ul class=\"summary-list\">\n            ${summary.decisions.slice(0, 3).map(dec => `<li>${escapeHtml(String(dec))}</li>`).join('')}\n          </ul>\n        </div>\n      `;\n    }\n\n    // Next Steps\n    if (summary.nextSteps) {\n      html += `\n        <div class=\"summary-section\">\n          <div class=\"summary-section-title\">Next Steps</div>\n          <p style=\"font-size: 13px; color: var(--text-secondary); margin: 0;\">${escapeHtml(summary.nextSteps)}</p>\n        </div>\n      `;\n    }\n\n    // Source indicator\n    const sourceLabels: Record<string, string> = {\n      'krisp_metadata': 'From Krisp',\n      'ai_generated': 'AI Generated',\n      'excerpt_fallback': 'Excerpt',\n      'no_content': ''\n    };\n    if (summary.source && sourceLabels[summary.source]) {\n      html += `<div class=\"summary-source\">${sourceLabels[summary.source]}</div>`;\n    }\n\n    summaryEl.innerHTML = html;\n    \n    // Bind refresh button\n    bindRefreshButton(container, transcript);\n\n  } catch (error) {\n    console.error('[ProjectAssignmentModal] Summary error:', error);\n    summaryEl.innerHTML = `\n      <div class=\"summary-header\">\n        <svg fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n          <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"/>\n        </svg>\n        <span style=\"flex: 1;\">Meeting Summary</span>\n        <button class=\"refresh-summary-btn\" title=\"Regenerate summary\">\n          <svg fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" width=\"16\" height=\"16\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"/>\n          </svg>\n        </button>\n      </div>\n      <p style=\"color: var(--text-secondary); font-size: 13px;\">Could not load summary.</p>\n    `;\n    bindRefreshButton(container, transcript);\n  }\n}\n\n/**\n * Bind refresh summary button\n */\nfunction bindRefreshButton(container: HTMLElement, transcript: KrispTranscript): void {\n  const btn = container.querySelector('.refresh-summary-btn');\n  if (btn) {\n    on(btn as HTMLElement, 'click', async (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      await loadMeetingSummary(container, transcript, true);\n      toast.success('Summary regenerated');\n    });\n  }\n}\n\n/**\n * Escape HTML\n */\nfunction escapeHtml(text: string): string {\n  const div = document.createElement('div');\n  div.textContent = text;\n  return div.innerHTML;\n}\n\n/**\n * Close the modal\n */\nexport function closeProjectAssignmentModal(): void {\n  closeModal(MODAL_ID);\n}\n"],"names":["MODAL_ID","currentProps","userProjects","showProjectAssignmentModal","props","transcript","existing","content","createElement","escapeHtml","modal","createModal","openModal","bindButtonEvents","loadMeetingSummary","loadProjectOptions","container","cancelBtn","on","closeModal","skipBtn","krispService.skipTranscript","toast","assignBtn","projectId","selectedCandidate","selectEl","krispService.assignProject","contentEl","http","candidates","html","c","p","item","i","select","error","forceRegenerate","summaryEl","summary","krispService.generateSummary","bindRefreshButton","point","dec","sourceLabels","btn","e","text","div"],"mappings":"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"}
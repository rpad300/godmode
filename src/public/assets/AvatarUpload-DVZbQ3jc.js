import{c as y,r as a,g as K,ao as D,b6 as _,j as e,a as n,N as E,a4 as q}from"./main-BKbBKYvC.js";import{U as Q}from"./upload-BtADKM1s.js";import{L as Y}from"./link-2-CWyrMbe7.js";const ee=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],xe=y("briefcase",ee);const te=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],ae=y("camera",te);const re=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],ge=y("image",re),se={md:{box:"w-16 h-16",text:"text-lg",icon:"w-4 h-4"},lg:{box:"w-24 h-24",text:"text-2xl",icon:"w-5 h-5"},xl:{box:"w-32 h-32",text:"text-3xl",icon:"w-6 h-6"}},M=["from-blue-500 to-indigo-600","from-emerald-500 to-teal-600","from-violet-500 to-purple-600","from-amber-500 to-orange-600","from-rose-500 to-pink-600"];function ie(o){let r=0;for(let i=0;i<o.length;i++)r=o.charCodeAt(i)+((r<<5)-r);return M[Math.abs(r)%M.length]}const ne="image/jpeg,image/png,image/gif,image/webp",oe=5*1024*1024;function ue({currentUrl:o,name:r="",onUpload:i,uploadEndpoint:x,deleteEndpoint:g,onUrlChange:u,onRemove:f,onUploaded:b,onRemoved:P,size:F="lg",showUrlInput:O=!0,className:V}){const[p,w]=a.useState(!1),[j,N]=a.useState(!1),[G,d]=a.useState(!1),[k,I]=a.useState(!1),[h,C]=a.useState(""),[B,c]=a.useState(!1),[T,l]=a.useState(null),v=a.useRef(null),m=se[F],z=K(r),S=T||(D(o)?o:null),U=S&&!B,H=!!(f||g),W=O&&!!u,L=a.useCallback(async t=>{if(!t.type.startsWith("image/")||t.size>oe)return;const s=URL.createObjectURL(t);l(s),c(!1),w(!0);try{if(i)await i(t);else if(x){const A=new FormData;A.append("file",t);const J=await _.upload(x,A);b?.(J.avatar_url)}}catch{l(null)}finally{w(!1),URL.revokeObjectURL(s)}},[i,x,b]),X=t=>{const s=t.target.files?.[0];s&&L(s),t.target.value=""},Z=t=>{t.preventDefault(),d(!1);const s=t.dataTransfer.files[0];s&&L(s)},R=()=>{h.trim()&&u&&(u(h.trim()),I(!1),C(""),c(!1),l(null))},$=async()=>{N(!0);try{f?await f():g&&(await _.delete(g),P?.()),l(null),c(!1)}finally{N(!1)}};return e.jsxs("div",{className:n("flex flex-col items-center gap-3",V),children:[e.jsxs("div",{className:n(m.box,"relative rounded-full overflow-hidden cursor-pointer group transition-all",G&&"ring-2 ring-[var(--gm-accent-primary)] ring-offset-2 ring-offset-[var(--gm-bg-primary)]","hover:ring-2 hover:ring-[var(--gm-accent-primary)]/40"),onDragOver:t=>{t.preventDefault(),d(!0)},onDragLeave:()=>d(!1),onDrop:Z,onClick:()=>v.current?.click(),children:[U?e.jsx("img",{src:S,alt:r,className:"w-full h-full object-cover",onError:()=>c(!0)}):e.jsx("div",{className:n("w-full h-full flex items-center justify-center bg-gradient-to-br",ie(r)),children:e.jsx("span",{className:n(m.text,"font-bold text-white"),children:z})}),e.jsx("div",{className:n("absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",p&&"opacity-100"),children:p?e.jsx(E,{className:n(m.icon,"text-white animate-spin")}):e.jsx(ae,{className:n(m.icon,"text-white")})})]}),e.jsx("input",{ref:v,type:"file",accept:ne,onChange:X,className:"hidden"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("button",{type:"button",onClick:()=>v.current?.click(),disabled:p,className:"flex items-center gap-1 px-2 py-1 rounded text-[10px] font-medium text-[var(--gm-text-secondary)] hover:text-[var(--gm-accent-primary)] hover:bg-[var(--gm-surface-hover)] transition-colors disabled:opacity-50",children:[e.jsx(Q,{className:"w-3 h-3"})," Upload"]}),W&&e.jsxs("button",{type:"button",onClick:()=>I(!k),className:"flex items-center gap-1 px-2 py-1 rounded text-[10px] font-medium text-[var(--gm-text-secondary)] hover:text-[var(--gm-accent-primary)] hover:bg-[var(--gm-surface-hover)] transition-colors",children:[e.jsx(Y,{className:"w-3 h-3"})," URL"]}),(U||D(o))&&H&&e.jsxs("button",{type:"button",onClick:$,disabled:j,className:"flex items-center gap-1 px-2 py-1 rounded text-[10px] font-medium text-[var(--color-danger-500)] hover:bg-[var(--color-danger-500)]/10 transition-colors disabled:opacity-50",children:[j?e.jsx(E,{className:"w-3 h-3 animate-spin"}):e.jsx(q,{className:"w-3 h-3"}),"Remove"]})]}),k&&e.jsxs("div",{className:"flex items-center gap-1.5 w-full max-w-xs",children:[e.jsx("input",{type:"url",value:h,onChange:t=>C(t.target.value),placeholder:"https://...",onKeyDown:t=>t.key==="Enter"&&R(),className:"flex-1 h-7 px-2 text-[10px] rounded border border-[var(--gm-border-primary)] bg-[var(--gm-bg-secondary)] text-[var(--gm-text-primary)] focus:outline-none focus:ring-1 focus:ring-[var(--gm-accent-primary)]"}),e.jsx("button",{type:"button",onClick:R,className:"h-7 px-2 rounded text-[10px] font-medium bg-[var(--gm-accent-primary)] text-white hover:opacity-90 transition-opacity",children:"Set"})]}),e.jsx("p",{className:"text-[9px] text-[var(--gm-text-tertiary)] text-center",children:"JPG, PNG, GIF or WebP Â· Max 5 MB"})]})}export{ue as A,xe as B,ge as I};
//# sourceMappingURL=AvatarUpload-DVZbQ3jc.js.map

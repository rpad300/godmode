const m={profiles:[],selectedProfile:null,teamAnalysis:null,relationships:[],graphData:null,loading:!1,analyzing:!1,error:null,currentSubtab:"profiles"};let s={...m};const p=new Set;function t(){p.forEach(e=>e(s))}function P(){return s}function F(e){return p.add(e),()=>p.delete(e)}function r(e){s={...s,loading:e},t()}function i(e){s={...s,analyzing:e},t()}function n(e){s={...s,error:e},t()}function y(e){s={...s,profiles:e},t()}function d(e){s={...s,selectedProfile:e},t()}function u(e){s={...s,teamAnalysis:e},t()}function h(e){s={...s,relationships:e},t()}function g(e){s={...s,graphData:e},t()}function z(e){s={...s,currentSubtab:e},t()}async function S(){r(!0),n(null);try{const a=await(await fetch("/api/team-analysis/profiles")).json();a.ok?y(a.profiles||[]):n(a.error||"Failed to load profiles")}catch(e){n(e.message||"Failed to load profiles")}finally{r(!1)}}async function b(e){r(!0),n(null);try{const o=await(await fetch(`/api/team-analysis/profiles/${e}`)).json();return o.ok&&o.profile?(d(o.profile),o.profile):(n(o.error||"Profile not found"),null)}catch(a){return n(a.message||"Failed to load profile"),null}finally{r(!1)}}async function j(e,a={}){i(!0),n(null);try{const l=await(await fetch(`/api/team-analysis/profiles/${e}/analyze`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json();if(l.ok&&l.profile){const f=s.profiles.map(c=>c.person_id===e?l.profile:c);return f.find(c=>c.person_id===e)||f.push(l.profile),y(f),d(l.profile),l.profile}else return n(l.error||"Failed to analyze profile"),null}catch(o){return n(o.message||"Failed to analyze profile"),null}finally{i(!1)}}async function T(){r(!0),n(null);try{console.log("[TeamAnalysisStore] Loading team analysis...");const a=await(await fetch("/api/team-analysis/team")).json();console.log("[TeamAnalysisStore] Team analysis response:",a),a.ok?(console.log("[TeamAnalysisStore] Setting team analysis:",a.analysis),u(a.analysis)):(console.error("[TeamAnalysisStore] Error:",a.error),n(a.error||"Failed to load team analysis"))}catch(e){console.error("[TeamAnalysisStore] Exception:",e),n(e.message||"Failed to load team analysis")}finally{r(!1)}}async function k(e=!1){i(!0),n(null);try{const o=await(await fetch("/api/team-analysis/team/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({forceReanalysis:e})})).json();return o.ok&&o.analysis?(u(o.analysis),o.analysis):(n(o.error||"Failed to analyze team"),null)}catch(a){return n(a.message||"Failed to analyze team"),null}finally{i(!1)}}async function w(){try{const a=await(await fetch("/api/team-analysis/relationships")).json();a.ok&&h(a.relationships||[])}catch(e){console.error("Failed to load relationships:",e)}}async function A(){try{console.log("[TeamAnalysisStore] Loading graph data...");const a=await(await fetch("/api/team-analysis/graph")).json();console.log("[TeamAnalysisStore] Graph data response:",a),a.ok&&(console.log("[TeamAnalysisStore] Setting graph data:",a.nodes?.length,"nodes,",a.edges?.length,"edges"),g({nodes:a.nodes||[],edges:a.edges||[]}))}catch(e){console.error("[TeamAnalysisStore] Failed to load graph data:",e)}}async function D(){await Promise.all([S(),T(),w(),A()])}function E(){s={...m},t()}const O={getState:P,subscribe:F,setLoading:r,setAnalyzing:i,setError:n,setProfiles:y,setSelectedProfile:d,setTeamAnalysis:u,setRelationships:h,setGraphData:g,setSubtab:z,loadProfiles:S,loadProfile:b,analyzeProfile:j,loadTeamAnalysis:T,analyzeTeam:k,loadRelationships:w,loadGraphData:A,loadAll:D,reset:E};export{j as analyzeProfile,k as analyzeTeam,P as getState,D as loadAll,A as loadGraphData,b as loadProfile,S as loadProfiles,w as loadRelationships,T as loadTeamAnalysis,E as reset,i as setAnalyzing,n as setError,g as setGraphData,r as setLoading,y as setProfiles,h as setRelationships,d as setSelectedProfile,z as setSubtab,u as setTeamAnalysis,F as subscribe,O as teamAnalysisStore};
//# sourceMappingURL=teamAnalysis-b6DZM1KK.js.map

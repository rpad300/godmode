{"version":3,"file":"TeamAnalysis-BKtZPBFt.js","sources":["../../frontend/components/TeamAnalysis.ts"],"sourcesContent":["/**\n * Team Analysis Component\n * Behavioral profiling and team dynamics analysis\n */\n\nimport { createElement, on } from '../utils/dom';\nimport { teamAnalysisStore, BehavioralProfile, TeamAnalysis as TeamAnalysisData } from '../stores/teamAnalysis';\nimport { toast } from '../services/toast';\nimport { http } from '../services/api';\n\n// Network visualization (vis.js)\ndeclare const vis: any;\n\nlet networkInstance: any = null;\n\n/**\n * Create Team Analysis component\n */\nexport function createTeamAnalysis(): HTMLElement {\n    const container = createElement('div', { className: 'team-analysis-panel' });\n\n    container.innerHTML = `\n        <style>\n            .team-analysis-panel {\n                padding: 24px;\n                min-height: 100%;\n            }\n\n            /* Profiles Grid */\n            .profiles-grid {\n                display: grid;\n                grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));\n                gap: 20px;\n                margin-top: 20px;\n            }\n\n            .profile-card {\n                background: var(--bg-secondary);\n                border: 1px solid var(--border-color);\n                border-radius: 16px;\n                padding: 20px;\n                cursor: pointer;\n                transition: all 0.2s;\n            }\n\n            .profile-card:hover {\n                border-color: var(--primary-color);\n                transform: translateY(-2px);\n                box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);\n            }\n\n            .profile-header {\n                display: flex;\n                align-items: flex-start;\n                gap: 16px;\n                margin-bottom: 16px;\n            }\n\n            .profile-avatar {\n                width: 56px;\n                height: 56px;\n                border-radius: 50%;\n                background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                color: white;\n                font-weight: 700;\n                font-size: 20px;\n                flex-shrink: 0;\n            }\n\n            .profile-info h3 {\n                margin: 0 0 4px;\n                font-size: 16px;\n                font-weight: 600;\n                color: var(--text-primary);\n            }\n\n            .profile-info .role {\n                font-size: 13px;\n                color: var(--text-secondary);\n                margin-bottom: 8px;\n            }\n\n            .profile-badges {\n                display: flex;\n                gap: 8px;\n                flex-wrap: wrap;\n            }\n\n            .badge {\n                padding: 4px 10px;\n                border-radius: 20px;\n                font-size: 11px;\n                font-weight: 600;\n                text-transform: uppercase;\n            }\n\n            .badge-confidence {\n                background: var(--bg-tertiary);\n                color: var(--text-secondary);\n            }\n\n            .badge-confidence.high, .badge-confidence.very_high {\n                background: rgba(39, 174, 96, 0.15);\n                color: #27ae60;\n            }\n\n            .badge-confidence.medium {\n                background: rgba(243, 156, 18, 0.15);\n                color: #f39c12;\n            }\n\n            .badge-confidence.low {\n                background: rgba(231, 76, 60, 0.15);\n                color: #e74c3c;\n            }\n\n            .profile-metrics {\n                display: grid;\n                grid-template-columns: repeat(3, 1fr);\n                gap: 12px;\n                padding-top: 16px;\n                border-top: 1px solid var(--border-color);\n            }\n\n            .metric {\n                text-align: center;\n            }\n\n            .metric-value {\n                font-size: 20px;\n                font-weight: 700;\n                color: var(--text-primary);\n            }\n\n            .metric-label {\n                font-size: 11px;\n                color: var(--text-tertiary);\n                text-transform: uppercase;\n            }\n\n            .profile-style {\n                margin-top: 12px;\n                padding: 12px;\n                background: var(--bg-tertiary);\n                border-radius: 10px;\n            }\n\n            .profile-style-label {\n                font-size: 11px;\n                color: var(--text-tertiary);\n                text-transform: uppercase;\n                margin-bottom: 4px;\n            }\n\n            .profile-style-value {\n                font-size: 13px;\n                color: var(--text-primary);\n            }\n\n            /* Profile Detail */\n            .profile-detail {\n                background: var(--bg-secondary);\n                border: 1px solid var(--border-color);\n                border-radius: 16px;\n                padding: 24px;\n            }\n\n            .profile-detail-header {\n                display: flex;\n                align-items: center;\n                justify-content: space-between;\n                margin-bottom: 24px;\n            }\n\n            .profile-detail-back {\n                display: flex;\n                align-items: center;\n                gap: 8px;\n                color: var(--text-secondary);\n                cursor: pointer;\n                font-size: 14px;\n            }\n\n            .profile-detail-back:hover {\n                color: var(--text-primary);\n            }\n\n            .profile-sections {\n                display: flex;\n                flex-direction: column;\n                gap: 24px;\n            }\n\n            .profile-section {\n                background: var(--bg-primary);\n                border-radius: 12px;\n                padding: 20px;\n            }\n\n            .profile-section h4 {\n                margin: 0 0 16px;\n                font-size: 14px;\n                font-weight: 600;\n                color: var(--text-primary);\n                display: flex;\n                align-items: center;\n                gap: 8px;\n            }\n\n            .profile-section h4 svg {\n                width: 18px;\n                height: 18px;\n                color: var(--primary-color);\n            }\n\n            .evidence-list {\n                margin-top: 12px;\n                display: flex;\n                flex-direction: column;\n                gap: 10px;\n            }\n\n            .evidence-item {\n                background: var(--bg-secondary);\n                border-radius: 8px;\n                padding: 12px;\n                font-size: 13px;\n            }\n\n            .evidence-quote {\n                color: var(--text-secondary);\n                font-style: italic;\n                border-left: 3px solid var(--primary-color);\n                padding-left: 12px;\n                margin-bottom: 8px;\n            }\n\n            .evidence-timestamp {\n                font-size: 11px;\n                color: var(--text-tertiary);\n            }\n\n            /* Team Dynamics */\n            .team-dynamics {\n                display: grid;\n                grid-template-columns: 1fr 1fr;\n                gap: 24px;\n            }\n\n            @media (max-width: 1200px) {\n                .team-dynamics {\n                    grid-template-columns: 1fr;\n                }\n            }\n\n            .dynamics-card {\n                background: var(--bg-secondary);\n                border: 1px solid var(--border-color);\n                border-radius: 16px;\n                padding: 20px;\n            }\n\n            .dynamics-card h3 {\n                margin: 0 0 16px;\n                font-size: 16px;\n                font-weight: 600;\n                display: flex;\n                align-items: center;\n                gap: 10px;\n            }\n\n            .dynamics-list {\n                display: flex;\n                flex-direction: column;\n                gap: 12px;\n            }\n\n            .dynamics-item {\n                display: flex;\n                align-items: center;\n                justify-content: space-between;\n                padding: 12px;\n                background: var(--bg-primary);\n                border-radius: 10px;\n            }\n\n            .dynamics-item-info {\n                display: flex;\n                align-items: center;\n                gap: 12px;\n            }\n\n            .dynamics-item-arrow {\n                color: var(--text-tertiary);\n            }\n\n            .strength-bar {\n                width: 80px;\n                height: 6px;\n                background: var(--bg-tertiary);\n                border-radius: 3px;\n                overflow: hidden;\n            }\n\n            .strength-fill {\n                height: 100%;\n                border-radius: 3px;\n                background: var(--primary-color);\n            }\n\n            /* Network Graph */\n            .network-graph-container {\n                height: 600px;\n                background: var(--bg-secondary);\n                border: 1px solid var(--border-color);\n                border-radius: 16px;\n                overflow: hidden;\n            }\n\n            .network-graph {\n                width: 100%;\n                height: 100%;\n            }\n\n            /* Loading & Empty States */\n            .loading-state, .empty-state {\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n                justify-content: center;\n                padding: 60px;\n                text-align: center;\n            }\n\n            .loading-spinner {\n                width: 48px;\n                height: 48px;\n                border: 4px solid var(--border-color);\n                border-top-color: var(--primary-color);\n                border-radius: 50%;\n                animation: spin 1s linear infinite;\n            }\n\n            @keyframes spin {\n                to { transform: rotate(360deg); }\n            }\n\n            .empty-state svg {\n                width: 64px;\n                height: 64px;\n                color: var(--text-tertiary);\n                margin-bottom: 16px;\n            }\n\n            .empty-state h3 {\n                margin: 0 0 8px;\n                color: var(--text-primary);\n            }\n\n            .empty-state p {\n                color: var(--text-secondary);\n                margin: 0;\n            }\n\n            /* Cohesion Gauge */\n            .cohesion-gauge {\n                display: flex;\n                align-items: center;\n                gap: 16px;\n                padding: 16px;\n                background: var(--bg-primary);\n                border-radius: 12px;\n                margin-bottom: 20px;\n            }\n\n            .cohesion-score {\n                font-size: 36px;\n                font-weight: 700;\n                color: var(--text-primary);\n            }\n\n            .cohesion-label {\n                font-size: 14px;\n                color: var(--text-secondary);\n            }\n\n            .tension-indicator {\n                padding: 6px 12px;\n                border-radius: 20px;\n                font-size: 12px;\n                font-weight: 600;\n            }\n\n            .tension-low {\n                background: rgba(39, 174, 96, 0.15);\n                color: #27ae60;\n            }\n\n            .tension-medium {\n                background: rgba(243, 156, 18, 0.15);\n                color: #f39c12;\n            }\n\n            .tension-high {\n                background: rgba(231, 76, 60, 0.15);\n                color: #e74c3c;\n            }\n        </style>\n\n        <div id=\"team-analysis-content\">\n            <div class=\"loading-state\">\n                <div class=\"loading-spinner\"></div>\n                <p style=\"margin-top: 16px; color: var(--text-secondary);\">Loading team analysis...</p>\n            </div>\n        </div>\n    `;\n\n    // Initialize\n    setTimeout(() => {\n        initTeamAnalysis(container);\n    }, 0);\n\n    return container;\n}\n\n/**\n * Initialize team analysis\n */\nasync function initTeamAnalysis(container: HTMLElement): Promise<void> {\n    // Subscribe to store changes\n    teamAnalysisStore.subscribe(state => {\n        renderContent(container, state);\n    });\n\n    // Load initial data\n    await teamAnalysisStore.loadAll();\n\n    // Setup event listeners\n    setupEventListeners(container);\n}\n\n/**\n * Setup event listeners\n */\nfunction setupEventListeners(container: HTMLElement): void {\n    // Subtab switching\n    document.querySelectorAll('#team-analysis-subtabs .subtab').forEach(btn => {\n        btn.addEventListener('click', (e) => {\n            const subtab = (e.target as HTMLElement).dataset.subtab as 'profiles' | 'team' | 'graph';\n            if (subtab) {\n                switchSubtab(subtab);\n            }\n        });\n    });\n\n    // Refresh button\n    document.getElementById('team-analysis-refresh-btn')?.addEventListener('click', async () => {\n        await teamAnalysisStore.loadAll();\n        toast.success('Data refreshed');\n    });\n\n    // Analyze team button\n    document.getElementById('team-analysis-analyze-btn')?.addEventListener('click', async () => {\n        // If on profiles tab, show contact selection modal\n        const state = teamAnalysisStore.getState();\n        if (state.currentSubtab === 'profiles') {\n            await showAnalyzeContactsModal();\n        } else {\n            // Team dynamics analysis for other tabs\n            toast.info('Analyzing team dynamics...');\n            await teamAnalysisStore.analyzeTeam(true);\n            toast.success('Team analysis complete');\n        }\n    });\n}\n\n/**\n * Show modal to select contacts for analysis\n */\nasync function showAnalyzeContactsModal(): Promise<void> {\n    // Create modal\n    const modal = document.createElement('div');\n    modal.className = 'modal-overlay';\n    modal.innerHTML = `\n        <div class=\"modal\" style=\"max-width: 600px; max-height: 80vh; display: flex; flex-direction: column;\">\n            <div class=\"modal-header\">\n                <h2>Analyze Team Members</h2>\n                <button class=\"modal-close\">&times;</button>\n            </div>\n            <div class=\"modal-body\" style=\"flex: 1; overflow-y: auto; padding: 20px;\">\n                <p style=\"color: var(--text-secondary); margin-bottom: 16px;\">\n                    Select team members to analyze. Members with existing profiles can be re-analyzed.\n                </p>\n                <div id=\"contacts-list-loading\" style=\"text-align: center; padding: 40px;\">\n                    <div class=\"loading-spinner\"></div>\n                    <p style=\"margin-top: 16px; color: var(--text-secondary);\">Loading contacts...</p>\n                </div>\n                <div id=\"contacts-list\" style=\"display: none;\"></div>\n            </div>\n            <div class=\"modal-footer\" style=\"display: flex; gap: 12px; justify-content: flex-end; padding: 16px 20px; border-top: 1px solid var(--border-color);\">\n                <button class=\"btn btn-secondary\" id=\"modal-cancel-btn\">Cancel</button>\n                <button class=\"btn btn-primary\" id=\"modal-analyze-selected-btn\" disabled>Analyze Selected (0)</button>\n            </div>\n        </div>\n    `;\n    document.body.appendChild(modal);\n\n    // Close handlers\n    const closeModal = () => modal.remove();\n    modal.querySelector('.modal-close')?.addEventListener('click', closeModal);\n    modal.querySelector('#modal-cancel-btn')?.addEventListener('click', closeModal);\n    modal.addEventListener('click', (e) => {\n        if (e.target === modal) closeModal();\n    });\n\n    // Load contacts\n    try {\n        const response = await http.get<{ contacts?: any[]; people?: any[] }>('/api/contacts');\n        const contacts = response.data?.contacts || response.data?.people || [];\n        \n        // Get existing profiles\n        const state = teamAnalysisStore.getState();\n        const existingProfileIds = new Set(state.profiles.map((p: any) => p.contact_id || p.person_id));\n\n        const loadingEl = modal.querySelector('#contacts-list-loading') as HTMLElement;\n        const listEl = modal.querySelector('#contacts-list') as HTMLElement;\n        \n        if (loadingEl) loadingEl.style.display = 'none';\n        if (listEl) listEl.style.display = 'block';\n\n        if (contacts.length === 0) {\n            listEl.innerHTML = `\n                <div style=\"text-align: center; padding: 40px; color: var(--text-tertiary);\">\n                    <p>No contacts found. Add contacts to the project first.</p>\n                </div>\n            `;\n            return;\n        }\n\n        // Sort: unanalyzed first, then by name\n        contacts.sort((a: any, b: any) => {\n            const aAnalyzed = existingProfileIds.has(a.id);\n            const bAnalyzed = existingProfileIds.has(b.id);\n            if (aAnalyzed !== bAnalyzed) return aAnalyzed ? 1 : -1;\n            return (a.name || '').localeCompare(b.name || '');\n        });\n\n        listEl.innerHTML = `\n            <div style=\"margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;\">\n                <span style=\"font-size: 13px; color: var(--text-secondary);\">\n                    ${contacts.length} contacts â€¢ ${existingProfileIds.size} analyzed\n                </span>\n                <button class=\"btn btn-sm btn-secondary\" id=\"select-unanalyzed-btn\" style=\"font-size: 12px; padding: 4px 10px;\">\n                    Select Unanalyzed\n                </button>\n            </div>\n            <div style=\"display: flex; flex-direction: column; gap: 8px;\">\n                ${contacts.map((c: any) => {\n                    const hasProfile = existingProfileIds.has(c.id);\n                    const initials = (c.name || 'U').split(' ').map((n: string) => n[0]).join('').substring(0, 2).toUpperCase();\n                    return `\n                        <label class=\"contact-item\" style=\"display: flex; align-items: center; gap: 12px; padding: 12px 16px; background: var(--bg-secondary); border-radius: 10px; cursor: pointer; transition: all 0.15s; border: 2px solid transparent;\" data-contact-id=\"${c.id}\">\n                            <input type=\"checkbox\" class=\"contact-checkbox\" data-id=\"${c.id}\" data-name=\"${c.name || 'Unknown'}\" style=\"width: 18px; height: 18px; accent-color: var(--primary-color);\">\n                            ${(c.avatar_url || c.photo_url)\n                                ? `<img src=\"${c.avatar_url || c.photo_url}\" alt=\"${c.name}\" style=\"width: 40px; height: 40px; border-radius: 50%; object-fit: cover;\">`\n                                : `<div style=\"width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 14px;\">${initials}</div>`\n                            }\n                            <div style=\"flex: 1;\">\n                                <div style=\"font-weight: 500; color: var(--text-primary);\">${c.name || 'Unknown'}</div>\n                                <div style=\"font-size: 12px; color: var(--text-secondary);\">${c.role || c.organization || 'No role'}</div>\n                            </div>\n                            ${hasProfile \n                                ? `<span style=\"font-size: 11px; padding: 4px 8px; background: var(--success-bg, rgba(39, 174, 96, 0.1)); color: var(--success, #27ae60); border-radius: 12px;\">Analyzed</span>`\n                                : `<span style=\"font-size: 11px; padding: 4px 8px; background: var(--warning-bg, rgba(243, 156, 18, 0.1)); color: var(--warning, #f39c12); border-radius: 12px;\">Not analyzed</span>`\n                            }\n                        </label>\n                    `;\n                }).join('')}\n            </div>\n        `;\n\n        // Checkbox handlers\n        const selectedIds = new Set<string>();\n        const updateButton = () => {\n            const btn = modal.querySelector('#modal-analyze-selected-btn') as HTMLButtonElement;\n            if (btn) {\n                btn.disabled = selectedIds.size === 0;\n                btn.textContent = `Analyze Selected (${selectedIds.size})`;\n            }\n        };\n\n        listEl.querySelectorAll('.contact-checkbox').forEach(checkbox => {\n            checkbox.addEventListener('change', (e) => {\n                const input = e.target as HTMLInputElement;\n                const id = input.dataset.id;\n                const label = input.closest('.contact-item') as HTMLElement;\n                if (id) {\n                    if (input.checked) {\n                        selectedIds.add(id);\n                        if (label) label.style.borderColor = 'var(--primary-color)';\n                    } else {\n                        selectedIds.delete(id);\n                        if (label) label.style.borderColor = 'transparent';\n                    }\n                    updateButton();\n                }\n            });\n        });\n\n        // Select unanalyzed button\n        modal.querySelector('#select-unanalyzed-btn')?.addEventListener('click', () => {\n            listEl.querySelectorAll('.contact-checkbox').forEach(checkbox => {\n                const input = checkbox as HTMLInputElement;\n                const id = input.dataset.id;\n                const label = input.closest('.contact-item') as HTMLElement;\n                if (id && !existingProfileIds.has(id)) {\n                    input.checked = true;\n                    selectedIds.add(id);\n                    if (label) label.style.borderColor = 'var(--primary-color)';\n                }\n            });\n            updateButton();\n        });\n\n        // Analyze selected button\n        modal.querySelector('#modal-analyze-selected-btn')?.addEventListener('click', async () => {\n            if (selectedIds.size === 0) return;\n            \n            const btn = modal.querySelector('#modal-analyze-selected-btn') as HTMLButtonElement;\n            const originalText = btn.textContent;\n            btn.disabled = true;\n            btn.textContent = 'Analyzing...';\n\n            let successCount = 0;\n            let errorCount = 0;\n\n            for (const id of selectedIds) {\n                const checkbox = listEl.querySelector(`.contact-checkbox[data-id=\"${id}\"]`) as HTMLInputElement;\n                const name = checkbox?.dataset.name || 'Contact';\n                \n                try {\n                    btn.textContent = `Analyzing ${name}...`;\n                    await teamAnalysisStore.analyzeProfile(id, { forceReanalysis: true });\n                    successCount++;\n                    \n                    // Mark as analyzed in the UI\n                    const label = checkbox?.closest('.contact-item') as HTMLElement;\n                    const badge = label?.querySelector('span:last-child');\n                    if (badge) {\n                        badge.style.background = 'var(--success-bg, rgba(39, 174, 96, 0.1))';\n                        badge.style.color = 'var(--success, #27ae60)';\n                        badge.textContent = 'Analyzed';\n                    }\n                } catch (error: any) {\n                    console.error(`Failed to analyze ${name}:`, error);\n                    errorCount++;\n                }\n            }\n\n            // Reload profiles\n            await teamAnalysisStore.loadProfiles();\n\n            if (successCount > 0) {\n                toast.success(`Successfully analyzed ${successCount} team member${successCount > 1 ? 's' : ''}`);\n            }\n            if (errorCount > 0) {\n                toast.error(`Failed to analyze ${errorCount} contact${errorCount > 1 ? 's' : ''}`);\n            }\n\n            closeModal();\n        });\n\n    } catch (error) {\n        const loadingEl = modal.querySelector('#contacts-list-loading');\n        if (loadingEl) {\n            loadingEl.innerHTML = `\n                <p style=\"color: var(--error);\">Failed to load contacts. Please try again.</p>\n            `;\n        }\n    }\n}\n\n/**\n * Switch subtab\n */\nasync function switchSubtab(subtab: 'profiles' | 'team' | 'graph'): Promise<void> {\n    // Update subtab buttons\n    document.querySelectorAll('#team-analysis-subtabs .subtab').forEach(btn => {\n        btn.classList.toggle('active', btn.getAttribute('data-subtab') === subtab);\n    });\n\n    // Load graph data BEFORE switching to graph tab to ensure data is available\n    if (subtab === 'graph') {\n        console.log('[TeamAnalysis] Loading graph data before switching tab...');\n        await teamAnalysisStore.loadGraphData();\n    }\n\n    // Now switch tab - this triggers re-render with the loaded data\n    teamAnalysisStore.setSubtab(subtab);\n}\n\n/**\n * Render content based on state\n */\nfunction renderContent(container: HTMLElement, state: any): void {\n    const contentEl = container.querySelector('#team-analysis-content');\n    if (!contentEl) return;\n\n    if (state.loading) {\n        contentEl.innerHTML = `\n            <div class=\"loading-state\">\n                <div class=\"loading-spinner\"></div>\n                <p style=\"margin-top: 16px; color: var(--text-secondary);\">Loading team analysis...</p>\n            </div>\n        `;\n        return;\n    }\n\n    if (state.analyzing) {\n        contentEl.innerHTML = `\n            <div class=\"loading-state\">\n                <div class=\"loading-spinner\"></div>\n                <p style=\"margin-top: 16px; color: var(--text-secondary);\">Analyzing... This may take a moment.</p>\n            </div>\n        `;\n        return;\n    }\n\n    // Render based on current subtab from store state\n    const currentSubtab = state.currentSubtab || 'profiles';\n    console.log('[TeamAnalysis] renderContent - currentSubtab:', currentSubtab);\n    \n    switch (currentSubtab) {\n        case 'profiles':\n            renderProfiles(contentEl, state);\n            break;\n        case 'team':\n            renderTeamDynamics(contentEl, state);\n            break;\n        case 'graph':\n            renderNetworkGraph(contentEl, state);\n            break;\n    }\n}\n\n/**\n * Render profiles grid\n */\nfunction renderProfiles(container: Element, state: any): void {\n    const { profiles, selectedProfile } = state;\n\n    if (selectedProfile) {\n        renderProfileDetail(container, selectedProfile);\n        return;\n    }\n\n    if (profiles.length === 0) {\n        container.innerHTML = `\n            <div class=\"empty-state\">\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                    <circle cx=\"12\" cy=\"5\" r=\"3\"/>\n                    <circle cx=\"5\" cy=\"19\" r=\"3\"/>\n                    <circle cx=\"19\" cy=\"19\" r=\"3\"/>\n                    <line x1=\"12\" y1=\"8\" x2=\"5\" y2=\"16\"/>\n                    <line x1=\"12\" y1=\"8\" x2=\"19\" y2=\"16\"/>\n                </svg>\n                <h3>No Profiles Yet</h3>\n                <p>Select a person to analyze, or process transcripts to build profiles automatically.</p>\n                <div id=\"people-list-container\" style=\"margin-top: 20px; width: 100%; max-width: 500px;\">\n                    <p style=\"color: var(--text-tertiary); font-size: 13px;\">Loading people...</p>\n                </div>\n            </div>\n        `;\n        \n        // Load people for manual analysis\n        loadPeopleForAnalysis(container);\n        return;\n    }\n\n    container.innerHTML = `\n        <div class=\"profiles-grid\">\n            ${profiles.map((p: BehavioralProfile) => renderProfileCard(p)).join('')}\n        </div>\n    `;\n\n    // Add click handlers\n    container.querySelectorAll('.profile-card').forEach(card => {\n        card.addEventListener('click', () => {\n            const personId = (card as HTMLElement).dataset.personId;\n            if (personId) {\n                teamAnalysisStore.loadProfile(personId);\n            }\n        });\n    });\n\n    // Add analyze buttons\n    container.querySelectorAll('.analyze-btn').forEach(btn => {\n        btn.addEventListener('click', async (e) => {\n            e.stopPropagation();\n            const personId = (btn as HTMLElement).dataset.personId;\n            if (personId) {\n                toast.info('Analyzing profile...');\n                await teamAnalysisStore.analyzeProfile(personId, { forceReanalysis: true });\n                toast.success('Profile analysis complete');\n            }\n        });\n    });\n}\n\n/**\n * Render a single profile card\n */\nfunction renderProfileCard(profile: BehavioralProfile): string {\n    const contact = (profile as any).contact || {};\n    const name = contact.name || 'Unknown';\n    const initials = name.split(' ').map((n: string) => n[0]).join('').substring(0, 2).toUpperCase();\n    const role = contact.role || contact.organization || 'No role';\n    const confidence = profile.confidence_level || 'low';\n    const avatarUrl = contact.avatar_url || contact.photo_url;\n    const contactId = (profile as any).contact_id || profile.person_id;\n\n    return `\n        <div class=\"profile-card\" data-person-id=\"${contactId}\">\n            <div class=\"profile-header\">\n                ${avatarUrl \n                    ? `<img class=\"profile-avatar\" src=\"${avatarUrl}\" alt=\"${name}\" style=\"width: 48px; height: 48px; border-radius: 50%; object-fit: cover;\" />`\n                    : `<div class=\"profile-avatar\">${initials}</div>`\n                }\n                <div class=\"profile-info\">\n                    <h3>${name}</h3>\n                    <div class=\"role\">${role}</div>\n                    <div class=\"profile-badges\">\n                        <span class=\"badge badge-confidence ${confidence}\">${confidence.replace('_', ' ')}</span>\n                    </div>\n                </div>\n            </div>\n            <div class=\"profile-metrics\">\n                <div class=\"metric\">\n                    <div class=\"metric-value\">${profile.influence_score || 0}</div>\n                    <div class=\"metric-label\">Influence</div>\n                </div>\n                <div class=\"metric\">\n                    <div class=\"metric-value\">${profile.transcript_count || 0}</div>\n                    <div class=\"metric-label\">Transcripts</div>\n                </div>\n                <div class=\"metric\">\n                    <div class=\"metric-value\">${profile.risk_tolerance || '-'}</div>\n                    <div class=\"metric-label\">Risk</div>\n                </div>\n            </div>\n            ${profile.communication_style ? `\n                <div class=\"profile-style\">\n                    <div class=\"profile-style-label\">Communication Style</div>\n                    <div class=\"profile-style-value\">${profile.communication_style}</div>\n                </div>\n            ` : ''}\n            <button class=\"btn btn-secondary analyze-btn\" data-person-id=\"${contactId}\" style=\"width: 100%; margin-top: 12px;\">\n                Re-analyze\n            </button>\n        </div>\n    `;\n}\n\n/**\n * Render profile detail view\n */\nfunction renderProfileDetail(container: Element, profile: BehavioralProfile): void {\n    const contact = (profile as any).contact || {};\n    const name = contact.name || 'Unknown';\n    const data = profile.profile_data || {};\n\n    container.innerHTML = `\n        <div class=\"profile-detail\">\n            <div class=\"profile-detail-header\">\n                <div class=\"profile-detail-back\" id=\"back-to-profiles\">\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                        <polyline points=\"15 18 9 12 15 6\"/>\n                    </svg>\n                    Back to Profiles\n                </div>\n                <h2>${name}</h2>\n            </div>\n\n            <div class=\"profile-sections\">\n                ${renderCommunicationSection(data)}\n                ${renderMotivationsSection(data)}\n                ${renderPressureSection(data)}\n                ${renderInfluenceSection(data)}\n                ${renderVulnerabilitiesSection(data)}\n                ${renderStrategySection(data)}\n                ${renderWarningSection(data)}\n                ${renderPowerSection(data)}\n            </div>\n        </div>\n    `;\n\n    // Back button handler\n    container.querySelector('#back-to-profiles')?.addEventListener('click', () => {\n        teamAnalysisStore.setSelectedProfile(null);\n    });\n}\n\n/**\n * Render communication identity section\n */\nfunction renderCommunicationSection(data: any): string {\n    const comm = data.communication_identity;\n    if (!comm) return '';\n\n    return `\n        <div class=\"profile-section\">\n            <h4>\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                    <path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\"/>\n                </svg>\n                Communication Identity\n            </h4>\n            <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;\">\n                ${comm.dominant_style ? `<div><strong>Style:</strong> ${comm.dominant_style}</div>` : ''}\n                ${comm.intervention_rhythm ? `<div><strong>Rhythm:</strong> ${comm.intervention_rhythm}</div>` : ''}\n                ${comm.textual_body_language ? `<div><strong>Textual Cues:</strong> ${comm.textual_body_language}</div>` : ''}\n            </div>\n            ${renderEvidenceList(comm.evidence)}\n        </div>\n    `;\n}\n\n/**\n * Render motivations section\n */\nfunction renderMotivationsSection(data: any): string {\n    const mot = data.motivations_and_priorities;\n    if (!mot) return '';\n\n    return `\n        <div class=\"profile-section\">\n            <h4>\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                    <polygon points=\"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2\"/>\n                </svg>\n                Motivations & Priorities\n            </h4>\n            ${mot.values_most?.length ? `<div><strong>Values most:</strong> ${mot.values_most.join(', ')}</div>` : ''}\n            ${mot.avoids?.length ? `<div style=\"margin-top: 8px;\"><strong>Avoids:</strong> ${mot.avoids.join(', ')}</div>` : ''}\n            <div style=\"margin-top: 8px; font-size: 12px; color: var(--text-tertiary);\">\n                Confidence: ${mot.confidence || 'Not specified'}\n            </div>\n        </div>\n    `;\n}\n\n/**\n * Render behavior under pressure section\n */\nfunction renderPressureSection(data: any): string {\n    const behaviors = data.behavior_under_pressure;\n    if (!behaviors?.length) return '';\n\n    return `\n        <div class=\"profile-section\">\n            <h4>\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                    <path d=\"M12 22a10 10 0 1 1 0-20 10 10 0 0 1 0 20z\"/>\n                    <path d=\"M12 6v6l4 2\"/>\n                </svg>\n                Behavior Under Pressure\n            </h4>\n            <div class=\"evidence-list\">\n                ${behaviors.map((b: any) => `\n                    <div class=\"evidence-item\">\n                        <strong>${b.situation}</strong>\n                        <p style=\"margin: 8px 0 0; color: var(--text-secondary);\">${b.observed_behavior}</p>\n                        ${b.quote ? `<div class=\"evidence-quote\">\"${b.quote}\"</div>` : ''}\n                        ${b.timestamp ? `<div class=\"evidence-timestamp\">${b.timestamp}</div>` : ''}\n                    </div>\n                `).join('')}\n            </div>\n        </div>\n    `;\n}\n\n/**\n * Render influence tactics section\n */\nfunction renderInfluenceSection(data: any): string {\n    const tactics = data.influence_tactics;\n    if (!tactics?.length) return '';\n\n    return `\n        <div class=\"profile-section\">\n            <h4>\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                    <path d=\"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2\"/>\n                    <circle cx=\"9\" cy=\"7\" r=\"4\"/>\n                    <path d=\"M23 21v-2a4 4 0 0 0-3-3.87\"/>\n                    <path d=\"M16 3.13a4 4 0 0 1 0 7.75\"/>\n                </svg>\n                Influence Tactics\n            </h4>\n            <div class=\"evidence-list\">\n                ${tactics.map((t: any) => `\n                    <div class=\"evidence-item\">\n                        <strong>${t.objective}</strong>\n                        <p style=\"margin: 8px 0 0; color: var(--text-secondary);\">${t.tactic}</p>\n                        ${t.example ? `<div class=\"evidence-quote\">${t.example}</div>` : ''}\n                    </div>\n                `).join('')}\n            </div>\n        </div>\n    `;\n}\n\n/**\n * Render vulnerabilities section\n */\nfunction renderVulnerabilitiesSection(data: any): string {\n    const vuln = data.vulnerabilities;\n    if (!vuln) return '';\n\n    const sections = [];\n\n    if (vuln.defense_triggers?.length) {\n        sections.push(`\n            <div style=\"margin-bottom: 16px;\">\n                <strong style=\"color: #e74c3c;\">Defense Triggers</strong>\n                <ul style=\"margin: 8px 0; padding-left: 20px;\">\n                    ${vuln.defense_triggers.map((t: any) => `<li>${t.trigger}</li>`).join('')}\n                </ul>\n            </div>\n        `);\n    }\n\n    if (vuln.blind_spots?.length) {\n        sections.push(`\n            <div style=\"margin-bottom: 16px;\">\n                <strong style=\"color: #f39c12;\">Blind Spots</strong>\n                <ul style=\"margin: 8px 0; padding-left: 20px;\">\n                    ${vuln.blind_spots.map((b: any) => `<li>${b.description}</li>`).join('')}\n                </ul>\n            </div>\n        `);\n    }\n\n    if (sections.length === 0) return '';\n\n    return `\n        <div class=\"profile-section\">\n            <h4>\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                    <path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"/>\n                    <line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\"/>\n                    <line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"/>\n                </svg>\n                Vulnerabilities & Friction Points\n            </h4>\n            ${sections.join('')}\n        </div>\n    `;\n}\n\n/**\n * Render interaction strategy section\n */\nfunction renderStrategySection(data: any): string {\n    const strat = data.interaction_strategy;\n    if (!strat) return '';\n\n    return `\n        <div class=\"profile-section\">\n            <h4>\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                    <path d=\"M12 20h9\"/>\n                    <path d=\"M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z\"/>\n                </svg>\n                Recommended Interaction Strategy\n            </h4>\n            ${strat.ideal_format ? `\n                <div style=\"margin-bottom: 12px;\">\n                    <strong>Ideal Format</strong>\n                    <div style=\"margin-top: 4px; color: var(--text-secondary);\">\n                        ${strat.ideal_format.channel ? `Channel: ${strat.ideal_format.channel}` : ''}\n                        ${strat.ideal_format.structure ? ` | Structure: ${strat.ideal_format.structure}` : ''}\n                        ${strat.ideal_format.timing ? ` | Timing: ${strat.ideal_format.timing}` : ''}\n                    </div>\n                </div>\n            ` : ''}\n            ${strat.framing_that_works?.length ? `\n                <div style=\"margin-bottom: 12px;\">\n                    <strong style=\"color: #27ae60;\">What Works</strong>\n                    <ul style=\"margin: 8px 0; padding-left: 20px;\">\n                        ${strat.framing_that_works.map((f: string) => `<li>${f}</li>`).join('')}\n                    </ul>\n                </div>\n            ` : ''}\n            ${strat.what_to_avoid?.length ? `\n                <div>\n                    <strong style=\"color: #e74c3c;\">What to Avoid</strong>\n                    <ul style=\"margin: 8px 0; padding-left: 20px;\">\n                        ${strat.what_to_avoid.map((a: string) => `<li>${a}</li>`).join('')}\n                    </ul>\n                </div>\n            ` : ''}\n        </div>\n    `;\n}\n\n/**\n * Render early warning signs section\n */\nfunction renderWarningSection(data: any): string {\n    const warnings = data.early_warning_signs;\n    if (!warnings?.length) return '';\n\n    return `\n        <div class=\"profile-section\">\n            <h4>\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                    <circle cx=\"12\" cy=\"12\" r=\"10\"/>\n                    <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"12\"/>\n                    <line x1=\"12\" y1=\"16\" x2=\"12.01\" y2=\"16\"/>\n                </svg>\n                Early Warning Signs\n            </h4>\n            <div class=\"evidence-list\">\n                ${warnings.map((w: any) => `\n                    <div class=\"evidence-item\">\n                        <strong>${w.signal}</strong>\n                        <p style=\"margin: 8px 0 0; color: var(--text-secondary);\">Indicates: ${w.indicates}</p>\n                    </div>\n                `).join('')}\n            </div>\n        </div>\n    `;\n}\n\n/**\n * Render power analysis section\n */\nfunction renderPowerSection(data: any): string {\n    const power = data.power_analysis;\n    if (!power?.length) return '';\n\n    return `\n        <div class=\"profile-section\">\n            <h4>\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                    <polygon points=\"13 2 3 14 12 14 11 22 21 10 12 10 13 2\"/>\n                </svg>\n                Power & Dependency Analysis\n            </h4>\n            <div class=\"evidence-list\">\n                ${power.map((p: any) => `\n                    <div class=\"evidence-item\">\n                        <strong>${p.factor}</strong>\n                        <p style=\"margin: 8px 0 0; color: var(--text-secondary);\">${p.assessment}</p>\n                        ${p.strategic_implication ? `<p style=\"margin: 8px 0 0; font-size: 12px; color: var(--primary-color);\">â†’ ${p.strategic_implication}</p>` : ''}\n                    </div>\n                `).join('')}\n            </div>\n        </div>\n    `;\n}\n\n/**\n * Render evidence list\n */\nfunction renderEvidenceList(evidence: any[]): string {\n    if (!evidence?.length) return '';\n\n    return `\n        <div class=\"evidence-list\">\n            ${evidence.map(e => `\n                <div class=\"evidence-item\">\n                    ${e.quote ? `<div class=\"evidence-quote\">\"${e.quote}\"</div>` : ''}\n                    ${e.observation ? `<p style=\"margin: 0; color: var(--text-secondary);\">${e.observation}</p>` : ''}\n                    ${e.timestamp ? `<div class=\"evidence-timestamp\">${e.timestamp}</div>` : ''}\n                </div>\n            `).join('')}\n        </div>\n    `;\n}\n\n/**\n * Render team dynamics view\n */\n/**\n * Build a name resolver that maps Person_N to real names\n */\nfunction buildNameResolver(profiles: any[]): (name: string) => { name: string; initials: string; role: string; avatarUrl?: string } {\n    const mapping: Record<string, { name: string; initials: string; role: string; avatarUrl?: string }> = {};\n    \n    // Map by Person_N pattern (index-based)\n    profiles.forEach((profile, index) => {\n        const contact = profile.contact || {};\n        const realName = contact.name || 'Unknown';\n        const initials = realName.split(' ').map((n: string) => n[0]).join('').substring(0, 2).toUpperCase();\n        const info = {\n            name: realName,\n            initials,\n            role: contact.role || contact.organization || '',\n            avatarUrl: contact.avatar_url || contact.photo_url\n        };\n        \n        // Map various patterns\n        mapping[`person_${index + 1}`] = info;\n        mapping[`person ${index + 1}`] = info;\n        mapping[`Person_${index + 1}`] = info;\n        mapping[`Person ${index + 1}`] = info;\n        mapping[realName.toLowerCase()] = info;\n        \n        // Also map by first name\n        const firstName = realName.split(' ')[0];\n        if (firstName) {\n            mapping[firstName.toLowerCase()] = info;\n        }\n    });\n    \n    return (name: string) => {\n        if (!name) return { name: 'Unknown', initials: '?', role: '' };\n        const normalized = name.toLowerCase().trim();\n        return mapping[normalized] || { \n            name: name.replace(/_/g, ' '), \n            initials: name.substring(0, 2).toUpperCase(), \n            role: '' \n        };\n    };\n}\n\n/**\n * Render a person chip with avatar and name\n */\nfunction renderPersonChip(personName: string, resolveName: (name: string) => any): string {\n    const info = resolveName(personName);\n    return `\n        <div class=\"person-chip\">\n            ${info.avatarUrl \n                ? `<img class=\"person-chip-avatar\" src=\"${info.avatarUrl}\" alt=\"${info.name}\" />`\n                : `<div class=\"person-chip-avatar person-chip-initials\">${info.initials}</div>`\n            }\n            <span class=\"person-chip-name\">${info.name}</span>\n        </div>\n    `;\n}\n\nfunction renderTeamDynamics(container: Element, state: any): void {\n    const { teamAnalysis, profiles } = state;\n\n    console.log('[TeamAnalysis] renderTeamDynamics called, teamAnalysis:', teamAnalysis);\n\n    if (!teamAnalysis) {\n        console.log('[TeamAnalysis] No teamAnalysis data, showing empty state');\n        container.innerHTML = `\n            <div class=\"empty-state\">\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                    <circle cx=\"12\" cy=\"5\" r=\"3\"/>\n                    <circle cx=\"5\" cy=\"19\" r=\"3\"/>\n                    <circle cx=\"19\" cy=\"19\" r=\"3\"/>\n                    <line x1=\"12\" y1=\"8\" x2=\"5\" y2=\"16\"/>\n                    <line x1=\"12\" y1=\"8\" x2=\"19\" y2=\"16\"/>\n                </svg>\n                <h3>No Team Analysis Yet</h3>\n                <p>Click \"Analyze Team\" to generate team dynamics analysis.</p>\n            </div>\n        `;\n        return;\n    }\n    \n    // Build name resolver from profiles\n    const resolveName = buildNameResolver(profiles || []);\n    \n    console.log('[TeamAnalysis] Rendering team dynamics with data:', {\n        cohesion: teamAnalysis.cohesion_score,\n        tension: teamAnalysis.tension_level,\n        teamSize: teamAnalysis.team_size,\n        influenceMapLength: teamAnalysis.influence_map?.length\n    });\n\n    const tensionClass = `tension-${teamAnalysis.tension_level || 'low'}`;\n    const cohesionColor = teamAnalysis.cohesion_score >= 70 ? '#27ae60' : \n                          teamAnalysis.cohesion_score >= 40 ? '#f39c12' : '#e74c3c';\n    \n    // Get additional analysis data\n    const analysisData = teamAnalysis.analysis_data || {};\n    const analysisDate = analysisData.analysis_date || teamAnalysis.last_analysis_at;\n    const recommendations = analysisData.recommendations || [];\n    const riskFactors = analysisData.risk_factors || [];\n    const commFlow = analysisData.communication_flow || {};\n    const dominantPattern = analysisData.dominant_communication_pattern || '';\n\n    container.innerHTML = `\n        <div class=\"team-dynamics-header\">\n            <div class=\"cohesion-card\">\n                <div class=\"cohesion-score-circle\" style=\"--score-color: ${cohesionColor}\">\n                    <span class=\"score-value\">${teamAnalysis.cohesion_score || 0}</span>\n                    <span class=\"score-label\">Cohesion</span>\n                </div>\n                <div class=\"cohesion-details\">\n                    <h3>Team Cohesion Score</h3>\n                    <span class=\"tension-badge ${tensionClass}\">\n                        ${teamAnalysis.tension_level || 'unknown'} tension\n                    </span>\n                </div>\n            </div>\n            <div class=\"team-size-card\">\n                <div class=\"team-size-value\">${teamAnalysis.team_size || 0}</div>\n                <div class=\"team-size-label\">Team Members</div>\n            </div>\n            <div class=\"analysis-meta-card\">\n                <div class=\"meta-icon\">ðŸ“Š</div>\n                <div class=\"meta-details\">\n                    <span class=\"meta-label\">Analysis Date</span>\n                    <span class=\"meta-value\">${analysisDate ? new Date(analysisDate).toLocaleDateString() : 'N/A'}</span>\n                </div>\n            </div>\n        </div>\n\n        ${dominantPattern ? `\n            <div class=\"executive-summary-section\">\n                <div class=\"summary-header\">\n                    <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                        <circle cx=\"12\" cy=\"12\" r=\"10\"/>\n                        <line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"12\"/>\n                        <line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\"/>\n                    </svg>\n                    <h3>Executive Summary</h3>\n                </div>\n                <p class=\"summary-text\">${replacePersonNames(dominantPattern, resolveName)}</p>\n            </div>\n        ` : ''}\n\n        ${renderInfluenceScoreboard(profiles || [], resolveName)}\n\n        ${renderCommunicationFlow(commFlow, resolveName)}\n\n        <div class=\"team-dynamics-grid\">\n            ${renderInfluenceMapV2(teamAnalysis.influence_map || [], resolveName)}\n            ${renderAlliancesV2(teamAnalysis.alliances || [], resolveName)}\n            ${renderTensionsV2(teamAnalysis.tensions || [], resolveName)}\n            ${renderPowerCentersV2(analysisData.power_centers || [], resolveName)}\n        </div>\n\n        ${renderRiskFactors(riskFactors)}\n        ${renderRecommendations(recommendations, resolveName)}\n    `;\n}\n\n/**\n * Render influence scoreboard - ranking of team members by influence\n */\nfunction renderInfluenceScoreboard(profiles: any[], resolveName: (name: string) => any): string {\n    if (!profiles?.length) return '';\n\n    // Sort profiles by influence score (descending)\n    const sortedProfiles = [...profiles]\n        .filter(p => p.influence_score !== undefined)\n        .sort((a, b) => (b.influence_score || 0) - (a.influence_score || 0));\n\n    if (sortedProfiles.length === 0) return '';\n\n    const maxScore = Math.max(...sortedProfiles.map(p => p.influence_score || 0), 100);\n\n    // Medal icons for top 3\n    const medals = ['ðŸ¥‡', 'ðŸ¥ˆ', 'ðŸ¥‰'];\n\n    return `\n        <div class=\"influence-scoreboard-section\">\n            <div class=\"scoreboard-header\">\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                    <path d=\"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z\"/>\n                </svg>\n                <h3>Influence Scoreboard</h3>\n                <span class=\"section-badge\" style=\"background: rgba(251, 191, 36, 0.15); color: #f59e0b;\">\n                    ${sortedProfiles.length} members ranked\n                </span>\n            </div>\n            <div class=\"scoreboard-list\">\n                ${sortedProfiles.map((profile, index) => {\n                    const contact = profile.contact || {};\n                    const name = contact.name || profile.person_name || 'Unknown';\n                    const role = contact.role || contact.organization || '';\n                    const avatarUrl = contact.avatar_url || contact.photo_url;\n                    const initials = name.split(' ').map((n: string) => n[0]).join('').substring(0, 2).toUpperCase();\n                    const score = profile.influence_score || 0;\n                    const barWidth = (score / maxScore) * 100;\n                    const rank = index + 1;\n                    const medal = medals[index] || '';\n                    const isTopThree = index < 3;\n                    \n                    // Risk indicator\n                    const riskLevel = profile.risk_tolerance || profile.risk_level || 'medium';\n                    const riskColors: Record<string, string> = {\n                        'low': '#10b981',\n                        'medium': '#f59e0b',\n                        'high': '#ef4444'\n                    };\n                    const riskColor = riskColors[riskLevel] || riskColors['medium'];\n                    \n                    // Communication style snippet\n                    const commStyle = profile.communication_style || profile.profile_data?.communication_identity?.dominant_style || '';\n                    const styleSnippet = commStyle.split(';')[0]?.substring(0, 50) || '';\n\n                    return `\n                        <div class=\"scoreboard-item ${isTopThree ? 'top-three' : ''}\">\n                            <div class=\"rank-badge ${isTopThree ? 'rank-' + rank : ''}\">\n                                ${medal || rank}\n                            </div>\n                            <div class=\"scoreboard-avatar\">\n                                ${avatarUrl \n                                    ? `<img src=\"${avatarUrl}\" alt=\"${name}\">`\n                                    : `<span class=\"avatar-initials\">${initials}</span>`\n                                }\n                            </div>\n                            <div class=\"scoreboard-info\">\n                                <div class=\"scoreboard-name\">${name}</div>\n                                <div class=\"scoreboard-role\">${role}</div>\n                                ${styleSnippet ? `<div class=\"scoreboard-style\">${styleSnippet}</div>` : ''}\n                            </div>\n                            <div class=\"scoreboard-metrics\">\n                                <div class=\"influence-meter\">\n                                    <div class=\"meter-label\">Influence</div>\n                                    <div class=\"meter-bar\">\n                                        <div class=\"meter-fill\" style=\"width: ${barWidth}%;\"></div>\n                                    </div>\n                                    <div class=\"meter-value\">${score}</div>\n                                </div>\n                                <div class=\"risk-indicator\" style=\"--risk-color: ${riskColor};\">\n                                    <span class=\"risk-dot\"></span>\n                                    <span class=\"risk-text\">${riskLevel} risk</span>\n                                </div>\n                            </div>\n                        </div>\n                    `;\n                }).join('')}\n            </div>\n        </div>\n    `;\n}\n\n/**\n * Render communication flow section\n */\nfunction renderCommunicationFlow(commFlow: any, resolveName: (name: string) => any): string {\n    if (!commFlow || (!commFlow.bottlenecks?.length && !commFlow.information_brokers?.length)) {\n        return '';\n    }\n\n    return `\n        <div class=\"communication-flow-section\">\n            <div class=\"flow-header\">\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                    <path d=\"M22 12h-4l-3 9L9 3l-3 9H2\"/>\n                </svg>\n                <h3>Communication Flow</h3>\n            </div>\n            <div class=\"flow-cards\">\n                ${commFlow.bottlenecks?.length ? `\n                    <div class=\"flow-card bottleneck-card\">\n                        <div class=\"flow-card-header\">\n                            <span class=\"flow-icon\">ðŸš§</span>\n                            <h4>Bottlenecks</h4>\n                        </div>\n                        <ul class=\"flow-list\">\n                            ${commFlow.bottlenecks.map((b: string) => `<li>${replacePersonNames(b, resolveName)}</li>`).join('')}\n                        </ul>\n                    </div>\n                ` : ''}\n                ${commFlow.information_brokers?.length ? `\n                    <div class=\"flow-card broker-card\">\n                        <div class=\"flow-card-header\">\n                            <span class=\"flow-icon\">ðŸ”—</span>\n                            <h4>Information Brokers</h4>\n                        </div>\n                        <div class=\"broker-chips\">\n                            ${commFlow.information_brokers.map((b: string) => renderPersonChip(b, resolveName)).join('')}\n                        </div>\n                        <p class=\"flow-hint\">Key connectors who bridge information across the team</p>\n                    </div>\n                ` : ''}\n                ${commFlow.central_nodes?.length ? `\n                    <div class=\"flow-card central-card\">\n                        <div class=\"flow-card-header\">\n                            <span class=\"flow-icon\">â­</span>\n                            <h4>Central Nodes</h4>\n                        </div>\n                        <div class=\"broker-chips\">\n                            ${commFlow.central_nodes.map((n: string) => renderPersonChip(n, resolveName)).join('')}\n                        </div>\n                        <p class=\"flow-hint\">Most connected team members</p>\n                    </div>\n                ` : ''}\n                ${commFlow.isolated_members?.length ? `\n                    <div class=\"flow-card isolated-card\">\n                        <div class=\"flow-card-header\">\n                            <span class=\"flow-icon\">ðŸï¸</span>\n                            <h4>Isolated Members</h4>\n                        </div>\n                        <div class=\"broker-chips\">\n                            ${commFlow.isolated_members.map((m: string) => renderPersonChip(m, resolveName)).join('')}\n                        </div>\n                        <p class=\"flow-hint\">Members with fewer connections - may need inclusion</p>\n                    </div>\n                ` : ''}\n            </div>\n        </div>\n    `;\n}\n\n/**\n * Replace Person_X names in text with real names\n */\nfunction replacePersonNames(text: string, resolveName: (name: string) => any): string {\n    return text.replace(/Person_(\\d+)/g, (match) => {\n        const resolved = resolveName(match);\n        return resolved.name || match;\n    });\n}\n\n/**\n * Render risk factors section\n */\nfunction renderRiskFactors(riskFactors: string[]): string {\n    if (!riskFactors?.length) return '';\n\n    return `\n        <div class=\"risk-factors-section\">\n            <div class=\"section-header\">\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                    <path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"/>\n                    <line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\"/>\n                    <line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"/>\n                </svg>\n                <h3>Risk Factors</h3>\n                <span class=\"section-badge risk-badge\">${riskFactors.length} identified</span>\n            </div>\n            <div class=\"risk-list\">\n                ${riskFactors.map((risk, i) => `\n                    <div class=\"risk-item\">\n                        <span class=\"risk-number\">${i + 1}</span>\n                        <p>${risk}</p>\n                    </div>\n                `).join('')}\n            </div>\n        </div>\n    `;\n}\n\n/**\n * Render recommendations section\n */\nfunction renderRecommendations(recommendations: string[], resolveName: (name: string) => any): string {\n    if (!recommendations?.length) return '';\n\n    return `\n        <div class=\"recommendations-section\">\n            <div class=\"section-header\">\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                    <path d=\"M9 11l3 3L22 4\"/>\n                    <path d=\"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11\"/>\n                </svg>\n                <h3>Recommendations</h3>\n                <span class=\"section-badge rec-badge\">${recommendations.length} actions</span>\n            </div>\n            <div class=\"recommendations-list\">\n                ${recommendations.map((rec, i) => `\n                    <div class=\"recommendation-item\">\n                        <div class=\"rec-icon\">\n                            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                                <circle cx=\"12\" cy=\"12\" r=\"10\"/>\n                                <path d=\"M12 16v-4\"/>\n                                <path d=\"M12 8h.01\"/>\n                            </svg>\n                        </div>\n                        <div class=\"rec-content\">\n                            <span class=\"rec-number\">Action ${i + 1}</span>\n                            <p>${replacePersonNames(rec, resolveName)}</p>\n                        </div>\n                    </div>\n                `).join('')}\n            </div>\n        </div>\n    `;\n}\n\n/**\n * Render influence map V2 with person chips\n */\nfunction renderInfluenceMapV2(influenceMap: any[], resolveName: (name: string) => any): string {\n    if (!influenceMap.length) return '';\n\n    // Type colors and icons\n    const typeConfig: Record<string, { color: string; bg: string; icon: string; desc: string }> = {\n        'direct': { color: '#3b82f6', bg: '#eff6ff', icon: 'â†’', desc: 'Direct influence through communication and decisions' },\n        'technical': { color: '#8b5cf6', bg: '#f5f3ff', icon: 'âš™', desc: 'Influence through technical expertise and knowledge' },\n        'political': { color: '#f59e0b', bg: '#fffbeb', icon: 'â™Ÿ', desc: 'Influence through organizational dynamics and alliances' },\n        'social': { color: '#10b981', bg: '#ecfdf5', icon: 'ðŸ¤', desc: 'Influence through relationships and social capital' },\n        'resource': { color: '#ef4444', bg: '#fef2f2', icon: 'ðŸ“Š', desc: 'Influence through control of resources' }\n    };\n\n    return `\n        <div class=\"dynamics-card\">\n            <div class=\"dynamics-card-header\">\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                    <path d=\"M22 11.08V12a10 10 0 1 1-5.93-9.14\"/>\n                    <polyline points=\"22 4 12 14.01 9 11.01\"/>\n                </svg>\n                <h3>Influence Map</h3>\n                <span class=\"dynamics-count\">${influenceMap.length} connections</span>\n            </div>\n            <div class=\"dynamics-list\">\n                ${influenceMap.slice(0, 10).map(inf => {\n                    const strengthPct = Math.round((inf.strength || 0.5) * 100);\n                    const strengthLabel = strengthPct >= 70 ? 'Strong' : strengthPct >= 40 ? 'Moderate' : 'Weak';\n                    const infType = (inf.influence_type || 'direct').toLowerCase();\n                    const config = typeConfig[infType] || typeConfig['direct'];\n                    const hasEvidence = inf.evidence && inf.evidence.length > 10;\n                    const itemId = `inf-${Math.random().toString(36).substr(2, 9)}`;\n                    \n                    return `\n                        <div class=\"dynamics-item influence-item expandable-item\" data-item-id=\"${itemId}\">\n                            <div class=\"influence-main-row\">\n                                <div class=\"influence-flow\">\n                                    ${renderPersonChip(inf.from_person, resolveName)}\n                                    <div class=\"influence-arrow\">\n                                        <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                                            <line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"/>\n                                            <polyline points=\"12 5 19 12 12 19\"/>\n                                        </svg>\n                                    </div>\n                                    ${renderPersonChip(inf.to_person, resolveName)}\n                                </div>\n                                <div class=\"influence-meta\">\n                                    <span class=\"type-badge\" style=\"background: ${config.bg}; color: ${config.color};\" title=\"${config.desc}\">\n                                        <span class=\"type-icon\">${config.icon}</span>\n                                        ${infType}\n                                    </span>\n                                </div>\n                                <div class=\"influence-strength-container\">\n                                    <div class=\"strength-value\">${strengthPct}%</div>\n                                    <div class=\"strength-bar-mini\">\n                                        <div class=\"strength-fill-mini\" style=\"width: ${strengthPct}%; background: ${config.color};\"></div>\n                                    </div>\n                                    <div class=\"strength-label\">${strengthLabel}</div>\n                                </div>\n                                ${hasEvidence ? `<button class=\"expand-btn\" onclick=\"this.closest('.expandable-item').classList.toggle('expanded')\" title=\"Show details\">\n                                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                                        <polyline points=\"6 9 12 15 18 9\"/>\n                                    </svg>\n                                </button>` : ''}\n                            </div>\n                            ${hasEvidence ? `\n                                <div class=\"item-details\">\n                                    <div class=\"evidence-text\">\n                                        <strong>Evidence:</strong> ${replacePersonNames(inf.evidence, resolveName)}\n                                    </div>\n                                </div>\n                            ` : ''}\n                        </div>\n                    `;\n                }).join('')}\n            </div>\n        </div>\n    `;\n}\n\n/**\n * Render alliances V2 with person chips\n */\nfunction renderAlliancesV2(alliances: any[], resolveName: (name: string) => any): string {\n    if (!alliances.length) return '';\n\n    // Alliance type colors\n    const typeConfig: Record<string, { color: string; bg: string; icon: string; desc: string }> = {\n        'natural': { color: '#10b981', bg: '#ecfdf5', icon: 'ðŸŒ±', desc: 'Organic alliance based on shared values and goals' },\n        'circumstantial': { color: '#6366f1', bg: '#eef2ff', icon: 'ðŸ”—', desc: 'Alliance formed due to shared circumstances or challenges' },\n        'strategic': { color: '#f59e0b', bg: '#fffbeb', icon: 'â™Ÿ', desc: 'Deliberate alliance for mutual benefit' },\n        'historical': { color: '#8b5cf6', bg: '#f5f3ff', icon: 'ðŸ“œ', desc: 'Long-standing alliance based on history' }\n    };\n\n    return `\n        <div class=\"dynamics-card alliance-card\">\n            <div class=\"dynamics-card-header\">\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                    <path d=\"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2\"/>\n                    <circle cx=\"9\" cy=\"7\" r=\"4\"/>\n                    <path d=\"M23 21v-2a4 4 0 0 0-3-3.87\"/>\n                    <path d=\"M16 3.13a4 4 0 0 1 0 7.75\"/>\n                </svg>\n                <h3>Alliances</h3>\n                <span class=\"dynamics-count\">${alliances.length} groups</span>\n            </div>\n            <div class=\"dynamics-list\">\n                ${alliances.map(all => {\n                    let members = all.members || [];\n                    if (typeof members === 'string') {\n                        members = members.split(/[\\s,]+/).filter((m: string) => m.trim());\n                    }\n                    const strengthPct = Math.round((all.strength || 0.5) * 100);\n                    const bondLabel = strengthPct >= 70 ? 'Strong bond' : strengthPct >= 40 ? 'Moderate bond' : 'Weak bond';\n                    const allianceType = (all.alliance_type || 'natural').toLowerCase();\n                    const config = typeConfig[allianceType] || typeConfig['natural'];\n                    const hasEvidence = all.evidence && all.evidence.length > 10;\n                    const hasSharedValues = all.shared_values && all.shared_values.length > 0;\n                    const itemId = `all-${Math.random().toString(36).substr(2, 9)}`;\n                    \n                    return `\n                        <div class=\"dynamics-item alliance-item expandable-item\" data-item-id=\"${itemId}\">\n                            <div class=\"alliance-main-row\">\n                                <div class=\"alliance-members\">\n                                    ${members.map((m: string) => renderPersonChip(m, resolveName)).join('<span class=\"alliance-connector\">&</span>')}\n                                </div>\n                                <div class=\"alliance-meta\">\n                                    <span class=\"type-badge\" style=\"background: ${config.bg}; color: ${config.color};\" title=\"${config.desc}\">\n                                        <span class=\"type-icon\">${config.icon}</span>\n                                        ${allianceType}\n                                    </span>\n                                </div>\n                                <div class=\"alliance-strength-container\">\n                                    <div class=\"strength-value alliance-value\">${strengthPct}%</div>\n                                    <div class=\"strength-bar-mini alliance-bar\">\n                                        <div class=\"strength-fill-mini\" style=\"width: ${strengthPct}%; background: ${config.color};\"></div>\n                                    </div>\n                                    <div class=\"strength-label\">${bondLabel}</div>\n                                </div>\n                                ${(hasEvidence || hasSharedValues) ? `<button class=\"expand-btn\" onclick=\"this.closest('.expandable-item').classList.toggle('expanded')\" title=\"Show details\">\n                                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                                        <polyline points=\"6 9 12 15 18 9\"/>\n                                    </svg>\n                                </button>` : ''}\n                            </div>\n                            ${(hasEvidence || hasSharedValues) ? `\n                                <div class=\"item-details\">\n                                    ${hasSharedValues ? `\n                                        <div class=\"shared-values\">\n                                            <strong>Shared Values:</strong>\n                                            <ul>${all.shared_values.map((v: string) => `<li>${v}</li>`).join('')}</ul>\n                                        </div>\n                                    ` : ''}\n                                    ${hasEvidence ? `\n                                        <div class=\"evidence-text\">\n                                            <strong>Evidence:</strong> ${replacePersonNames(all.evidence, resolveName)}\n                                        </div>\n                                    ` : ''}\n                                </div>\n                            ` : ''}\n                        </div>\n                    `;\n                }).join('')}\n            </div>\n        </div>\n    `;\n}\n\n/**\n * Render tensions V2 with person chips\n */\nfunction renderTensionsV2(tensions: any[], resolveName: (name: string) => any): string {\n    if (!tensions.length) return '';\n\n    // Tension type colors\n    const typeConfig: Record<string, { color: string; bg: string; icon: string; desc: string }> = {\n        'technical': { color: '#8b5cf6', bg: '#f5f3ff', icon: 'âš™', desc: 'Disagreements about technical approaches or solutions' },\n        'resource': { color: '#f59e0b', bg: '#fffbeb', icon: 'ðŸ“Š', desc: 'Competition for resources, time, or attention' },\n        'political': { color: '#ef4444', bg: '#fef2f2', icon: 'â™Ÿ', desc: 'Power dynamics and organizational influence conflicts' },\n        'communication': { color: '#3b82f6', bg: '#eff6ff', icon: 'ðŸ’¬', desc: 'Misunderstandings or communication style clashes' },\n        'values': { color: '#10b981', bg: '#ecfdf5', icon: 'âš–', desc: 'Differences in core values or priorities' }\n    };\n\n    // Level colors\n    const levelColors: Record<string, { color: string; bg: string }> = {\n        'high': { color: '#dc2626', bg: '#fef2f2' },\n        'medium': { color: '#f59e0b', bg: '#fffbeb' },\n        'low': { color: '#10b981', bg: '#ecfdf5' }\n    };\n\n    return `\n        <div class=\"dynamics-card tension-card\">\n            <div class=\"dynamics-card-header\">\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                    <path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"/>\n                    <line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\"/>\n                    <line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"/>\n                </svg>\n                <h3>Tensions</h3>\n                <span class=\"dynamics-count\">${tensions.length} identified</span>\n            </div>\n            <div class=\"dynamics-list\">\n                ${tensions.map(t => {\n                    let between = t.between || [];\n                    if (typeof between === 'string') {\n                        between = between.split(/[\\s,]+/).filter((m: string) => m.trim());\n                    }\n                    const level = (t.level || 'low').toLowerCase();\n                    const levelClass = `tension-level-${level}`;\n                    const levelConfig = levelColors[level] || levelColors['low'];\n                    const tensionType = (t.tension_type || 'communication').toLowerCase();\n                    const config = typeConfig[tensionType] || typeConfig['communication'];\n                    const hasEvidence = t.evidence && t.evidence.length > 10;\n                    const hasTriggers = t.triggers && t.triggers.length > 0;\n                    const itemId = `ten-${Math.random().toString(36).substr(2, 9)}`;\n                    \n                    return `\n                        <div class=\"dynamics-item tension-item expandable-item ${levelClass}\" data-item-id=\"${itemId}\">\n                            <div class=\"tension-main-row\">\n                                <div class=\"tension-parties\">\n                                    ${between.slice(0, 2).map((p: string) => renderPersonChip(p, resolveName)).join('<span class=\"tension-vs\">â†”</span>')}\n                                </div>\n                                <div class=\"tension-meta\">\n                                    <span class=\"type-badge\" style=\"background: ${config.bg}; color: ${config.color};\" title=\"${config.desc}\">\n                                        <span class=\"type-icon\">${config.icon}</span>\n                                        ${tensionType}\n                                    </span>\n                                </div>\n                                <span class=\"tension-badge\" style=\"background: ${levelConfig.bg}; color: ${levelConfig.color};\">${level}</span>\n                                ${(hasEvidence || hasTriggers) ? `<button class=\"expand-btn\" onclick=\"this.closest('.expandable-item').classList.toggle('expanded')\" title=\"Show details\">\n                                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                                        <polyline points=\"6 9 12 15 18 9\"/>\n                                    </svg>\n                                </button>` : ''}\n                            </div>\n                            ${(hasEvidence || hasTriggers) ? `\n                                <div class=\"item-details\">\n                                    ${hasTriggers ? `\n                                        <div class=\"triggers-list\">\n                                            <strong>Triggers:</strong>\n                                            <ul>${t.triggers.map((tr: string) => `<li>${tr}</li>`).join('')}</ul>\n                                        </div>\n                                    ` : ''}\n                                    ${hasEvidence ? `\n                                        <div class=\"evidence-text\">\n                                            <strong>Evidence:</strong> ${replacePersonNames(t.evidence, resolveName)}\n                                        </div>\n                                    ` : ''}\n                                </div>\n                            ` : ''}\n                        </div>\n                    `;\n                }).join('')}\n            </div>\n        </div>\n    `;\n}\n\n/**\n * Render power centers V2 with person chips\n */\nfunction renderPowerCentersV2(powerCenters: any[], resolveName: (name: string) => any): string {\n    if (!powerCenters.length) return '';\n\n    // Power type configuration\n    const typeConfig: Record<string, { color: string; bg: string; icon: string; desc: string }> = {\n        'technical': { color: '#8b5cf6', bg: '#f5f3ff', icon: 'âš™', desc: 'Power through technical expertise and knowledge' },\n        'formal': { color: '#3b82f6', bg: '#eff6ff', icon: 'ðŸ‘”', desc: 'Power through official role and authority' },\n        'informal': { color: '#f59e0b', bg: '#fffbeb', icon: 'ðŸ’¬', desc: 'Power through relationships and influence' },\n        'social': { color: '#10b981', bg: '#ecfdf5', icon: 'ðŸ¤', desc: 'Power through social connections and trust' },\n        'resource': { color: '#ef4444', bg: '#fef2f2', icon: 'ðŸ“Š', desc: 'Power through control of resources' }\n    };\n\n    return `\n        <div class=\"dynamics-card power-card\">\n            <div class=\"dynamics-card-header\">\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                    <polygon points=\"13 2 3 14 12 14 11 22 21 10 12 10 13 2\"/>\n                </svg>\n                <h3>Power Centers</h3>\n                <span class=\"dynamics-count\">${powerCenters.length} key players</span>\n            </div>\n            <div class=\"dynamics-list\">\n                ${powerCenters.map(pc => {\n                    const reachPct = Math.round(pc.influence_reach || 50);\n                    const powerType = (pc.power_type || 'informal').toLowerCase();\n                    const config = typeConfig[powerType] || typeConfig['informal'];\n                    const hasDependencies = pc.dependencies && pc.dependencies.length > 0;\n                    const itemId = `pow-${Math.random().toString(36).substr(2, 9)}`;\n                    \n                    return `\n                        <div class=\"dynamics-item power-item expandable-item\" data-item-id=\"${itemId}\">\n                            <div class=\"power-main-row\">\n                                <div class=\"power-person\">\n                                    ${renderPersonChip(pc.person, resolveName)}\n                                </div>\n                                <div class=\"power-details\">\n                                    <span class=\"type-badge\" style=\"background: ${config.bg}; color: ${config.color};\" title=\"${config.desc}\">\n                                        <span class=\"type-icon\">${config.icon}</span>\n                                        ${powerType}\n                                    </span>\n                                </div>\n                                <div class=\"power-reach-container\">\n                                    <div class=\"strength-value power-value\">${reachPct}%</div>\n                                    <div class=\"strength-bar-mini power-bar\">\n                                        <div class=\"strength-fill-mini\" style=\"width: ${reachPct}%; background: ${config.color};\"></div>\n                                    </div>\n                                    <div class=\"strength-label\">reach</div>\n                                </div>\n                                ${hasDependencies ? `<button class=\"expand-btn\" onclick=\"this.closest('.expandable-item').classList.toggle('expanded')\" title=\"Show details\">\n                                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                                        <polyline points=\"6 9 12 15 18 9\"/>\n                                    </svg>\n                                </button>` : ''}\n                            </div>\n                            ${hasDependencies ? `\n                                <div class=\"item-details\">\n                                    <div class=\"dependencies-list\">\n                                        <strong>Power Sources:</strong>\n                                        <ul>${pc.dependencies.map((d: string) => `<li>${d}</li>`).join('')}</ul>\n                                    </div>\n                                </div>\n                            ` : ''}\n                        </div>\n                    `;\n                }).join('')}\n            </div>\n        </div>\n    `;\n}\n\n/**\n * Render network graph\n */\nfunction renderNetworkGraph(container: Element, state: any): void {\n    const { graphData, profiles } = state;\n\n    console.log('[TeamAnalysis] renderNetworkGraph called, graphData:', graphData);\n\n    if (!graphData || !graphData.nodes || !graphData.nodes.length) {\n        console.log('[TeamAnalysis] No graph data, showing empty state');\n        container.innerHTML = `\n            <div class=\"empty-state\">\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                    <circle cx=\"12\" cy=\"12\" r=\"3\"/>\n                    <circle cx=\"19\" cy=\"5\" r=\"2\"/>\n                    <circle cx=\"5\" cy=\"19\" r=\"2\"/>\n                    <line x1=\"14.5\" y1=\"9.5\" x2=\"17.5\" y2=\"6.5\"/>\n                    <line x1=\"9.5\" y1=\"14.5\" x2=\"6.5\" y2=\"17.5\"/>\n                </svg>\n                <h3>No Network Data</h3>\n                <p>Analyze profiles to build the team network graph.</p>\n            </div>\n        `;\n        return;\n    }\n\n    // Build profile lookup for enriched node data\n    const profileLookup: Record<string, any> = {};\n    (profiles || []).forEach((p: any) => {\n        const id = p.contact_id || p.person_id;\n        if (id) profileLookup[id] = p;\n    });\n    \n    console.log('[TeamAnalysis] Rendering network graph with', graphData.nodes.length, 'nodes and', graphData.edges?.length || 0, 'edges');\n\n    container.innerHTML = `\n        <div class=\"network-graph-wrapper\">\n            <div class=\"network-legend\">\n                <div class=\"legend-item\">\n                    <span class=\"legend-line legend-influences\"></span>\n                    <span>Influences</span>\n                </div>\n                <div class=\"legend-item\">\n                    <span class=\"legend-line legend-alliance\"></span>\n                    <span>Alliance</span>\n                </div>\n                <div class=\"legend-item\">\n                    <span class=\"legend-line legend-tension\"></span>\n                    <span>Tension</span>\n                </div>\n            </div>\n            <div class=\"network-graph-container\">\n                <div id=\"team-network-graph\" class=\"network-graph\"></div>\n            </div>\n            <div class=\"network-info-panel\" id=\"network-info-panel\">\n                <div class=\"info-panel-placeholder\">\n                    <p>Click on a person to see details</p>\n                </div>\n            </div>\n        </div>\n    `;\n\n    // Initialize vis.js network with enhanced styling\n    setTimeout(() => {\n        initializeNetwork(graphData, profileLookup);\n    }, 100);\n}\n\n/**\n * Generate initials from a name\n */\nfunction getInitials(name: string): string {\n    return name.split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase();\n}\n\n/**\n * Generate a color based on a string (for consistent avatar colors)\n */\nfunction stringToColor(str: string): string {\n    const colors = ['#9b59b6', '#3498db', '#e74c3c', '#27ae60', '#f39c12', '#1abc9c', '#e67e22', '#34495e'];\n    let hash = 0;\n    for (let i = 0; i < str.length; i++) {\n        hash = str.charCodeAt(i) + ((hash << 5) - hash);\n    }\n    return colors[Math.abs(hash) % colors.length];\n}\n\n/**\n * Create SVG data URL for avatar node\n */\nfunction createAvatarSvg(name: string, avatarUrl?: string, role?: string, influenceScore?: number): string {\n    const initials = getInitials(name);\n    const bgColor = stringToColor(name);\n    const size = 80;\n    \n    // If there's an avatar URL, we'll use circularImage shape instead\n    if (avatarUrl) {\n        return avatarUrl;\n    }\n    \n    // Create SVG with initials\n    const svg = `\n        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${size}\" height=\"${size}\" viewBox=\"0 0 ${size} ${size}\">\n            <defs>\n                <linearGradient id=\"grad-${initials}\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n                    <stop offset=\"0%\" style=\"stop-color:${bgColor};stop-opacity:1\" />\n                    <stop offset=\"100%\" style=\"stop-color:${adjustColor(bgColor, -30)};stop-opacity:1\" />\n                </linearGradient>\n            </defs>\n            <circle cx=\"${size/2}\" cy=\"${size/2}\" r=\"${size/2 - 2}\" fill=\"url(#grad-${initials})\" stroke=\"white\" stroke-width=\"3\"/>\n            <text x=\"${size/2}\" y=\"${size/2 + 8}\" font-family=\"Arial, sans-serif\" font-size=\"24\" font-weight=\"bold\" fill=\"white\" text-anchor=\"middle\">${initials}</text>\n        </svg>\n    `;\n    \n    return 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent(svg);\n}\n\n/**\n * Adjust color brightness\n */\nfunction adjustColor(color: string, amount: number): string {\n    const clamp = (num: number) => Math.min(255, Math.max(0, num));\n    const hex = color.replace('#', '');\n    const r = clamp(parseInt(hex.substring(0, 2), 16) + amount);\n    const g = clamp(parseInt(hex.substring(2, 4), 16) + amount);\n    const b = clamp(parseInt(hex.substring(4, 6), 16) + amount);\n    return `#${r.toString(16).padStart(2, '0')}${g.toString(16).padStart(2, '0')}${b.toString(16).padStart(2, '0')}`;\n}\n\n/**\n * Get edge color based on relationship type\n */\nfunction getEdgeStyle(edgeType: string): { color: string; dashes: boolean; width: number } {\n    switch (edgeType) {\n        case 'influences':\n            return { color: '#3498db', dashes: false, width: 2 };\n        case 'aligned_with':\n            return { color: '#27ae60', dashes: false, width: 3 };\n        case 'tension_with':\n            return { color: '#e74c3c', dashes: [5, 5] as any, width: 2 };\n        default:\n            return { color: '#95a5a6', dashes: false, width: 1 };\n    }\n}\n\n/**\n * Initialize vis.js network visualization with avatars\n */\nfunction initializeNetwork(graphData: { nodes: any[]; edges: any[] }, profileLookup: Record<string, any>): void {\n    console.log('[TeamAnalysis] initializeNetwork called with', graphData.nodes?.length, 'nodes,', graphData.edges?.length, 'edges');\n    \n    const container = document.getElementById('team-network-graph');\n    if (!container) {\n        console.error('[TeamAnalysis] Network container not found!');\n        return;\n    }\n\n    // Destroy existing network\n    if (networkInstance) {\n        console.log('[TeamAnalysis] Destroying existing network instance');\n        networkInstance.destroy();\n        networkInstance = null;\n    }\n\n    // Check if vis.js is available\n    if (typeof vis === 'undefined') {\n        console.error('[TeamAnalysis] vis.js library not loaded!');\n        container.innerHTML = `\n            <div style=\"display: flex; align-items: center; justify-content: center; height: 100%; color: var(--text-secondary);\">\n                Network visualization library not loaded\n            </div>\n        `;\n        return;\n    }\n    \n    console.log('[TeamAnalysis] vis.js is available, creating network...');\n\n    // Create enhanced nodes with avatars\n    const nodes = new vis.DataSet(graphData.nodes.map(n => {\n        const profile = profileLookup[n.id] || {};\n        const contact = profile.contact || {};\n        const name = n.label || contact.name || 'Unknown';\n        const avatarUrl = contact.avatar_url || contact.photo_url;\n        const role = contact.role || n.properties?.role || '';\n        const influenceScore = profile.influence_score || n.properties?.influenceScore || 50;\n        \n        // Base size on influence score\n        const nodeSize = 30 + (influenceScore / 10);\n        \n        return {\n            id: n.id,\n            label: name,\n            shape: avatarUrl ? 'circularImage' : 'image',\n            image: createAvatarSvg(name, avatarUrl, role, influenceScore),\n            size: nodeSize,\n            borderWidth: 3,\n            borderWidthSelected: 5,\n            color: {\n                border: stringToColor(name),\n                highlight: {\n                    border: '#f39c12'\n                },\n                hover: {\n                    border: '#f39c12'\n                }\n            },\n            font: {\n                size: 14,\n                color: 'var(--color-text)',\n                face: 'Arial',\n                strokeWidth: 3,\n                strokeColor: 'var(--color-surface)'\n            },\n            // Store extra data for click handler\n            _profile: profile,\n            _role: role,\n            _influenceScore: influenceScore\n        };\n    }));\n\n    // Create styled edges\n    const edges = new vis.DataSet(graphData.edges.map(e => {\n        const style = getEdgeStyle(e.label || e.relationship_type);\n        return {\n            from: e.from,\n            to: e.to,\n            label: '',\n            width: style.width,\n            dashes: style.dashes,\n            color: {\n                color: style.color,\n                highlight: style.color,\n                hover: style.color,\n                opacity: 0.8\n            },\n            arrows: e.label === 'influences' ? { to: { enabled: true, scaleFactor: 0.8 } } : undefined,\n            smooth: {\n                type: 'curvedCW',\n                roundness: 0.2\n            },\n            title: formatEdgeLabel(e.label)\n        };\n    }));\n\n    const options = {\n        nodes: {\n            shapeProperties: {\n                useBorderWithImage: true,\n                interpolation: false\n            },\n            shadow: {\n                enabled: true,\n                color: 'rgba(0,0,0,0.2)',\n                size: 10,\n                x: 3,\n                y: 3\n            }\n        },\n        edges: {\n            font: {\n                size: 11,\n                align: 'middle',\n                color: 'var(--text-secondary)'\n            },\n            smooth: {\n                type: 'curvedCW',\n                roundness: 0.2\n            },\n            hoverWidth: 2,\n            selectionWidth: 3\n        },\n        physics: {\n            enabled: true,\n            stabilization: {\n                enabled: true,\n                iterations: 200\n            },\n            barnesHut: {\n                gravitationalConstant: -3000,\n                springLength: 200,\n                springConstant: 0.04,\n                damping: 0.3\n            }\n        },\n        interaction: {\n            hover: true,\n            tooltipDelay: 100,\n            navigationButtons: true,\n            keyboard: true,\n            zoomView: true\n        },\n        layout: {\n            improvedLayout: true\n        }\n    };\n\n    networkInstance = new vis.Network(container, { nodes, edges }, options);\n    \n    // Handle node click to show details\n    networkInstance.on('click', (params: any) => {\n        if (params.nodes.length > 0) {\n            const nodeId = params.nodes[0];\n            const nodeData = nodes.get(nodeId);\n            showNodeDetails(nodeData, profileLookup[nodeId]);\n        } else {\n            hideNodeDetails();\n        }\n    });\n    \n    // Handle hover for cursor change\n    networkInstance.on('hoverNode', () => {\n        container.style.cursor = 'pointer';\n    });\n    \n    networkInstance.on('blurNode', () => {\n        container.style.cursor = 'default';\n    });\n}\n\n/**\n * Format edge label for tooltip\n */\nfunction formatEdgeLabel(label: string): string {\n    const labels: Record<string, string> = {\n        'influences': 'â†’ Influences',\n        'aligned_with': 'ðŸ¤ Alliance',\n        'tension_with': 'âš¡ Tension'\n    };\n    return labels[label] || label;\n}\n\n/**\n * Show node details in side panel\n */\nfunction showNodeDetails(nodeData: any, profile: any): void {\n    const panel = document.getElementById('network-info-panel');\n    if (!panel) return;\n    \n    const contact = profile?.contact || {};\n    const name = nodeData.label || 'Unknown';\n    const role = contact.role || nodeData._role || '';\n    const org = contact.organization || '';\n    const influenceScore = profile?.influence_score || nodeData._influenceScore || 0;\n    const commStyle = profile?.communication_style || 'Unknown';\n    const motivation = profile?.dominant_motivation || 'Unknown';\n    const initials = getInitials(name);\n    const avatarUrl = contact.avatar_url || contact.photo_url;\n    \n    panel.innerHTML = `\n        <div class=\"node-detail-card\">\n            <div class=\"node-detail-header\">\n                ${avatarUrl \n                    ? `<img class=\"node-avatar\" src=\"${avatarUrl}\" alt=\"${name}\" />`\n                    : `<div class=\"node-avatar node-initials\" style=\"background: ${stringToColor(name)}\">${initials}</div>`\n                }\n                <div class=\"node-info\">\n                    <h3>${name}</h3>\n                    ${role ? `<p class=\"node-role\">${role}</p>` : ''}\n                    ${org ? `<p class=\"node-org\">${org}</p>` : ''}\n                </div>\n            </div>\n            <div class=\"node-metrics\">\n                <div class=\"node-metric\">\n                    <span class=\"metric-label\">Influence</span>\n                    <div class=\"metric-bar\">\n                        <div class=\"metric-fill\" style=\"width: ${influenceScore}%; background: #9b59b6;\"></div>\n                    </div>\n                    <span class=\"metric-value\">${influenceScore}%</span>\n                </div>\n            </div>\n            <div class=\"node-traits\">\n                <div class=\"trait-item\">\n                    <span class=\"trait-label\">Communication</span>\n                    <span class=\"trait-value\">${commStyle}</span>\n                </div>\n                <div class=\"trait-item\">\n                    <span class=\"trait-label\">Motivation</span>\n                    <span class=\"trait-value\">${motivation}</span>\n                </div>\n            </div>\n        </div>\n    `;\n}\n\n/**\n * Hide node details panel\n */\nfunction hideNodeDetails(): void {\n    const panel = document.getElementById('network-info-panel');\n    if (!panel) return;\n    \n    panel.innerHTML = `\n        <div class=\"info-panel-placeholder\">\n            <p>Click on a person to see details</p>\n        </div>\n    `;\n}\n\n/**\n * Load people available for analysis (when no profiles exist yet)\n */\nasync function loadPeopleForAnalysis(container: Element): Promise<void> {\n    const listContainer = container.querySelector('#people-list-container');\n    if (!listContainer) return;\n\n    try {\n        // Fetch people from contacts/people endpoint\n        const response = await http.get<{ contacts?: any[]; people?: any[] }>('/api/contacts');\n        const people = response.data?.contacts || response.data?.people || [];\n        \n        if (people.length === 0) {\n            listContainer.innerHTML = `\n                <p style=\"color: var(--text-tertiary); font-size: 13px;\">\n                    No people found. Process some transcripts first to extract participants.\n                </p>\n            `;\n            return;\n        }\n\n        listContainer.innerHTML = `\n            <div style=\"text-align: left;\">\n                <p style=\"color: var(--text-secondary); font-size: 13px; margin-bottom: 12px;\">\n                    Select a person to analyze (${people.length} available):\n                </p>\n                <div style=\"display: flex; flex-direction: column; gap: 8px; max-height: 300px; overflow-y: auto;\">\n                    ${people.slice(0, 20).map((p: any) => `\n                        <button class=\"btn btn-secondary analyze-person-btn\" \n                                data-person-id=\"${p.id}\" \n                                data-person-name=\"${p.name || 'Unknown'}\"\n                                style=\"display: flex; justify-content: space-between; align-items: center; padding: 12px 16px;\">\n                            <span style=\"font-weight: 500;\">${p.name || 'Unknown'}</span>\n                            <span style=\"font-size: 12px; color: var(--text-tertiary);\">${p.role || p.organization || ''}</span>\n                        </button>\n                    `).join('')}\n                </div>\n                ${people.length > 20 ? `<p style=\"color: var(--text-tertiary); font-size: 12px; margin-top: 8px;\">Showing first 20 of ${people.length} people</p>` : ''}\n            </div>\n        `;\n\n        // Add click handlers\n        listContainer.querySelectorAll('.analyze-person-btn').forEach(btn => {\n            btn.addEventListener('click', async () => {\n                const personId = (btn as HTMLElement).dataset.personId;\n                const personName = (btn as HTMLElement).dataset.personName;\n                if (personId) {\n                    toast.info(`Analyzing ${personName}...`);\n                    (btn as HTMLButtonElement).disabled = true;\n                    (btn as HTMLButtonElement).innerHTML = '<span>Analyzing...</span>';\n                    \n                    try {\n                        await teamAnalysisStore.analyzeProfile(personId, { forceReanalysis: true });\n                        toast.success(`Profile created for ${personName}`);\n                        // Reload profiles\n                        await teamAnalysisStore.loadProfiles();\n                    } catch (error: any) {\n                        toast.error(`Failed to analyze: ${error.message || 'Unknown error'}`);\n                        (btn as HTMLButtonElement).disabled = false;\n                        (btn as HTMLButtonElement).innerHTML = `<span style=\"font-weight: 500;\">${personName}</span>`;\n                    }\n                }\n            });\n        });\n    } catch (error) {\n        listContainer.innerHTML = `\n            <p style=\"color: var(--error); font-size: 13px;\">\n                Failed to load people. Please try again.\n            </p>\n        `;\n    }\n}\n\n// Export\nexport default createTeamAnalysis;\n"],"names":["networkInstance","createTeamAnalysis","container","createElement","initTeamAnalysis","teamAnalysisStore","state","renderContent","setupEventListeners","btn","e","subtab","switchSubtab","toast","showAnalyzeContactsModal","modal","closeModal","response","http","contacts","existingProfileIds","p","loadingEl","listEl","a","b","aAnalyzed","bAnalyzed","c","hasProfile","initials","n","selectedIds","updateButton","checkbox","input","id","label","originalText","successCount","errorCount","name","badge","error","contentEl","currentSubtab","renderProfiles","renderTeamDynamics","renderNetworkGraph","profiles","selectedProfile","renderProfileDetail","loadPeopleForAnalysis","renderProfileCard","card","personId","profile","contact","role","confidence","avatarUrl","contactId","data","renderCommunicationSection","renderMotivationsSection","renderPressureSection","renderInfluenceSection","renderVulnerabilitiesSection","renderStrategySection","renderWarningSection","renderPowerSection","comm","renderEvidenceList","mot","behaviors","tactics","t","vuln","sections","strat","f","warnings","w","power","evidence","buildNameResolver","mapping","index","realName","info","firstName","normalized","renderPersonChip","personName","resolveName","teamAnalysis","tensionClass","cohesionColor","analysisData","analysisDate","recommendations","riskFactors","commFlow","dominantPattern","replacePersonNames","renderInfluenceScoreboard","renderCommunicationFlow","renderInfluenceMapV2","renderAlliancesV2","renderTensionsV2","renderPowerCentersV2","renderRiskFactors","renderRecommendations","sortedProfiles","maxScore","medals","score","barWidth","rank","medal","isTopThree","riskLevel","riskColors","riskColor","styleSnippet","m","text","match","risk","i","rec","influenceMap","typeConfig","inf","strengthPct","strengthLabel","infType","config","hasEvidence","alliances","all","members","bondLabel","allianceType","hasSharedValues","v","tensions","levelColors","between","level","levelClass","levelConfig","tensionType","hasTriggers","itemId","tr","powerCenters","pc","reachPct","powerType","hasDependencies","d","graphData","profileLookup","initializeNetwork","getInitials","stringToColor","str","colors","hash","createAvatarSvg","influenceScore","bgColor","size","svg","adjustColor","color","amount","clamp","num","hex","r","g","getEdgeStyle","edgeType","nodes","nodeSize","edges","style","formatEdgeLabel","options","params","nodeId","nodeData","showNodeDetails","hideNodeDetails","panel","org","commStyle","motivation","listContainer","people"],"mappings":"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"}
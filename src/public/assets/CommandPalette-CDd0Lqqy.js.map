{"version":3,"file":"CommandPalette-CDd0Lqqy.js","sources":["../../frontend/components/graph/CommandPalette.ts"],"sourcesContent":["/**\r\n * CommandPalette - Quick action launcher (Cmd+K)\r\n * \r\n * Features:\r\n * - Fuzzy search\r\n * - Keyboard navigation\r\n * - Action categories\r\n * - Recent actions\r\n */\r\n\r\nimport { createElement, on } from '../../utils/dom';\r\n\r\nexport interface CommandPaletteProps {\r\n  onClose?: () => void;\r\n  onAction?: (actionId: string, data?: unknown) => void;\r\n}\r\n\r\ninterface Command {\r\n  id: string;\r\n  label: string;\r\n  description?: string;\r\n  category: string;\r\n  icon: string;\r\n  shortcut?: string;\r\n  keywords?: string[];\r\n}\r\n\r\nconst COMMANDS: Command[] = [\r\n  // Navigation\r\n  { id: 'go-explorer', label: 'Go to Explorer', category: 'Navigation', icon: 'üîç', shortcut: '1' },\r\n  { id: 'go-ontology', label: 'Go to Ontology', category: 'Navigation', icon: 'üìö', shortcut: '2' },\r\n  { id: 'go-query', label: 'Go to Query Builder', category: 'Navigation', icon: 'üíª', shortcut: '3' },\r\n  { id: 'go-analytics', label: 'Go to Analytics', category: 'Navigation', icon: 'üìä', shortcut: '4' },\r\n  \r\n  // Graph Actions\r\n  { id: 'fit-view', label: 'Fit Graph to View', category: 'Graph', icon: '‚¨ú', keywords: ['zoom', 'fit', 'center'] },\r\n  { id: 'find-paths', label: 'Find Paths Between Nodes', category: 'Graph', icon: 'üîó', keywords: ['path', 'connection', 'route'] },\r\n  { id: 'detect-communities', label: 'Detect Communities', category: 'Graph', icon: 'üéØ', keywords: ['cluster', 'group'] },\r\n  { id: 'export-graph', label: 'Export Graph', category: 'Graph', icon: 'üì§', keywords: ['download', 'save', 'export'] },\r\n  { id: 'create-snapshot', label: 'Create Snapshot', category: 'Graph', icon: 'üì∏', keywords: ['save', 'backup', 'snapshot'] },\r\n  \r\n  // Filter Actions\r\n  { id: 'filter-people', label: 'Show Only People', category: 'Filter', icon: 'üë•', keywords: ['person', 'people', 'filter'] },\r\n  { id: 'filter-projects', label: 'Show Only Projects', category: 'Filter', icon: 'üìÅ', keywords: ['project', 'filter'] },\r\n  { id: 'filter-decisions', label: 'Show Only Decisions', category: 'Filter', icon: '‚úÖ', keywords: ['decision', 'filter'] },\r\n  { id: 'filter-risks', label: 'Show Only Risks', category: 'Filter', icon: '‚ö†Ô∏è', keywords: ['risk', 'filter'] },\r\n  { id: 'clear-filters', label: 'Clear All Filters', category: 'Filter', icon: 'üîÑ', keywords: ['reset', 'clear'] },\r\n  \r\n  // AI Actions\r\n  { id: 'ai-copilot', label: 'Open AI Copilot', category: 'AI', icon: 'ü§ñ', shortcut: 'C' },\r\n  { id: 'ai-insights', label: 'Generate AI Insights', category: 'AI', icon: 'üí°', keywords: ['insight', 'analysis'] },\r\n  { id: 'ai-summarize', label: 'Summarize Selection', category: 'AI', icon: 'üìù', keywords: ['summary', 'summarize'] },\r\n  { id: 'ai-explain', label: 'Explain Connection', category: 'AI', icon: '‚ùì', keywords: ['explain', 'why'] },\r\n  \r\n  // Query Actions\r\n  { id: 'new-query', label: 'New Cypher Query', category: 'Query', icon: '‚ûï', keywords: ['query', 'cypher', 'new'] },\r\n  { id: 'query-history', label: 'View Query History', category: 'Query', icon: 'üìú', keywords: ['history', 'past'] },\r\n  { id: 'query-templates', label: 'Browse Query Templates', category: 'Query', icon: 'üìã', keywords: ['template', 'pattern'] },\r\n  \r\n  // Settings\r\n  { id: 'toggle-theme', label: 'Toggle Dark/Light Mode', category: 'Settings', icon: 'üåô', keywords: ['theme', 'dark', 'light', 'mode'] },\r\n  { id: 'toggle-labels', label: 'Toggle Node Labels', category: 'Settings', icon: 'üè∑Ô∏è', keywords: ['label', 'text'] },\r\n  { id: 'toggle-physics', label: 'Toggle Physics Simulation', category: 'Settings', icon: '‚ö°', keywords: ['physics', 'animation'] },\r\n];\r\n\r\n/**\r\n * Create the command palette component\r\n */\r\nexport function createCommandPalette(props: CommandPaletteProps = {}): HTMLElement {\r\n  const container = createElement('div', { className: 'command-palette' });\r\n  \r\n  container.innerHTML = `\r\n    <div class=\"palette-search\">\r\n      <svg class=\"search-icon\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n        <circle cx=\"11\" cy=\"11\" r=\"8\"/>\r\n        <line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\"/>\r\n      </svg>\r\n      <input type=\"text\" id=\"palette-input\" class=\"palette-input\" placeholder=\"Type a command or search...\" autofocus>\r\n      <div class=\"palette-shortcut\">\r\n        <kbd>Esc</kbd> to close\r\n      </div>\r\n    </div>\r\n    \r\n    <div class=\"palette-results\" id=\"palette-results\">\r\n      <!-- Results will be rendered here -->\r\n    </div>\r\n    \r\n    <div class=\"palette-footer\">\r\n      <div class=\"footer-hint\">\r\n        <kbd>‚Üë‚Üì</kbd> to navigate\r\n        <kbd>Enter</kbd> to select\r\n      </div>\r\n    </div>\r\n  `;\r\n\r\n  // Initialize\r\n  initPalette(container, props);\r\n\r\n  return container;\r\n}\r\n\r\n/**\r\n * Initialize palette\r\n */\r\nfunction initPalette(container: HTMLElement, props: CommandPaletteProps): void {\r\n  const input = container.querySelector('#palette-input') as HTMLInputElement;\r\n  const results = container.querySelector('#palette-results') as HTMLElement;\r\n  \r\n  let selectedIndex = 0;\r\n  let filteredCommands = [...COMMANDS];\r\n\r\n  // Initial render\r\n  renderResults(results, filteredCommands, selectedIndex, props);\r\n\r\n  // Filter on input\r\n  on(input, 'input', () => {\r\n    const query = input.value.toLowerCase().trim();\r\n    \r\n    if (!query) {\r\n      filteredCommands = [...COMMANDS];\r\n    } else {\r\n      filteredCommands = COMMANDS.filter(cmd => {\r\n        const searchText = [\r\n          cmd.label,\r\n          cmd.description || '',\r\n          cmd.category,\r\n          ...(cmd.keywords || []),\r\n        ].join(' ').toLowerCase();\r\n        \r\n        return searchText.includes(query) || fuzzyMatch(query, cmd.label.toLowerCase());\r\n      });\r\n    }\r\n    \r\n    selectedIndex = 0;\r\n    renderResults(results, filteredCommands, selectedIndex, props);\r\n  });\r\n\r\n  // Keyboard navigation\r\n  on(input, 'keydown', (e: Event) => {\r\n    const event = e as KeyboardEvent;\r\n    \r\n    switch (event.key) {\r\n      case 'ArrowDown':\r\n        event.preventDefault();\r\n        selectedIndex = Math.min(selectedIndex + 1, filteredCommands.length - 1);\r\n        renderResults(results, filteredCommands, selectedIndex, props);\r\n        break;\r\n        \r\n      case 'ArrowUp':\r\n        event.preventDefault();\r\n        selectedIndex = Math.max(selectedIndex - 1, 0);\r\n        renderResults(results, filteredCommands, selectedIndex, props);\r\n        break;\r\n        \r\n      case 'Enter':\r\n        event.preventDefault();\r\n        if (filteredCommands[selectedIndex]) {\r\n          executeCommand(filteredCommands[selectedIndex], props);\r\n        }\r\n        break;\r\n        \r\n      case 'Escape':\r\n        event.preventDefault();\r\n        props.onClose?.();\r\n        break;\r\n    }\r\n  });\r\n\r\n  // Click outside to close\r\n  on(container, 'click', (e: Event) => {\r\n    if (e.target === container) {\r\n      props.onClose?.();\r\n    }\r\n  });\r\n}\r\n\r\n/**\r\n * Render results\r\n */\r\nfunction renderResults(\r\n  container: HTMLElement,\r\n  commands: Command[],\r\n  selectedIndex: number,\r\n  props: CommandPaletteProps\r\n): void {\r\n  if (commands.length === 0) {\r\n    container.innerHTML = `\r\n      <div class=\"palette-empty\">\r\n        <p>No commands found</p>\r\n      </div>\r\n    `;\r\n    return;\r\n  }\r\n\r\n  // Group by category\r\n  const byCategory: Record<string, Command[]> = {};\r\n  commands.forEach(cmd => {\r\n    if (!byCategory[cmd.category]) byCategory[cmd.category] = [];\r\n    byCategory[cmd.category].push(cmd);\r\n  });\r\n\r\n  let globalIndex = 0;\r\n  \r\n  container.innerHTML = Object.entries(byCategory).map(([category, cmds]) => `\r\n    <div class=\"palette-category\">\r\n      <div class=\"category-label\">${escapeHtml(category)}</div>\r\n      ${cmds.map(cmd => {\r\n        const index = globalIndex++;\r\n        const isSelected = index === selectedIndex;\r\n        return `\r\n          <div class=\"palette-item ${isSelected ? 'selected' : ''}\" data-id=\"${cmd.id}\" data-index=\"${index}\">\r\n            <span class=\"item-icon\">${cmd.icon}</span>\r\n            <span class=\"item-label\">${escapeHtml(cmd.label)}</span>\r\n            ${cmd.description ? `<span class=\"item-description\">${escapeHtml(cmd.description)}</span>` : ''}\r\n            ${cmd.shortcut ? `<kbd class=\"item-shortcut\">${cmd.shortcut}</kbd>` : ''}\r\n          </div>\r\n        `;\r\n      }).join('')}\r\n    </div>\r\n  `).join('');\r\n\r\n  // Bind click events\r\n  container.querySelectorAll('.palette-item').forEach(item => {\r\n    on(item as HTMLElement, 'click', () => {\r\n      const id = item.getAttribute('data-id');\r\n      const cmd = commands.find(c => c.id === id);\r\n      if (cmd) {\r\n        executeCommand(cmd, props);\r\n      }\r\n    });\r\n\r\n    // Hover to select\r\n    on(item as HTMLElement, 'mouseenter', () => {\r\n      container.querySelectorAll('.palette-item').forEach(i => i.classList.remove('selected'));\r\n      item.classList.add('selected');\r\n    });\r\n  });\r\n\r\n  // Scroll selected into view\r\n  const selectedEl = container.querySelector('.palette-item.selected');\r\n  if (selectedEl) {\r\n    selectedEl.scrollIntoView({ block: 'nearest' });\r\n  }\r\n}\r\n\r\n/**\r\n * Execute command\r\n */\r\nfunction executeCommand(command: Command, props: CommandPaletteProps): void {\r\n  props.onAction?.(command.id);\r\n  props.onClose?.();\r\n}\r\n\r\n/**\r\n * Fuzzy match\r\n */\r\nfunction fuzzyMatch(query: string, text: string): boolean {\r\n  let qi = 0;\r\n  for (let ti = 0; ti < text.length && qi < query.length; ti++) {\r\n    if (text[ti] === query[qi]) qi++;\r\n  }\r\n  return qi === query.length;\r\n}\r\n\r\n/**\r\n * Show command palette (helper)\r\n */\r\nexport function showCommandPalette(props: CommandPaletteProps = {}): void {\r\n  // Remove existing palette\r\n  const existing = document.querySelector('.command-palette-overlay');\r\n  if (existing) existing.remove();\r\n\r\n  // Create new palette\r\n  const overlay = createElement('div', { className: 'command-palette-overlay' });\r\n  const palette = createCommandPalette({\r\n    ...props,\r\n    onClose: () => {\r\n      overlay.remove();\r\n      props.onClose?.();\r\n    },\r\n  });\r\n  \r\n  overlay.appendChild(palette);\r\n  document.body.appendChild(overlay);\r\n\r\n  // Focus input\r\n  const input = overlay.querySelector('input');\r\n  if (input) input.focus();\r\n}\r\n\r\n/**\r\n * Escape HTML\r\n */\r\nfunction escapeHtml(text: string): string {\r\n  const div = document.createElement('div');\r\n  div.textContent = text;\r\n  return div.innerHTML;\r\n}\r\n\r\nexport default createCommandPalette;\r\n"],"names":["COMMANDS","createCommandPalette","props","container","createElement","initPalette","input","results","selectedIndex","filteredCommands","renderResults","on","query","cmd","fuzzyMatch","e","event","executeCommand","commands","byCategory","globalIndex","category","cmds","escapeHtml","index","item","id","c","i","selectedEl","command","text","qi","ti","div"],"mappings":"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"}
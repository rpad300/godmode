{"version":3,"file":"SotPage-BQ9BjH_w.js","sources":["../../frontend/src/components/sot/OwnerSelect.tsx","../../frontend/src/components/sot/QuestionsPanel.tsx","../../frontend/src/components/sot/FactsPanel.tsx","../../frontend/src/components/sot/RisksPanel.tsx","../../frontend/src/components/sot/ActionModal.tsx","../../frontend/src/components/sot/ActionDetailView.tsx","../../frontend/src/components/sot/CreateSprintModal.tsx","../../frontend/src/components/sot/ActionsPanel.tsx","../../frontend/src/components/sot/DecisionsPanel.tsx","../../frontend/src/components/sot/UserStoriesPanel.tsx","../../frontend/src/pages/SotPage.tsx"],"sourcesContent":["import { useState, useRef, useEffect } from 'react';\r\nimport { ChevronDown, X, Search, User } from 'lucide-react';\r\nimport { useContacts } from '../../hooks/useGodMode';\r\nimport { cn, getInitials, isValidAvatarUrl } from '../../lib/utils';\r\n\r\ninterface Contact {\r\n  id: string;\r\n  name: string;\r\n  email?: string;\r\n  role?: string;\r\n  organization?: string;\r\n  avatarUrl?: string;\r\n  avatar?: string;\r\n  photo_url?: string;\r\n  cargo?: string;\r\n  empresa?: string;\r\n  [key: string]: unknown;\r\n}\r\n\r\ninterface OwnerSelectProps {\r\n  value: string;\r\n  onChange: (value: string) => void;\r\n  placeholder?: string;\r\n  label?: string;\r\n  className?: string;\r\n}\r\n\r\nconst COLORS = [\r\n  'from-blue-500 to-cyan-400',\r\n  'from-purple-500 to-pink-400',\r\n  'from-amber-500 to-orange-400',\r\n  'from-emerald-500 to-teal-400',\r\n  'from-rose-500 to-red-400',\r\n  'from-indigo-500 to-violet-400',\r\n];\r\n\r\nfunction hashColor(name: string) {\r\n  let h = 0;\r\n  for (let i = 0; i < name.length; i++) h = ((h << 5) - h + name.charCodeAt(i)) | 0;\r\n  return COLORS[Math.abs(h) % COLORS.length];\r\n}\r\n\r\nfunction ContactAvatar({ contact, size = 'sm' }: { contact: Contact; size?: 'sm' | 'md' }) {\r\n  const dim = size === 'sm' ? 'w-7 h-7' : 'w-9 h-9';\r\n  const txt = size === 'sm' ? 'text-[9px]' : 'text-[11px]';\r\n\r\n  const avatarRaw = contact.avatarUrl || contact.avatar || contact.photo_url;\r\n  const avatarSrc = isValidAvatarUrl(avatarRaw) ? avatarRaw : null;\r\n  if (avatarSrc) {\r\n    return <img src={avatarSrc} alt={contact.name} className={cn(dim, 'rounded-full object-cover')} />;\r\n  }\r\n\r\n  return (\r\n    <div className={cn(dim, 'rounded-full bg-gradient-to-br flex items-center justify-center shrink-0', hashColor(contact.name))}>\r\n      <span className={cn(txt, 'font-bold text-white')}>{getInitials(contact.name || '?')}</span>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport function ContactInline({ contact, size = 'sm' }: { contact: Contact; size?: 'sm' | 'md' }) {\r\n  const role = contact.cargo || contact.role || '';\r\n  const org = contact.empresa || contact.organization || '';\r\n\r\n  return (\r\n    <div className=\"flex items-center gap-2 min-w-0\">\r\n      <ContactAvatar contact={contact} size={size} />\r\n      <div className=\"min-w-0 flex-1\">\r\n        <div className={cn('font-medium truncate text-[var(--gm-text-primary)]', size === 'sm' ? 'text-[11px]' : 'text-xs')}>\r\n          {contact.name}\r\n        </div>\r\n        {(role || org) && (\r\n          <div className={cn('truncate text-[var(--gm-text-tertiary)]', size === 'sm' ? 'text-[9px]' : 'text-[10px]')}>\r\n            {[role, org].filter(Boolean).join(' · ')}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function OwnerSelect({ value, onChange, placeholder = 'Select owner...', label, className }: OwnerSelectProps) {\r\n  const [open, setOpen] = useState(false);\r\n  const [search, setSearch] = useState('');\r\n  const ref = useRef<HTMLDivElement>(null);\r\n  const inputRef = useRef<HTMLInputElement>(null);\r\n\r\n  const { data: contactsData } = useContacts();\r\n  const contacts: Contact[] = ((contactsData as Record<string, unknown>)?.contacts as Contact[] ?? []);\r\n\r\n  const filtered = contacts.filter(c => {\r\n    if (!search) return true;\r\n    const q = search.toLowerCase();\r\n    return (\r\n      c.name?.toLowerCase().includes(q) ||\r\n      (c.role || c.cargo || '')?.toLowerCase().includes(q) ||\r\n      (c.organization || c.empresa || '')?.toLowerCase().includes(q) ||\r\n      c.email?.toLowerCase().includes(q)\r\n    );\r\n  });\r\n\r\n  const selected = contacts.find(c => c.name === value || c.id === value);\r\n\r\n  useEffect(() => {\r\n    function handleClick(e: MouseEvent) {\r\n      if (ref.current && !ref.current.contains(e.target as Node)) setOpen(false);\r\n    }\r\n    document.addEventListener('mousedown', handleClick);\r\n    return () => document.removeEventListener('mousedown', handleClick);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (open && inputRef.current) inputRef.current.focus();\r\n  }, [open]);\r\n\r\n  return (\r\n    <div ref={ref} className={cn('relative', className)}>\r\n      {label && <label className=\"block text-[10px] font-bold text-[var(--gm-text-tertiary)] uppercase tracking-wider mb-1.5\">{label}</label>}\r\n\r\n      <button type=\"button\" onClick={() => setOpen(!open)}\r\n        className=\"w-full flex items-center gap-2 px-3 py-2 rounded-lg border border-[var(--gm-border-primary)] bg-[var(--gm-surface-primary)] text-left hover:border-[var(--gm-accent-primary)]/50 transition-colors\">\r\n        {selected ? (\r\n          <ContactInline contact={selected} size=\"sm\" />\r\n        ) : value ? (\r\n          <div className=\"flex items-center gap-2 min-w-0 flex-1\">\r\n            <div className=\"w-7 h-7 rounded-full bg-[var(--gm-bg-tertiary)] flex items-center justify-center shrink-0\">\r\n              <User className=\"w-3.5 h-3.5 text-[var(--gm-text-tertiary)]\" />\r\n            </div>\r\n            <span className=\"text-[11px] text-[var(--gm-text-secondary)] truncate\">{value}</span>\r\n          </div>\r\n        ) : (\r\n          <span className=\"text-[11px] text-[var(--gm-text-tertiary)] flex-1\">{placeholder}</span>\r\n        )}\r\n        <div className=\"flex items-center gap-1 shrink-0\">\r\n          {value && (\r\n            <span onClick={(e) => { e.stopPropagation(); onChange(''); }} className=\"p-0.5 hover:bg-[var(--gm-bg-tertiary)] rounded cursor-pointer\">\r\n              <X className=\"w-3 h-3 text-[var(--gm-text-tertiary)]\" />\r\n            </span>\r\n          )}\r\n          <ChevronDown className={cn('w-3.5 h-3.5 text-[var(--gm-text-tertiary)] transition-transform', open && 'rotate-180')} />\r\n        </div>\r\n      </button>\r\n\r\n      {open && (\r\n        <div className=\"absolute z-50 mt-1 w-full rounded-xl border border-[var(--gm-border-primary)] bg-[var(--gm-surface-primary)] shadow-xl overflow-hidden\">\r\n          <div className=\"p-2 border-b border-[var(--gm-border-primary)]\">\r\n            <div className=\"flex items-center gap-2 px-2 py-1.5 rounded-lg bg-[var(--gm-bg-tertiary)]\">\r\n              <Search className=\"w-3.5 h-3.5 text-[var(--gm-text-tertiary)]\" />\r\n              <input ref={inputRef} type=\"text\" value={search} onChange={(e) => setSearch(e.target.value)}\r\n                placeholder=\"Search contacts...\" className=\"flex-1 bg-transparent text-xs text-[var(--gm-text-primary)] outline-none placeholder:text-[var(--gm-text-tertiary)]\" />\r\n            </div>\r\n          </div>\r\n          <div className=\"max-h-64 overflow-y-auto p-1\">\r\n            {filtered.length > 0 ? filtered.map((c) => (\r\n              <button key={c.id} type=\"button\"\r\n                onClick={() => { onChange(c.name); setOpen(false); setSearch(''); }}\r\n                className={cn('w-full px-2 py-2 rounded-lg flex items-center gap-2 hover:bg-[var(--gm-surface-hover)] transition-colors',\r\n                  (c.name === value || c.id === value) && 'bg-[var(--gm-accent-primary)]/10')}>\r\n                <ContactInline contact={c} size=\"sm\" />\r\n              </button>\r\n            )) : (\r\n              <div className=\"px-3 py-4 text-center\">\r\n                <User className=\"w-5 h-5 text-[var(--gm-text-tertiary)] mx-auto mb-1\" />\r\n                <p className=\"text-[10px] text-[var(--gm-text-tertiary)]\">No contacts found</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import { useState, useMemo, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Plus, Sparkles, Loader2, ArrowLeft, Edit2, Clock, User, MessageCircle, X, Wand2, Trash2 } from 'lucide-react';\nimport { toast } from 'sonner';\nimport type { Question } from '@/types/godmode';\nimport { useSotChat, useEnrichQuestions } from '../../hooks/useGodMode';\nimport OwnerBadge from './OwnerBadge';\nimport OwnerSelect from './OwnerSelect';\n\ntype StatusFilter = 'all' | 'open' | 'answered' | 'dismissed';\ntype PriorityFilter = 'all' | 'high' | 'medium' | 'low';\n\nconst statusColor = (s: string) =>\n  s === 'answered' ? 'bg-green-500/10 text-green-400' :\n    s === 'dismissed' ? 'bg-white/5 text-slate-400' :\n      'bg-blue-500/10 text-blue-400';\n\nconst priorityColor = (p: string) =>\n  p === 'high' ? 'bg-red-500/10 text-red-400' :\n    p === 'medium' ? 'bg-yellow-500/10 text-yellow-400' :\n      'bg-white/5 text-slate-400';\n\nconst QuestionModal = ({ open, onClose, onSave, question, mode }: {\n  open: boolean; onClose: () => void; onSave: (q: Question) => void;\n  question?: Question | null; mode: 'create' | 'edit';\n}) => {\n  const empty: Omit<Question, 'id'> = { content: '', priority: 'medium', status: 'open', source: '', assignee: '' };\n  const [form, setForm] = useState<Omit<Question, 'id'>>(empty);\n  const [aiLoading, setAiLoading] = useState<string | null>(null);\n  const chatMut = useSotChat();\n\n  useEffect(() => {\n    if (question && mode === 'edit') {\n      const { id, ...rest } = question;\n      setForm(rest);\n    } else {\n      setForm(empty);\n    }\n  }, [question, mode, open]);\n\n  const handleAiSuggest = async () => {\n    setAiLoading('suggest');\n    chatMut.mutate({ message: 'Suggest one important question that should be asked about this project. Return only the question text, no explanation.' }, {\n      onSuccess: (d) => {\n        const resp = (d as Record<string, unknown>)?.response as string;\n        if (resp) setForm(prev => ({ ...prev, content: resp.replace(/^[\"']|[\"']$/g, '').trim() }));\n        setAiLoading(null);\n        toast.success('AI suggestion applied');\n      },\n      onError: () => { setAiLoading(null); toast.error('AI suggestion failed'); },\n    });\n  };\n\n  const handleAiAnswer = async () => {\n    if (!form.content) { toast.error('Add a question first'); return; }\n    setAiLoading('answer');\n    chatMut.mutate({ message: `Answer this question based on the project knowledge: \"${form.content}\". Be concise and factual.` }, {\n      onSuccess: (d) => {\n        const resp = (d as Record<string, unknown>)?.response as string;\n        if (resp) setForm(prev => ({ ...prev, answer: resp, status: 'answered' }));\n        setAiLoading(null);\n        toast.success('AI generated answer');\n      },\n      onError: () => { setAiLoading(null); toast.error('AI answer failed'); },\n    });\n  };\n\n  return (\n    <AnimatePresence>\n      {open && (\n        <>\n          <div className=\"fixed inset-0 bg-black/80 backdrop-blur-sm z-50\" onClick={onClose} />\n          <motion.div initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} exit={{ opacity: 0, scale: 0.95 }} className=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\n            <div className=\"bg-[var(--gm-bg-elevated)] border border-[var(--gm-border-primary)] rounded-2xl shadow-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto\" onClick={e => e.stopPropagation()}>\n              <div className=\"flex items-center justify-between p-5 border-b border-[var(--gm-border-primary)]\">\n                <h2 className=\"text-lg font-semibold text-[var(--gm-text-primary)]\">{mode === 'create' ? 'New Question' : 'Edit Question'}</h2>\n                <button onClick={onClose} className=\"w-8 h-8 rounded-lg hover:bg-[var(--gm-surface-hover)] flex items-center justify-center\"><X className=\"w-4 h-4 text-[var(--gm-text-tertiary)]\" /></button>\n              </div>\n              <div className=\"px-5 pt-4 flex gap-2\">\n                <button type=\"button\" onClick={handleAiSuggest} disabled={!!aiLoading} className=\"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-purple-500/10 text-purple-400 text-xs font-medium hover:bg-purple-500/20 disabled:opacity-50\">\n                  {aiLoading === 'suggest' ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Sparkles className=\"w-3.5 h-3.5\" />} Suggest Question\n                </button>\n                <button type=\"button\" onClick={handleAiAnswer} disabled={!!aiLoading} className=\"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-blue-500/10 text-blue-400 text-xs font-medium hover:bg-blue-500/20 disabled:opacity-50\">\n                  {aiLoading === 'answer' ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Wand2 className=\"w-3.5 h-3.5\" />} AI Answer\n                </button>\n              </div>\n              <form onSubmit={e => { e.preventDefault(); if (!form.content.trim()) return; onSave({ id: question?.id || String(Date.now()), ...form }); onClose(); }} className=\"p-5 space-y-4\">\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Question *</label>\n                  <textarea value={form.content} onChange={e => setForm({ ...form, content: e.target.value })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] placeholder:text-[var(--gm-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)] min-h-[80px] resize-y\" placeholder=\"Type your question...\" required />\n                </div>\n                <div className=\"grid grid-cols-2 gap-3\">\n                  <div>\n                    <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Priority</label>\n                    <select value={form.priority} onChange={e => setForm({ ...form, priority: e.target.value as Question['priority'] })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\">\n                      <option value=\"high\">High</option><option value=\"medium\">Medium</option><option value=\"low\">Low</option>\n                    </select>\n                  </div>\n                  <div>\n                    <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Status</label>\n                    <select value={form.status} onChange={e => setForm({ ...form, status: e.target.value as Question['status'] })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\">\n                      <option value=\"open\">Open</option><option value=\"answered\">Answered</option><option value=\"dismissed\">Dismissed</option>\n                    </select>\n                  </div>\n                </div>\n                <div className=\"grid grid-cols-2 gap-3\">\n                  <OwnerSelect value={form.assignee || ''} onChange={v => setForm({ ...form, assignee: v })} label=\"Assignee\" placeholder=\"Select assignee...\" />\n                  <div>\n                    <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Source</label>\n                    <input value={form.source} onChange={e => setForm({ ...form, source: e.target.value })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\" placeholder=\"Where did this come from?\" />\n                  </div>\n                </div>\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Answer</label>\n                  <textarea value={form.answer || ''} onChange={e => setForm({ ...form, answer: e.target.value })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] placeholder:text-[var(--gm-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)] min-h-[60px] resize-y\" placeholder=\"Answer (if known)...\" />\n                </div>\n                <div className=\"flex gap-2 pt-2\">\n                  <button type=\"button\" onClick={onClose} className=\"flex-1 px-4 py-2.5 rounded-lg bg-[var(--gm-interactive-secondary)] text-[var(--gm-text-primary)] text-sm font-medium hover:bg-[var(--gm-surface-hover)]\">Cancel</button>\n                  <button type=\"submit\" className=\"flex-1 px-4 py-2.5 rounded-lg bg-blue-600 text-white text-sm font-medium hover:bg-blue-700\">{mode === 'create' ? 'Create' : 'Save'}</button>\n                </div>\n              </form>\n            </div>\n          </motion.div>\n        </>\n      )}\n    </AnimatePresence>\n  );\n};\n\nconst QuestionDetail = ({ question, onBack, onEdit, onDelete }: { question: Question; onBack: () => void; onEdit: (q: Question) => void; onDelete?: (id: string) => void }) => {\n  const [aiLoading, setAiLoading] = useState<string | null>(null);\n  const [aiInsights, setAiInsights] = useState<string[]>([]);\n  const chatMut = useSotChat();\n\n  const handleAnalyze = async () => {\n    setAiLoading('analyze');\n    chatMut.mutate({ message: `Analyze this project question and provide 3 actionable insights:\\nQuestion: \"${question.content}\"\\nStatus: ${question.status}\\nPriority: ${question.priority}\\nAssignee: ${question.assignee || 'none'}\\nSource: ${question.source || 'unknown'}` }, {\n      onSuccess: (d) => {\n        const resp = (d as Record<string, unknown>)?.response as string;\n        if (resp) setAiInsights(resp.split('\\n').filter(l => l.trim()));\n        setAiLoading(null);\n        toast.success('AI analysis complete');\n      },\n      onError: () => { setAiLoading(null); toast.error('AI analysis failed'); },\n    });\n  };\n\n  return (\n    <motion.div initial={{ opacity: 0, x: 20 }} animate={{ opacity: 1, x: 0 }} className=\"space-y-4\">\n      <div className=\"flex items-center gap-3\">\n        <button onClick={onBack} className=\"w-8 h-8 rounded-lg bg-[var(--gm-interactive-secondary)] flex items-center justify-center hover:bg-[var(--gm-surface-hover)]\"><ArrowLeft className=\"w-4 h-4 text-[var(--gm-text-tertiary)]\" /></button>\n        <div className=\"flex-1\"><h2 className=\"text-lg font-semibold text-[var(--gm-text-primary)]\">Question Detail</h2><p className=\"text-xs text-[var(--gm-text-tertiary)]\">#{question.id}</p></div>\n        <button onClick={handleAnalyze} disabled={!!aiLoading} className=\"px-3 py-1.5 rounded-lg bg-purple-500/10 text-purple-400 text-xs font-medium hover:bg-purple-500/20 flex items-center gap-1.5 disabled:opacity-50\">\n          {aiLoading === 'analyze' ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Sparkles className=\"w-3.5 h-3.5\" />} Analyze\n        </button>\n        <button onClick={() => onEdit(question)} className=\"px-3 py-1.5 rounded-lg bg-[var(--gm-interactive-secondary)] text-[var(--gm-text-primary)] text-xs hover:bg-[var(--gm-surface-hover)] flex items-center gap-1.5\"><Edit2 className=\"w-3.5 h-3.5\" /> Edit</button>\n        {onDelete && <button onClick={() => { onDelete(question.id); onBack(); }} className=\"px-3 py-1.5 rounded-lg bg-red-500/10 text-red-400 text-xs hover:bg-red-500/20 flex items-center gap-1.5\"><Trash2 className=\"w-3.5 h-3.5\" /> Delete</button>}\n      </div>\n      <div className=\"flex gap-2\">\n        <span className={`text-xs px-3 py-1 rounded-full font-medium ${statusColor(question.status)}`}>{question.status || '—'}</span>\n        <span className={`text-xs px-3 py-1 rounded-full font-medium ${priorityColor(question.priority)}`}>{question.priority || '—'}</span>\n      </div>\n      <div className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-4\">\n        <h3 className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider mb-2\">Question</h3>\n        <p className=\"text-sm text-[var(--gm-text-primary)]\">{question.content || '(no content)'}</p>\n      </div>\n      <div className=\"grid grid-cols-2 gap-3\">\n        <div className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 mb-2\"><User className=\"w-3.5 h-3.5 text-[var(--gm-text-tertiary)]\" /><span className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Assignee</span></div>\n          {question.assignee ? <OwnerBadge name={question.assignee} size=\"md\" /> : <p className=\"text-sm text-[var(--gm-text-tertiary)]\">Unassigned</p>}\n        </div>\n        <div className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 mb-2\"><MessageCircle className=\"w-3.5 h-3.5 text-[var(--gm-text-tertiary)]\" /><span className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Source</span></div>\n          <p className=\"text-sm text-[var(--gm-text-primary)]\">{question.source || '—'}</p>\n        </div>\n      </div>\n      {question.answer && (\n        <div className=\"bg-purple-500/5 border border-purple-500/20 rounded-xl p-4\">\n          <h3 className=\"text-xs font-medium text-purple-400 uppercase tracking-wider mb-2\">Answer</h3>\n          <p className=\"text-sm text-[var(--gm-text-primary)]\">{question.answer}</p>\n        </div>\n      )}\n      {aiInsights.length > 0 && (\n        <motion.div initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} className=\"bg-purple-500/5 border border-purple-500/20 rounded-xl p-4\">\n          <h3 className=\"text-xs font-medium text-purple-400 uppercase tracking-wider mb-2 flex items-center gap-1.5\"><Sparkles className=\"w-3.5 h-3.5\" /> AI Insights</h3>\n          <ul className=\"space-y-1.5\">{aiInsights.map((ins, i) => <li key={i} className=\"text-sm text-[var(--gm-text-primary)]\">{ins}</li>)}</ul>\n        </motion.div>\n      )}\n    </motion.div>\n  );\n};\n\nconst QuestionsPanel = ({ initialData = [], onSave, onDelete }: { initialData?: Question[]; onSave?: (q: Question) => void; onDelete?: (id: string) => void }) => {\n  const [questions, setQuestions] = useState<Question[]>(initialData);\n  const chatMut = useSotChat();\n  const enrichMut = useEnrichQuestions();\n\n  useEffect(() => {\n    if (initialData) setQuestions(initialData);\n  }, [initialData]);\n  const [statusFilter, setStatusFilter] = useState<StatusFilter>('all');\n  const [priorityFilter, setPriorityFilter] = useState<PriorityFilter>('all');\n  const [modalOpen, setModalOpen] = useState(false);\n  const [modalMode, setModalMode] = useState<'create' | 'edit'>('create');\n  const [editingItem, setEditingItem] = useState<Question | null>(null);\n  const [detailItem, setDetailItem] = useState<Question | null>(null);\n  const [aiLoading, setAiLoading] = useState(false);\n\n  const filtered = useMemo(() => {\n    let result = questions;\n    if (statusFilter !== 'all') result = result.filter(q => q.status === statusFilter);\n    if (priorityFilter !== 'all') result = result.filter(q => q.priority === priorityFilter);\n    return result;\n  }, [questions, statusFilter, priorityFilter]);\n\n  const stats = useMemo(() => ({\n    total: questions.length,\n    open: questions.filter(q => q.status === 'open').length,\n    answered: questions.filter(q => q.status === 'answered').length,\n    dismissed: questions.filter(q => q.status === 'dismissed').length,\n  }), [questions]);\n\n  const handleSave = (q: Question) => {\n    setQuestions(prev => {\n      const idx = prev.findIndex(x => x.id === q.id);\n      if (idx >= 0) { const u = [...prev]; u[idx] = q; return u; }\n      return [...prev, q];\n    });\n    onSave?.(q);\n  };\n\n  const handleDelete = (id: string) => {\n    setQuestions(prev => prev.filter(x => x.id !== id));\n    onDelete?.(id);\n    toast.success('Question deleted');\n  };\n\n  const handleAiSuggest = async () => {\n    setAiLoading(true);\n    chatMut.mutate({ message: 'Based on the current project knowledge, suggest one new important question that should be raised. Return the question text only, and a suggested priority (high/medium/low) on a second line.' }, {\n      onSuccess: (d) => {\n        const resp = (d as Record<string, unknown>)?.response as string;\n        if (resp) {\n          const lines = resp.split('\\n').filter(l => l.trim());\n          const content = lines[0]?.replace(/^[\"'\\-*\\d.]+\\s*/, '').trim() || resp.trim();\n          const priMatch = resp.toLowerCase().match(/(high|medium|low)/);\n          const newQ: Question = { id: `ai-${Date.now()}`, content, priority: (priMatch?.[1] as Question['priority']) || 'medium', status: 'open', source: 'AI Analysis' };\n          setQuestions(prev => [...prev, newQ]);\n          onSave?.(newQ);\n        }\n        setAiLoading(false);\n        toast.success('AI suggested a new question');\n      },\n      onError: () => { setAiLoading(false); toast.error('AI suggestion failed'); },\n    });\n  };\n\n  if (detailItem) {\n    return <QuestionDetail question={detailItem} onBack={() => setDetailItem(null)} onEdit={q => { setDetailItem(null); setEditingItem(q); setModalMode('edit'); setModalOpen(true); }} onDelete={handleDelete} />;\n  }\n\n  return (\n    <div className=\"space-y-3\">\n      <div className=\"flex gap-2 flex-wrap\">\n        {[\n          { label: 'Total', value: stats.total, color: 'text-[var(--gm-text-primary)]' },\n          { label: 'Open', value: stats.open, color: 'text-primary' },\n          { label: 'Answered', value: stats.answered, color: 'text-green-400' },\n          { label: 'Dismissed', value: stats.dismissed, color: 'text-[var(--gm-text-tertiary)]' },\n        ].map(s => (\n          <div key={s.label} className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 flex items-center gap-2\">\n            <span className={`text-lg font-bold ${s.color}`}>{s.value}</span>\n            <span className=\"text-[10px] text-[var(--gm-text-tertiary)] uppercase tracking-wider\">{s.label}</span>\n          </div>\n        ))}\n      </div>\n      <div className=\"flex items-center gap-2 flex-wrap\">\n        <select value={statusFilter} onChange={e => setStatusFilter(e.target.value as StatusFilter)} className=\"bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-1.5 text-xs text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\">\n          <option value=\"all\">All statuses</option><option value=\"open\">Open</option><option value=\"answered\">Answered</option><option value=\"dismissed\">Dismissed</option>\n        </select>\n        <select value={priorityFilter} onChange={e => setPriorityFilter(e.target.value as PriorityFilter)} className=\"bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-1.5 text-xs text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\">\n          <option value=\"all\">All priorities</option><option value=\"high\">High</option><option value=\"medium\">Medium</option><option value=\"low\">Low</option>\n        </select>\n        <div className=\"flex-1\" />\n        <button\n          onClick={() => enrichMut.mutate(undefined, { onSuccess: (r) => toast.success(`Enriched ${r?.enriched ?? 0} questions with AI-assigned people`) })}\n          disabled={enrichMut.isPending}\n          className=\"px-3 py-1.5 rounded-lg bg-purple-500/10 text-purple-400 text-xs font-medium hover:bg-purple-500/20 flex items-center gap-1.5 disabled:opacity-50\"\n        >\n          {enrichMut.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Wand2 className=\"w-3.5 h-3.5\" />} AI Enrich\n        </button>\n        <button onClick={handleAiSuggest} disabled={aiLoading} className=\"px-3 py-1.5 rounded-lg bg-purple-500/10 text-purple-400 text-xs font-medium hover:bg-purple-500/20 flex items-center gap-1.5 disabled:opacity-50\">\n          {aiLoading ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Sparkles className=\"w-3.5 h-3.5\" />} AI Suggest\n        </button>\n        <button onClick={() => { setEditingItem(null); setModalMode('create'); setModalOpen(true); }} className=\"px-3 py-1.5 rounded-lg bg-blue-600 text-white text-xs font-medium hover:bg-blue-700 flex items-center gap-1.5\">\n          <Plus className=\"w-3.5 h-3.5\" /> Add Question\n        </button>\n      </div>\n      <div className=\"space-y-2\">\n        {filtered.length === 0 ? (\n          <p className=\"text-sm text-[var(--gm-text-tertiary)] text-center py-8\">No questions match the current filter</p>\n        ) : filtered.map(q => (\n          <motion.div key={q.id} layout initial={{ opacity: 0 }} animate={{ opacity: 1 }} className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-3.5 hover:border-blue-500/30 transition-colors cursor-pointer group\" onClick={() => setDetailItem(q)}>\n            <div className=\"flex items-start justify-between gap-3\">\n              <p className=\"text-sm font-medium text-[var(--gm-text-primary)] group-hover:text-blue-400 transition-colors flex-1\">{q.content || '(no content)'}</p>\n              <div className=\"flex gap-1.5 flex-shrink-0\">\n                <span className={`text-[10px] px-2 py-0.5 rounded-full font-medium ${priorityColor(q.priority)}`}>{q.priority || '—'}</span>\n                <span className={`text-[10px] px-2 py-0.5 rounded-full font-medium ${statusColor(q.status)}`}>{q.status || '—'}</span>\n              </div>\n            </div>\n            <div className=\"flex items-center justify-between mt-2.5\">\n              {q.assignee ? <OwnerBadge name={q.assignee} size=\"sm\" /> : <span className=\"text-[11px] text-[var(--gm-text-tertiary)]\">Unassigned</span>}\n              <span className=\"text-[10px] text-[var(--gm-text-tertiary)]\">{q.source || ''}</span>\n            </div>\n            {q.answer && <p className=\"text-xs text-purple-400 mt-2 line-clamp-1\">{q.answer}</p>}\n          </motion.div>\n        ))}\n      </div>\n      <QuestionModal open={modalOpen} onClose={() => setModalOpen(false)} onSave={handleSave} question={editingItem} mode={modalMode} />\n    </div>\n  );\n};\n\nexport default QuestionsPanel;\n","import { useState, useMemo, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Plus, Sparkles, Loader2, ArrowLeft, Edit2, Clock, FileText, X, Wand2, Trash2 } from 'lucide-react';\nimport { toast } from 'sonner';\nimport type { Fact } from '@/types/godmode';\nimport { useSotChat, useAiSimilarFacts } from '../../hooks/useGodMode';\n\ntype CategoryFilter = 'all' | Fact['category'];\n\nconst categoryColor = (c: string) =>\n  c === 'technical' ? 'bg-blue-500/10 text-blue-400' :\n    c === 'process' ? 'bg-purple-500/10 text-purple-400' :\n      c === 'policy' ? 'bg-yellow-500/10 text-yellow-400' :\n        c === 'people' ? 'bg-red-500/10 text-red-400' :\n          'bg-white/5 text-slate-400';\n\nconst confidenceColor = (c: number) =>\n  c >= 0.9 ? 'text-green-400' : c >= 0.7 ? 'text-yellow-400' : 'text-red-400';\n\nconst FactModal = ({ open, onClose, onSave, fact, mode }: {\n  open: boolean; onClose: () => void; onSave: (f: Fact) => void;\n  fact?: Fact | null; mode: 'create' | 'edit';\n}) => {\n  const empty: Omit<Fact, 'id'> = { content: '', category: 'technical', source: '', confidence: 0.8, createdAt: new Date().toISOString().split('T')[0] };\n  const [form, setForm] = useState<Omit<Fact, 'id'>>(empty);\n  const [aiLoading, setAiLoading] = useState<string | null>(null);\n  const chatMut = useSotChat();\n\n  useEffect(() => {\n    if (fact && mode === 'edit') { const { id, ...rest } = fact; setForm(rest); } else { setForm(empty); }\n  }, [fact, mode, open]);\n\n  const handleAiRefine = async () => {\n    if (!form.content) { toast.error('Add content first'); return; }\n    setAiLoading('refine');\n    chatMut.mutate({ message: `Refine and verify this fact against project knowledge. Rewrite it more precisely if needed and estimate confidence (0.0-1.0):\\n\"${form.content}\"` }, {\n      onSuccess: (d) => {\n        const resp = (d as Record<string, unknown>)?.response as string;\n        if (resp) {\n          const confMatch = resp.match(/(\\d\\.\\d+)/);\n          setForm(prev => ({\n            ...prev,\n            content: resp.replace(/confidence[:\\s]*\\d\\.\\d+/i, '').trim(),\n            confidence: confMatch ? Math.min(parseFloat(confMatch[1]), 1) : Math.min(prev.confidence + 0.05, 1),\n          }));\n        }\n        setAiLoading(null);\n        toast.success('Fact refined with AI');\n      },\n      onError: () => { setAiLoading(null); toast.error('AI refinement failed'); },\n    });\n  };\n\n  return (\n    <AnimatePresence>\n      {open && (\n        <>\n          <div className=\"fixed inset-0 bg-black/80 backdrop-blur-sm z-50\" onClick={onClose} />\n          <motion.div initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} exit={{ opacity: 0, scale: 0.95 }} className=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\n            <div className=\"bg-[var(--gm-bg-elevated)] border border-[var(--gm-border-primary)] rounded-2xl shadow-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto\" onClick={e => e.stopPropagation()}>\n              <div className=\"flex items-center justify-between p-5 border-b border-[var(--gm-border-primary)]\">\n                <h2 className=\"text-lg font-semibold text-[var(--gm-text-primary)]\">{mode === 'create' ? 'New Fact' : 'Edit Fact'}</h2>\n                <button onClick={onClose} className=\"w-8 h-8 rounded-lg hover:bg-[var(--gm-surface-hover)] flex items-center justify-center\"><X className=\"w-4 h-4 text-[var(--gm-text-tertiary)]\" /></button>\n              </div>\n              <div className=\"px-5 pt-4 flex gap-2\">\n                <button type=\"button\" onClick={handleAiRefine} disabled={!!aiLoading} className=\"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-blue-500/10 text-blue-400 text-xs font-medium hover:bg-blue-500/20 disabled:opacity-50\">\n                  {aiLoading === 'refine' ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Wand2 className=\"w-3.5 h-3.5\" />} Refine with AI\n                </button>\n              </div>\n              <form onSubmit={e => { e.preventDefault(); if (!form.content.trim()) return; onSave({ id: fact?.id || String(Date.now()), ...form }); onClose(); }} className=\"p-5 space-y-4\">\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Content *</label>\n                  <textarea value={form.content} onChange={e => setForm({ ...form, content: e.target.value })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] placeholder:text-[var(--gm-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)] min-h-[80px] resize-y\" placeholder=\"State the fact...\" required />\n                </div>\n                <div className=\"grid grid-cols-2 gap-3\">\n                  <div>\n                    <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Category</label>\n                    <select value={form.category} onChange={e => setForm({ ...form, category: e.target.value as Fact['category'] })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\">\n                      <option value=\"technical\">Technical</option><option value=\"process\">Process</option><option value=\"policy\">Policy</option><option value=\"people\">People</option><option value=\"timeline\">Timeline</option>\n                    </select>\n                  </div>\n                  <div>\n                    <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Confidence</label>\n                    <input type=\"number\" min={0} max={1} step={0.05} value={form.confidence} onChange={e => setForm({ ...form, confidence: parseFloat(e.target.value) })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\" />\n                  </div>\n                </div>\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Source</label>\n                  <input value={form.source} onChange={e => setForm({ ...form, source: e.target.value })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\" placeholder=\"Document or meeting source...\" />\n                </div>\n                <div className=\"flex gap-2 pt-2\">\n                  <button type=\"button\" onClick={onClose} className=\"flex-1 px-4 py-2.5 rounded-lg bg-[var(--gm-interactive-secondary)] text-[var(--gm-text-primary)] text-sm font-medium hover:bg-[var(--gm-surface-hover)]\">Cancel</button>\n                  <button type=\"submit\" className=\"flex-1 px-4 py-2.5 rounded-lg bg-blue-600 text-white text-sm font-medium hover:bg-blue-700\">{mode === 'create' ? 'Create' : 'Save'}</button>\n                </div>\n              </form>\n            </div>\n          </motion.div>\n        </>\n      )}\n    </AnimatePresence>\n  );\n};\n\nconst FactDetail = ({ fact, onBack, onEdit, onDelete }: { fact: Fact; onBack: () => void; onEdit: (f: Fact) => void; onDelete?: (id: string) => void }) => {\n  const [aiLoading, setAiLoading] = useState(false);\n  const [aiInsights, setAiInsights] = useState<string[]>([]);\n  const chatMut = useSotChat();\n  const similarFacts = useAiSimilarFacts(fact.id);\n\n  const handleVerify = async () => {\n    setAiLoading(true);\n    chatMut.mutate({ message: `Verify this fact against the project knowledge base. Check accuracy, find related/conflicting facts, and assess confidence:\\nFact: \"${fact.content}\"\\nCategory: ${fact.category}\\nCurrent confidence: ${Math.round(fact.confidence * 100)}%\\nSource: ${fact.source}` }, {\n      onSuccess: (d) => {\n        const resp = (d as Record<string, unknown>)?.response as string;\n        if (resp) setAiInsights(resp.split('\\n').filter(l => l.trim()));\n        setAiLoading(false);\n        toast.success('AI verification complete');\n      },\n      onError: () => { setAiLoading(false); toast.error('AI verification failed'); },\n    });\n  };\n\n  return (\n    <motion.div initial={{ opacity: 0, x: 20 }} animate={{ opacity: 1, x: 0 }} className=\"space-y-4\">\n      <div className=\"flex items-center gap-3\">\n        <button onClick={onBack} className=\"w-8 h-8 rounded-lg bg-[var(--gm-interactive-secondary)] flex items-center justify-center hover:bg-[var(--gm-surface-hover)]\"><ArrowLeft className=\"w-4 h-4 text-[var(--gm-text-tertiary)]\" /></button>\n        <div className=\"flex-1\"><h2 className=\"text-lg font-semibold text-[var(--gm-text-primary)]\">Fact Detail</h2><p className=\"text-xs text-[var(--gm-text-tertiary)]\">#{fact.id}</p></div>\n        <button onClick={handleVerify} disabled={aiLoading} className=\"px-3 py-1.5 rounded-lg bg-purple-500/10 text-purple-400 text-xs font-medium hover:bg-purple-500/20 flex items-center gap-1.5 disabled:opacity-50\">\n          {aiLoading ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Sparkles className=\"w-3.5 h-3.5\" />} Verify\n        </button>\n        <button onClick={() => onEdit(fact)} className=\"px-3 py-1.5 rounded-lg bg-[var(--gm-interactive-secondary)] text-[var(--gm-text-primary)] text-xs hover:bg-[var(--gm-surface-hover)] flex items-center gap-1.5\"><Edit2 className=\"w-3.5 h-3.5\" /> Edit</button>\n        {onDelete && <button onClick={() => { onDelete(fact.id); onBack(); }} className=\"px-3 py-1.5 rounded-lg bg-red-500/10 text-red-400 text-xs hover:bg-red-500/20 flex items-center gap-1.5\"><Trash2 className=\"w-3.5 h-3.5\" /> Delete</button>}\n      </div>\n      <div className=\"flex gap-2\">\n        <span className={`text-xs px-3 py-1 rounded-full font-medium ${categoryColor(fact.category)}`}>{fact.category || '—'}</span>\n        <span className={`text-xs px-3 py-1 rounded-full font-medium bg-[var(--gm-interactive-secondary)] ${confidenceColor(fact.confidence)}`}>{Math.round(fact.confidence * 100)}% confidence</span>\n      </div>\n      <div className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-4\">\n        <h3 className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider mb-2\">Content</h3>\n        <p className=\"text-sm text-[var(--gm-text-primary)]\">{fact.content || '(no content)'}</p>\n      </div>\n      <div className=\"grid grid-cols-2 gap-3\">\n        <div className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 mb-2\"><FileText className=\"w-3.5 h-3.5 text-[var(--gm-text-tertiary)]\" /><span className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase\">Source</span></div>\n          <p className=\"text-sm text-[var(--gm-text-primary)]\">{fact.source || '—'}</p>\n        </div>\n        <div className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 mb-2\"><Clock className=\"w-3.5 h-3.5 text-[var(--gm-text-tertiary)]\" /><span className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase\">Extracted</span></div>\n          <p className=\"text-sm text-[var(--gm-text-primary)]\">{fact.createdAt || '—'}</p>\n        </div>\n      </div>\n      {aiInsights.length > 0 && (\n        <motion.div initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} className=\"bg-purple-500/5 border border-purple-500/20 rounded-xl p-4\">\n          <h3 className=\"text-xs font-medium text-purple-400 uppercase tracking-wider mb-2 flex items-center gap-1.5\"><Sparkles className=\"w-3.5 h-3.5\" /> AI Verification</h3>\n          <ul className=\"space-y-1.5\">{aiInsights.map((ins, i) => <li key={i} className=\"text-sm text-[var(--gm-text-primary)]\">{ins}</li>)}</ul>\n        </motion.div>\n      )}\n      {similarFacts.data && similarFacts.data.length > 0 && (\n        <motion.div initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} className=\"bg-purple-500/5 border border-purple-500/20 rounded-xl p-4\">\n          <h3 className=\"text-xs font-medium text-purple-400 uppercase tracking-wider mb-2 flex items-center gap-1.5\"><Sparkles className=\"w-3.5 h-3.5\" /> Similar Facts</h3>\n          <ul className=\"space-y-2\">{similarFacts.data.map((sf, i) => (\n            <li key={i} className=\"text-sm text-[var(--gm-text-primary)] bg-[var(--gm-surface-primary)] rounded-lg p-3 border border-[var(--gm-border-primary)]\">\n              <p>{(sf as Record<string, unknown>).content as string ?? '—'}</p>\n              {(sf as Record<string, unknown>).similarity != null && (\n                <span className=\"text-xs text-[var(--gm-text-tertiary)] mt-1 inline-block\">{Math.round(Number((sf as Record<string, unknown>).similarity) * 100)}% match</span>\n              )}\n            </li>\n          ))}</ul>\n        </motion.div>\n      )}\n      {similarFacts.isLoading && (\n        <div className=\"flex items-center gap-2 text-xs text-[var(--gm-text-tertiary)]\"><Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> Loading similar facts...</div>\n      )}\n    </motion.div>\n  );\n};\n\nconst FactsPanel = ({ initialData = [], onSave, onDelete }: { initialData?: Fact[]; onSave?: (f: Fact) => void; onDelete?: (id: string) => void }) => {\n  const [facts, setFacts] = useState<Fact[]>(initialData);\n  const chatMut = useSotChat();\n\n  useEffect(() => {\n    if (initialData) setFacts(initialData);\n  }, [initialData]);\n  const [categoryFilter, setCategoryFilter] = useState<CategoryFilter>('all');\n  const [modalOpen, setModalOpen] = useState(false);\n  const [modalMode, setModalMode] = useState<'create' | 'edit'>('create');\n  const [editingItem, setEditingItem] = useState<Fact | null>(null);\n  const [detailItem, setDetailItem] = useState<Fact | null>(null);\n  const [aiLoading, setAiLoading] = useState(false);\n\n  const filtered = useMemo(() => {\n    if (categoryFilter === 'all') return facts;\n    return facts.filter(f => f.category === categoryFilter);\n  }, [facts, categoryFilter]);\n\n  const stats = useMemo(() => {\n    const cats: Record<string, number> = {};\n    facts.forEach(f => { cats[f.category] = (cats[f.category] || 0) + 1; });\n    return { total: facts.length, categories: cats, avgConfidence: facts.length ? facts.reduce((a, f) => a + f.confidence, 0) / facts.length : 0 };\n  }, [facts]);\n\n  const handleSave = (f: Fact) => {\n    setFacts(prev => {\n      const idx = prev.findIndex(x => x.id === f.id);\n      if (idx >= 0) { const u = [...prev]; u[idx] = f; return u; }\n      return [...prev, f];\n    });\n    onSave?.(f);\n  };\n\n  const handleDelete = (id: string) => {\n    setFacts(prev => prev.filter(x => x.id !== id));\n    onDelete?.(id);\n    toast.success('Fact deleted');\n  };\n\n  const handleAiExtract = async () => {\n    setAiLoading(true);\n    chatMut.mutate({ message: 'Based on the project knowledge, extract one important fact that is not yet documented. Return on line 1: the fact text. Line 2: category (technical/process/policy/people/timeline). Line 3: confidence (0.0-1.0).' }, {\n      onSuccess: (d) => {\n        const resp = (d as Record<string, unknown>)?.response as string;\n        if (resp) {\n          const lines = resp.split('\\n').filter(l => l.trim());\n          const content = lines[0]?.replace(/^[\"'\\-*\\d.]+\\s*/, '').trim() || resp.trim();\n          const catMatch = resp.toLowerCase().match(/(technical|process|policy|people|timeline)/);\n          const confMatch = resp.match(/(\\d\\.\\d+)/);\n          const newF: Fact = {\n            id: `ai-${Date.now()}`, content,\n            category: (catMatch?.[1] as Fact['category']) || 'technical',\n            source: 'AI Analysis', confidence: confMatch ? parseFloat(confMatch[1]) : 0.8,\n            createdAt: new Date().toISOString().split('T')[0],\n          };\n          setFacts(prev => [...prev, newF]);\n          onSave?.(newF);\n        }\n        setAiLoading(false);\n        toast.success('AI extracted a new fact');\n      },\n      onError: () => { setAiLoading(false); toast.error('AI extraction failed'); },\n    });\n  };\n\n  if (detailItem) {\n    return <FactDetail fact={detailItem} onBack={() => setDetailItem(null)} onEdit={f => { setDetailItem(null); setEditingItem(f); setModalMode('edit'); setModalOpen(true); }} onDelete={handleDelete} />;\n  }\n\n  return (\n    <div className=\"space-y-3\">\n      <div className=\"flex gap-2 flex-wrap\">\n        <div className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 flex items-center gap-2\">\n          <span className=\"text-lg font-bold text-[var(--gm-text-primary)]\">{stats.total}</span>\n          <span className=\"text-[10px] text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Total</span>\n        </div>\n        <div className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 flex items-center gap-2\">\n          <span className=\"text-lg font-bold text-purple-400\">{Math.round(stats.avgConfidence * 100)}%</span>\n          <span className=\"text-[10px] text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Avg Confidence</span>\n        </div>\n        {Object.entries(stats.categories).map(([cat, count]) => (\n          <div key={cat} className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 flex items-center gap-2\">\n            <span className={`text-lg font-bold ${categoryColor(cat).split(' ')[1]}`}>{count}</span>\n            <span className=\"text-[10px] text-[var(--gm-text-tertiary)] uppercase tracking-wider\">{cat}</span>\n          </div>\n        ))}\n      </div>\n      <div className=\"flex items-center gap-2 flex-wrap\">\n        <select value={categoryFilter} onChange={e => setCategoryFilter(e.target.value as CategoryFilter)} className=\"bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-1.5 text-xs text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\">\n          <option value=\"all\">All categories</option><option value=\"technical\">Technical</option><option value=\"process\">Process</option><option value=\"policy\">Policy</option><option value=\"people\">People</option><option value=\"timeline\">Timeline</option>\n        </select>\n        <div className=\"flex-1\" />\n        <button onClick={handleAiExtract} disabled={aiLoading} className=\"px-3 py-1.5 rounded-lg bg-purple-500/10 text-purple-400 text-xs font-medium hover:bg-purple-500/20 flex items-center gap-1.5 disabled:opacity-50\">\n          {aiLoading ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Sparkles className=\"w-3.5 h-3.5\" />} AI Extract\n        </button>\n        <button onClick={() => { setEditingItem(null); setModalMode('create'); setModalOpen(true); }} className=\"px-3 py-1.5 rounded-lg bg-blue-600 text-white text-xs font-medium hover:bg-blue-700 flex items-center gap-1.5\">\n          <Plus className=\"w-3.5 h-3.5\" /> Add Fact\n        </button>\n      </div>\n      <div className=\"space-y-2\">\n        {filtered.length === 0 ? (\n          <p className=\"text-sm text-[var(--gm-text-tertiary)] text-center py-8\">No facts match the current filter</p>\n        ) : filtered.map(f => (\n          <motion.div key={f.id} layout initial={{ opacity: 0 }} animate={{ opacity: 1 }} className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-3.5 hover:border-blue-500/30 transition-colors cursor-pointer group\" onClick={() => setDetailItem(f)}>\n            <p className=\"text-sm text-[var(--gm-text-primary)] group-hover:text-blue-400 transition-colors\">{f.content || '(no content)'}</p>\n            <div className=\"flex items-center gap-2 mt-2.5\">\n              <span className={`text-[10px] px-2 py-0.5 rounded-full font-medium ${categoryColor(f.category)}`}>{f.category || '—'}</span>\n              <span className={`text-[10px] ${confidenceColor(f.confidence)}`}>{Math.round(f.confidence * 100)}%</span>\n              <span className=\"text-[10px] text-[var(--gm-text-tertiary)]\">· {f.source || '—'}</span>\n              <span className=\"text-[10px] text-[var(--gm-text-tertiary)] ml-auto\">{f.createdAt || '—'}</span>\n            </div>\n          </motion.div>\n        ))}\n      </div>\n      <FactModal open={modalOpen} onClose={() => setModalOpen(false)} onSave={handleSave} fact={editingItem} mode={modalMode} />\n    </div>\n  );\n};\n\nexport default FactsPanel;\n","import { useState, useMemo, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Plus, Sparkles, Loader2, ArrowLeft, Edit2, Shield, AlertTriangle, User, X, Wand2, Trash2 } from 'lucide-react';\nimport { toast } from 'sonner';\nimport type { Risk } from '@/types/godmode';\nimport { useSotChat, useAiSuggestRisk } from '../../hooks/useGodMode';\nimport OwnerBadge from './OwnerBadge';\nimport OwnerSelect from './OwnerSelect';\n\ntype StatusFilter = 'all' | Risk['status'];\ntype ImpactFilter = 'all' | 'high' | 'medium' | 'low';\n\nconst statusColor = (s: string) =>\n  s === 'mitigated' ? 'bg-green-500/10 text-green-400' :\n    s === 'accepted' ? 'bg-yellow-500/10 text-yellow-400' :\n      'bg-red-500/10 text-red-400';\n\nconst levelColor = (l: string) =>\n  l === 'high' ? 'bg-red-500/10 text-red-400' :\n    l === 'medium' ? 'bg-yellow-500/10 text-yellow-400' :\n      'bg-white/5 text-slate-400';\n\nconst RiskModal = ({ open, onClose, onSave, risk, mode }: {\n  open: boolean; onClose: () => void; onSave: (r: Risk) => void;\n  risk?: Risk | null; mode: 'create' | 'edit';\n}) => {\n  const empty: Omit<Risk, 'id'> = { content: '', impact: 'medium', likelihood: 'medium', status: 'open', owner: '', mitigation: '' };\n  const [form, setForm] = useState<Omit<Risk, 'id'>>(empty);\n  const [aiLoading, setAiLoading] = useState<string | null>(null);\n  const suggestRisk = useAiSuggestRisk();\n\n  useEffect(() => {\n    if (risk && mode === 'edit') { const { id, ...rest } = risk; setForm(rest); } else { setForm(empty); }\n  }, [risk, mode, open]);\n\n  const handleAiMitigation = async () => {\n    if (!form.content) { toast.error('Add a description first'); return; }\n    setAiLoading('mitigate');\n    suggestRisk.mutate({ content: form.content, impact: form.impact, likelihood: form.likelihood }, {\n      onSuccess: (d) => {\n        if (d.suggested_mitigation) setForm(prev => ({ ...prev, mitigation: d.suggested_mitigation }));\n        if (d.suggested_owner && !form.owner) setForm(prev => ({ ...prev, owner: d.suggested_owner }));\n        setAiLoading(null);\n        toast.success('AI suggested mitigation strategy');\n      },\n      onError: () => { setAiLoading(null); toast.error('AI mitigation failed'); },\n    });\n  };\n\n  return (\n    <AnimatePresence>\n      {open && (\n        <>\n          <div className=\"fixed inset-0 bg-black/80 backdrop-blur-sm z-50\" onClick={onClose} />\n          <motion.div initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} exit={{ opacity: 0, scale: 0.95 }} className=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\n            <div className=\"bg-[var(--gm-bg-elevated)] border border-[var(--gm-border-primary)] rounded-2xl shadow-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto\" onClick={e => e.stopPropagation()}>\n              <div className=\"flex items-center justify-between p-5 border-b border-[var(--gm-border-primary)]\">\n                <h2 className=\"text-lg font-semibold text-[var(--gm-text-primary)]\">{mode === 'create' ? 'New Risk' : 'Edit Risk'}</h2>\n                <button onClick={onClose} className=\"w-8 h-8 rounded-lg hover:bg-[var(--gm-surface-hover)] flex items-center justify-center\"><X className=\"w-4 h-4 text-[var(--gm-text-tertiary)]\" /></button>\n              </div>\n              <div className=\"px-5 pt-4 flex gap-2\">\n                <button type=\"button\" onClick={handleAiMitigation} disabled={!!aiLoading} className=\"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-blue-500/10 text-blue-400 text-xs font-medium hover:bg-blue-500/20 disabled:opacity-50\">\n                  {aiLoading === 'mitigate' ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Wand2 className=\"w-3.5 h-3.5\" />} AI Mitigation\n                </button>\n              </div>\n              <form onSubmit={e => { e.preventDefault(); if (!form.content.trim()) return; onSave({ id: risk?.id || String(Date.now()), ...form }); onClose(); }} className=\"p-5 space-y-4\">\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Risk *</label>\n                  <input value={form.content} onChange={e => setForm({ ...form, content: e.target.value })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\" placeholder=\"Risk title...\" required />\n                </div>\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Mitigation Plan</label>\n                  <textarea value={form.mitigation || ''} onChange={e => setForm({ ...form, mitigation: e.target.value })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] placeholder:text-[var(--gm-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)] min-h-[60px] resize-y\" placeholder=\"Describe the risk...\" />\n                </div>\n                <div className=\"grid grid-cols-3 gap-3\">\n                  <div>\n                    <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Impact</label>\n                    <select value={form.impact} onChange={e => setForm({ ...form, impact: e.target.value as Risk['impact'] })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\">\n                      <option value=\"high\">High</option><option value=\"medium\">Medium</option><option value=\"low\">Low</option>\n                    </select>\n                  </div>\n                  <div>\n                    <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Likelihood</label>\n                    <select value={form.likelihood} onChange={e => setForm({ ...form, likelihood: e.target.value as Risk['likelihood'] })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\">\n                      <option value=\"high\">High</option><option value=\"medium\">Medium</option><option value=\"low\">Low</option>\n                    </select>\n                  </div>\n                  <div>\n                    <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Status</label>\n                    <select value={form.status} onChange={e => setForm({ ...form, status: e.target.value as Risk['status'] })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\">\n                      <option value=\"open\">Open</option><option value=\"mitigated\">Mitigated</option><option value=\"accepted\">Accepted</option>\n                    </select>\n                  </div>\n                </div>\n                <OwnerSelect value={form.owner || ''} onChange={v => setForm({ ...form, owner: v })} label=\"Owner\" placeholder=\"Select risk owner...\" />\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Mitigation</label>\n                  <textarea value={form.mitigation || ''} onChange={e => setForm({ ...form, mitigation: e.target.value })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] placeholder:text-[var(--gm-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)] min-h-[60px] resize-y\" placeholder=\"Mitigation strategy...\" />\n                </div>\n                <div className=\"flex gap-2 pt-2\">\n                  <button type=\"button\" onClick={onClose} className=\"flex-1 px-4 py-2.5 rounded-lg bg-[var(--gm-interactive-secondary)] text-[var(--gm-text-primary)] text-sm font-medium hover:bg-[var(--gm-surface-hover)]\">Cancel</button>\n                  <button type=\"submit\" className=\"flex-1 px-4 py-2.5 rounded-lg bg-blue-600 text-white text-sm font-medium hover:bg-blue-700\">{mode === 'create' ? 'Create' : 'Save'}</button>\n                </div>\n              </form>\n            </div>\n          </motion.div>\n        </>\n      )}\n    </AnimatePresence>\n  );\n};\n\nconst RiskDetail = ({ risk, onBack, onEdit, onDelete }: { risk: Risk; onBack: () => void; onEdit: (r: Risk) => void; onDelete?: (id: string) => void }) => {\n  const [aiLoading, setAiLoading] = useState(false);\n  const [aiInsights, setAiInsights] = useState<string[]>([]);\n  const chatMut = useSotChat();\n\n  const riskScore = risk.impact === 'high' && risk.likelihood === 'high' ? 'Critical' :\n    (risk.impact === 'high' || risk.likelihood === 'high') ? 'High' :\n      risk.impact === 'medium' && risk.likelihood === 'medium' ? 'Medium' : 'Low';\n\n  const handleAnalyze = async () => {\n    setAiLoading(true);\n    chatMut.mutate({ message: `Analyze this project risk and provide insights:\\nRisk: \"${risk.content}\"\\nImpact: ${risk.impact}, Likelihood: ${risk.likelihood}, Status: ${risk.status}\\nOwner: ${risk.owner || 'none'}\\nMitigation: ${risk.mitigation || 'none'}\\nProvide: risk assessment, related risks, and recommendations.` }, {\n      onSuccess: (d) => {\n        const resp = (d as Record<string, unknown>)?.response as string;\n        if (resp) setAiInsights(resp.split('\\n').filter(l => l.trim()));\n        setAiLoading(false);\n        toast.success('AI risk analysis complete');\n      },\n      onError: () => { setAiLoading(false); toast.error('AI analysis failed'); },\n    });\n  };\n\n  return (\n    <motion.div initial={{ opacity: 0, x: 20 }} animate={{ opacity: 1, x: 0 }} className=\"space-y-4\">\n      <div className=\"flex items-center gap-3\">\n        <button onClick={onBack} className=\"w-8 h-8 rounded-lg bg-[var(--gm-interactive-secondary)] flex items-center justify-center hover:bg-[var(--gm-surface-hover)]\"><ArrowLeft className=\"w-4 h-4 text-[var(--gm-text-tertiary)]\" /></button>\n        <div className=\"flex-1\"><h2 className=\"text-lg font-semibold text-[var(--gm-text-primary)]\">{risk.content || risk.description || '(untitled risk)'}</h2><p className=\"text-xs text-[var(--gm-text-tertiary)]\">Risk #{risk.id?.substring(0, 8)}</p></div>\n        <button onClick={handleAnalyze} disabled={aiLoading} className=\"px-3 py-1.5 rounded-lg bg-purple-500/10 text-purple-400 text-xs font-medium hover:bg-purple-500/20 flex items-center gap-1.5 disabled:opacity-50\">\n          {aiLoading ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Sparkles className=\"w-3.5 h-3.5\" />} Analyze\n        </button>\n        <button onClick={() => onEdit(risk)} className=\"px-3 py-1.5 rounded-lg bg-[var(--gm-interactive-secondary)] text-[var(--gm-text-primary)] text-xs hover:bg-[var(--gm-surface-hover)] flex items-center gap-1.5\"><Edit2 className=\"w-3.5 h-3.5\" /> Edit</button>\n        {onDelete && <button onClick={() => { onDelete(risk.id); onBack(); }} className=\"px-3 py-1.5 rounded-lg bg-red-500/10 text-red-400 text-xs hover:bg-red-500/20 flex items-center gap-1.5\"><Trash2 className=\"w-3.5 h-3.5\" /> Delete</button>}\n      </div>\n      <div className=\"flex gap-2\">\n        <span className={`text-xs px-3 py-1 rounded-full font-medium ${statusColor(risk.status)}`}>{risk.status || '—'}</span>\n        <span className={`text-xs px-3 py-1 rounded-full font-medium ${levelColor(risk.impact)}`}>Impact: {risk.impact || '—'}</span>\n        <span className={`text-xs px-3 py-1 rounded-full font-medium ${levelColor(risk.likelihood)}`}>Likelihood: {risk.likelihood || '—'}</span>\n      </div>\n      <div className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-4\">\n        <h3 className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider mb-2\">Description</h3>\n        <p className=\"text-sm text-[var(--gm-text-primary)]\">{risk.mitigation || 'No mitigation plan defined'}</p>\n      </div>\n      <div className=\"grid grid-cols-2 gap-3\">\n        <div className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 mb-2\"><User className=\"w-3.5 h-3.5 text-[var(--gm-text-tertiary)]\" /><span className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase\">Owner</span></div>\n          {risk.owner ? <OwnerBadge name={risk.owner} size=\"md\" /> : <p className=\"text-sm text-[var(--gm-text-tertiary)]\">Unassigned</p>}\n        </div>\n        <div className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 mb-2\"><AlertTriangle className=\"w-3.5 h-3.5 text-[var(--gm-text-tertiary)]\" /><span className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase\">Risk Score</span></div>\n          <p className={`text-sm font-semibold ${riskScore === 'Critical' ? 'text-red-400' : riskScore === 'High' ? 'text-yellow-400' : 'text-[var(--gm-text-primary)]'}`}>{riskScore}</p>\n        </div>\n      </div>\n      {risk.mitigation && (\n        <div className=\"bg-green-500/5 border border-green-500/20 rounded-xl p-4\">\n          <h3 className=\"text-xs font-medium text-green-400 uppercase tracking-wider mb-2 flex items-center gap-1.5\"><Shield className=\"w-3.5 h-3.5\" /> Mitigation</h3>\n          <p className=\"text-sm text-[var(--gm-text-primary)]\">{risk.mitigation}</p>\n        </div>\n      )}\n      {aiInsights.length > 0 && (\n        <motion.div initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} className=\"bg-purple-500/5 border border-purple-500/20 rounded-xl p-4\">\n          <h3 className=\"text-xs font-medium text-purple-400 uppercase tracking-wider mb-2 flex items-center gap-1.5\"><Sparkles className=\"w-3.5 h-3.5\" /> AI Analysis</h3>\n          <ul className=\"space-y-1.5\">{aiInsights.map((ins, i) => <li key={i} className=\"text-sm text-[var(--gm-text-primary)]\">{ins}</li>)}</ul>\n        </motion.div>\n      )}\n    </motion.div>\n  );\n};\n\nconst RisksPanel = ({ initialData = [], onSave, onDelete }: { initialData?: Risk[]; onSave?: (r: Risk) => void; onDelete?: (id: string) => void }) => {\n  const [risks, setRisks] = useState<Risk[]>(initialData);\n  const chatMut = useSotChat();\n\n  useEffect(() => {\n    if (initialData) setRisks(initialData);\n  }, [initialData]);\n  const [statusFilter, setStatusFilter] = useState<StatusFilter>('all');\n  const [impactFilter, setImpactFilter] = useState<ImpactFilter>('all');\n  const [modalOpen, setModalOpen] = useState(false);\n  const [modalMode, setModalMode] = useState<'create' | 'edit'>('create');\n  const [editingItem, setEditingItem] = useState<Risk | null>(null);\n  const [detailItem, setDetailItem] = useState<Risk | null>(null);\n  const [aiLoading, setAiLoading] = useState(false);\n\n  const filtered = useMemo(() => {\n    let result = risks;\n    if (statusFilter !== 'all') result = result.filter(r => r.status === statusFilter);\n    if (impactFilter !== 'all') result = result.filter(r => r.impact === impactFilter);\n    return result;\n  }, [risks, statusFilter, impactFilter]);\n\n  const stats = useMemo(() => ({\n    total: risks.length,\n    open: risks.filter(r => r.status === 'open').length,\n    mitigated: risks.filter(r => r.status === 'mitigated').length,\n    critical: risks.filter(r => r.impact === 'high' && r.likelihood === 'high').length,\n  }), [risks]);\n\n  const handleSave = (r: Risk) => {\n    setRisks(prev => {\n      const idx = prev.findIndex(x => x.id === r.id);\n      if (idx >= 0) { const u = [...prev]; u[idx] = r; return u; }\n      return [...prev, r];\n    });\n    onSave?.(r);\n  };\n\n  const handleDelete = (id: string) => {\n    setRisks(prev => prev.filter(x => x.id !== id));\n    onDelete?.(id);\n    toast.success('Risk deleted');\n  };\n\n  const handleAiScan = async () => {\n    setAiLoading(true);\n    chatMut.mutate({ message: 'Scan the project for potential risks not yet identified. Return on line 1: risk title. Line 2: brief description. Line 3: impact (high/medium/low). Line 4: likelihood (high/medium/low).' }, {\n      onSuccess: (d) => {\n        const resp = (d as Record<string, unknown>)?.response as string;\n        if (resp) {\n          const lines = resp.split('\\n').filter(l => l.trim());\n          const title = lines[0]?.replace(/^[\"'\\-*\\d.]+\\s*/, '').trim() || resp.trim();\n          const desc = lines[1]?.replace(/^[\"'\\-*\\d.]+\\s*/, '').trim() || '';\n          const impMatch = resp.toLowerCase().match(/impact[:\\s]*(high|medium|low)/);\n          const likMatch = resp.toLowerCase().match(/likelihood[:\\s]*(high|medium|low)/);\n          const newR: Risk = {\n            id: `ai-${Date.now()}`, content: title, mitigation: desc,\n            impact: (impMatch?.[1] as Risk['impact']) || 'medium',\n            likelihood: (likMatch?.[1] as Risk['likelihood']) || 'medium',\n            status: 'open', owner: '',\n          };\n          setRisks(prev => [...prev, newR]);\n          onSave?.(newR);\n        }\n        setAiLoading(false);\n        toast.success('AI identified a new risk');\n      },\n      onError: () => { setAiLoading(false); toast.error('AI risk scan failed'); },\n    });\n  };\n\n  if (detailItem) {\n    return <RiskDetail risk={detailItem} onBack={() => setDetailItem(null)} onEdit={r => { setDetailItem(null); setEditingItem(r); setModalMode('edit'); setModalOpen(true); }} onDelete={handleDelete} />;\n  }\n\n  return (\n    <div className=\"space-y-3\">\n      <div className=\"flex gap-2 flex-wrap\">\n        {[\n          { label: 'Total', value: stats.total, color: 'text-[var(--gm-text-primary)]' },\n          { label: 'Open', value: stats.open, color: 'text-red-400' },\n          { label: 'Mitigated', value: stats.mitigated, color: 'text-green-400' },\n          { label: 'Critical', value: stats.critical, color: 'text-red-400' },\n        ].map(s => (\n          <div key={s.label} className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 flex items-center gap-2\">\n            <span className={`text-lg font-bold ${s.color}`}>{s.value}</span>\n            <span className=\"text-[10px] text-[var(--gm-text-tertiary)] uppercase tracking-wider\">{s.label}</span>\n          </div>\n        ))}\n      </div>\n      <div className=\"flex items-center gap-2 flex-wrap\">\n        <select value={statusFilter} onChange={e => setStatusFilter(e.target.value as StatusFilter)} className=\"bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-1.5 text-xs text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\">\n          <option value=\"all\">All statuses</option><option value=\"open\">Open</option><option value=\"mitigated\">Mitigated</option><option value=\"accepted\">Accepted</option>\n        </select>\n        <select value={impactFilter} onChange={e => setImpactFilter(e.target.value as ImpactFilter)} className=\"bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-1.5 text-xs text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\">\n          <option value=\"all\">All impacts</option><option value=\"high\">High</option><option value=\"medium\">Medium</option><option value=\"low\">Low</option>\n        </select>\n        <div className=\"flex-1\" />\n        <button onClick={handleAiScan} disabled={aiLoading} className=\"px-3 py-1.5 rounded-lg bg-purple-500/10 text-purple-400 text-xs font-medium hover:bg-purple-500/20 flex items-center gap-1.5 disabled:opacity-50\">\n          {aiLoading ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Sparkles className=\"w-3.5 h-3.5\" />} AI Risk Scan\n        </button>\n        <button onClick={() => { setEditingItem(null); setModalMode('create'); setModalOpen(true); }} className=\"px-3 py-1.5 rounded-lg bg-blue-600 text-white text-xs font-medium hover:bg-blue-700 flex items-center gap-1.5\">\n          <Plus className=\"w-3.5 h-3.5\" /> Add Risk\n        </button>\n      </div>\n      <div className=\"space-y-2\">\n        {filtered.length === 0 ? (\n          <p className=\"text-sm text-[var(--gm-text-tertiary)] text-center py-8\">No risks match the current filter</p>\n        ) : filtered.map(r => (\n          <motion.div key={r.id} layout initial={{ opacity: 0 }} animate={{ opacity: 1 }} className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-3.5 hover:border-blue-500/30 transition-colors cursor-pointer group\" onClick={() => setDetailItem(r)}>\n            <div className=\"flex items-start justify-between gap-3\">\n              <div className=\"flex-1 min-w-0\">\n                <p className=\"text-sm font-medium text-[var(--gm-text-primary)] truncate group-hover:text-blue-400 transition-colors\">{r.content || r.description || '(untitled risk)'}</p>\n                <p className=\"text-xs text-[var(--gm-text-tertiary)] mt-0.5 line-clamp-1\">{r.mitigation || ''}</p>\n              </div>\n              <span className={`text-[10px] px-2 py-0.5 rounded-full font-medium ${statusColor(r.status)}`}>{r.status || '—'}</span>\n            </div>\n            <div className=\"flex items-center justify-between mt-2.5\">\n              <div className=\"flex gap-1.5\">\n                <span className={`text-[10px] px-2 py-0.5 rounded-full font-medium ${levelColor(r.impact)}`}>Impact: {r.impact || '—'}</span>\n                <span className={`text-[10px] px-2 py-0.5 rounded-full font-medium ${levelColor(r.likelihood)}`}>Likelihood: {r.likelihood || '—'}</span>\n              </div>\n              {r.owner ? <OwnerBadge name={r.owner} size=\"sm\" /> : <span className=\"text-[10px] text-[var(--gm-text-tertiary)]\">No owner</span>}\n            </div>\n            {r.mitigation && <p className=\"text-xs text-green-400 mt-2 line-clamp-1\">{r.mitigation}</p>}\n          </motion.div>\n        ))}\n      </div>\n      <RiskModal open={modalOpen} onClose={() => setModalOpen(false)} onSave={handleSave} risk={editingItem} mode={modalMode} />\n    </div>\n  );\n};\n\nexport default RisksPanel;\n","import { useState, useEffect } from 'react';\nimport { X, Sparkles, Wand2, Loader2 } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { toast } from 'sonner';\nimport type { Action, Sprint, UserStory } from '@/types/godmode';\nimport { useAiSuggestTask, useSotChat } from '../../hooks/useGodMode';\nimport { useSprints } from '../../hooks/useAdmin';\nimport OwnerSelect from './OwnerSelect';\n\ninterface ActionModalProps {\n  open: boolean;\n  onClose: () => void;\n  onSave: (action: Action) => void;\n  action?: Action | null;\n  mode: 'create' | 'edit';\n  sprints?: Sprint[];\n  userStories?: UserStory[];\n}\n\nconst emptyAction: Omit<Action, 'id'> = {\n  task: '',\n  description: '',\n  owner: '',\n  deadline: '',\n  status: 'pending',\n  priority: 'medium',\n  sprint_id: '',\n  parent_story_id: '',\n};\n\nconst ActionModal = ({ open, onClose, onSave, action, mode, sprints: propSprints, userStories = [] }: ActionModalProps) => {\n  const [form, setForm] = useState<Omit<Action, 'id'>>(emptyAction);\n  const [aiLoading, setAiLoading] = useState<string | null>(null);\n  const suggestTask = useAiSuggestTask();\n  const chatMut = useSotChat();\n  const { data: sprintsData } = useSprints();\n  const sprints = propSprints ?? (sprintsData as { sprints?: Sprint[] })?.sprints ?? [];\n\n  useEffect(() => {\n    if (action && mode === 'edit') {\n      const { id, ...rest } = action;\n      setForm(rest);\n    } else {\n      setForm(emptyAction);\n    }\n  }, [action, mode, open]);\n\n  const storiesForSprint = userStories.filter(s => (s.sprint_id || s.sprintId) === form.sprint_id);\n\n  const handleAiSuggest = async (field: 'title' | 'description') => {\n    setAiLoading(field);\n    if (field === 'title') {\n      chatMut.mutate({ message: 'Suggest one concise action item title for this project. Return only the title text.' }, {\n        onSuccess: (d) => {\n          const resp = (d as Record<string, unknown>)?.response as string;\n          if (resp) setForm(prev => ({ ...prev, title: resp.replace(/^[\"'\\-*\\d.]+\\s*/, '').trim() }));\n          setAiLoading(null);\n          toast.success('AI suggestion applied to title');\n        },\n        onError: () => { setAiLoading(null); toast.error('AI suggestion failed'); },\n      });\n    } else {\n      const input = form.task || 'a new project task';\n      suggestTask.mutate({ user_input: input }, {\n        onSuccess: (d) => {\n          const parts: string[] = [];\n          if (d.description) parts.push(d.description);\n          if (d.definition_of_done) parts.push(`Definition of Done: ${d.definition_of_done}`);\n          if (d.acceptance_criteria) parts.push(`Acceptance Criteria: ${d.acceptance_criteria}`);\n          if (d.size_estimate) parts.push(`Estimate: ${d.size_estimate}`);\n          const text = parts.join('\\n\\n');\n          setForm(prev => ({ ...prev, description: prev.description ? `${prev.description}\\n\\n${text}` : text }));\n          if (d.task && !form.task) setForm(prev => ({ ...prev, task: d.task }));\n          setAiLoading(null);\n          toast.success('AI suggestion applied to description');\n        },\n        onError: () => { setAiLoading(null); toast.error('AI suggestion failed'); },\n      });\n    }\n  };\n\n  const handleAiRefine = async () => {\n    if (!form.task && !form.description) { toast.error('Add a title or description first'); return; }\n    setAiLoading('refine');\n    chatMut.mutate({ message: `Refine this action item. Clarify scope, add measurable outcomes, identify blockers:\\nTask: \"${form.task}\"\\nDescription: \"${form.description}\"` }, {\n      onSuccess: (d) => {\n        const resp = (d as Record<string, unknown>)?.response as string;\n        if (resp) setForm(prev => ({ ...prev, description: prev.description ? `${prev.description}\\n\\n${resp}` : resp }));\n        setAiLoading(null);\n        toast.success('Action refined with AI');\n      },\n      onError: () => { setAiLoading(null); toast.error('AI refinement failed'); },\n    });\n  };\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    const taskText = (form.task || form.title || '').trim();\n    if (!taskText) return;\n    onSave({\n      id: action?.id || String(Date.now()),\n      ...form,\n      task: taskText,\n      created_at: action?.created_at || new Date().toISOString(),\n      updated_at: new Date().toISOString(),\n    });\n    onClose();\n  };\n\n  return (\n    <AnimatePresence>\n      {open && (\n        <>\n          <div className=\"fixed inset-0 bg-black/80 backdrop-blur-sm z-50\" onClick={onClose} />\n          <motion.div initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} exit={{ opacity: 0, scale: 0.95 }} className=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\n            <div className=\"bg-[var(--gm-bg-elevated)] border border-[var(--gm-border-primary)] rounded-2xl shadow-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto\" onClick={e => e.stopPropagation()}>\n              <div className=\"flex items-center justify-between p-5 border-b border-[var(--gm-border-primary)]\" style={{ background: 'linear-gradient(to right, rgba(37,99,235,0.18), rgba(37,99,235,0.05))' }}>\n                <h2 className=\"text-lg font-semibold text-white\">{mode === 'create' ? 'New Action' : 'Edit Action'}</h2>\n                <button onClick={onClose} className=\"w-8 h-8 rounded-lg hover:bg-white/10 flex items-center justify-center\"><X className=\"w-4 h-4 text-slate-400\" /></button>\n              </div>\n              <div className=\"px-5 pt-4 flex gap-2\">\n                <button type=\"button\" onClick={() => handleAiSuggest('title')} disabled={!!aiLoading} className=\"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-blue-500/10 text-blue-400 text-xs font-medium hover:bg-blue-500/20 disabled:opacity-50\">\n                  {aiLoading === 'title' ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Sparkles className=\"w-3.5 h-3.5\" />} Suggest Title\n                </button>\n                <button type=\"button\" onClick={() => handleAiSuggest('description')} disabled={!!aiLoading} className=\"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-blue-500/10 text-blue-400 text-xs font-medium hover:bg-blue-500/20 disabled:opacity-50\">\n                  {aiLoading === 'description' ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Sparkles className=\"w-3.5 h-3.5\" />} Suggest Description\n                </button>\n                <button type=\"button\" onClick={handleAiRefine} disabled={!!aiLoading} className=\"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-blue-500/10 text-blue-400 text-xs font-medium hover:bg-blue-500/20 disabled:opacity-50\">\n                  {aiLoading === 'refine' ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Wand2 className=\"w-3.5 h-3.5\" />} Refine with AI\n                </button>\n              </div>\n              <form onSubmit={handleSubmit} className=\"p-5 space-y-4\">\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Title *</label>\n                  <input value={form.title} onChange={e => setForm({ ...form, title: e.target.value })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] placeholder:text-[var(--gm-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\" placeholder=\"Action title...\" required />\n                </div>\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Description</label>\n                  <textarea value={form.description} onChange={e => setForm({ ...form, description: e.target.value })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] placeholder:text-[var(--gm-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)] min-h-[80px] resize-y\" placeholder=\"Describe the action...\" />\n                </div>\n                <div className=\"grid grid-cols-2 gap-3\">\n                  <OwnerSelect value={form.owner || ''} onChange={v => setForm({ ...form, owner: v })} label=\"Owner\" placeholder=\"Select assignee...\" />\n                  <div>\n                    <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Deadline</label>\n                    <input type=\"date\" value={form.deadline || ''} onChange={e => setForm({ ...form, deadline: e.target.value })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\" />\n                  </div>\n                </div>\n                <div className=\"grid grid-cols-2 gap-3\">\n                  <div>\n                    <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Status</label>\n                    <select value={form.status} onChange={e => setForm({ ...form, status: e.target.value as Action['status'] })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\">\n                      <option value=\"pending\">Pending</option><option value=\"in_progress\">In Progress</option><option value=\"completed\">Completed</option><option value=\"overdue\">Overdue</option>\n                    </select>\n                  </div>\n                  <div>\n                    <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Priority</label>\n                    <select value={form.priority} onChange={e => setForm({ ...form, priority: e.target.value as Action['priority'] })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\">\n                      <option value=\"high\">High</option><option value=\"medium\">Medium</option><option value=\"low\">Low</option>\n                    </select>\n                  </div>\n                </div>\n                <div className=\"grid grid-cols-2 gap-3\">\n                  <div>\n                    <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Sprint</label>\n                    <select value={form.sprint_id || ''} onChange={e => setForm({ ...form, sprint_id: e.target.value, parent_story_id: '' })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\">\n                      <option value=\"\">No sprint</option>\n                      {sprints.map(s => <option key={s.id} value={s.id}>{s.name || '(unnamed)'}</option>)}\n                    </select>\n                  </div>\n                  <div>\n                    <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">User Story</label>\n                    <select value={form.parent_story_id || ''} onChange={e => setForm({ ...form, parent_story_id: e.target.value })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\" disabled={!form.sprint_id}>\n                      <option value=\"\">No story</option>\n                      {storiesForSprint.map(s => <option key={s.id} value={s.id}>{s.title || '(untitled)'}</option>)}\n                    </select>\n                  </div>\n                </div>\n                <div className=\"flex gap-2 pt-2\">\n                  <button type=\"button\" onClick={onClose} className=\"flex-1 px-4 py-2.5 rounded-lg bg-[var(--gm-interactive-secondary)] text-[var(--gm-text-primary)] text-sm font-medium hover:bg-[var(--gm-surface-hover)]\">Cancel</button>\n                  <button type=\"submit\" className=\"flex-1 px-4 py-2.5 rounded-lg bg-blue-600 text-white text-sm font-medium hover:bg-blue-700\">{mode === 'create' ? 'Create Action' : 'Save Changes'}</button>\n                </div>\n              </form>\n            </div>\n          </motion.div>\n        </>\n      )}\n    </AnimatePresence>\n  );\n};\n\nexport default ActionModal;\n","import { useState } from 'react';\nimport { ArrowLeft, Edit2, Calendar, User, Flag, Clock, BookOpen, Target, Sparkles, Wand2, Loader2, Trash2 } from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport { toast } from 'sonner';\nimport type { Action } from '@/types/godmode';\nimport { useSotChat } from '../../hooks/useGodMode';\nimport OwnerBadge from './OwnerBadge';\n\nconst statusColor = (s: string) =>\n  s === 'completed' ? 'bg-success/10 text-success' :\n    s === 'overdue' ? 'bg-destructive/10 text-destructive' :\n      s === 'in_progress' ? 'bg-primary/10 text-primary' :\n        'bg-muted text-[var(--gm-text-tertiary)]';\n\nconst priorityColor = (p: string) =>\n  p === 'high' ? 'bg-destructive/10 text-destructive' :\n    p === 'medium' ? 'bg-warning/10 text-warning' :\n      'bg-muted text-[var(--gm-text-tertiary)]';\n\ninterface ActionDetailViewProps {\n  action: Action;\n  onBack: () => void;\n  onEdit: (action: Action) => void;\n  onDelete?: (id: string) => void;\n}\n\nconst ActionDetailView = ({ action, onBack, onEdit, onDelete }: ActionDetailViewProps) => {\n  const [aiLoading, setAiLoading] = useState<string | null>(null);\n  const [aiInsights, setAiInsights] = useState<string[]>([]);\n  const chatMut = useSotChat();\n\n  const handleAiAnalyze = async () => {\n    setAiLoading('analyze');\n    chatMut.mutate({ message: `Analyze this action item and provide insights on urgency, dependencies, and risks:\\nTitle: \"${action.title}\"\\nDescription: \"${action.description}\"\\nStatus: ${action.status}\\nPriority: ${action.priority}\\nOwner: ${action.owner || 'unassigned'}\\nDeadline: ${action.deadline || 'none'}\\nSprint: ${action.sprintId || 'none'}` }, {\n      onSuccess: (d) => {\n        const resp = (d as Record<string, unknown>)?.response as string;\n        if (resp) setAiInsights(resp.split('\\n').filter(l => l.trim()));\n        setAiLoading(null);\n        toast.success('AI analysis complete');\n      },\n      onError: () => { setAiLoading(null); toast.error('AI analysis failed'); },\n    });\n  };\n\n  const handleAiSuggestNextSteps = async () => {\n    setAiLoading('steps');\n    chatMut.mutate({ message: `Suggest 3 concrete next steps for this action:\\nTitle: \"${action.title}\"\\nDescription: \"${action.description}\"\\nStatus: ${action.status}\\nReturn each step on a new line.` }, {\n      onSuccess: (d) => {\n        const resp = (d as Record<string, unknown>)?.response as string;\n        if (resp) setAiInsights(prev => [...prev, ...resp.split('\\n').filter(l => l.trim())]);\n        setAiLoading(null);\n        toast.success('AI suggested next steps');\n      },\n      onError: () => { setAiLoading(null); toast.error('AI suggestion failed'); },\n    });\n  };\n\n  return (\n    <motion.div initial={{ opacity: 0, x: 20 }} animate={{ opacity: 1, x: 0 }} className=\"space-y-4\">\n      <div className=\"flex items-center gap-3\">\n        <button onClick={onBack} className=\"w-8 h-8 rounded-lg bg-[var(--gm-interactive-secondary)] flex items-center justify-center hover:bg-[var(--gm-surface-hover)]\"><ArrowLeft className=\"w-4 h-4 text-[var(--gm-text-tertiary)]\" /></button>\n        <div className=\"flex-1\">\n          <h2 className=\"text-lg font-semibold text-[var(--gm-text-primary)]\">{action.title || action.task || action.content || '(untitled action)'}</h2>\n          <p className=\"text-xs text-[var(--gm-text-tertiary)]\">Action #{action.id}</p>\n        </div>\n        <div className=\"flex gap-2\">\n          <button onClick={handleAiAnalyze} disabled={!!aiLoading} className=\"px-3 py-1.5 rounded-lg bg-accent/10 text-accent text-xs font-medium hover:bg-accent/20 flex items-center gap-1.5 disabled:opacity-50\">\n            {aiLoading === 'analyze' ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Sparkles className=\"w-3.5 h-3.5\" />} Analyze\n          </button>\n          <button onClick={handleAiSuggestNextSteps} disabled={!!aiLoading} className=\"px-3 py-1.5 rounded-lg bg-primary/10 text-primary text-xs font-medium hover:bg-primary/20 flex items-center gap-1.5 disabled:opacity-50\">\n            {aiLoading === 'steps' ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Wand2 className=\"w-3.5 h-3.5\" />} Suggest Steps\n          </button>\n          <button onClick={() => onEdit(action)} className=\"px-3 py-1.5 rounded-lg bg-[var(--gm-interactive-secondary)] text-secondary-foreground text-xs hover:bg-[var(--gm-surface-hover)] flex items-center gap-1.5\"><Edit2 className=\"w-3.5 h-3.5\" /> Edit</button>\n          {onDelete && <button onClick={() => { onDelete(action.id); onBack(); }} className=\"px-3 py-1.5 rounded-lg bg-destructive/10 text-destructive text-xs hover:bg-destructive/20 flex items-center gap-1.5\"><Trash2 className=\"w-3.5 h-3.5\" /> Delete</button>}\n        </div>\n      </div>\n\n      <div className=\"flex gap-2\">\n        <span className={`text-xs px-3 py-1 rounded-full font-medium ${statusColor(action.status)}`}>{(action.status || '').replace('_', ' ')}</span>\n        <span className={`text-xs px-3 py-1 rounded-full font-medium ${priorityColor(action.priority)}`}>{action.priority} priority</span>\n      </div>\n\n      <div className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-4\">\n        <h3 className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider mb-2\">Description</h3>\n        <p className=\"text-sm text-[var(--gm-text-primary)] whitespace-pre-wrap\">{action.description || '—'}</p>\n      </div>\n\n      <div className=\"grid grid-cols-2 gap-3\">\n        <div className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 mb-2\"><User className=\"w-3.5 h-3.5 text-[var(--gm-text-tertiary)]\" /><span className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Owner</span></div>\n          {action.owner ? <OwnerBadge name={action.owner} size=\"md\" /> : <p className=\"text-sm text-[var(--gm-text-tertiary)]\">Unassigned</p>}\n        </div>\n        <div className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 mb-1\"><Calendar className=\"w-3.5 h-3.5 text-[var(--gm-text-tertiary)]\" /><span className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Deadline</span></div>\n          <p className=\"text-sm text-[var(--gm-text-primary)]\">{action.deadline || 'No deadline'}</p>\n        </div>\n        <div className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 mb-1\"><Target className=\"w-3.5 h-3.5 text-[var(--gm-text-tertiary)]\" /><span className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Sprint</span></div>\n          <p className=\"text-sm text-[var(--gm-text-primary)]\">{action.sprintId || 'No sprint'}</p>\n        </div>\n        <div className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 mb-1\"><BookOpen className=\"w-3.5 h-3.5 text-[var(--gm-text-tertiary)]\" /><span className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">User Story</span></div>\n          <p className=\"text-sm text-[var(--gm-text-primary)]\">{action.storyId || 'No story'}</p>\n        </div>\n      </div>\n\n      {aiInsights.length > 0 && (\n        <motion.div initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} className=\"bg-accent/5 border border-accent/20 rounded-xl p-4\">\n          <h3 className=\"text-xs font-medium text-accent uppercase tracking-wider mb-2 flex items-center gap-1.5\"><Sparkles className=\"w-3.5 h-3.5\" /> AI Insights</h3>\n          <ul className=\"space-y-1.5\">{aiInsights.map((insight, i) => <li key={i} className=\"text-sm text-[var(--gm-text-primary)]\">{insight}</li>)}</ul>\n        </motion.div>\n      )}\n\n      <div className=\"flex gap-4 text-[10px] text-[var(--gm-text-tertiary)]\">\n        {action.createdAt && <span className=\"flex items-center gap-1\"><Clock className=\"w-3 h-3\" /> Created: {action.createdAt}</span>}\n        {action.updatedAt && <span className=\"flex items-center gap-1\"><Clock className=\"w-3 h-3\" /> Updated: {action.updatedAt}</span>}\n      </div>\n    </motion.div>\n  );\n};\n\nexport default ActionDetailView;\n","/**\n * Purpose:\n *   Modal form for creating a new sprint with name, date range, and\n *   context/goals description.\n *\n * Responsibilities:\n *   - Renders a form with sprint name (required), start date, end date,\n *     and context/goals textarea\n *   - Generates a sprint ID using timestamp prefix \"sp-\"\n *   - Sets initial status to \"planning\"\n *   - Resets form fields after successful submission\n *\n * Key dependencies:\n *   - framer-motion (AnimatePresence): modal enter/exit animations\n *   - Sprint (godmode types): sprint data shape\n *\n * Side effects:\n *   - None\n *\n * Notes:\n *   - Does not validate that end date is after start date.\n *   - Sprint ID uses Date.now() which could collide in rapid creation\n *     scenarios, but is acceptable for the current use case.\n */\nimport { useState } from 'react';\nimport { X, Loader2 } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { toast } from 'sonner';\nimport type { Sprint } from '@/types/godmode';\nimport { useCreateSprint } from '../../hooks/useKrisp';\n\ninterface CreateSprintModalProps {\n  open: boolean;\n  onClose: () => void;\n  onSave?: (sprint: Sprint) => void;\n}\n\nconst CreateSprintModal = ({ open, onClose, onSave }: CreateSprintModalProps) => {\n  const [form, setForm] = useState({\n    name: '',\n    start_date: '',\n    end_date: '',\n    context: '',\n    goals: '',\n    analysis_start_date: '',\n    analysis_end_date: '',\n  });\n  const createMut = useCreateSprint();\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!form.name.trim() || !form.start_date || !form.end_date) return;\n    createMut.mutate({\n      name: form.name,\n      start_date: form.start_date,\n      end_date: form.end_date,\n      context: form.context || undefined,\n      goals: form.goals.trim() ? form.goals.split('\\n').filter(g => g.trim()) : undefined,\n      analysis_start_date: form.analysis_start_date || undefined,\n      analysis_end_date: form.analysis_end_date || undefined,\n    }, {\n      onSuccess: (data) => {\n        const sprint = (data as { sprint: Sprint }).sprint;\n        onSave?.(sprint);\n        toast.success('Sprint created');\n        setForm({ name: '', start_date: '', end_date: '', context: '', goals: '', analysis_start_date: '', analysis_end_date: '' });\n        onClose();\n      },\n      onError: () => toast.error('Failed to create sprint'),\n    });\n  };\n\n  return (\n    <AnimatePresence>\n      {open && (\n        <>\n          <div className=\"fixed inset-0 bg-black/80 backdrop-blur-sm z-50\" onClick={onClose} />\n          <motion.div\n            initial={{ opacity: 0, scale: 0.95 }}\n            animate={{ opacity: 1, scale: 1 }}\n            exit={{ opacity: 0, scale: 0.95 }}\n            className=\"fixed inset-0 z-50 flex items-center justify-center p-4\"\n          >\n            <div className=\"bg-[var(--gm-bg-elevated)] border border-[var(--gm-border-primary)] rounded-2xl shadow-2xl w-full max-w-md\" onClick={e => e.stopPropagation()}>\n              <div className=\"flex items-center justify-between p-5 border-b border-[var(--gm-border-primary)]\" style={{ background: 'linear-gradient(to right, rgba(37,99,235,0.18), rgba(37,99,235,0.05))' }}>\n                <h2 className=\"text-lg font-semibold text-white\">Create Sprint</h2>\n                <button onClick={onClose} className=\"w-8 h-8 rounded-lg hover:bg-white/10 flex items-center justify-center transition-colors\">\n                  <X className=\"w-4 h-4 text-slate-400\" />\n                </button>\n              </div>\n\n              <form onSubmit={handleSubmit} className=\"p-5 space-y-4\">\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Sprint Name *</label>\n                  <input\n                    value={form.name}\n                    onChange={e => setForm({ ...form, name: e.target.value })}\n                    className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] placeholder:text-[var(--gm-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\"\n                    placeholder=\"e.g. Sprint 4 — Analytics\"\n                    required\n                  />\n                </div>\n\n                <div className=\"grid grid-cols-2 gap-3\">\n                  <div>\n                    <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Start Date *</label>\n                    <input\n                      type=\"date\"\n                      value={form.start_date}\n                      onChange={e => setForm({ ...form, start_date: e.target.value })}\n                      className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\"\n                      required\n                    />\n                  </div>\n                  <div>\n                    <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">End Date *</label>\n                    <input\n                      type=\"date\"\n                      value={form.end_date}\n                      onChange={e => setForm({ ...form, end_date: e.target.value })}\n                      className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\"\n                      required\n                    />\n                  </div>\n                </div>\n\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Context</label>\n                  <input\n                    value={form.context}\n                    onChange={e => setForm({ ...form, context: e.target.value })}\n                    className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] placeholder:text-[var(--gm-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\"\n                    placeholder=\"Sprint context...\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Goals (one per line)</label>\n                  <textarea\n                    value={form.goals}\n                    onChange={e => setForm({ ...form, goals: e.target.value })}\n                    className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] placeholder:text-[var(--gm-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)] min-h-[60px] resize-y\"\n                    placeholder=\"Define key goals for this sprint...\"\n                  />\n                </div>\n\n                <div className=\"grid grid-cols-2 gap-3\">\n                  <div>\n                    <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Analysis Start</label>\n                    <input\n                      type=\"date\"\n                      value={form.analysis_start_date}\n                      onChange={e => setForm({ ...form, analysis_start_date: e.target.value })}\n                      className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\"\n                    />\n                  </div>\n                  <div>\n                    <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Analysis End</label>\n                    <input\n                      type=\"date\"\n                      value={form.analysis_end_date}\n                      onChange={e => setForm({ ...form, analysis_end_date: e.target.value })}\n                      className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\"\n                    />\n                  </div>\n                </div>\n\n                <div className=\"flex gap-2 pt-2\">\n                  <button\n                    type=\"button\"\n                    onClick={onClose}\n                    className=\"flex-1 px-4 py-2.5 rounded-lg bg-[var(--gm-interactive-secondary)] text-[var(--gm-text-primary)] text-sm font-medium hover:bg-[var(--gm-surface-hover)] transition-colors\"\n                  >\n                    Cancel\n                  </button>\n                  <button\n                    type=\"submit\"\n                    disabled={createMut.isPending}\n                    className=\"flex-1 px-4 py-2.5 rounded-lg bg-blue-600 text-white text-sm font-medium hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center justify-center gap-2\"\n                  >\n                    {createMut.isPending && <Loader2 className=\"w-4 h-4 animate-spin\" />}\n                    Create Sprint\n                  </button>\n                </div>\n              </form>\n            </div>\n          </motion.div>\n        </>\n      )}\n    </AnimatePresence>\n  );\n};\n\nexport default CreateSprintModal;\n","/**\n * Purpose:\n *   Main panel for managing project actions (tasks/to-dos) within the\n *   Source of Truth module. Supports multiple view modes, filtering,\n *   CRUD operations, and AI-powered action suggestions.\n *\n * Responsibilities:\n *   - Renders actions in three view modes: flat list, grouped by sprint,\n *     grouped by user story\n *   - Provides status and sprint filters with a summary stats strip\n *   - CRUD: create, edit (via ActionModal), delete, and view detail\n *     (via ActionDetailView)\n *   - AI Suggest: generates placeholder AI-suggested actions and appends\n *     them to the list (simulated with setTimeout)\n *   - Sprint management: create sprints via CreateSprintModal\n *   - Collapsible accordion groups with animated expand/collapse\n *\n * Key dependencies:\n *   - ActionModal: create/edit form modal\n *   - ActionDetailView: single action detail with AI analysis\n *   - CreateSprintModal: sprint creation form\n *   - OwnerBadge: avatar+name badge for action owners\n *   - framer-motion: layout animations and group expand/collapse\n *   - sonner (toast): user feedback notifications\n *   - Action, Sprint, UserStory (godmode types): data shapes\n *\n * Side effects:\n *   - None (state is managed locally; parent is notified via onSave/onDelete)\n *\n * Notes:\n *   - AI suggestions are simulated with hardcoded data and delays.\n *   - User stories array is empty (hardcoded `[]`); the \"by story\" view\n *     is prepared but non-functional until the API is connected.\n *   - Actions and sprints are controlled via props (initialData/initialSprints)\n *     but also maintain local state, which can desync if props change\n *     without remounting.\n */\nimport { useState, useMemo, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Plus, List, Layers, BookOpen, Filter, Target, ChevronDown, ChevronRight, FileBarChart, Sparkles, Loader2, Trash2 } from 'lucide-react';\nimport { toast } from 'sonner';\nimport type { Action, Sprint, UserStory } from '@/types/godmode';\nimport { useSotChat } from '../../hooks/useGodMode';\nimport { useSprints } from '../../hooks/useAdmin';\nimport ActionModal from './ActionModal';\nimport ActionDetailView from './ActionDetailView';\nimport CreateSprintModal from './CreateSprintModal';\nimport OwnerBadge from './OwnerBadge';\n\ntype ViewMode = 'list' | 'by_sprint' | 'by_story';\ntype StatusFilter = 'all' | 'pending' | 'in_progress' | 'completed' | 'overdue';\n\nconst statusColor = (s: string) =>\n  s === 'completed' ? 'bg-green-500/10 text-green-400' :\n    s === 'overdue' ? 'bg-red-500/10 text-red-400' :\n      s === 'in_progress' ? 'bg-blue-500/10 text-blue-400' :\n        'bg-white/5 text-slate-400';\n\nconst priorityColor = (p: string) =>\n  p === 'high' ? 'bg-red-500/10 text-red-400' :\n    p === 'medium' ? 'bg-yellow-500/10 text-yellow-400' :\n      'bg-white/5 text-slate-400';\n\nconst sprintStatusColor = (s: string) =>\n  s === 'active' ? 'bg-green-500/10 text-green-400' :\n    s === 'completed' ? 'bg-white/5 text-slate-400' :\n      'bg-blue-500/10 text-blue-400';\n\nconst ActionsPanel = ({ initialData = [], initialSprints = [], onSave, onDelete }: { initialData?: Action[]; initialSprints?: Sprint[]; onSave?: (a: Action) => void; onDelete?: (id: string) => void }) => {\n  const [actions, setActions] = useState<Action[]>(initialData);\n  const chatMut = useSotChat();\n  const { data: sprintsData } = useSprints();\n  const apiSprints = (sprintsData as { sprints?: Sprint[] })?.sprints ?? [];\n  const sprints = apiSprints.length > 0 ? apiSprints : initialSprints;\n\n  useEffect(() => {\n    if (initialData) setActions(initialData);\n  }, [initialData]);\n  const [viewMode, setViewMode] = useState<ViewMode>('by_sprint');\n  const [statusFilter, setStatusFilter] = useState<StatusFilter>('all');\n  const [sprintFilter, setSprintFilter] = useState<string>('');\n  const [expandedGroups, setExpandedGroups] = useState<Set<string>>(new Set(['sp-2', 'sp-1', 'sp-3', 'no-sprint']));\n\n  // Modal states\n  const [actionModalOpen, setActionModalOpen] = useState(false);\n  const [actionModalMode, setActionModalMode] = useState<'create' | 'edit'>('create');\n  const [editingAction, setEditingAction] = useState<Action | null>(null);\n  const [sprintModalOpen, setSprintModalOpen] = useState(false);\n  const [detailAction, setDetailAction] = useState<Action | null>(null);\n  const [aiSuggestLoading, setAiSuggestLoading] = useState(false);\n\n  const handleAiSuggestActions = async () => {\n    setAiSuggestLoading(true);\n    chatMut.mutate({ message: 'Based on the project state, suggest one important action item. Return on line 1: the action title. Line 2: description. Line 3: priority (high/medium/low).' }, {\n      onSuccess: (d) => {\n        const resp = (d as Record<string, unknown>)?.response as string;\n        if (resp) {\n          const lines = resp.split('\\n').filter(l => l.trim());\n          const title = lines[0]?.replace(/^[\"'\\-*\\d.]+\\s*/, '').trim() || resp.trim();\n          const desc = lines[1]?.replace(/^[\"'\\-*\\d.]+\\s*/, '').trim() || '';\n          const priMatch = resp.toLowerCase().match(/(high|medium|low)/);\n          const newA: Action = {\n            id: `ai-${Date.now()}`, title, description: desc,\n            status: 'pending', priority: (priMatch?.[1] as Action['priority']) || 'medium',\n            owner: '', deadline: new Date(Date.now() + 7 * 86400000).toISOString().split('T')[0],\n            sprintId: sprints.find(s => s.status === 'active')?.id,\n            createdAt: new Date().toISOString().split('T')[0],\n          };\n          setActions(prev => [...prev, newA]);\n          onSave?.(newA);\n        }\n        setAiSuggestLoading(false);\n        toast.success('AI suggested a new action');\n      },\n      onError: () => { setAiSuggestLoading(false); toast.error('AI suggestion failed'); },\n    });\n  };\n\n  // Filter actions\n  const filtered = useMemo(() => {\n    let result = actions;\n    if (statusFilter !== 'all') result = result.filter(a => a.status === statusFilter);\n    if (sprintFilter) result = result.filter(a => (a.sprint_id || a.sprintId) === sprintFilter);\n    return result;\n  }, [actions, statusFilter, sprintFilter]);\n\n  // Stats for report strip\n  const stats = useMemo(() => ({\n    total: actions.length,\n    pending: actions.filter(a => a.status === 'pending').length,\n    inProgress: actions.filter(a => a.status === 'in_progress').length,\n    completed: actions.filter(a => a.status === 'completed').length,\n    overdue: actions.filter(a => a.status === 'overdue').length,\n  }), [actions]);\n\n  const toggleGroup = (id: string) => {\n    setExpandedGroups(prev => {\n      const next = new Set(prev);\n      next.has(id) ? next.delete(id) : next.add(id);\n      return next;\n    });\n  };\n\n  const handleSaveAction = (action: Action) => {\n    setActions(prev => {\n      const idx = prev.findIndex(a => a.id === action.id);\n      if (idx >= 0) {\n        const updated = [...prev];\n        updated[idx] = action;\n        return updated;\n      }\n      return [...prev, action];\n    });\n    onSave?.(action);\n  };\n\n  const handleDeleteAction = (id: string) => {\n    setActions(prev => prev.filter(a => a.id !== id));\n    onDelete?.(id);\n    toast.success('Action deleted');\n  };\n\n  const handleCreateSprint = (sprint: Sprint) => {\n    setExpandedGroups(prev => new Set([...prev, sprint.id]));\n  };\n\n  const openEditModal = (action: Action) => {\n    setEditingAction(action);\n    setActionModalMode('edit');\n    setActionModalOpen(true);\n  };\n\n  // If viewing detail\n  if (detailAction) {\n    return (\n      <ActionDetailView\n        action={detailAction}\n        onBack={() => setDetailAction(null)}\n        onEdit={(a) => {\n          setDetailAction(null);\n          openEditModal(a);\n        }}\n        onDelete={handleDeleteAction}\n      />\n    );\n  }\n\n  // Render an action card\n  const ActionCard = ({ action }: { action: Action }) => (\n    <motion.div\n      layout\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-3.5 hover:border-blue-500/30 transition-colors cursor-pointer group\"\n      onClick={() => setDetailAction(action)}\n    >\n      <div className=\"flex items-start justify-between gap-3\">\n        <div className=\"flex-1 min-w-0\">\n          <p className=\"text-sm font-medium text-[var(--gm-text-primary)] truncate group-hover:text-blue-400 transition-colors\">{action.task || action.title || action.content || '(no title)'}</p>\n          <p className=\"text-xs text-[var(--gm-text-tertiary)] mt-0.5 line-clamp-1\">{action.description || ''}</p>\n        </div>\n        <div className=\"flex gap-1.5 flex-shrink-0\">\n          {action.priority && <span className={`text-[10px] px-2 py-0.5 rounded-full font-medium ${priorityColor(action.priority)}`}>{action.priority}</span>}\n          {action.status && <span className={`text-[10px] px-2 py-0.5 rounded-full font-medium ${statusColor(action.status)}`}>{action.status.replace('_', ' ')}</span>}\n        </div>\n      </div>\n      <div className=\"flex items-center justify-between mt-2.5\">\n        {action.owner ? (\n          <OwnerBadge name={action.owner} size=\"sm\" />\n        ) : (\n          <span className=\"text-[11px] text-[var(--gm-text-tertiary)]\">Unassigned</span>\n        )}\n        {action.deadline && <span className=\"text-[10px] text-[var(--gm-text-tertiary)]\">📅 {action.deadline}</span>}\n      </div>\n    </motion.div>\n  );\n\n  // Group by sprint\n  const renderBySprint = () => {\n    const groups = sprints.map(sprint => ({\n      sprint,\n      actions: filtered.filter(a => a.sprintId === sprint.id),\n    }));\n    const unassigned = filtered.filter(a => !a.sprintId);\n\n    return (\n      <div className=\"space-y-3\">\n        {groups.map(({ sprint, actions: sprintActions }) => (\n          <div key={sprint.id} className=\"bg-[var(--gm-interactive-secondary)]/30 rounded-xl overflow-hidden\">\n            <button\n              onClick={() => toggleGroup(sprint.id)}\n              className=\"w-full flex items-center gap-2 px-4 py-3 hover:bg-[var(--gm-interactive-secondary)]/50 transition-colors text-left\"\n            >\n              {expandedGroups.has(sprint.id)\n                ? <ChevronDown className=\"w-4 h-4 text-[var(--gm-text-tertiary)]\" />\n                : <ChevronRight className=\"w-4 h-4 text-[var(--gm-text-tertiary)]\" />\n              }\n              <Target className=\"w-4 h-4 text-blue-400\" />\n              <span className=\"text-sm font-medium text-[var(--gm-text-primary)] flex-1\">{sprint.name || '(unnamed sprint)'}</span>\n              <span className={`text-[10px] px-2 py-0.5 rounded-full font-medium ${sprintStatusColor(sprint.status)}`}>{sprint.status || '—'}</span>\n              <span className=\"text-[10px] text-[var(--gm-text-tertiary)]\">{sprintActions.length} actions</span>\n            </button>\n            <AnimatePresence>\n              {expandedGroups.has(sprint.id) && (\n                <motion.div\n                  initial={{ height: 0, opacity: 0 }}\n                  animate={{ height: 'auto', opacity: 1 }}\n                  exit={{ height: 0, opacity: 0 }}\n                  className=\"overflow-hidden\"\n                >\n                  {sprint.context && (\n                    <p className=\"text-xs text-[var(--gm-text-tertiary)] px-4 pb-2\">{sprint.context}</p>\n                  )}\n                  <div className=\"px-3 pb-3 space-y-2\">\n                    {sprintActions.length === 0 ? (\n                      <p className=\"text-xs text-[var(--gm-text-tertiary)] text-center py-4\">No actions in this sprint</p>\n                    ) : (\n                      sprintActions.map(a => <ActionCard key={a.id} action={a} />)\n                    )}\n                  </div>\n                </motion.div>\n              )}\n            </AnimatePresence>\n          </div>\n        ))}\n\n        {unassigned.length > 0 && (\n          <div className=\"bg-[var(--gm-interactive-secondary)]/30 rounded-xl overflow-hidden\">\n            <button\n              onClick={() => toggleGroup('no-sprint')}\n              className=\"w-full flex items-center gap-2 px-4 py-3 hover:bg-[var(--gm-interactive-secondary)]/50 transition-colors text-left\"\n            >\n              {expandedGroups.has('no-sprint')\n                ? <ChevronDown className=\"w-4 h-4 text-[var(--gm-text-tertiary)]\" />\n                : <ChevronRight className=\"w-4 h-4 text-[var(--gm-text-tertiary)]\" />\n              }\n              <span className=\"text-sm font-medium text-[var(--gm-text-tertiary)] flex-1\">No Sprint</span>\n              <span className=\"text-[10px] text-[var(--gm-text-tertiary)]\">{unassigned.length} actions</span>\n            </button>\n            <AnimatePresence>\n              {expandedGroups.has('no-sprint') && (\n                <motion.div\n                  initial={{ height: 0, opacity: 0 }}\n                  animate={{ height: 'auto', opacity: 1 }}\n                  exit={{ height: 0, opacity: 0 }}\n                  className=\"overflow-hidden px-3 pb-3 space-y-2\"\n                >\n                  {unassigned.map(a => <ActionCard key={a.id} action={a} />)}\n                </motion.div>\n              )}\n            </AnimatePresence>\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  // Group by story (user stories fetched from API will be added later)\n  const userStories: UserStory[] = [];\n  const renderByStory = () => {\n    const storiesWithActions = userStories.map(story => ({\n      story,\n      actions: filtered.filter(a => a.storyId === story.id),\n    })).filter(g => g.actions.length > 0);\n    const noStory = filtered.filter(a => !a.storyId);\n\n    return (\n      <div className=\"space-y-3\">\n        {storiesWithActions.map(({ story, actions: storyActions }) => {\n          const sprint = sprints.find(s => s.id === story.sprintId);\n          return (\n            <div key={story.id} className=\"bg-[var(--gm-interactive-secondary)]/30 rounded-xl overflow-hidden\">\n              <button\n                onClick={() => toggleGroup(story.id)}\n                className=\"w-full flex items-center gap-2 px-4 py-3 hover:bg-[var(--gm-interactive-secondary)]/50 transition-colors text-left\"\n              >\n                {expandedGroups.has(story.id)\n                  ? <ChevronDown className=\"w-4 h-4 text-[var(--gm-text-tertiary)]\" />\n                  : <ChevronRight className=\"w-4 h-4 text-[var(--gm-text-tertiary)]\" />\n                }\n                <BookOpen className=\"w-4 h-4 text-accent\" />\n                <span className=\"text-sm font-medium text-[var(--gm-text-primary)] flex-1 truncate\">{story.title || '(untitled story)'}</span>\n                {sprint && <span className=\"text-[10px] text-[var(--gm-text-tertiary)]\">{sprint.name || '—'}</span>}\n                <span className=\"text-[10px] text-[var(--gm-text-tertiary)]\">{storyActions.length}</span>\n              </button>\n              <AnimatePresence>\n                {expandedGroups.has(story.id) && (\n                  <motion.div\n                    initial={{ height: 0, opacity: 0 }}\n                    animate={{ height: 'auto', opacity: 1 }}\n                    exit={{ height: 0, opacity: 0 }}\n                    className=\"overflow-hidden px-3 pb-3 space-y-2\"\n                  >\n                    {storyActions.map(a => <ActionCard key={a.id} action={a} />)}\n                  </motion.div>\n                )}\n              </AnimatePresence>\n            </div>\n          );\n        })}\n\n        {noStory.length > 0 && (\n          <div className=\"bg-[var(--gm-interactive-secondary)]/30 rounded-xl overflow-hidden\">\n            <button\n              onClick={() => toggleGroup('no-story')}\n              className=\"w-full flex items-center gap-2 px-4 py-3 hover:bg-[var(--gm-interactive-secondary)]/50 transition-colors text-left\"\n            >\n              {expandedGroups.has('no-story')\n                ? <ChevronDown className=\"w-4 h-4 text-[var(--gm-text-tertiary)]\" />\n                : <ChevronRight className=\"w-4 h-4 text-[var(--gm-text-tertiary)]\" />\n              }\n              <span className=\"text-sm font-medium text-[var(--gm-text-tertiary)] flex-1\">No Story</span>\n              <span className=\"text-[10px] text-[var(--gm-text-tertiary)]\">{noStory.length}</span>\n            </button>\n            <AnimatePresence>\n              {expandedGroups.has('no-story') && (\n                <motion.div\n                  initial={{ height: 0, opacity: 0 }}\n                  animate={{ height: 'auto', opacity: 1 }}\n                  exit={{ height: 0, opacity: 0 }}\n                  className=\"overflow-hidden px-3 pb-3 space-y-2\"\n                >\n                  {noStory.map(a => <ActionCard key={a.id} action={a} />)}\n                </motion.div>\n              )}\n            </AnimatePresence>\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  // Flat list\n  const renderList = () => (\n    <div className=\"space-y-2\">\n      {filtered.length === 0 ? (\n        <p className=\"text-sm text-[var(--gm-text-tertiary)] text-center py-8\">No actions match the current filter</p>\n      ) : (\n        filtered.map(a => <ActionCard key={a.id} action={a} />)\n      )}\n    </div>\n  );\n\n  return (\n    <div className=\"space-y-3\">\n      {/* Report strip */}\n      <div className=\"flex gap-2 flex-wrap\">\n        {[\n          { label: 'Total', value: stats.total, color: 'text-[var(--gm-text-primary)]' },\n          { label: 'Pending', value: stats.pending, color: 'text-[var(--gm-text-tertiary)]' },\n          { label: 'In Progress', value: stats.inProgress, color: 'text-primary' },\n          { label: 'Completed', value: stats.completed, color: 'text-success' },\n          { label: 'Overdue', value: stats.overdue, color: 'text-destructive' },\n        ].map(s => (\n          <div key={s.label} className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 flex items-center gap-2\">\n            <span className={`text-lg font-bold ${s.color}`}>{s.value}</span>\n            <span className=\"text-[10px] text-[var(--gm-text-tertiary)] uppercase tracking-wider\">{s.label}</span>\n          </div>\n        ))}\n      </div>\n\n      {/* Toolbar */}\n      <div className=\"flex items-center gap-2 flex-wrap\">\n        {/* View mode tabs */}\n        <div className=\"flex bg-[var(--gm-interactive-secondary)] rounded-lg p-0.5\">\n          {([\n            { id: 'list' as ViewMode, icon: List, label: 'List' },\n            { id: 'by_sprint' as ViewMode, icon: Layers, label: 'Sprints' },\n            { id: 'by_story' as ViewMode, icon: BookOpen, label: 'Stories' },\n          ]).map(v => (\n            <button\n              key={v.id}\n              onClick={() => setViewMode(v.id)}\n              className={`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${viewMode === v.id ? 'bg-[var(--gm-surface-primary)] text-[var(--gm-text-primary)] shadow-sm' : 'text-[var(--gm-text-tertiary)] hover:text-[var(--gm-text-primary)]'\n                }`}\n            >\n              <v.icon className=\"w-3.5 h-3.5\" />\n              {v.label}\n            </button>\n          ))}\n        </div>\n\n        {/* Sprint filter (list mode) */}\n        {viewMode === 'list' && (\n          <select\n            value={sprintFilter}\n            onChange={e => setSprintFilter(e.target.value)}\n            className=\"bg-[var(--gm-interactive-secondary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-1.5 text-xs text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\"\n          >\n            <option value=\"\">All sprints</option>\n            {sprints.map(s => <option key={s.id} value={s.id}>{s.name || '(unnamed)'}</option>)}\n          </select>\n        )}\n\n        {/* Status filter */}\n        <select\n          value={statusFilter}\n          onChange={e => setStatusFilter(e.target.value as StatusFilter)}\n          className=\"bg-[var(--gm-interactive-secondary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-1.5 text-xs text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\"\n        >\n          <option value=\"all\">All statuses</option>\n          <option value=\"pending\">Pending</option>\n          <option value=\"in_progress\">In Progress</option>\n          <option value=\"completed\">Completed</option>\n          <option value=\"overdue\">Overdue</option>\n        </select>\n\n        <div className=\"flex-1\" />\n\n        {/* Actions */}\n        <button\n          onClick={() => setSprintModalOpen(true)}\n          className=\"px-3 py-1.5 rounded-lg bg-[var(--gm-interactive-secondary)] text-slate-300 text-xs font-medium hover:bg-[var(--gm-surface-hover)] transition-colors flex items-center gap-1.5\"\n        >\n          <Target className=\"w-3.5 h-3.5\" /> Sprint\n        </button>\n        <button\n          onClick={handleAiSuggestActions}\n          disabled={aiSuggestLoading}\n          className=\"px-3 py-1.5 rounded-lg bg-purple-500/10 text-purple-400 text-xs font-medium hover:bg-purple-500/20 transition-colors flex items-center gap-1.5 disabled:opacity-50\"\n        >\n          {aiSuggestLoading ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Sparkles className=\"w-3.5 h-3.5\" />}\n          AI Suggest\n        </button>\n        <button\n          onClick={() => {\n            setEditingAction(null);\n            setActionModalMode('create');\n            setActionModalOpen(true);\n          }}\n          className=\"px-3 py-1.5 rounded-lg bg-blue-600 text-white text-xs font-medium hover:bg-blue-700 transition-colors flex items-center gap-1.5\"\n        >\n          <Plus className=\"w-3.5 h-3.5\" /> Add Action\n        </button>\n      </div>\n\n      {/* Content */}\n      <motion.div key={viewMode} initial={{ opacity: 0 }} animate={{ opacity: 1 }}>\n        {viewMode === 'list' && renderList()}\n        {viewMode === 'by_sprint' && renderBySprint()}\n        {viewMode === 'by_story' && renderByStory()}\n      </motion.div>\n\n      {/* Modals */}\n      <ActionModal\n        open={actionModalOpen}\n        onClose={() => setActionModalOpen(false)}\n        onSave={handleSaveAction}\n        action={editingAction}\n        mode={actionModalMode}\n      />\n      <CreateSprintModal\n        open={sprintModalOpen}\n        onClose={() => setSprintModalOpen(false)}\n        onSave={handleCreateSprint}\n      />\n    </div>\n  );\n};\n\nexport default ActionsPanel;\n","import { useState, useMemo, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Plus, Sparkles, Loader2, ArrowLeft, Edit2, Calendar, User, X, Wand2, Trash2 } from 'lucide-react';\nimport { toast } from 'sonner';\nimport type { Decision } from '@/types/godmode';\nimport { useSotChat, useAiSuggestDecision, useAiSuggestDecisionOwner } from '../../hooks/useGodMode';\nimport OwnerBadge from './OwnerBadge';\nimport OwnerSelect from './OwnerSelect';\n\ntype StatusFilter = 'all' | Decision['status'];\n\nconst statusColor = (s: string) =>\n  s === 'approved' ? 'bg-green-500/10 text-green-400' :\n    s === 'rejected' ? 'bg-red-500/10 text-red-400' :\n      'bg-blue-500/10 text-blue-400';\n\nconst DecisionModal = ({ open, onClose, onSave, decision, mode }: {\n  open: boolean; onClose: () => void; onSave: (d: Decision) => void;\n  decision?: Decision | null; mode: 'create' | 'edit';\n}) => {\n  const empty: Omit<Decision, 'id'> = { content: '', rationale: '', owner: '', decision_date: new Date().toISOString().split('T')[0], status: 'pending' };\n  const [form, setForm] = useState<Omit<Decision, 'id'>>(empty);\n  const [aiLoading, setAiLoading] = useState<string | null>(null);\n  const suggestDecision = useAiSuggestDecision();\n  const suggestOwner = useAiSuggestDecisionOwner();\n\n  useEffect(() => {\n    if (decision && mode === 'edit') { const { id, ...rest } = decision; setForm(rest); } else { setForm(empty); }\n  }, [decision, mode, open]);\n\n  const handleAiImpact = async () => {\n    if (!form.content) { toast.error('Add a title first'); return; }\n    setAiLoading('impact');\n    suggestDecision.mutate({ content: form.content, rationale: form.rationale }, {\n      onSuccess: (d) => {\n        const parts: string[] = [];\n        if (d.impact_summary) parts.push(d.impact_summary);\n        if (d.rationale && form.rationale !== d.rationale) parts.push(d.rationale);\n        if (d.summary) parts.push(d.summary);\n        if (parts.length > 0) {\n          const addition = parts.join('\\n\\n');\n          setForm(prev => ({ ...prev, rationale: prev.rationale ? `${prev.rationale}\\n\\n${addition}` : addition }));\n        }\n        setAiLoading(null);\n        toast.success('AI impact analysis added');\n      },\n      onError: () => { setAiLoading(null); toast.error('AI impact analysis failed'); },\n    });\n  };\n\n  return (\n    <AnimatePresence>\n      {open && (\n        <>\n          <div className=\"fixed inset-0 bg-black/80 backdrop-blur-sm z-50\" onClick={onClose} />\n          <motion.div initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} exit={{ opacity: 0, scale: 0.95 }} className=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\n            <div className=\"bg-[var(--gm-bg-elevated)] border border-[var(--gm-border-primary)] rounded-2xl shadow-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto\" onClick={e => e.stopPropagation()}>\n              <div className=\"flex items-center justify-between p-5 border-b border-[var(--gm-border-primary)]\">\n                <h2 className=\"text-lg font-semibold text-[var(--gm-text-primary)]\">{mode === 'create' ? 'New Decision' : 'Edit Decision'}</h2>\n                <button onClick={onClose} className=\"w-8 h-8 rounded-lg hover:bg-[var(--gm-surface-hover)] flex items-center justify-center\"><X className=\"w-4 h-4 text-[var(--gm-text-tertiary)]\" /></button>\n              </div>\n              <div className=\"px-5 pt-4 flex gap-2\">\n                <button type=\"button\" onClick={handleAiImpact} disabled={!!aiLoading} className=\"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-blue-500/10 text-blue-400 text-xs font-medium hover:bg-blue-500/20 disabled:opacity-50\">\n                  {aiLoading === 'impact' ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Wand2 className=\"w-3.5 h-3.5\" />} AI Impact Analysis\n                </button>\n                <button type=\"button\" disabled={suggestOwner.isPending || !form.content.trim()}\n                  onClick={() => suggestOwner.mutate({ content: form.content, rationale: form.rationale }, {\n                    onSuccess: (d) => { const owners = d?.suggested_owners; if (owners?.[0]) { setForm(f => ({ ...f, owner: String(owners[0].name || owners[0].id || '') })); toast.success('Owner suggested by AI'); } },\n                    onError: () => toast.error('Owner suggestion failed'),\n                  })}\n                  className=\"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-purple-500/10 text-purple-400 text-xs font-medium hover:bg-purple-500/20 disabled:opacity-50\">\n                  {suggestOwner.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Wand2 className=\"w-3.5 h-3.5\" />} AI Suggest Owner\n                </button>\n              </div>\n              <form onSubmit={e => { e.preventDefault(); if (!form.content.trim()) return; onSave({ id: decision?.id || String(Date.now()), ...form }); onClose(); }} className=\"p-5 space-y-4\">\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Title *</label>\n                  <input value={form.content} onChange={e => setForm({ ...form, content: e.target.value })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\" placeholder=\"Decision title...\" required />\n                </div>\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Rationale / Description</label>\n                  <textarea value={form.rationale || ''} onChange={e => setForm({ ...form, rationale: e.target.value })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] placeholder:text-[var(--gm-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)] min-h-[80px] resize-y\" placeholder=\"Describe the decision and rationale...\" />\n                </div>\n                <div className=\"grid grid-cols-3 gap-3\">\n                  <OwnerSelect value={form.owner || ''} onChange={v => setForm({ ...form, owner: v })} label=\"Owner\" placeholder=\"Decision maker...\" />\n                  <div>\n                    <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Date</label>\n                    <input type=\"date\" value={form.decision_date || ''} onChange={e => setForm({ ...form, decision_date: e.target.value })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\" />\n                  </div>\n                  <div>\n                    <label className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider\">Status</label>\n                    <select value={form.status} onChange={e => setForm({ ...form, status: e.target.value as Decision['status'] })} className=\"mt-1 w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\">\n                      <option value=\"pending\">Pending</option><option value=\"active\">Active</option><option value=\"approved\">Approved</option><option value=\"rejected\">Rejected</option>\n                    </select>\n                  </div>\n                </div>\n                <div className=\"flex gap-2 pt-2\">\n                  <button type=\"button\" onClick={onClose} className=\"flex-1 px-4 py-2.5 rounded-lg bg-[var(--gm-interactive-secondary)] text-[var(--gm-text-primary)] text-sm font-medium hover:bg-[var(--gm-surface-hover)]\">Cancel</button>\n                  <button type=\"submit\" className=\"flex-1 px-4 py-2.5 rounded-lg bg-blue-600 text-white text-sm font-medium hover:bg-blue-700\">{mode === 'create' ? 'Create' : 'Save'}</button>\n                </div>\n              </form>\n            </div>\n          </motion.div>\n        </>\n      )}\n    </AnimatePresence>\n  );\n};\n\nconst DecisionDetail = ({ decision, onBack, onEdit, onDelete }: { decision: Decision; onBack: () => void; onEdit: (d: Decision) => void; onDelete?: (id: string) => void }) => {\n  const [aiLoading, setAiLoading] = useState(false);\n  const [aiInsights, setAiInsights] = useState<string[]>([]);\n  const chatMut = useSotChat();\n\n  const handleAnalyze = async () => {\n    setAiLoading(true);\n    chatMut.mutate({ message: `Analyze this project decision and provide insights:\\nTitle: \"${decision.content}\"\\nRationale: \"${decision.rationale || ''}\"\\nOwner: ${decision.owner || 'unknown'}\\nDate: ${decision.decision_date || ''}\\nStatus: ${decision.status}\\nProvide: impact assessment, related actions/risks, and recommendations.` }, {\n      onSuccess: (d) => {\n        const resp = (d as Record<string, unknown>)?.response as string;\n        if (resp) setAiInsights(resp.split('\\n').filter(l => l.trim()));\n        setAiLoading(false);\n        toast.success('AI analysis complete');\n      },\n      onError: () => { setAiLoading(false); toast.error('AI analysis failed'); },\n    });\n  };\n\n  return (\n    <motion.div initial={{ opacity: 0, x: 20 }} animate={{ opacity: 1, x: 0 }} className=\"space-y-4\">\n      <div className=\"flex items-center gap-3\">\n        <button onClick={onBack} className=\"w-8 h-8 rounded-lg bg-[var(--gm-interactive-secondary)] flex items-center justify-center hover:bg-[var(--gm-surface-hover)]\"><ArrowLeft className=\"w-4 h-4 text-[var(--gm-text-tertiary)]\" /></button>\n        <div className=\"flex-1\"><h2 className=\"text-lg font-semibold text-[var(--gm-text-primary)]\">{decision.content || decision.decision || decision.summary || '(untitled decision)'}</h2><p className=\"text-xs text-[var(--gm-text-tertiary)]\">Decision #{decision.id?.substring(0, 8)}</p></div>\n        <button onClick={handleAnalyze} disabled={aiLoading} className=\"px-3 py-1.5 rounded-lg bg-purple-500/10 text-purple-400 text-xs font-medium hover:bg-purple-500/20 flex items-center gap-1.5 disabled:opacity-50\">\n          {aiLoading ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Sparkles className=\"w-3.5 h-3.5\" />} Analyze\n        </button>\n        <button onClick={() => onEdit(decision)} className=\"px-3 py-1.5 rounded-lg bg-[var(--gm-interactive-secondary)] text-[var(--gm-text-primary)] text-xs hover:bg-[var(--gm-surface-hover)] flex items-center gap-1.5\"><Edit2 className=\"w-3.5 h-3.5\" /> Edit</button>\n        {onDelete && <button onClick={() => { onDelete(decision.id); onBack(); }} className=\"px-3 py-1.5 rounded-lg bg-red-500/10 text-red-400 text-xs hover:bg-red-500/20 flex items-center gap-1.5\"><Trash2 className=\"w-3.5 h-3.5\" /> Delete</button>}\n      </div>\n      <div className=\"flex gap-2\">\n        <span className={`text-xs px-3 py-1 rounded-full font-medium ${statusColor(decision.status)}`}>{decision.status || '—'}</span>\n      </div>\n      {decision.rationale && (\n        <div className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-4\">\n          <h3 className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase tracking-wider mb-2\">Rationale</h3>\n          <p className=\"text-sm text-[var(--gm-text-primary)] whitespace-pre-wrap\">{decision.rationale}</p>\n        </div>\n      )}\n      <div className=\"grid grid-cols-2 gap-3\">\n        <div className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 mb-2\"><User className=\"w-3.5 h-3.5 text-[var(--gm-text-tertiary)]\" /><span className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase\">Decision Maker</span></div>\n          {decision.owner ? <OwnerBadge name={decision.owner} size=\"md\" /> : <p className=\"text-sm text-[var(--gm-text-tertiary)]\">Unknown</p>}\n        </div>\n        <div className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-4\">\n          <div className=\"flex items-center gap-2 mb-2\"><Calendar className=\"w-3.5 h-3.5 text-[var(--gm-text-tertiary)]\" /><span className=\"text-xs font-medium text-[var(--gm-text-tertiary)] uppercase\">Date</span></div>\n          <p className=\"text-sm text-[var(--gm-text-primary)]\">{decision.decision_date || '—'}</p>\n        </div>\n      </div>\n      {aiInsights.length > 0 && (\n        <motion.div initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} className=\"bg-purple-500/5 border border-purple-500/20 rounded-xl p-4\">\n          <h3 className=\"text-xs font-medium text-purple-400 uppercase tracking-wider mb-2 flex items-center gap-1.5\"><Sparkles className=\"w-3.5 h-3.5\" /> AI Insights</h3>\n          <ul className=\"space-y-1.5\">{aiInsights.map((ins, i) => <li key={i} className=\"text-sm text-[var(--gm-text-primary)]\">{ins}</li>)}</ul>\n        </motion.div>\n      )}\n    </motion.div>\n  );\n};\n\nconst DecisionsPanel = ({ initialData = [], onSave, onDelete }: { initialData?: Decision[]; onSave?: (d: Decision) => void; onDelete?: (id: string) => void }) => {\n  const [decisions, setDecisions] = useState<Decision[]>(initialData);\n  const chatMut = useSotChat();\n\n  useEffect(() => {\n    if (initialData) setDecisions(initialData);\n  }, [initialData]);\n  const [statusFilter, setStatusFilter] = useState<StatusFilter>('all');\n  const [modalOpen, setModalOpen] = useState(false);\n  const [modalMode, setModalMode] = useState<'create' | 'edit'>('create');\n  const [editingItem, setEditingItem] = useState<Decision | null>(null);\n  const [detailItem, setDetailItem] = useState<Decision | null>(null);\n  const [aiLoading, setAiLoading] = useState(false);\n\n  const filtered = useMemo(() => {\n    if (statusFilter === 'all') return decisions;\n    return decisions.filter(d => d.status === statusFilter);\n  }, [decisions, statusFilter]);\n\n  const stats = useMemo(() => ({\n    total: decisions.length,\n    approved: decisions.filter(d => d.status === 'approved').length,\n    pending: decisions.filter(d => d.status === 'pending').length,\n    active: decisions.filter(d => d.status === 'active').length,\n    rejected: decisions.filter(d => d.status === 'rejected').length,\n  }), [decisions]);\n\n  const handleSave = (d: Decision) => {\n    setDecisions(prev => {\n      const idx = prev.findIndex(x => x.id === d.id);\n      if (idx >= 0) { const u = [...prev]; u[idx] = d; return u; }\n      return [...prev, d];\n    });\n    onSave?.(d);\n  };\n\n  const handleDelete = (id: string) => {\n    setDecisions(prev => prev.filter(x => x.id !== id));\n    onDelete?.(id);\n    toast.success('Decision deleted');\n  };\n\n  const handleAiSuggest = async () => {\n    setAiLoading(true);\n    chatMut.mutate({ message: 'Based on the current project state, suggest one important decision that should be made. Return on line 1: the decision title. Line 2: brief rationale.' }, {\n      onSuccess: (d) => {\n        const resp = (d as Record<string, unknown>)?.response as string;\n        if (resp) {\n          const lines = resp.split('\\n').filter(l => l.trim());\n          const content = lines[0]?.replace(/^[\"'\\-*\\d.]+\\s*/, '').trim() || resp.trim();\n          const rationale = lines.slice(1).join('\\n').trim();\n          const newD: Decision = {\n            id: `ai-${Date.now()}`, content, rationale,\n            owner: '', decision_date: new Date().toISOString().split('T')[0], status: 'pending',\n          };\n          setDecisions(prev => [...prev, newD]);\n          onSave?.(newD);\n        }\n        setAiLoading(false);\n        toast.success('AI suggested a new decision');\n      },\n      onError: () => { setAiLoading(false); toast.error('AI suggestion failed'); },\n    });\n  };\n\n  if (detailItem) {\n    return <DecisionDetail decision={detailItem} onBack={() => setDetailItem(null)} onEdit={d => { setDetailItem(null); setEditingItem(d); setModalMode('edit'); setModalOpen(true); }} onDelete={handleDelete} />;\n  }\n\n  return (\n    <div className=\"space-y-3\">\n      <div className=\"flex gap-2 flex-wrap\">\n        {[\n          { label: 'Total', value: stats.total, color: 'text-[var(--gm-text-primary)]' },\n          { label: 'Approved', value: stats.approved, color: 'text-green-400' },\n          { label: 'Pending', value: stats.pending, color: 'text-primary' },\n          { label: 'Active', value: stats.active, color: 'text-purple-400' },\n          { label: 'Rejected', value: stats.rejected, color: 'text-red-400' },\n        ].map(s => (\n          <div key={s.label} className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 flex items-center gap-2\">\n            <span className={`text-lg font-bold ${s.color}`}>{s.value}</span>\n            <span className=\"text-[10px] text-[var(--gm-text-tertiary)] uppercase tracking-wider\">{s.label}</span>\n          </div>\n        ))}\n      </div>\n      <div className=\"flex items-center gap-2 flex-wrap\">\n        <select value={statusFilter} onChange={e => setStatusFilter(e.target.value as StatusFilter)} className=\"bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-1.5 text-xs text-[var(--gm-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--gm-border-focus)]\">\n          <option value=\"all\">All statuses</option><option value=\"approved\">Approved</option><option value=\"active\">Active</option><option value=\"pending\">Pending</option><option value=\"rejected\">Rejected</option>\n        </select>\n        <div className=\"flex-1\" />\n        <button onClick={handleAiSuggest} disabled={aiLoading} className=\"px-3 py-1.5 rounded-lg bg-purple-500/10 text-purple-400 text-xs font-medium hover:bg-purple-500/20 flex items-center gap-1.5 disabled:opacity-50\">\n          {aiLoading ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Sparkles className=\"w-3.5 h-3.5\" />} AI Suggest\n        </button>\n        <button onClick={() => { setEditingItem(null); setModalMode('create'); setModalOpen(true); }} className=\"px-3 py-1.5 rounded-lg bg-blue-600 text-white text-xs font-medium hover:bg-blue-700 flex items-center gap-1.5\">\n          <Plus className=\"w-3.5 h-3.5\" /> Add Decision\n        </button>\n      </div>\n      <div className=\"space-y-2\">\n        {filtered.length === 0 ? (\n          <p className=\"text-sm text-[var(--gm-text-tertiary)] text-center py-8\">No decisions match the current filter</p>\n        ) : filtered.map(d => (\n          <motion.div key={d.id} layout initial={{ opacity: 0 }} animate={{ opacity: 1 }} className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-3.5 hover:border-blue-500/30 transition-colors cursor-pointer group\" onClick={() => setDetailItem(d)}>\n            <div className=\"flex items-start justify-between gap-3\">\n              <div className=\"flex-1 min-w-0\">\n                <p className=\"text-sm font-medium text-[var(--gm-text-primary)] truncate group-hover:text-blue-400 transition-colors\">{d.content || d.decision || d.summary || d.context || '(no title)'}</p>\n                <p className=\"text-xs text-[var(--gm-text-tertiary)] mt-0.5 line-clamp-1\">{d.rationale || d.context || ''}</p>\n              </div>\n              <span className={`text-[10px] px-2 py-0.5 rounded-full font-medium ${statusColor(d.status)}`}>{d.status || '—'}</span>\n            </div>\n            <div className=\"flex items-center justify-between mt-2.5\">\n              {d.owner ? <OwnerBadge name={d.owner} size=\"sm\" /> : <span className=\"text-[10px] text-[var(--gm-text-tertiary)]\">No owner</span>}\n              <span className=\"text-[10px] text-[var(--gm-text-tertiary)]\">{d.decision_date || ''}</span>\n            </div>\n          </motion.div>\n        ))}\n      </div>\n      <DecisionModal open={modalOpen} onClose={() => setModalOpen(false)} onSave={handleSave} decision={editingItem} mode={modalMode} />\n    </div>\n  );\n};\n\nexport default DecisionsPanel;\n","import { useState, useMemo, useEffect } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { Plus, Loader2, Edit2, Trash2, X, BookOpen, Target, CheckCircle2 } from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport {\r\n  useUserStories, useCreateUserStory, useUpdateUserStory, useDeleteUserStory,\r\n  type UserStory,\r\n} from '@/hooks/useGodMode';\r\n\r\ntype StatusFilter = 'all' | 'backlog' | 'in_progress' | 'done' | 'cancelled';\r\ntype PriorityFilter = 'all' | 'high' | 'medium' | 'low';\r\n\r\nconst statusColor = (s?: string) =>\r\n  s === 'done' ? 'bg-green-500/10 text-green-400' :\r\n  s === 'in_progress' ? 'bg-blue-500/10 text-blue-400' :\r\n  s === 'cancelled' ? 'bg-[var(--gm-border-primary)] text-[var(--gm-text-tertiary)]' :\r\n  'bg-amber-500/10 text-amber-400';\r\n\r\nconst priorityColor = (p?: string) =>\r\n  p === 'high' ? 'bg-red-500/10 text-red-400' :\r\n  p === 'medium' ? 'bg-amber-500/10 text-amber-400' :\r\n  'bg-[var(--gm-border-primary)] text-[var(--gm-text-tertiary)]';\r\n\r\nconst StoryModal = ({ open, onClose, story, mode }: {\r\n  open: boolean; onClose: () => void;\r\n  story?: UserStory | null; mode: 'create' | 'edit';\r\n}) => {\r\n  const createMut = useCreateUserStory();\r\n  const updateMut = useUpdateUserStory();\r\n\r\n  const empty = { title: '', description: '', acceptance_criteria: '', priority: 'medium', status: 'backlog' };\r\n  const [form, setForm] = useState(empty);\r\n\r\n  useEffect(() => {\r\n    if (story && mode === 'edit') {\r\n      setForm({\r\n        title: story.title || '',\r\n        description: story.description || '',\r\n        acceptance_criteria: story.acceptance_criteria || '',\r\n        priority: story.priority || 'medium',\r\n        status: story.status || 'backlog',\r\n      });\r\n    } else {\r\n      setForm(empty);\r\n    }\r\n  }, [story, mode, open]);\r\n\r\n  const handleSave = () => {\r\n    if (!form.title.trim()) { toast.error('Title is required'); return; }\r\n    if (mode === 'edit' && story) {\r\n      updateMut.mutate({ id: story.id, ...form }, {\r\n        onSuccess: () => { toast.success('Story updated'); onClose(); },\r\n        onError: () => toast.error('Failed to update'),\r\n      });\r\n    } else {\r\n      createMut.mutate(form, {\r\n        onSuccess: () => { toast.success('Story created'); onClose(); },\r\n        onError: () => toast.error('Failed to create'),\r\n      });\r\n    }\r\n  };\r\n\r\n  const saving = createMut.isPending || updateMut.isPending;\r\n\r\n  if (!open) return null;\r\n  return (\r\n    <AnimatePresence>\r\n      <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }}\r\n        className=\"fixed inset-0 z-50 bg-black/80 backdrop-blur-sm flex items-center justify-center\"\r\n        onClick={onClose}>\r\n        <motion.div initial={{ scale: 0.95 }} animate={{ scale: 1 }} exit={{ scale: 0.95 }}\r\n          className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl w-full max-w-lg p-5 shadow-2xl\"\r\n          onClick={e => e.stopPropagation()}>\r\n          <div className=\"flex items-center justify-between mb-4\">\r\n            <h3 className=\"text-sm font-semibold text-[var(--gm-text-primary)]\">\r\n              {mode === 'create' ? 'New User Story' : 'Edit User Story'}\r\n            </h3>\r\n            <button onClick={onClose} className=\"p-1 rounded text-[var(--gm-text-tertiary)] hover:text-[var(--gm-text-primary)]\">\r\n              <X className=\"w-4 h-4\" />\r\n            </button>\r\n          </div>\r\n\r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <label className=\"text-xs font-medium text-[var(--gm-text-secondary)] mb-1 block\">Title *</label>\r\n              <input value={form.title} onChange={e => setForm(p => ({ ...p, title: e.target.value }))}\r\n                className=\"w-full bg-[var(--gm-surface-secondary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] placeholder:text-[var(--gm-text-tertiary)]\"\r\n                placeholder=\"As a user, I want to...\" />\r\n            </div>\r\n            <div>\r\n              <label className=\"text-xs font-medium text-[var(--gm-text-secondary)] mb-1 block\">Description</label>\r\n              <textarea value={form.description} onChange={e => setForm(p => ({ ...p, description: e.target.value }))}\r\n                rows={3}\r\n                className=\"w-full bg-[var(--gm-surface-secondary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] placeholder:text-[var(--gm-text-tertiary)] resize-y\"\r\n                placeholder=\"Detailed description...\" />\r\n            </div>\r\n            <div>\r\n              <label className=\"text-xs font-medium text-[var(--gm-text-secondary)] mb-1 block\">Acceptance Criteria</label>\r\n              <textarea value={form.acceptance_criteria} onChange={e => setForm(p => ({ ...p, acceptance_criteria: e.target.value }))}\r\n                rows={3}\r\n                className=\"w-full bg-[var(--gm-surface-secondary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] placeholder:text-[var(--gm-text-tertiary)] resize-y font-mono text-xs\"\r\n                placeholder=\"Given... When... Then...\" />\r\n            </div>\r\n            <div className=\"grid grid-cols-2 gap-3\">\r\n              <div>\r\n                <label className=\"text-xs font-medium text-[var(--gm-text-secondary)] mb-1 block\">Priority</label>\r\n                <select value={form.priority} onChange={e => setForm(p => ({ ...p, priority: e.target.value }))}\r\n                  className=\"w-full bg-[var(--gm-surface-secondary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)]\">\r\n                  <option value=\"low\">Low</option>\r\n                  <option value=\"medium\">Medium</option>\r\n                  <option value=\"high\">High</option>\r\n                </select>\r\n              </div>\r\n              <div>\r\n                <label className=\"text-xs font-medium text-[var(--gm-text-secondary)] mb-1 block\">Status</label>\r\n                <select value={form.status} onChange={e => setForm(p => ({ ...p, status: e.target.value }))}\r\n                  className=\"w-full bg-[var(--gm-surface-secondary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)]\">\r\n                  <option value=\"backlog\">Backlog</option>\r\n                  <option value=\"in_progress\">In Progress</option>\r\n                  <option value=\"done\">Done</option>\r\n                  <option value=\"cancelled\">Cancelled</option>\r\n                </select>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex justify-end gap-2 mt-5 pt-4 border-t border-[var(--gm-border-primary)]\">\r\n            <button onClick={onClose} className=\"px-4 py-2 rounded-lg text-sm text-[var(--gm-text-tertiary)] hover:bg-[var(--gm-surface-secondary)]\">Cancel</button>\r\n            <button onClick={handleSave} disabled={saving}\r\n              className=\"flex items-center gap-2 px-4 py-2 rounded-lg bg-[var(--gm-accent-primary)] text-white text-sm font-medium hover:opacity-90 disabled:opacity-50\">\r\n              {saving ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : <CheckCircle2 className=\"w-4 h-4\" />}\r\n              {saving ? 'Saving...' : 'Save'}\r\n            </button>\r\n          </div>\r\n        </motion.div>\r\n      </motion.div>\r\n    </AnimatePresence>\r\n  );\r\n};\r\n\r\nexport default function UserStoriesPanel() {\r\n  const { data, isLoading } = useUserStories();\r\n  const deleteMut = useDeleteUserStory();\r\n  const [modalOpen, setModalOpen] = useState(false);\r\n  const [modalMode, setModalMode] = useState<'create' | 'edit'>('create');\r\n  const [editTarget, setEditTarget] = useState<UserStory | null>(null);\r\n  const [search, setSearch] = useState('');\r\n  const [statusFilter, setStatusFilter] = useState<StatusFilter>('all');\r\n  const [priorityFilter, setPriorityFilter] = useState<PriorityFilter>('all');\r\n\r\n  const stories = (data?.stories ?? []) as UserStory[];\r\n\r\n  const filtered = useMemo(() => {\r\n    let list = stories;\r\n    if (statusFilter !== 'all') list = list.filter(s => s.status === statusFilter);\r\n    if (priorityFilter !== 'all') list = list.filter(s => s.priority === priorityFilter);\r\n    if (search) {\r\n      const q = search.toLowerCase();\r\n      list = list.filter(s => s.title.toLowerCase().includes(q) || s.description?.toLowerCase().includes(q));\r\n    }\r\n    return list;\r\n  }, [stories, statusFilter, priorityFilter, search]);\r\n\r\n  const handleEdit = (story: UserStory) => {\r\n    setEditTarget(story);\r\n    setModalMode('edit');\r\n    setModalOpen(true);\r\n  };\r\n\r\n  const handleCreate = () => {\r\n    setEditTarget(null);\r\n    setModalMode('create');\r\n    setModalOpen(true);\r\n  };\r\n\r\n  const handleDelete = (id: string) => {\r\n    if (confirm('Delete this user story?')) {\r\n      deleteMut.mutate(id, { onSuccess: () => toast.success('Story deleted') });\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex justify-center py-12\">\r\n        <Loader2 className=\"w-6 h-6 animate-spin text-[var(--gm-accent-primary)]\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <StoryModal open={modalOpen} onClose={() => setModalOpen(false)} story={editTarget} mode={modalMode} />\r\n\r\n      {/* Toolbar */}\r\n      <div className=\"flex items-center justify-between gap-3 flex-wrap\">\r\n        <div className=\"flex items-center gap-2\">\r\n          <input value={search} onChange={e => setSearch(e.target.value)}\r\n            placeholder=\"Search stories...\"\r\n            className=\"bg-[var(--gm-surface-secondary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-1.5 text-sm text-[var(--gm-text-primary)] placeholder:text-[var(--gm-text-tertiary)] w-48\" />\r\n          <select value={statusFilter} onChange={e => setStatusFilter(e.target.value as StatusFilter)}\r\n            className=\"bg-[var(--gm-surface-secondary)] border border-[var(--gm-border-primary)] rounded-lg px-2 py-1.5 text-xs text-[var(--gm-text-primary)]\">\r\n            <option value=\"all\">All statuses</option>\r\n            <option value=\"backlog\">Backlog</option>\r\n            <option value=\"in_progress\">In Progress</option>\r\n            <option value=\"done\">Done</option>\r\n            <option value=\"cancelled\">Cancelled</option>\r\n          </select>\r\n          <select value={priorityFilter} onChange={e => setPriorityFilter(e.target.value as PriorityFilter)}\r\n            className=\"bg-[var(--gm-surface-secondary)] border border-[var(--gm-border-primary)] rounded-lg px-2 py-1.5 text-xs text-[var(--gm-text-primary)]\">\r\n            <option value=\"all\">All priorities</option>\r\n            <option value=\"high\">High</option>\r\n            <option value=\"medium\">Medium</option>\r\n            <option value=\"low\">Low</option>\r\n          </select>\r\n        </div>\r\n        <button onClick={handleCreate}\r\n          className=\"flex items-center gap-2 px-4 py-2 rounded-lg bg-[var(--gm-accent-primary)] text-white text-sm font-medium hover:opacity-90 transition-opacity\">\r\n          <Plus className=\"w-4 h-4\" /> New Story\r\n        </button>\r\n      </div>\r\n\r\n      {/* List */}\r\n      {filtered.length === 0 ? (\r\n        <div className=\"text-center py-12\">\r\n          <BookOpen className=\"w-10 h-10 mx-auto text-[var(--gm-text-tertiary)] opacity-40 mb-3\" />\r\n          <p className=\"text-sm text-[var(--gm-text-tertiary)]\">\r\n            {stories.length === 0 ? 'No user stories yet. Create one above.' : 'No stories match your filters.'}\r\n          </p>\r\n        </div>\r\n      ) : (\r\n        <div className=\"space-y-2\">\r\n          {filtered.map((story, i) => (\r\n            <motion.div\r\n              key={story.id}\r\n              initial={{ opacity: 0, y: 8 }}\r\n              animate={{ opacity: 1, y: 0 }}\r\n              transition={{ delay: i * 0.03 }}\r\n              className=\"bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-4 hover:border-[var(--gm-accent-primary)]/20 transition-colors group\"\r\n            >\r\n              <div className=\"flex items-start gap-3\">\r\n                <div className=\"mt-0.5 flex-shrink-0\">\r\n                  <Target className=\"w-4 h-4 text-[var(--gm-accent-primary)]\" />\r\n                </div>\r\n                <div className=\"flex-1 min-w-0\">\r\n                  <div className=\"flex items-center gap-2 mb-1\">\r\n                    <h4 className=\"text-sm font-medium text-[var(--gm-text-primary)]\">{story.title}</h4>\r\n                    <span className={`text-[10px] px-2 py-0.5 rounded-full font-medium ${statusColor(story.status)}`}>\r\n                      {(story.status || 'backlog').replace('_', ' ')}\r\n                    </span>\r\n                    <span className={`text-[10px] px-2 py-0.5 rounded-full font-medium ${priorityColor(story.priority)}`}>\r\n                      {story.priority || 'medium'}\r\n                    </span>\r\n                  </div>\r\n                  {story.description && (\r\n                    <p className=\"text-xs text-[var(--gm-text-secondary)] line-clamp-2 mb-1\">{story.description}</p>\r\n                  )}\r\n                  {story.acceptance_criteria && (\r\n                    <p className=\"text-[10px] text-[var(--gm-text-tertiary)] font-mono line-clamp-1 mt-1\">\r\n                      AC: {story.acceptance_criteria}\r\n                    </p>\r\n                  )}\r\n                </div>\r\n                <div className=\"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0\">\r\n                  <button onClick={() => handleEdit(story)}\r\n                    className=\"p-1.5 rounded-lg text-[var(--gm-text-tertiary)] hover:bg-[var(--gm-surface-secondary)] hover:text-[var(--gm-text-primary)]\">\r\n                    <Edit2 className=\"w-3.5 h-3.5\" />\r\n                  </button>\r\n                  <button onClick={() => handleDelete(story.id)}\r\n                    className=\"p-1.5 rounded-lg text-[var(--gm-text-tertiary)] hover:bg-red-500/10 hover:text-red-400\">\r\n                    <Trash2 className=\"w-3.5 h-3.5\" />\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </motion.div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","/**\n * Source of Truth (SOT) page. Provides:\n *   - Overview dashboard: health score, insights, change delta, alerts\n *   - Tabbed CRUD for Questions, Facts, Risks, Actions, Decisions\n *   - Timeline of all project events\n *   - Version history with comparison\n *   - Export (Markdown / HTML / JSON)\n *   - Executive summary generation\n */\nimport { useState, useMemo } from 'react';\nimport { motion } from 'framer-motion';\nimport {\n  Loader2, Heart, Lightbulb, AlertTriangle, Clock, History, Download,\n  FileText, ChevronRight, ArrowUpRight, ArrowDownRight, Minus, RefreshCw, Zap,\n  FileJson, Globe, ChevronDown, ChevronUp, Trash2, RotateCw,\n} from 'lucide-react';\nimport { ErrorState } from '../components/shared/ErrorState';\nimport { SotSkeleton } from '../components/shared/PageSkeleton';\nimport {\n  useQuestions, useCreateQuestion, useUpdateQuestion, useDeleteQuestion,\n  useFacts, useCreateFact, useUpdateFact, useDeleteFact,\n  useRisks, useCreateRisk, useUpdateRisk, useDeleteRisk,\n  useActions, useCreateAction, useUpdateAction, useDeleteAction,\n  useDecisions, useCreateDecision, useUpdateDecision, useDeleteDecision,\n  useHealth, useSotAlerts, useSotInsights, useSotDelta, useSotTimeline,\n  useSotVersions, useSotCompare, useSotGenerateSummary,\n  useDeletedFacts, useRestoreFact,\n  useDeletedDecisions, useRestoreDecision,\n  useDeletedRisks, useRestoreRisk,\n  useDeletedActions, useRestoreAction,\n} from '../hooks/useGodMode';\nimport { cn } from '../lib/utils';\nimport { toast } from 'sonner';\nimport { apiClient } from '../lib/api-client';\nimport QuestionsPanel from '../components/sot/QuestionsPanel';\nimport FactsPanel from '../components/sot/FactsPanel';\nimport RisksPanel from '../components/sot/RisksPanel';\nimport ActionsPanel from '../components/sot/ActionsPanel';\nimport DecisionsPanel from '../components/sot/DecisionsPanel';\nimport UserStoriesPanel from '../components/sot/UserStoriesPanel';\nimport type { Question, Fact, Risk, Action, Decision } from '../types/godmode';\n\nconst CARD = 'rounded-xl border border-[var(--gm-border-primary)] bg-[var(--gm-surface-primary)] shadow-[var(--shadow-sm)]';\nconst SECTION_TITLE = 'text-[10px] font-bold text-[var(--gm-accent-primary)] uppercase tracking-[0.1em]';\n\ntype MainTab = 'overview' | 'entities' | 'timeline' | 'history';\ntype EntityTab = 'questions' | 'facts' | 'risks' | 'actions' | 'decisions' | 'stories' | 'trash';\n\nfunction r(v: unknown): Record<string, unknown> { return (v && typeof v === 'object' ? v : {}) as Record<string, unknown>; }\n\nexport default function SotPage() {\n  const [mainTab, setMainTab] = useState<MainTab>('overview');\n  const [entityTab, setEntityTab] = useState<EntityTab>('questions');\n  const [compareV1, setCompareV1] = useState<string>('');\n  const [compareV2, setCompareV2] = useState<string>('');\n  const [expandedInsights, setExpandedInsights] = useState(true);\n\n  // Overview data\n  const { data: healthData } = useHealth();\n  const { data: alertsData } = useSotAlerts();\n  const { data: insightsData } = useSotInsights();\n  const { data: deltaData } = useSotDelta();\n\n  // Entities\n  const questions = useQuestions();\n  const facts = useFacts();\n  const risks = useRisks();\n  const actions = useActions();\n  const decisions = useDecisions();\n\n  // Mutations\n  const createQuestion = useCreateQuestion();\n  const updateQuestion = useUpdateQuestion();\n  const deleteQuestion = useDeleteQuestion();\n  const createFact = useCreateFact();\n  const updateFact = useUpdateFact();\n  const deleteFact = useDeleteFact();\n  const createRisk = useCreateRisk();\n  const updateRisk = useUpdateRisk();\n  const deleteRisk = useDeleteRisk();\n  const createAction = useCreateAction();\n  const updateAction = useUpdateAction();\n  const deleteAction = useDeleteAction();\n  const createDecision = useCreateDecision();\n  const updateDecision = useUpdateDecision();\n  const deleteDecision = useDeleteDecision();\n\n  // Trash\n  const deletedFacts = useDeletedFacts();\n  const restoreFact = useRestoreFact();\n  const deletedDecisions = useDeletedDecisions();\n  const restoreDecision = useRestoreDecision();\n  const deletedRisks = useDeletedRisks();\n  const restoreRisk = useRestoreRisk();\n  const deletedActions = useDeletedActions();\n  const restoreAction = useRestoreAction();\n\n  // Timeline\n  const { data: timelineData, isLoading: timelineLoading } = useSotTimeline(100);\n\n  // History\n  const { data: versionsData } = useSotVersions();\n  const compareQuery = useSotCompare(compareV1, compareV2);\n  const genSummary = useSotGenerateSummary();\n\n  // Derived\n  const health = r(healthData);\n  const alerts = ((r(alertsData).alerts ?? []) as Array<Record<string, unknown>>);\n  const insights = ((r(insightsData).insights ?? []) as Array<Record<string, unknown>>);\n  const delta = r(deltaData);\n  const changes = (delta.changes ?? []) as Array<Record<string, unknown>>;\n  const timeline = ((r(timelineData).timeline ?? []) as Array<Record<string, unknown>>);\n  const versions = ((r(versionsData).versions ?? []) as Array<Record<string, unknown>>);\n  const diff = r(compareQuery.data);\n\n  const healthScore = Number(health.score ?? 0);\n  const healthColor = healthScore >= 70 ? '#22c55e' : healthScore >= 40 ? '#f59e0b' : '#ef4444';\n\n  const dFacts = ((deletedFacts.data as Record<string, unknown>)?.facts ?? []) as unknown[];\n  const dDecs = ((deletedDecisions.data as Record<string, unknown>)?.decisions ?? []) as unknown[];\n  const dRisks = ((deletedRisks.data as Record<string, unknown>)?.risks ?? []) as unknown[];\n  const dActs = ((deletedActions.data as Record<string, unknown>)?.actions ?? []) as unknown[];\n  const trashCount = dFacts.length + dDecs.length + dRisks.length + dActs.length;\n\n  const entityTabs: { key: EntityTab; label: string; count: number }[] = [\n    { key: 'questions', label: 'Questions', count: (questions.data as unknown[] | undefined)?.length ?? 0 },\n    { key: 'facts', label: 'Facts', count: (facts.data as unknown[] | undefined)?.length ?? 0 },\n    { key: 'risks', label: 'Risks', count: (risks.data as unknown[] | undefined)?.length ?? 0 },\n    { key: 'actions', label: 'Actions', count: (actions.data as unknown[] | undefined)?.length ?? 0 },\n    { key: 'decisions', label: 'Decisions', count: (decisions.data as unknown[] | undefined)?.length ?? 0 },\n    { key: 'stories', label: 'User Stories', count: 0 },\n    { key: 'trash', label: 'Trash', count: trashCount },\n  ];\n  const totalEntities = entityTabs.reduce((s, t) => s + t.count, 0);\n\n  const isLoading = questions.isLoading || facts.isLoading || risks.isLoading || actions.isLoading || decisions.isLoading;\n  const hasError = questions.isError || facts.isError || risks.isError || actions.isError || decisions.isError;\n  const refetchAll = () => { questions.refetch(); facts.refetch(); risks.refetch(); actions.refetch(); decisions.refetch(); };\n\n  function makeSaveHandler(\n    serverData: Array<{ id: string }> | undefined,\n    createMut: { mutate: (data: Record<string, unknown>) => void },\n    updateMut: { mutate: (data: { id: string; [key: string]: unknown }) => void },\n  ) {\n    return (item: { id: string; [key: string]: unknown }) => {\n      const exists = serverData?.some(x => x.id === item.id);\n      if (exists) { updateMut.mutate(item); } else { const { id: _clientId, ...data } = item; createMut.mutate(data); }\n    };\n  }\n\n  const handleExport = async (format: 'markdown' | 'html' | 'json') => {\n    try {\n      const data = await apiClient.get<string | Record<string, unknown>>(`/api/sot/export/${format}`);\n      const content = typeof data === 'string' ? data : JSON.stringify(data, null, 2);\n      const mime = format === 'json' ? 'application/json' : 'text/plain';\n      const blob = new Blob([content], { type: mime });\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `sot-export.${format === 'markdown' ? 'md' : format}`;\n      a.click();\n      URL.revokeObjectURL(url);\n      toast.success(`Exported as ${format.toUpperCase()}`);\n    } catch {\n      toast.error('Export failed');\n    }\n  };\n\n  const criticalAlerts = alerts.filter(a => a.severity === 'critical' || a.severity === 'high');\n\n  // Timeline grouping by date\n  const groupedTimeline = useMemo(() => {\n    const groups: Record<string, Array<Record<string, unknown>>> = {};\n    for (const ev of timeline) {\n      const d = ev.date || ev.created_at || ev.timestamp;\n      const day = d ? new Date(d as string).toLocaleDateString() : 'Unknown';\n      if (!groups[day]) groups[day] = [];\n      groups[day].push(ev);\n    }\n    return Object.entries(groups);\n  }, [timeline]);\n\n  return (\n    <div className=\"p-6 space-y-5\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-xl font-bold text-[var(--gm-text-primary)]\">Source of Truth</h1>\n          <p className=\"text-xs text-[var(--gm-text-tertiary)]\">{totalEntities} entities · {alerts.length} alerts · Score {healthScore}%</p>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <button onClick={() => handleExport('markdown')} aria-label=\"Export as Markdown\" className=\"inline-flex items-center gap-1.5 px-3 py-1.5 text-[10px] font-medium rounded-lg bg-[var(--gm-interactive-secondary)] text-[var(--gm-text-primary)] hover:bg-[var(--gm-interactive-secondary-hover)] border border-[var(--gm-border-primary)]\">\n            <FileText className=\"w-3 h-3\" /> MD\n          </button>\n          <button onClick={() => handleExport('html')} aria-label=\"Export as HTML\" className=\"inline-flex items-center gap-1.5 px-3 py-1.5 text-[10px] font-medium rounded-lg bg-[var(--gm-interactive-secondary)] text-[var(--gm-text-primary)] hover:bg-[var(--gm-interactive-secondary-hover)] border border-[var(--gm-border-primary)]\">\n            <Globe className=\"w-3 h-3\" /> HTML\n          </button>\n          <button onClick={() => handleExport('json')} aria-label=\"Export as JSON\" className=\"inline-flex items-center gap-1.5 px-3 py-1.5 text-[10px] font-medium rounded-lg bg-[var(--gm-interactive-secondary)] text-[var(--gm-text-primary)] hover:bg-[var(--gm-interactive-secondary-hover)] border border-[var(--gm-border-primary)]\">\n            <FileJson className=\"w-3 h-3\" /> JSON\n          </button>\n        </div>\n      </div>\n\n      {/* Main Tabs */}\n      <div className={cn(CARD, 'p-1 flex gap-1')} role=\"tablist\">\n        {([\n          { key: 'overview' as MainTab, label: 'Overview', icon: Heart },\n          { key: 'entities' as MainTab, label: `Entities (${totalEntities})`, icon: FileText },\n          { key: 'timeline' as MainTab, label: `Timeline (${timeline.length})`, icon: Clock },\n          { key: 'history' as MainTab, label: `History (${versions.length})`, icon: History },\n        ]).map(t => (\n          <button key={t.key} onClick={() => setMainTab(t.key)}\n            role=\"tab\" aria-selected={mainTab === t.key}\n            className={cn('flex-1 flex items-center justify-center gap-1.5 px-3 py-2 text-[11px] font-medium rounded-lg transition-colors',\n              mainTab === t.key ? 'bg-[var(--gm-accent-primary)]/15 text-[var(--gm-accent-primary)]' : 'text-[var(--gm-text-tertiary)] hover:text-[var(--gm-text-secondary)]')}>\n            <t.icon className=\"w-3.5 h-3.5\" /> {t.label}\n          </button>\n        ))}\n      </div>\n\n      {/* ── OVERVIEW TAB ── */}\n      {mainTab === 'overview' && (\n        <div className=\"space-y-5\">\n          {/* Health + Delta Row */}\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n            {/* Health Score */}\n            <div className={cn(CARD, 'p-5 flex items-center gap-5')}>\n              <div className=\"relative w-20 h-20 shrink-0\">\n                <svg viewBox=\"0 0 36 36\" className=\"w-full h-full -rotate-90\">\n                  <circle cx=\"18\" cy=\"18\" r=\"15.5\" fill=\"none\" stroke=\"var(--gm-bg-tertiary)\" strokeWidth=\"3\" />\n                  <circle cx=\"18\" cy=\"18\" r=\"15.5\" fill=\"none\" stroke={healthColor} strokeWidth=\"3\"\n                    strokeDasharray={`${(healthScore / 100) * 97.4} 97.4`} strokeLinecap=\"round\" className=\"transition-all duration-700\" />\n                </svg>\n                <span className=\"absolute inset-0 flex items-center justify-center text-lg font-bold tabular-nums\" style={{ color: healthColor }}>{healthScore}</span>\n              </div>\n              <div>\n                <div className={SECTION_TITLE}>Health Score</div>\n                <p className=\"text-xs text-[var(--gm-text-secondary)] mt-1 capitalize\">{(health.status || '—') as string}</p>\n                {Array.isArray(health.factors) && (\n                  <div className=\"flex flex-wrap gap-1 mt-2\">\n                    {(health.factors as Array<Record<string, unknown>>).slice(0, 3).map((f, i) => (\n                      <span key={i} className=\"text-[8px] px-1.5 py-0.5 rounded bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-tertiary)]\">{(f.name || f.label || f.factor) as string}</span>\n                    ))}\n                  </div>\n                )}\n              </div>\n            </div>\n\n            {/* Change Delta */}\n            <div className={cn(CARD, 'p-5')}>\n              <div className={SECTION_TITLE}>Changes Since Last View</div>\n              {delta.isFirstView ? (\n                <p className=\"text-xs text-[var(--gm-text-tertiary)] mt-2\">First view — no prior snapshot</p>\n              ) : changes.length > 0 ? (\n                <div className=\"mt-2 space-y-1.5\">\n                  {changes.map((ch, i) => {\n                    const change = Number(ch.change ?? 0);\n                    return (\n                      <div key={i} className=\"flex items-center justify-between text-xs\">\n                        <span className=\"text-[var(--gm-text-secondary)] capitalize\">{(ch.metric || '—') as string}</span>\n                        <span className={cn('flex items-center gap-1 font-medium tabular-nums',\n                          change > 0 ? 'text-green-400' : change < 0 ? 'text-red-400' : 'text-[var(--gm-text-tertiary)]')}>\n                          {change > 0 ? <ArrowUpRight className=\"w-3 h-3\" /> : change < 0 ? <ArrowDownRight className=\"w-3 h-3\" /> : <Minus className=\"w-3 h-3\" />}\n                          {change > 0 ? '+' : ''}{change}\n                        </span>\n                      </div>\n                    );\n                  })}\n                </div>\n              ) : (\n                <p className=\"text-xs text-[var(--gm-text-tertiary)] mt-2\">No changes since last view</p>\n              )}\n              {delta.summary && <p className=\"text-[10px] text-[var(--gm-text-tertiary)] mt-2\">{delta.summary as string}</p>}\n            </div>\n\n            {/* Alerts Summary */}\n            <div className={cn(CARD, 'p-5')}>\n              <div className={SECTION_TITLE}>Alerts ({alerts.length})</div>\n              {alerts.length > 0 ? (\n                <div className=\"mt-2 space-y-2 max-h-40 overflow-y-auto\">\n                  {alerts.slice(0, 8).map((a, i) => (\n                    <div key={i} className=\"flex items-start gap-2\">\n                      <span className={cn('w-1.5 h-1.5 rounded-full mt-1.5 shrink-0',\n                        a.severity === 'critical' ? 'bg-red-500' : a.severity === 'high' ? 'bg-orange-500' : a.severity === 'medium' ? 'bg-amber-500' : 'bg-blue-500')} />\n                      <div className=\"min-w-0\">\n                        <span className=\"text-[10px] font-medium text-[var(--gm-text-primary)] block truncate\">{(a.title || a.message || '—') as string}</span>\n                        {a.message && a.title && <span className=\"text-[9px] text-[var(--gm-text-tertiary)] block truncate\">{a.message as string}</span>}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              ) : (\n                <p className=\"text-xs text-green-400 mt-2\">No active alerts</p>\n              )}\n            </div>\n          </div>\n\n          {/* Insights */}\n          {insights.length > 0 && (\n            <div className={cn(CARD, 'overflow-hidden')}>\n              <button onClick={() => setExpandedInsights(!expandedInsights)}\n                className=\"w-full px-5 py-3 flex items-center justify-between border-b border-[var(--gm-border-primary)] hover:bg-[var(--gm-surface-hover)]\">\n                <div className=\"flex items-center gap-2\">\n                  <Lightbulb className=\"w-3.5 h-3.5 text-[var(--gm-accent-primary)]\" />\n                  <span className={SECTION_TITLE}>Insights ({insights.length})</span>\n                </div>\n                {expandedInsights ? <ChevronUp className=\"w-3.5 h-3.5 text-[var(--gm-text-tertiary)]\" /> : <ChevronDown className=\"w-3.5 h-3.5 text-[var(--gm-text-tertiary)]\" />}\n              </button>\n              {expandedInsights && (\n                <div className=\"divide-y divide-[var(--gm-border-primary)]\">\n                  {insights.map((ins, i) => (\n                    <div key={i} className=\"px-5 py-3 flex items-start gap-3 hover:bg-[var(--gm-surface-hover)]\">\n                      <span className=\"text-lg shrink-0\">{(ins.icon || '💡') as string}</span>\n                      <div className=\"min-w-0 flex-1\">\n                        <div className=\"flex items-center gap-2\">\n                          <span className=\"text-xs font-semibold text-[var(--gm-text-primary)]\">{(ins.title || '—') as string}</span>\n                          {ins.category && <span className=\"text-[8px] px-1.5 py-0.5 rounded bg-[var(--gm-bg-tertiary)] text-[var(--gm-text-tertiary)] capitalize\">{ins.category as string}</span>}\n                        </div>\n                        <p className=\"text-[10px] text-[var(--gm-text-secondary)] mt-0.5\">{(ins.message || '—') as string}</p>\n                        {ins.suggestion && <p className=\"text-[10px] text-[var(--gm-accent-primary)] mt-1\">→ {ins.suggestion as string}</p>}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Executive Summary */}\n          <div className={cn(CARD, 'p-4 flex items-center gap-3')}>\n            <button onClick={() => genSummary.mutate(undefined, {\n              onSuccess: (d) => {\n                const content = (d as Record<string, unknown>)?.content || (d as Record<string, unknown>)?.summary;\n                if (content) toast.success('Executive summary generated');\n                else toast.info('No summary content returned');\n              },\n              onError: (e: Error) => toast.error(e.message),\n            })} disabled={genSummary.isPending}\n              className=\"inline-flex items-center gap-1.5 px-4 py-2 text-xs font-medium rounded-lg bg-[var(--gm-accent-primary)] text-white hover:opacity-90 transition-opacity\">\n              {genSummary.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Zap className=\"w-3.5 h-3.5\" />}\n              Generate Executive Summary\n            </button>\n            <span className=\"text-[10px] text-[var(--gm-text-tertiary)]\">AI-generated summary of health, risks, and key decisions</span>\n          </div>\n        </div>\n      )}\n\n      {/* ── ENTITIES TAB ── */}\n      {mainTab === 'entities' && (\n        <div className=\"space-y-4\">\n          <div className=\"flex gap-1 bg-[var(--gm-bg-tertiary)] rounded-xl p-1\" role=\"tablist\">\n            {entityTabs.map((tab) => (\n              <button key={tab.key} onClick={() => setEntityTab(tab.key)}\n                role=\"tab\" aria-selected={entityTab === tab.key}\n                className={cn('flex-1 px-3 py-2 rounded-lg text-sm font-medium transition-colors relative',\n                  entityTab === tab.key ? 'bg-[var(--gm-surface-primary)] text-[var(--gm-text-primary)] shadow-sm' : 'text-[var(--gm-text-tertiary)] hover:text-[var(--gm-text-secondary)]')}>\n                {tab.label}\n                <span className=\"ml-1.5 text-[10px] opacity-60\">{tab.count}</span>\n              </button>\n            ))}\n          </div>\n\n          {hasError ? (\n            <ErrorState message=\"Failed to load Source of Truth data.\" onRetry={refetchAll} />\n          ) : isLoading ? (\n            <SotSkeleton />\n          ) : (\n            <motion.div key={entityTab} initial={{ opacity: 0 }} animate={{ opacity: 1 }}>\n              {entityTab === 'questions' && <QuestionsPanel initialData={(questions.data ?? []) as Question[]} onSave={makeSaveHandler(questions.data as { id: string }[], createQuestion, updateQuestion)} onDelete={(id) => deleteQuestion.mutate(id)} />}\n              {entityTab === 'facts' && <FactsPanel initialData={(facts.data ?? []) as Fact[]} onSave={makeSaveHandler(facts.data as { id: string }[], createFact, updateFact)} onDelete={(id) => deleteFact.mutate(id)} />}\n              {entityTab === 'risks' && <RisksPanel initialData={(risks.data ?? []) as Risk[]} onSave={makeSaveHandler(risks.data as { id: string }[], createRisk, updateRisk)} onDelete={(id) => deleteRisk.mutate(id)} />}\n              {entityTab === 'actions' && <ActionsPanel initialData={(actions.data ?? []) as Action[]} onSave={makeSaveHandler(actions.data as { id: string }[], createAction, updateAction)} onDelete={(id) => deleteAction.mutate(id)} />}\n              {entityTab === 'decisions' && <DecisionsPanel initialData={(decisions.data ?? []) as Decision[]} onSave={makeSaveHandler(decisions.data as { id: string }[], createDecision, updateDecision)} onDelete={(id) => deleteDecision.mutate(id)} />}\n              {entityTab === 'stories' && <UserStoriesPanel />}\n              {entityTab === 'trash' && (\n                <div className=\"space-y-4\">\n                  <div className=\"flex items-center gap-2 text-[var(--gm-text-tertiary)]\">\n                    <Trash2 className=\"w-4 h-4\" />\n                    <span className=\"text-sm font-medium\">Deleted entities ({trashCount})</span>\n                  </div>\n                  {trashCount === 0 ? (\n                    <p className=\"text-sm text-[var(--gm-text-tertiary)] text-center py-12\">Trash is empty</p>\n                  ) : (\n                    <div className=\"space-y-2\">\n                      {(dFacts as Array<Record<string, unknown>>).map(item => (\n                        <div key={String(item.id)} className=\"flex items-center gap-3 bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-3\">\n                          <span className=\"text-[9px] font-medium px-2 py-0.5 rounded-full bg-blue-500/10 text-blue-400\">fact</span>\n                          <span className=\"flex-1 text-sm text-[var(--gm-text-secondary)] truncate\">{(item.content || '—') as string}</span>\n                          <button onClick={() => { restoreFact.mutate(String(item.id)); toast.success('Fact restored'); }}\n                            disabled={restoreFact.isPending}\n                            className=\"inline-flex items-center gap-1 px-2.5 py-1 text-[10px] font-medium rounded-lg bg-green-500/10 text-green-400 hover:bg-green-500/20\">\n                            <RotateCw className=\"w-3 h-3\" /> Restore\n                          </button>\n                        </div>\n                      ))}\n                      {(dDecs as Array<Record<string, unknown>>).map(item => (\n                        <div key={String(item.id)} className=\"flex items-center gap-3 bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-3\">\n                          <span className=\"text-[9px] font-medium px-2 py-0.5 rounded-full bg-purple-500/10 text-purple-400\">decision</span>\n                          <span className=\"flex-1 text-sm text-[var(--gm-text-secondary)] truncate\">{(item.content || '—') as string}</span>\n                          <button onClick={() => { restoreDecision.mutate(String(item.id)); toast.success('Decision restored'); }}\n                            disabled={restoreDecision.isPending}\n                            className=\"inline-flex items-center gap-1 px-2.5 py-1 text-[10px] font-medium rounded-lg bg-green-500/10 text-green-400 hover:bg-green-500/20\">\n                            <RotateCw className=\"w-3 h-3\" /> Restore\n                          </button>\n                        </div>\n                      ))}\n                      {(dRisks as Array<Record<string, unknown>>).map(item => (\n                        <div key={String(item.id)} className=\"flex items-center gap-3 bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-3\">\n                          <span className=\"text-[9px] font-medium px-2 py-0.5 rounded-full bg-red-500/10 text-red-400\">risk</span>\n                          <span className=\"flex-1 text-sm text-[var(--gm-text-secondary)] truncate\">{(item.content || '—') as string}</span>\n                          <button onClick={() => { restoreRisk.mutate(String(item.id)); toast.success('Risk restored'); }}\n                            disabled={restoreRisk.isPending}\n                            className=\"inline-flex items-center gap-1 px-2.5 py-1 text-[10px] font-medium rounded-lg bg-green-500/10 text-green-400 hover:bg-green-500/20\">\n                            <RotateCw className=\"w-3 h-3\" /> Restore\n                          </button>\n                        </div>\n                      ))}\n                      {(dActs as Array<Record<string, unknown>>).map(item => (\n                        <div key={String(item.id)} className=\"flex items-center gap-3 bg-[var(--gm-surface-primary)] border border-[var(--gm-border-primary)] rounded-xl p-3\">\n                          <span className=\"text-[9px] font-medium px-2 py-0.5 rounded-full bg-amber-500/10 text-amber-400\">action</span>\n                          <span className=\"flex-1 text-sm text-[var(--gm-text-secondary)] truncate\">{(item.task || item.content || '—') as string}</span>\n                          <button onClick={() => { restoreAction.mutate(String(item.id)); toast.success('Action restored'); }}\n                            disabled={restoreAction.isPending}\n                            className=\"inline-flex items-center gap-1 px-2.5 py-1 text-[10px] font-medium rounded-lg bg-green-500/10 text-green-400 hover:bg-green-500/20\">\n                            <RotateCw className=\"w-3 h-3\" /> Restore\n                          </button>\n                        </div>\n                      ))}\n                    </div>\n                  )}\n                </div>\n              )}\n            </motion.div>\n          )}\n        </div>\n      )}\n\n      {/* ── TIMELINE TAB ── */}\n      {mainTab === 'timeline' && (\n        <div className=\"space-y-4\">\n          {timelineLoading ? (\n            <div className=\"flex items-center justify-center h-32\"><Loader2 className=\"h-8 w-8 animate-spin text-[var(--gm-accent-primary)]\" /></div>\n          ) : groupedTimeline.length > 0 ? (\n            <div className=\"space-y-6\">\n              {groupedTimeline.map(([day, events]) => (\n                <div key={day}>\n                  <div className=\"sticky top-0 z-10 py-1.5 px-3 bg-[var(--gm-bg-primary)]\">\n                    <span className=\"text-[10px] font-bold text-[var(--gm-accent-primary)] uppercase tracking-wider\">{day}</span>\n                  </div>\n                  <div className=\"relative ml-4 border-l-2 border-[var(--gm-border-primary)] space-y-0\">\n                    {events.map((ev, i) => {\n                      const type = (ev.type || ev.entity_type || 'event') as string;\n                      const typeColors: Record<string, string> = {\n                        decision: 'bg-purple-500', risk: 'bg-red-500', action: 'bg-amber-500', fact: 'bg-blue-500',\n                        question: 'bg-cyan-500', document: 'bg-green-500', email: 'bg-pink-500', conversation: 'bg-indigo-500',\n                      };\n                      const time = ev.date || ev.created_at || ev.timestamp;\n                      return (\n                        <div key={i} className=\"relative pl-6 py-2.5 hover:bg-[var(--gm-surface-hover)] transition-colors rounded-r-lg\">\n                          <span className={cn('absolute left-[-5px] top-3.5 w-2.5 h-2.5 rounded-full border-2 border-[var(--gm-bg-primary)]', typeColors[type] || 'bg-gray-500')} />\n                          <div className=\"flex items-start justify-between gap-3\">\n                            <div className=\"min-w-0 flex-1\">\n                              <div className=\"flex items-center gap-2\">\n                                <span className={cn('text-[8px] px-1.5 py-0.5 rounded-full font-medium capitalize border',\n                                  type === 'risk' ? 'bg-red-500/10 border-red-500/30 text-red-400' :\n                                  type === 'decision' ? 'bg-purple-500/10 border-purple-500/30 text-purple-400' :\n                                  type === 'action' ? 'bg-amber-500/10 border-amber-500/30 text-amber-400' :\n                                  'bg-[var(--gm-bg-tertiary)] border-[var(--gm-border-primary)] text-[var(--gm-text-tertiary)]')}>{type}</span>\n                                <span className=\"text-xs font-medium text-[var(--gm-text-primary)] truncate\">{(ev.title || ev.content || ev.name || '—') as string}</span>\n                              </div>\n                              {ev.description && <p className=\"text-[10px] text-[var(--gm-text-tertiary)] mt-0.5 truncate\">{(ev.description || ev.content) as string}</p>}\n                            </div>\n                            <span className=\"text-[9px] text-[var(--gm-text-tertiary)] tabular-nums shrink-0 mt-0.5\">\n                              {time ? new Date(time as string).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) : ''}\n                            </span>\n                          </div>\n                        </div>\n                      );\n                    })}\n                  </div>\n                </div>\n              ))}\n            </div>\n          ) : (\n            <div className={cn(CARD, 'p-8 text-center')}>\n              <Clock className=\"w-8 h-8 text-[var(--gm-text-tertiary)] mx-auto mb-2\" />\n              <p className=\"text-sm text-[var(--gm-text-tertiary)]\">No timeline events yet</p>\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* ── HISTORY TAB ── */}\n      {mainTab === 'history' && (\n        <div className=\"space-y-5\">\n          {/* Version List */}\n          {versions.length > 0 ? (\n            <div className={cn(CARD, 'overflow-hidden')}>\n              <div className=\"px-5 py-3 border-b border-[var(--gm-border-primary)] flex items-center justify-between\">\n                <span className={SECTION_TITLE}>Version History</span>\n                <span className=\"text-[10px] text-[var(--gm-text-tertiary)]\">{versions.length} snapshots</span>\n              </div>\n              <div className=\"max-h-72 overflow-y-auto divide-y divide-[var(--gm-border-primary)]\">\n                {versions.map((v, i) => (\n                  <div key={i} className=\"px-5 py-3 flex items-center hover:bg-[var(--gm-surface-hover)] transition-colors\">\n                    <div className=\"flex-1 min-w-0\">\n                      <div className=\"flex items-center gap-2\">\n                        <span className=\"text-xs font-bold text-[var(--gm-accent-primary)] tabular-nums\">v{(v.version_number || i + 1) as number}</span>\n                        <span className=\"text-[10px] text-[var(--gm-text-tertiary)] tabular-nums\">\n                          {v.created_at ? new Date(v.created_at as string).toLocaleString() : '—'}\n                        </span>\n                      </div>\n                      <div className=\"flex gap-3 mt-1 text-[9px] text-[var(--gm-text-tertiary)]\">\n                        {v.facts_count != null && <span>{v.facts_count as number} facts</span>}\n                        {v.decisions_count != null && <span>{v.decisions_count as number} decisions</span>}\n                        {v.risks_count != null && <span>{v.risks_count as number} risks</span>}\n                      </div>\n                    </div>\n                    <div className=\"flex gap-1\">\n                      <button onClick={() => setCompareV1(String(v.version_number ?? v.id))}\n                        className={cn('text-[9px] px-2 py-1 rounded border', compareV1 === String(v.version_number ?? v.id) ? 'bg-[var(--gm-accent-primary)]/15 border-[var(--gm-accent-primary)]/40 text-[var(--gm-accent-primary)]' : 'bg-[var(--gm-bg-tertiary)] border-[var(--gm-border-primary)] text-[var(--gm-text-tertiary)]')}>\n                        V1\n                      </button>\n                      <button onClick={() => setCompareV2(String(v.version_number ?? v.id))}\n                        className={cn('text-[9px] px-2 py-1 rounded border', compareV2 === String(v.version_number ?? v.id) ? 'bg-[var(--gm-accent-primary)]/15 border-[var(--gm-accent-primary)]/40 text-[var(--gm-accent-primary)]' : 'bg-[var(--gm-bg-tertiary)] border-[var(--gm-border-primary)] text-[var(--gm-text-tertiary)]')}>\n                        V2\n                      </button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          ) : (\n            <div className={cn(CARD, 'p-8 text-center')}>\n              <History className=\"w-8 h-8 text-[var(--gm-text-tertiary)] mx-auto mb-2\" />\n              <p className=\"text-sm text-[var(--gm-text-tertiary)]\">No version history yet</p>\n            </div>\n          )}\n\n          {/* Compare */}\n          {compareV1 && compareV2 && (\n            <div className={cn(CARD, 'p-5 space-y-3')}>\n              <div className=\"flex items-center justify-between\">\n                <span className={SECTION_TITLE}>Compare v{compareV1} ↔ v{compareV2}</span>\n                {compareQuery.isFetching && <Loader2 className=\"w-3.5 h-3.5 animate-spin text-[var(--gm-accent-primary)]\" />}\n              </div>\n              {diff.ok ? (\n                <pre className=\"text-[10px] text-[var(--gm-text-secondary)] font-mono bg-[var(--gm-bg-tertiary)] p-3 rounded-lg overflow-auto max-h-64 whitespace-pre-wrap\">\n                  {JSON.stringify(diff, null, 2)}\n                </pre>\n              ) : compareQuery.isError ? (\n                <p className=\"text-xs text-red-400\">Failed to compare versions</p>\n              ) : !compareQuery.isFetching ? (\n                <p className=\"text-xs text-[var(--gm-text-tertiary)]\">Select V1 and V2 to compare</p>\n              ) : null}\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":["COLORS","hashColor","name","h","i","ContactAvatar","contact","size","dim","txt","avatarRaw","avatarSrc","isValidAvatarUrl","jsx","cn","ContactInline","role","org","jsxs","OwnerSelect","value","onChange","placeholder","label","className","open","setOpen","useState","search","setSearch","ref","useRef","inputRef","contactsData","useContacts","contacts","filtered","c","q","selected","useEffect","handleClick","e","User","X","ChevronDown","Search","statusColor","s","priorityColor","p","QuestionModal","onClose","onSave","question","mode","empty","form","setForm","aiLoading","setAiLoading","chatMut","useSotChat","id","rest","handleAiSuggest","d","resp","prev","toast","handleAiAnswer","AnimatePresence","Fragment","motion","Loader2","Sparkles","Wand2","v","QuestionDetail","onBack","onEdit","onDelete","aiInsights","setAiInsights","handleAnalyze","ArrowLeft","Edit2","Trash2","OwnerBadge","MessageCircle","ins","QuestionsPanel","initialData","questions","setQuestions","enrichMut","useEnrichQuestions","statusFilter","setStatusFilter","priorityFilter","setPriorityFilter","modalOpen","setModalOpen","modalMode","setModalMode","editingItem","setEditingItem","detailItem","setDetailItem","useMemo","result","stats","handleSave","idx","x","u","handleDelete","content","l","priMatch","newQ","r","Plus","categoryColor","confidenceColor","FactModal","fact","handleAiRefine","confMatch","FactDetail","similarFacts","useAiSimilarFacts","handleVerify","FileText","Clock","sf","FactsPanel","facts","setFacts","categoryFilter","setCategoryFilter","f","cats","a","handleAiExtract","catMatch","newF","cat","count","levelColor","RiskModal","risk","suggestRisk","useAiSuggestRisk","handleAiMitigation","RiskDetail","riskScore","AlertTriangle","Shield","RisksPanel","risks","setRisks","impactFilter","setImpactFilter","handleAiScan","lines","title","desc","impMatch","likMatch","newR","emptyAction","ActionModal","action","propSprints","userStories","suggestTask","useAiSuggestTask","sprintsData","useSprints","sprints","storiesForSprint","field","input","parts","text","handleSubmit","taskText","ActionDetailView","handleAiAnalyze","handleAiSuggestNextSteps","Calendar","Target","BookOpen","insight","CreateSprintModal","createMut","useCreateSprint","data","sprint","sprintStatusColor","ActionsPanel","initialSprints","actions","setActions","apiSprints","viewMode","setViewMode","sprintFilter","setSprintFilter","expandedGroups","setExpandedGroups","actionModalOpen","setActionModalOpen","actionModalMode","setActionModalMode","editingAction","setEditingAction","sprintModalOpen","setSprintModalOpen","detailAction","setDetailAction","aiSuggestLoading","setAiSuggestLoading","handleAiSuggestActions","newA","toggleGroup","next","handleSaveAction","updated","handleDeleteAction","handleCreateSprint","openEditModal","ActionCard","renderBySprint","groups","unassigned","sprintActions","ChevronRight","renderByStory","storiesWithActions","story","g","noStory","storyActions","renderList","List","Layers","DecisionModal","decision","suggestDecision","useAiSuggestDecision","suggestOwner","useAiSuggestDecisionOwner","handleAiImpact","addition","owners","DecisionDetail","DecisionsPanel","decisions","setDecisions","rationale","newD","StoryModal","useCreateUserStory","updateMut","useUpdateUserStory","saving","CheckCircle2","UserStoriesPanel","isLoading","useUserStories","deleteMut","useDeleteUserStory","editTarget","setEditTarget","stories","list","handleEdit","handleCreate","CARD","SECTION_TITLE","SotPage","mainTab","setMainTab","entityTab","setEntityTab","compareV1","setCompareV1","compareV2","setCompareV2","expandedInsights","setExpandedInsights","healthData","useHealth","alertsData","useSotAlerts","insightsData","useSotInsights","deltaData","useSotDelta","useQuestions","useFacts","useRisks","useActions","useDecisions","createQuestion","useCreateQuestion","updateQuestion","useUpdateQuestion","deleteQuestion","useDeleteQuestion","createFact","useCreateFact","updateFact","useUpdateFact","deleteFact","useDeleteFact","createRisk","useCreateRisk","updateRisk","useUpdateRisk","deleteRisk","useDeleteRisk","createAction","useCreateAction","updateAction","useUpdateAction","deleteAction","useDeleteAction","createDecision","useCreateDecision","updateDecision","useUpdateDecision","deleteDecision","useDeleteDecision","deletedFacts","useDeletedFacts","restoreFact","useRestoreFact","deletedDecisions","useDeletedDecisions","restoreDecision","useRestoreDecision","deletedRisks","useDeletedRisks","restoreRisk","useRestoreRisk","deletedActions","useDeletedActions","restoreAction","useRestoreAction","timelineData","timelineLoading","useSotTimeline","versionsData","useSotVersions","compareQuery","useSotCompare","genSummary","useSotGenerateSummary","health","alerts","insights","delta","changes","timeline","versions","diff","healthScore","healthColor","dFacts","dDecs","dRisks","dActs","trashCount","entityTabs","totalEntities","t","hasError","refetchAll","makeSaveHandler","serverData","item","_clientId","handleExport","format","apiClient","mime","blob","url","groupedTimeline","ev","day","Globe","FileJson","Heart","History","ch","change","ArrowUpRight","ArrowDownRight","Minus","Lightbulb","ChevronUp","Zap","tab","ErrorState","SotSkeleton","RotateCw","events","type","typeColors","time"],"mappings":"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"}
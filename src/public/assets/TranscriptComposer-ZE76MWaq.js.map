{"version":3,"file":"TranscriptComposer-ZE76MWaq.js","sources":["../../frontend/components/TranscriptComposer.ts"],"sourcesContent":["/**\r\n * Transcript Composer Component - SOTA UI\r\n * Multi-mode transcript input: paste text or upload file\r\n */\r\n\r\nimport { createElement, on } from '../utils/dom';\r\nimport { toast } from '../services/toast';\r\n\r\nexport interface TranscriptComposerProps {\r\n  onImport?: (document: unknown) => void;\r\n  onClose?: () => void;\r\n}\r\n\r\ntype InputMode = 'paste' | 'upload';\r\nlet currentMode: InputMode = 'paste';\r\n\r\n/**\r\n * Show transcript composer modal\r\n */\r\nexport function showTranscriptComposer(props: TranscriptComposerProps = {}): void {\r\n  const existing = document.getElementById('transcript-composer-overlay');\r\n  if (existing) existing.remove();\r\n\r\n  const overlay = createElement('div', { \r\n    id: 'transcript-composer-overlay',\r\n    className: 'composer-overlay' \r\n  });\r\n\r\n  const dialog = createTranscriptComposer(props);\r\n  overlay.appendChild(dialog);\r\n  document.body.appendChild(overlay);\r\n\r\n  on(overlay, 'click', (e) => {\r\n    if (e.target === overlay) {\r\n      closeTranscriptComposer();\r\n      props.onClose?.();\r\n    }\r\n  });\r\n\r\n  // Animate in\r\n  requestAnimationFrame(() => {\r\n    overlay.classList.add('visible');\r\n  });\r\n}\r\n\r\n/**\r\n * Close transcript composer\r\n */\r\nexport function closeTranscriptComposer(): void {\r\n  const overlay = document.getElementById('transcript-composer-overlay');\r\n  if (overlay) {\r\n    overlay.classList.remove('visible');\r\n    setTimeout(() => overlay.remove(), 200);\r\n  }\r\n}\r\n\r\n/**\r\n * Create transcript composer\r\n */\r\nfunction createTranscriptComposer(props: TranscriptComposerProps): HTMLElement {\r\n  const container = createElement('div', { className: 'composer-modal' });\r\n\r\n  container.innerHTML = `\r\n    <style>\r\n      .composer-overlay {\r\n        position: fixed;\r\n        inset: 0;\r\n        background: rgba(0, 0, 0, 0.5);\r\n        backdrop-filter: blur(8px);\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        z-index: 10000;\r\n        opacity: 0;\r\n        transition: opacity 0.2s ease;\r\n      }\r\n      .composer-overlay.visible {\r\n        opacity: 1;\r\n      }\r\n      .composer-overlay.visible .composer-modal {\r\n        transform: translateY(0) scale(1);\r\n        opacity: 1;\r\n      }\r\n      .composer-modal {\r\n        width: 640px;\r\n        max-width: 95vw;\r\n        max-height: 85vh;\r\n        background: var(--bg-primary);\r\n        border-radius: 16px;\r\n        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);\r\n        display: flex;\r\n        flex-direction: column;\r\n        overflow: hidden;\r\n        transform: translateY(20px) scale(0.98);\r\n        opacity: 0;\r\n        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\r\n      }\r\n      \r\n      /* Header */\r\n      .composer-header {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: space-between;\r\n        padding: 20px 24px;\r\n        border-bottom: 1px solid var(--border-color);\r\n      }\r\n      .composer-header h2 {\r\n        margin: 0;\r\n        font-size: 18px;\r\n        font-weight: 600;\r\n        color: var(--text-primary);\r\n      }\r\n      .composer-close {\r\n        width: 32px;\r\n        height: 32px;\r\n        border: none;\r\n        background: var(--bg-secondary);\r\n        border-radius: 8px;\r\n        cursor: pointer;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        color: var(--text-secondary);\r\n        transition: all 0.15s ease;\r\n      }\r\n      .composer-close:hover {\r\n        background: var(--bg-tertiary);\r\n        color: var(--text-primary);\r\n      }\r\n      \r\n      /* Tabs */\r\n      .composer-tabs {\r\n        display: flex;\r\n        padding: 0 24px;\r\n        border-bottom: 1px solid var(--border-color);\r\n        background: var(--bg-secondary);\r\n      }\r\n      .composer-tab {\r\n        padding: 14px 20px;\r\n        font-size: 14px;\r\n        font-weight: 500;\r\n        color: var(--text-secondary);\r\n        background: none;\r\n        border: none;\r\n        cursor: pointer;\r\n        position: relative;\r\n        transition: color 0.15s ease;\r\n      }\r\n      .composer-tab:hover {\r\n        color: var(--text-primary);\r\n      }\r\n      .composer-tab.active {\r\n        color: var(--primary);\r\n      }\r\n      .composer-tab.active::after {\r\n        content: '';\r\n        position: absolute;\r\n        bottom: 0;\r\n        left: 0;\r\n        right: 0;\r\n        height: 2px;\r\n        background: var(--primary);\r\n        border-radius: 2px 2px 0 0;\r\n      }\r\n      \r\n      /* Content */\r\n      .composer-body {\r\n        flex: 1;\r\n        padding: 24px;\r\n        overflow-y: auto;\r\n      }\r\n      \r\n      /* Paste Mode */\r\n      .paste-section label {\r\n        display: block;\r\n        font-size: 14px;\r\n        font-weight: 500;\r\n        color: var(--text-primary);\r\n        margin-bottom: 12px;\r\n      }\r\n      .paste-section textarea {\r\n        width: 100%;\r\n        min-height: 280px;\r\n        padding: 16px;\r\n        border: 1px solid var(--border-color);\r\n        border-radius: 12px;\r\n        background: var(--bg-secondary);\r\n        color: var(--text-primary);\r\n        font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;\r\n        font-size: 13px;\r\n        line-height: 1.6;\r\n        resize: vertical;\r\n        transition: border-color 0.15s ease, box-shadow 0.15s ease;\r\n      }\r\n      .paste-section textarea:focus {\r\n        outline: none;\r\n        border-color: var(--primary);\r\n        box-shadow: 0 0 0 3px rgba(var(--primary-rgb), 0.1);\r\n      }\r\n      .paste-section textarea::placeholder {\r\n        color: var(--text-tertiary);\r\n      }\r\n      .paste-hint {\r\n        margin-top: 12px;\r\n        font-size: 13px;\r\n        color: var(--text-tertiary);\r\n      }\r\n      \r\n      /* Source Select */\r\n      .source-row {\r\n        margin-top: 20px;\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 12px;\r\n      }\r\n      .source-row label {\r\n        font-size: 13px;\r\n        color: var(--text-secondary);\r\n        white-space: nowrap;\r\n      }\r\n      .source-row select {\r\n        flex: 1;\r\n        max-width: 200px;\r\n        padding: 10px 14px;\r\n        border: 1px solid var(--border-color);\r\n        border-radius: 8px;\r\n        background: var(--bg-secondary);\r\n        color: var(--text-primary);\r\n        font-size: 13px;\r\n        cursor: pointer;\r\n      }\r\n      .source-row select:focus {\r\n        outline: none;\r\n        border-color: var(--primary);\r\n      }\r\n      \r\n      /* Upload Mode */\r\n      .upload-section .dropzone {\r\n        border: 2px dashed var(--border-color);\r\n        border-radius: 16px;\r\n        padding: 60px 40px;\r\n        text-align: center;\r\n        cursor: pointer;\r\n        transition: all 0.2s ease;\r\n        background: var(--bg-secondary);\r\n      }\r\n      .upload-section .dropzone:hover,\r\n      .upload-section .dropzone.dragover {\r\n        border-color: var(--primary);\r\n        background: rgba(var(--primary-rgb), 0.03);\r\n      }\r\n      .dropzone-icon {\r\n        font-size: 48px;\r\n        margin-bottom: 16px;\r\n      }\r\n      .dropzone-title {\r\n        font-size: 16px;\r\n        font-weight: 500;\r\n        color: var(--text-primary);\r\n        margin-bottom: 8px;\r\n      }\r\n      .dropzone-hint {\r\n        font-size: 13px;\r\n        color: var(--text-tertiary);\r\n      }\r\n      \r\n      /* Selected File */\r\n      .selected-file {\r\n        display: none;\r\n        align-items: center;\r\n        gap: 16px;\r\n        margin-top: 20px;\r\n        padding: 16px;\r\n        background: var(--bg-secondary);\r\n        border-radius: 12px;\r\n        border: 1px solid var(--border-color);\r\n      }\r\n      .selected-file.visible {\r\n        display: flex;\r\n      }\r\n      .file-icon {\r\n        width: 48px;\r\n        height: 48px;\r\n        background: linear-gradient(135deg, var(--primary), color-mix(in srgb, var(--primary) 70%, white));\r\n        border-radius: 12px;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        font-size: 24px;\r\n      }\r\n      .file-info {\r\n        flex: 1;\r\n        min-width: 0;\r\n      }\r\n      .file-name {\r\n        font-size: 14px;\r\n        font-weight: 500;\r\n        color: var(--text-primary);\r\n        white-space: nowrap;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n      }\r\n      .file-size {\r\n        font-size: 12px;\r\n        color: var(--text-tertiary);\r\n        margin-top: 2px;\r\n      }\r\n      .file-remove {\r\n        width: 32px;\r\n        height: 32px;\r\n        border: none;\r\n        background: transparent;\r\n        border-radius: 8px;\r\n        cursor: pointer;\r\n        color: var(--text-tertiary);\r\n        font-size: 18px;\r\n        transition: all 0.15s ease;\r\n      }\r\n      .file-remove:hover {\r\n        background: rgba(239, 68, 68, 0.1);\r\n        color: #ef4444;\r\n      }\r\n      \r\n      /* Footer */\r\n      .composer-footer {\r\n        display: flex;\r\n        justify-content: flex-end;\r\n        gap: 12px;\r\n        padding: 16px 24px;\r\n        border-top: 1px solid var(--border-color);\r\n        background: var(--bg-secondary);\r\n      }\r\n      .composer-footer .btn {\r\n        padding: 10px 20px;\r\n        border-radius: 10px;\r\n        font-size: 14px;\r\n        font-weight: 500;\r\n        cursor: pointer;\r\n        transition: all 0.15s ease;\r\n        border: none;\r\n      }\r\n      .composer-footer .btn-secondary {\r\n        background: var(--bg-primary);\r\n        color: var(--text-primary);\r\n        border: 1px solid var(--border-color);\r\n      }\r\n      .composer-footer .btn-secondary:hover {\r\n        background: var(--bg-tertiary);\r\n      }\r\n      .composer-footer .btn-primary {\r\n        background: var(--primary);\r\n        color: white;\r\n      }\r\n      .composer-footer .btn-primary:hover:not(:disabled) {\r\n        opacity: 0.9;\r\n        transform: translateY(-1px);\r\n      }\r\n      .composer-footer .btn-primary:disabled {\r\n        opacity: 0.5;\r\n        cursor: not-allowed;\r\n      }\r\n    </style>\r\n    \r\n    <div class=\"composer-header\">\r\n      <h2>Import Transcript</h2>\r\n      <button class=\"composer-close\" id=\"close-btn\">\r\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n          <path d=\"M18 6L6 18M6 6l12 12\"/>\r\n        </svg>\r\n      </button>\r\n    </div>\r\n    \r\n    <div class=\"composer-tabs\">\r\n      <button class=\"composer-tab active\" data-mode=\"paste\">Paste Text</button>\r\n      <button class=\"composer-tab\" data-mode=\"upload\">Upload File</button>\r\n    </div>\r\n    \r\n    <div class=\"composer-body\" id=\"composer-body\">\r\n      ${renderPasteMode()}\r\n    </div>\r\n    \r\n    <div class=\"composer-footer\">\r\n      <button class=\"btn btn-secondary\" id=\"cancel-btn\">Cancel</button>\r\n      <button class=\"btn btn-primary\" id=\"import-btn\" disabled>Process Transcript</button>\r\n    </div>\r\n  `;\r\n\r\n  // Bind tabs\r\n  container.querySelectorAll('.composer-tab').forEach(tab => {\r\n    on(tab as HTMLElement, 'click', () => {\r\n      container.querySelectorAll('.composer-tab').forEach(t => t.classList.remove('active'));\r\n      tab.classList.add('active');\r\n      currentMode = tab.getAttribute('data-mode') as InputMode;\r\n      renderMode(container);\r\n    });\r\n  });\r\n\r\n  // Bind close\r\n  on(container.querySelector('#close-btn') as HTMLElement, 'click', () => {\r\n    closeTranscriptComposer();\r\n    props.onClose?.();\r\n  });\r\n\r\n  // Bind cancel\r\n  on(container.querySelector('#cancel-btn') as HTMLElement, 'click', () => {\r\n    closeTranscriptComposer();\r\n    props.onClose?.();\r\n  });\r\n\r\n  // Bind import\r\n  const importBtn = container.querySelector('#import-btn') as HTMLButtonElement;\r\n  on(importBtn, 'click', () => handleImport(container, props));\r\n\r\n  // Initial binding\r\n  bindPasteMode(container);\r\n\r\n  return container;\r\n}\r\n\r\nfunction renderMode(container: HTMLElement): void {\r\n  const body = container.querySelector('#composer-body') as HTMLElement;\r\n  body.innerHTML = currentMode === 'paste' ? renderPasteMode() : renderUploadMode();\r\n  \r\n  if (currentMode === 'paste') {\r\n    bindPasteMode(container);\r\n  } else {\r\n    bindUploadMode(container);\r\n  }\r\n}\r\n\r\nfunction renderPasteMode(): string {\r\n  return `\r\n    <div class=\"paste-section\">\r\n      <label>Paste meeting transcript:</label>\r\n      <textarea id=\"transcript-input\" placeholder=\"Paste your meeting transcript here...\r\n\r\nSupported formats:\r\n‚Ä¢ Krisp transcripts\r\n‚Ä¢ Otter.ai transcripts  \r\n‚Ä¢ Zoom meeting transcripts\r\n‚Ä¢ Google Meet transcripts\r\n‚Ä¢ Microsoft Teams transcripts\r\n\r\nExample:\r\nSpeaker 1 (00:00:05):\r\nHello everyone, welcome to today's meeting.\r\n\r\nSpeaker 2 (00:00:12):\r\nThanks for having us. Let's get started.\"></textarea>\r\n      <p class=\"paste-hint\">Include speaker names and timestamps if available for better parsing.</p>\r\n      <div class=\"source-row\">\r\n        <label>Source:</label>\r\n        <select id=\"source-select\">\r\n          <option value=\"\">Auto-detect</option>\r\n          <option value=\"krisp\">Krisp</option>\r\n          <option value=\"otter\">Otter.ai</option>\r\n          <option value=\"zoom\">Zoom</option>\r\n          <option value=\"meet\">Google Meet</option>\r\n          <option value=\"teams\">Microsoft Teams</option>\r\n        </select>\r\n      </div>\r\n    </div>\r\n  `;\r\n}\r\n\r\nfunction bindPasteMode(container: HTMLElement): void {\r\n  const textarea = container.querySelector('#transcript-input') as HTMLTextAreaElement;\r\n  const importBtn = container.querySelector('#import-btn') as HTMLButtonElement;\r\n\r\n  if (textarea) {\r\n    on(textarea, 'input', () => {\r\n      importBtn.disabled = textarea.value.trim().length < 20;\r\n    });\r\n  }\r\n}\r\n\r\nfunction renderUploadMode(): string {\r\n  return `\r\n    <div class=\"upload-section\">\r\n      <div class=\"dropzone\" id=\"file-dropzone\">\r\n        <div class=\"dropzone-icon\">üéôÔ∏è</div>\r\n        <p class=\"dropzone-title\">Drop transcript file here</p>\r\n        <p class=\"dropzone-hint\">or click to browse ‚Ä¢ .txt, .md, .srt, .vtt</p>\r\n        <input type=\"file\" id=\"file-input\" accept=\".txt,.md,.srt,.vtt,.json\" hidden>\r\n      </div>\r\n      <div class=\"selected-file\" id=\"selected-file\">\r\n        <div class=\"file-icon\">üìÑ</div>\r\n        <div class=\"file-info\">\r\n          <div class=\"file-name\" id=\"file-name\"></div>\r\n          <div class=\"file-size\" id=\"file-size\"></div>\r\n        </div>\r\n        <button class=\"file-remove\" id=\"file-remove\">√ó</button>\r\n      </div>\r\n    </div>\r\n  `;\r\n}\r\n\r\nfunction bindUploadMode(container: HTMLElement): void {\r\n  const dropzone = container.querySelector('#file-dropzone') as HTMLElement;\r\n  const input = container.querySelector('#file-input') as HTMLInputElement;\r\n  const selectedFile = container.querySelector('#selected-file') as HTMLElement;\r\n  const importBtn = container.querySelector('#import-btn') as HTMLButtonElement;\r\n\r\n  on(dropzone, 'click', () => input.click());\r\n\r\n  on(dropzone, 'dragover', (e) => {\r\n    e.preventDefault();\r\n    dropzone.classList.add('dragover');\r\n  });\r\n\r\n  on(dropzone, 'dragleave', () => dropzone.classList.remove('dragover'));\r\n\r\n  on(dropzone, 'drop', (e) => {\r\n    e.preventDefault();\r\n    dropzone.classList.remove('dragover');\r\n    const file = e.dataTransfer?.files[0];\r\n    if (file) selectFile(file, container);\r\n  });\r\n\r\n  on(input, 'change', () => {\r\n    if (input.files?.[0]) selectFile(input.files[0], container);\r\n  });\r\n\r\n  on(container.querySelector('#file-remove') as HTMLElement, 'click', () => {\r\n    selectedFile.classList.remove('visible');\r\n    (container as any)._fileContent = null;\r\n    importBtn.disabled = true;\r\n  });\r\n}\r\n\r\nfunction selectFile(file: File, container: HTMLElement): void {\r\n  const selectedFile = container.querySelector('#selected-file') as HTMLElement;\r\n  const importBtn = container.querySelector('#import-btn') as HTMLButtonElement;\r\n  \r\n  container.querySelector('#file-name')!.textContent = file.name;\r\n  container.querySelector('#file-size')!.textContent = formatFileSize(file.size);\r\n  selectedFile.classList.add('visible');\r\n\r\n  const reader = new FileReader();\r\n  reader.onload = () => {\r\n    (container as any)._fileContent = reader.result;\r\n    importBtn.disabled = false;\r\n  };\r\n  reader.readAsText(file);\r\n}\r\n\r\nfunction getContent(container: HTMLElement): string {\r\n  if (currentMode === 'paste') {\r\n    return (container.querySelector('#transcript-input') as HTMLTextAreaElement)?.value || '';\r\n  }\r\n  return (container as any)._fileContent || '';\r\n}\r\n\r\nasync function handleImport(container: HTMLElement, props: TranscriptComposerProps): Promise<void> {\r\n  const importBtn = container.querySelector('#import-btn') as HTMLButtonElement;\r\n  const cancelBtn = container.querySelector('#cancel-btn') as HTMLButtonElement;\r\n  const content = getContent(container);\r\n  if (!content) return;\r\n\r\n  // Prevent double-click\r\n  if (importBtn.disabled) return;\r\n  \r\n  importBtn.disabled = true;\r\n  cancelBtn.disabled = true;\r\n  \r\n  // Show processing state in footer\r\n  const footer = container.querySelector('.composer-footer') as HTMLElement;\r\n  const originalFooter = footer.innerHTML;\r\n  \r\n  footer.innerHTML = `\r\n    <div style=\"display: flex; align-items: center; gap: 12px; flex: 1;\">\r\n      <div class=\"processing-spinner\" style=\"\r\n        width: 20px;\r\n        height: 20px;\r\n        border: 2px solid var(--border-color);\r\n        border-top-color: var(--primary);\r\n        border-radius: 50%;\r\n        animation: spin 1s linear infinite;\r\n      \"></div>\r\n      <div style=\"flex: 1;\">\r\n        <div style=\"font-weight: 500; color: var(--text-primary);\" id=\"processing-status\">Uploading transcript...</div>\r\n        <div style=\"font-size: 12px; color: var(--text-tertiary);\" id=\"processing-detail\">Please wait</div>\r\n      </div>\r\n    </div>\r\n    <style>@keyframes spin { to { transform: rotate(360deg); } }</style>\r\n  `;\r\n  \r\n  const statusEl = footer.querySelector('#processing-status') as HTMLElement;\r\n  const detailEl = footer.querySelector('#processing-detail') as HTMLElement;\r\n\r\n  try {\r\n    const sourceSelect = container.querySelector('#source-select') as HTMLSelectElement;\r\n    const formData = new FormData();\r\n    const filename = `transcript_${Date.now()}.txt`;\r\n    formData.append('file', new Blob([content], { type: 'text/plain' }), filename);\r\n    formData.append('folder', 'newtranscripts');\r\n    if (sourceSelect?.value) formData.append('source', sourceSelect.value);\r\n\r\n    // Step 1: Upload\r\n    statusEl.textContent = 'Uploading transcript...';\r\n    detailEl.textContent = `${formatFileSize(content.length)} ‚Ä¢ ${filename}`;\r\n    \r\n    const response = await fetch('/api/upload', {\r\n      method: 'POST',\r\n      body: formData,\r\n      credentials: 'include'\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const errorData = await response.json().catch(() => ({}));\r\n      throw new Error(errorData.error || `Upload failed (${response.status})`);\r\n    }\r\n\r\n    const result = await response.json();\r\n    \r\n    // Step 2: Processing started\r\n    statusEl.textContent = 'Transcript uploaded!';\r\n    detailEl.textContent = 'AI processing will start automatically';\r\n    \r\n    // Show success state briefly\r\n    footer.innerHTML = `\r\n      <div style=\"display: flex; align-items: center; gap: 12px; flex: 1;\">\r\n        <div style=\"\r\n          width: 24px;\r\n          height: 24px;\r\n          background: #10b981;\r\n          border-radius: 50%;\r\n          display: flex;\r\n          align-items: center;\r\n          justify-content: center;\r\n          color: white;\r\n          font-size: 14px;\r\n        \">‚úì</div>\r\n        <div style=\"flex: 1;\">\r\n          <div style=\"font-weight: 500; color: #10b981;\">Transcript imported successfully!</div>\r\n          <div style=\"font-size: 12px; color: var(--text-tertiary);\">AI extraction will process in the background</div>\r\n        </div>\r\n      </div>\r\n      <button class=\"btn btn-primary\" id=\"done-btn\" style=\"\r\n        padding: 10px 20px;\r\n        border-radius: 10px;\r\n        font-size: 14px;\r\n        font-weight: 500;\r\n        cursor: pointer;\r\n        border: none;\r\n        background: var(--primary);\r\n        color: white;\r\n      \">Done</button>\r\n    `;\r\n    \r\n    // Bind done button\r\n    footer.querySelector('#done-btn')?.addEventListener('click', () => {\r\n      props.onImport?.(result);\r\n      closeTranscriptComposer();\r\n    });\r\n    \r\n    // Auto-close after 3 seconds\r\n    setTimeout(() => {\r\n      props.onImport?.(result);\r\n      closeTranscriptComposer();\r\n    }, 3000);\r\n    \r\n  } catch (err) {\r\n    console.error('[TranscriptComposer] Error:', err);\r\n    \r\n    // Show error state\r\n    footer.innerHTML = `\r\n      <div style=\"display: flex; align-items: center; gap: 12px; flex: 1;\">\r\n        <div style=\"\r\n          width: 24px;\r\n          height: 24px;\r\n          background: #ef4444;\r\n          border-radius: 50%;\r\n          display: flex;\r\n          align-items: center;\r\n          justify-content: center;\r\n          color: white;\r\n          font-size: 14px;\r\n        \">‚úï</div>\r\n        <div style=\"flex: 1;\">\r\n          <div style=\"font-weight: 500; color: #ef4444;\">Import failed</div>\r\n          <div style=\"font-size: 12px; color: var(--text-tertiary);\">${err instanceof Error ? err.message : 'Unknown error'}</div>\r\n        </div>\r\n      </div>\r\n      <button class=\"btn btn-secondary\" id=\"retry-btn\" style=\"\r\n        padding: 10px 20px;\r\n        border-radius: 10px;\r\n        font-size: 14px;\r\n        font-weight: 500;\r\n        cursor: pointer;\r\n        border: 1px solid var(--border-color);\r\n        background: var(--bg-primary);\r\n        color: var(--text-primary);\r\n      \">Try Again</button>\r\n    `;\r\n    \r\n    // Bind retry button\r\n    footer.querySelector('#retry-btn')?.addEventListener('click', () => {\r\n      footer.innerHTML = originalFooter;\r\n      const newImportBtn = footer.querySelector('#import-btn') as HTMLButtonElement;\r\n      const newCancelBtn = footer.querySelector('#cancel-btn') as HTMLButtonElement;\r\n      if (newImportBtn) {\r\n        newImportBtn.disabled = false;\r\n        newImportBtn.addEventListener('click', () => handleImport(container, props));\r\n      }\r\n      if (newCancelBtn) {\r\n        newCancelBtn.disabled = false;\r\n        newCancelBtn.addEventListener('click', () => {\r\n          closeTranscriptComposer();\r\n          props.onClose?.();\r\n        });\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction formatFileSize(bytes: number): string {\r\n  if (bytes < 1024) return `${bytes} B`;\r\n  if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;\r\n  return `${(bytes / (1024 * 1024)).toFixed(1)} MB`;\r\n}\r\n\r\nexport default showTranscriptComposer;\r\n"],"names":["currentMode","showTranscriptComposer","props","existing","overlay","createElement","dialog","createTranscriptComposer","on","e","closeTranscriptComposer","container","renderPasteMode","tab","t","renderMode","importBtn","handleImport","bindPasteMode","body","renderUploadMode","bindUploadMode","textarea","dropzone","input","selectedFile","file","selectFile","formatFileSize","reader","getContent","cancelBtn","content","footer","originalFooter","statusEl","detailEl","sourceSelect","formData","filename","response","errorData","result","err","newImportBtn","newCancelBtn","bytes"],"mappings":"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"}
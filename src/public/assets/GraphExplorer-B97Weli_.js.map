{"version":3,"mappings":"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","names":["createGraphExplorer","props","state","container","createElement","initializeGraphExplorer","tab","on","tabId","switchTab","bottomTabs","t","btnCopilot","toggleAICopilot","btnCommandPalette","toggleCommandPalette","btnSync","syncGraph","btnToggleRenderer","label","tabContent","toast","loadExplorerTab","btnFullscreen","toggleFullscreen","searchInput","e","event","btn","action","handleQuickAction","loadInitialData","stats","graphService","updateStatsMini","entityTypes","renderEntityTypeFilters","communities","renderCommunityFilters","bookmarks","renderBookmarks","error","content","el","graphName","connectionStatus","type","checkbox","colors","c","i","radio","value","b","loadOntologyTab","loadQueryTab","loadAnalyticsTab","createGraphCanvas","viz","node","updateNodeDetails","explorer","createGraphVisualization","createOntologyViewer","__vitePreload","viewer","createQueryBuilder","builder","cypher","results","createGraphAnalytics","analytics","panel","avatarUrl","role","organization","email","getTypeColor","escapeHtml","key","copilotContainer","createAICopilot","copilot","nodeIds","overlay","createCommandPalette","palette","input","centrality","data","insights","text","div"],"ignoreList":[],"sources":["../../frontend/components/graph/GraphExplorer.ts"],"sourcesContent":["/**\r\n * GraphExplorer - Main SOTA Knowledge Graph UI Component\r\n * \r\n * Features:\r\n * - 3-column layout: Filters | Canvas | Details\r\n * - Tab navigation: Explorer | Ontology | Query | Analytics\r\n * - Floating AI Copilot\r\n * - Command Palette (Cmd+K)\r\n * - Avatar nodes with semantic zoom\r\n * - Community coloring\r\n * - Rich hover cards\r\n */\r\n\r\nimport { createElement, on } from '../../utils/dom';\r\nimport { graphService, GraphNode, GraphStats } from '../../services/graph';\r\nimport { toast } from '../../services/toast';\r\n\r\nexport interface GraphExplorerProps {\r\n  onNodeSelect?: (node: GraphNode) => void;\r\n  onQueryExecute?: (cypher: string) => void;\r\n}\r\n\r\ntype TabId = 'explorer' | 'ontology' | 'query' | 'analytics';\r\n\r\ntype RendererType = 'visjs' | 'falkordb';\r\n\r\ninterface GraphExplorerState {\r\n  activeTab: TabId;\r\n  isLoading: boolean;\r\n  stats: GraphStats | null;\r\n  selectedNode: GraphNode | null;\r\n  isCopilotOpen: boolean;\r\n  isCommandPaletteOpen: boolean;\r\n  renderer: RendererType;\r\n  filters: {\r\n    entityTypes: string[];\r\n    communityId: number | null;\r\n    searchQuery: string;\r\n  };\r\n}\r\n\r\n/**\r\n * Create the main GraphExplorer component\r\n */\r\nexport function createGraphExplorer(props: GraphExplorerProps = {}): HTMLElement {\r\n  const state: GraphExplorerState = {\r\n    activeTab: 'explorer',\r\n    isLoading: true,\r\n    stats: null,\r\n    selectedNode: null,\r\n    isCopilotOpen: false,\r\n    isCommandPaletteOpen: false,\r\n    renderer: 'falkordb', // Default to FalkorDB canvas for better visuals\r\n    filters: {\r\n      entityTypes: [],\r\n      communityId: null,\r\n      searchQuery: '',\r\n    },\r\n  };\r\n\r\n  const container = createElement('div', { className: 'graph-explorer' });\r\n  \r\n  container.innerHTML = `\r\n    <div class=\"graph-explorer-header\">\r\n      <div class=\"graph-header-left\">\r\n        <h1 class=\"graph-title\">\r\n          <svg class=\"graph-title-icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n            <circle cx=\"12\" cy=\"12\" r=\"3\"/>\r\n            <circle cx=\"4\" cy=\"6\" r=\"2\"/>\r\n            <circle cx=\"20\" cy=\"6\" r=\"2\"/>\r\n            <circle cx=\"4\" cy=\"18\" r=\"2\"/>\r\n            <circle cx=\"20\" cy=\"18\" r=\"2\"/>\r\n            <line x1=\"6\" y1=\"6\" x2=\"9.5\" y2=\"10\"/>\r\n            <line x1=\"18\" y1=\"6\" x2=\"14.5\" y2=\"10\"/>\r\n            <line x1=\"6\" y1=\"18\" x2=\"9.5\" y2=\"14\"/>\r\n            <line x1=\"18\" y1=\"18\" x2=\"14.5\" y2=\"14\"/>\r\n          </svg>\r\n          Knowledge Graph\r\n        </h1>\r\n        <div class=\"graph-stats-mini\" id=\"graph-stats-mini\">\r\n          <span class=\"stat-loading\">Loading...</span>\r\n        </div>\r\n      </div>\r\n      <div class=\"graph-header-tabs\">\r\n        <button class=\"graph-tab active\" data-tab=\"explorer\">\r\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n            <circle cx=\"11\" cy=\"11\" r=\"8\"/>\r\n            <line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\"/>\r\n          </svg>\r\n          Explorer\r\n        </button>\r\n        <button class=\"graph-tab\" data-tab=\"ontology\">\r\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n            <path d=\"M12 2L2 7l10 5 10-5-10-5z\"/>\r\n            <path d=\"M2 17l10 5 10-5\"/>\r\n            <path d=\"M2 12l10 5 10-5\"/>\r\n          </svg>\r\n          Ontology\r\n        </button>\r\n        <button class=\"graph-tab\" data-tab=\"query\">\r\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n            <polyline points=\"16 18 22 12 16 6\"/>\r\n            <polyline points=\"8 6 2 12 8 18\"/>\r\n          </svg>\r\n          Query\r\n        </button>\r\n        <button class=\"graph-tab\" data-tab=\"analytics\">\r\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n            <line x1=\"18\" y1=\"20\" x2=\"18\" y2=\"10\"/>\r\n            <line x1=\"12\" y1=\"20\" x2=\"12\" y2=\"4\"/>\r\n            <line x1=\"6\" y1=\"20\" x2=\"6\" y2=\"14\"/>\r\n          </svg>\r\n          Analytics\r\n        </button>\r\n      </div>\r\n      <div class=\"graph-header-actions\">\r\n        <button class=\"graph-action-btn\" id=\"btn-command-palette\" title=\"Command Palette (Ctrl+K)\">\r\n          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n            <circle cx=\"11\" cy=\"11\" r=\"8\"/>\r\n            <line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\"/>\r\n          </svg>\r\n          <span class=\"shortcut-hint\">⌘K</span>\r\n        </button>\r\n        <button class=\"graph-action-btn\" id=\"btn-ai-copilot\" title=\"AI Copilot\">\r\n          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n            <path d=\"M12 2a10 10 0 0 1 10 10c0 5.5-4.5 10-10 10S2 17.5 2 12 6.5 2 12 2\"/>\r\n            <circle cx=\"12\" cy=\"12\" r=\"3\"/>\r\n            <path d=\"M12 6v1\"/>\r\n            <path d=\"M12 17v1\"/>\r\n            <path d=\"M6 12h1\"/>\r\n            <path d=\"M17 12h1\"/>\r\n          </svg>\r\n          AI Copilot\r\n        </button>\r\n        <button class=\"graph-action-btn\" id=\"btn-sync\" title=\"Sync to Graph\">\r\n          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n            <path d=\"M21 2v6h-6\"/>\r\n            <path d=\"M3 12a9 9 0 0 1 15-6.7L21 8\"/>\r\n            <path d=\"M3 22v-6h6\"/>\r\n            <path d=\"M21 12a9 9 0 0 1-15 6.7L3 16\"/>\r\n          </svg>\r\n        </button>\r\n        <button class=\"graph-action-btn\" id=\"btn-toggle-renderer\" title=\"Switch Renderer\">\r\n          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n            <rect x=\"3\" y=\"3\" width=\"7\" height=\"7\"/>\r\n            <rect x=\"14\" y=\"3\" width=\"7\" height=\"7\"/>\r\n            <rect x=\"14\" y=\"14\" width=\"7\" height=\"7\"/>\r\n            <rect x=\"3\" y=\"14\" width=\"7\" height=\"7\"/>\r\n          </svg>\r\n          <span id=\"renderer-label\" style=\"font-size: 10px; margin-left: 4px;\">FalkorDB</span>\r\n        </button>\r\n        <button class=\"graph-action-btn\" id=\"btn-fullscreen\" title=\"Fullscreen\">\r\n          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n            <path d=\"M8 3H5a2 2 0 0 0-2 2v3\"/>\r\n            <path d=\"M21 8V5a2 2 0 0 0-2-2h-3\"/>\r\n            <path d=\"M3 16v3a2 2 0 0 0 2 2h3\"/>\r\n            <path d=\"M16 21h3a2 2 0 0 0 2-2v-3\"/>\r\n          </svg>\r\n        </button>\r\n      </div>\r\n    </div>\r\n    \r\n    <div class=\"graph-explorer-body\">\r\n      <!-- Left Panel: Filters -->\r\n      <aside class=\"graph-sidebar graph-sidebar-left\" id=\"graph-sidebar-left\">\r\n        <div class=\"sidebar-section\">\r\n          <h3 class=\"sidebar-section-title\">\r\n            <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n              <polygon points=\"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3\"/>\r\n            </svg>\r\n            Filters\r\n          </h3>\r\n          <div class=\"filter-search\">\r\n            <input type=\"text\" id=\"graph-search\" class=\"filter-input\" placeholder=\"Search nodes...\">\r\n            <svg class=\"search-icon\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n              <circle cx=\"11\" cy=\"11\" r=\"8\"/>\r\n              <line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\"/>\r\n            </svg>\r\n          </div>\r\n        </div>\r\n        \r\n        <div class=\"sidebar-section\">\r\n          <h3 class=\"sidebar-section-title\">\r\n            <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n              <rect x=\"3\" y=\"3\" width=\"7\" height=\"7\"/>\r\n              <rect x=\"14\" y=\"3\" width=\"7\" height=\"7\"/>\r\n              <rect x=\"14\" y=\"14\" width=\"7\" height=\"7\"/>\r\n              <rect x=\"3\" y=\"14\" width=\"7\" height=\"7\"/>\r\n            </svg>\r\n            Entity Types\r\n          </h3>\r\n          <div id=\"entity-type-filters\" class=\"entity-filters\">\r\n            <div class=\"filter-loading\">Loading types...</div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div class=\"sidebar-section\">\r\n          <h3 class=\"sidebar-section-title\">\r\n            <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n              <circle cx=\"12\" cy=\"12\" r=\"10\"/>\r\n              <circle cx=\"12\" cy=\"12\" r=\"6\"/>\r\n              <circle cx=\"12\" cy=\"12\" r=\"2\"/>\r\n            </svg>\r\n            Communities\r\n          </h3>\r\n          <div id=\"community-filters\" class=\"community-filters\">\r\n            <div class=\"filter-loading\">Detecting...</div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div class=\"sidebar-section\">\r\n          <h3 class=\"sidebar-section-title\">\r\n            <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n              <path d=\"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z\"/>\r\n            </svg>\r\n            Bookmarks\r\n          </h3>\r\n          <div id=\"bookmarks-list\" class=\"bookmarks-list\">\r\n            <div class=\"empty-state-small\">No bookmarks yet</div>\r\n          </div>\r\n        </div>\r\n      </aside>\r\n      \r\n      <!-- Center: Main Content Area -->\r\n      <main class=\"graph-main\">\r\n        <div class=\"graph-content\" id=\"graph-content\">\r\n          <!-- Tab content will be rendered here -->\r\n          <div class=\"graph-loading\">\r\n            <div class=\"loading-spinner\"></div>\r\n            <p>Loading Knowledge Graph...</p>\r\n          </div>\r\n        </div>\r\n        \r\n        <!-- Bottom Bar: Query/Results -->\r\n        <div class=\"graph-bottom-bar\" id=\"graph-bottom-bar\">\r\n          <div class=\"bottom-bar-tabs\">\r\n            <button class=\"bottom-tab active\" data-bottom-tab=\"quick-actions\">Quick Actions</button>\r\n            <button class=\"bottom-tab\" data-bottom-tab=\"query-history\">Query History</button>\r\n            <button class=\"bottom-tab\" data-bottom-tab=\"results\">Results</button>\r\n          </div>\r\n          <div class=\"bottom-bar-content\" id=\"bottom-bar-content\">\r\n            <div class=\"quick-actions-grid\">\r\n              <button class=\"quick-action-btn\" data-action=\"find-paths\">\r\n                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                  <path d=\"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6\"/>\r\n                  <polyline points=\"15 3 21 3 21 9\"/>\r\n                  <line x1=\"10\" y1=\"14\" x2=\"21\" y2=\"3\"/>\r\n                </svg>\r\n                Find Paths\r\n              </button>\r\n              <button class=\"quick-action-btn\" data-action=\"detect-communities\">\r\n                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                  <circle cx=\"12\" cy=\"12\" r=\"10\"/>\r\n                  <circle cx=\"12\" cy=\"12\" r=\"6\"/>\r\n                  <circle cx=\"12\" cy=\"12\" r=\"2\"/>\r\n                </svg>\r\n                Detect Communities\r\n              </button>\r\n              <button class=\"quick-action-btn\" data-action=\"key-people\">\r\n                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                  <path d=\"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2\"/>\r\n                  <circle cx=\"9\" cy=\"7\" r=\"4\"/>\r\n                  <path d=\"M23 21v-2a4 4 0 0 0-3-3.87\"/>\r\n                  <path d=\"M16 3.13a4 4 0 0 1 0 7.75\"/>\r\n                </svg>\r\n                Key People\r\n              </button>\r\n              <button class=\"quick-action-btn\" data-action=\"export-graph\">\r\n                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                  <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\"/>\r\n                  <polyline points=\"7 10 12 15 17 10\"/>\r\n                  <line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\"/>\r\n                </svg>\r\n                Export\r\n              </button>\r\n              <button class=\"quick-action-btn\" data-action=\"create-snapshot\">\r\n                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                  <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"/>\r\n                  <circle cx=\"8.5\" cy=\"8.5\" r=\"1.5\"/>\r\n                  <polyline points=\"21 15 16 10 5 21\"/>\r\n                </svg>\r\n                Snapshot\r\n              </button>\r\n              <button class=\"quick-action-btn\" data-action=\"ai-insights\">\r\n                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                  <circle cx=\"12\" cy=\"12\" r=\"10\"/>\r\n                  <path d=\"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3\"/>\r\n                  <line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"/>\r\n                </svg>\r\n                AI Insights\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </main>\r\n      \r\n      <!-- Right Panel: Node Details -->\r\n      <aside class=\"graph-sidebar graph-sidebar-right\" id=\"graph-sidebar-right\">\r\n        <div class=\"node-details-panel\" id=\"node-details-panel\">\r\n          <div class=\"empty-state\">\r\n            <svg width=\"48\" height=\"48\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\" opacity=\"0.4\">\r\n              <circle cx=\"12\" cy=\"12\" r=\"10\"/>\r\n              <line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"12\"/>\r\n              <line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\"/>\r\n            </svg>\r\n            <p>Select a node to view details</p>\r\n          </div>\r\n        </div>\r\n      </aside>\r\n    </div>\r\n    \r\n    <!-- AI Copilot (floating) -->\r\n    <div class=\"ai-copilot-container hidden\" id=\"ai-copilot-container\">\r\n      <!-- Will be populated by AICopilot component -->\r\n    </div>\r\n    \r\n    <!-- Command Palette (modal) -->\r\n    <div class=\"command-palette-overlay hidden\" id=\"command-palette-overlay\">\r\n      <!-- Will be populated by CommandPalette component -->\r\n    </div>\r\n  `;\r\n\r\n  // Initialize\r\n  initializeGraphExplorer(container, state, props);\r\n\r\n  return container;\r\n}\r\n\r\n/**\r\n * Initialize the GraphExplorer\r\n */\r\nasync function initializeGraphExplorer(\r\n  container: HTMLElement,\r\n  state: GraphExplorerState,\r\n  props: GraphExplorerProps\r\n): Promise<void> {\r\n  // Bind tab switching\r\n  const tabs = container.querySelectorAll('.graph-tab');\r\n  tabs.forEach(tab => {\r\n    on(tab as HTMLElement, 'click', () => {\r\n      const tabId = tab.getAttribute('data-tab') as TabId;\r\n      if (tabId) {\r\n        switchTab(container, state, tabId, props);\r\n      }\r\n    });\r\n  });\r\n\r\n  // Bind bottom bar tabs\r\n  const bottomTabs = container.querySelectorAll('.bottom-tab');\r\n  bottomTabs.forEach(tab => {\r\n    on(tab as HTMLElement, 'click', () => {\r\n      bottomTabs.forEach(t => t.classList.remove('active'));\r\n      tab.classList.add('active');\r\n      // TODO: Switch bottom bar content\r\n    });\r\n  });\r\n\r\n  // Bind header actions\r\n  const btnCopilot = container.querySelector('#btn-ai-copilot');\r\n  if (btnCopilot) {\r\n    on(btnCopilot as HTMLElement, 'click', () => toggleAICopilot(container, state));\r\n  }\r\n\r\n  const btnCommandPalette = container.querySelector('#btn-command-palette');\r\n  if (btnCommandPalette) {\r\n    on(btnCommandPalette as HTMLElement, 'click', () => toggleCommandPalette(container, state));\r\n  }\r\n\r\n  const btnSync = container.querySelector('#btn-sync');\r\n  if (btnSync) {\r\n    on(btnSync as HTMLElement, 'click', () => syncGraph(container));\r\n  }\r\n\r\n  const btnToggleRenderer = container.querySelector('#btn-toggle-renderer');\r\n  if (btnToggleRenderer) {\r\n    on(btnToggleRenderer as HTMLElement, 'click', async () => {\r\n      // Toggle between renderers\r\n      state.renderer = state.renderer === 'falkordb' ? 'visjs' : 'falkordb';\r\n      const label = container.querySelector('#renderer-label');\r\n      if (label) label.textContent = state.renderer === 'falkordb' ? 'FalkorDB' : 'vis.js';\r\n      \r\n      // Reload the explorer tab\r\n      if (state.activeTab === 'explorer') {\r\n        const tabContent = container.querySelector('.graph-tab-content') as HTMLElement;\r\n        if (tabContent) {\r\n          toast.info(`Switching to ${state.renderer === 'falkordb' ? 'FalkorDB Canvas' : 'vis.js'}...`);\r\n          await loadExplorerTab(tabContent, state, props);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  const btnFullscreen = container.querySelector('#btn-fullscreen');\r\n  if (btnFullscreen) {\r\n    on(btnFullscreen as HTMLElement, 'click', () => toggleFullscreen(container));\r\n  }\r\n\r\n  // Bind search\r\n  const searchInput = container.querySelector('#graph-search') as HTMLInputElement;\r\n  if (searchInput) {\r\n    on(searchInput, 'input', () => {\r\n      state.filters.searchQuery = searchInput.value;\r\n      // TODO: Filter nodes\r\n    });\r\n  }\r\n\r\n  // Bind keyboard shortcuts\r\n  on(document, 'keydown', (e: Event) => {\r\n    const event = e as KeyboardEvent;\r\n    if ((event.metaKey || event.ctrlKey) && event.key === 'k') {\r\n      event.preventDefault();\r\n      toggleCommandPalette(container, state);\r\n    }\r\n  });\r\n\r\n  // Bind quick actions\r\n  const quickActionBtns = container.querySelectorAll('.quick-action-btn');\r\n  quickActionBtns.forEach(btn => {\r\n    on(btn as HTMLElement, 'click', () => {\r\n      const action = btn.getAttribute('data-action');\r\n      if (action) {\r\n        handleQuickAction(action, container, state);\r\n      }\r\n    });\r\n  });\r\n\r\n  // Load initial data\r\n  await loadInitialData(container, state, props);\r\n}\r\n\r\n/**\r\n * Load initial data\r\n */\r\nasync function loadInitialData(\r\n  container: HTMLElement,\r\n  state: GraphExplorerState,\r\n  props: GraphExplorerProps\r\n): Promise<void> {\r\n  try {\r\n    // Load stats\r\n    const stats = await graphService.getStats();\r\n    state.stats = stats;\r\n    updateStatsMini(container, stats);\r\n\r\n    // Load entity types for filters\r\n    const entityTypes = await graphService.getOntologyEntities();\r\n    renderEntityTypeFilters(container, entityTypes, state);\r\n\r\n    // Load communities\r\n    const communities = await graphService.getCommunities();\r\n    renderCommunityFilters(container, communities, state);\r\n\r\n    // Load bookmarks\r\n    const bookmarks = await graphService.getBookmarks();\r\n    renderBookmarks(container, bookmarks);\r\n\r\n    // Load the default tab content\r\n    state.isLoading = false;\r\n    await switchTab(container, state, 'explorer', props);\r\n\r\n  } catch (error) {\r\n    console.error('[GraphExplorer] Failed to load initial data:', error);\r\n    const content = container.querySelector('#graph-content');\r\n    if (content) {\r\n      content.innerHTML = `\r\n        <div class=\"graph-error\">\r\n          <svg width=\"48\" height=\"48\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\">\r\n            <circle cx=\"12\" cy=\"12\" r=\"10\"/>\r\n            <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"12\"/>\r\n            <line x1=\"12\" y1=\"16\" x2=\"12.01\" y2=\"16\"/>\r\n          </svg>\r\n          <h3>Failed to load graph</h3>\r\n          <p>Please check your graph database connection in Settings.</p>\r\n          <button class=\"btn btn-primary\" onclick=\"location.reload()\">Retry</button>\r\n        </div>\r\n      `;\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Update stats mini display\r\n */\r\nfunction updateStatsMini(container: HTMLElement, stats: GraphStats): void {\r\n  const el = container.querySelector('#graph-stats-mini');\r\n  if (el) {\r\n    const graphName = stats.graphName ? `<span class=\"stat-graph-name\" title=\"${stats.graphName}\">${stats.graphName.length > 20 ? stats.graphName.substring(0, 20) + '...' : stats.graphName}</span><span class=\"stat-divider\">•</span>` : '';\r\n    const connectionStatus = stats.connected === false ? '<span class=\"stat-disconnected\" title=\"Not connected\">⚠️</span>' : '';\r\n    el.innerHTML = `\r\n      ${connectionStatus}\r\n      ${graphName}\r\n      <span class=\"stat-item\"><strong>${stats.nodeCount}</strong> nodes</span>\r\n      <span class=\"stat-divider\">•</span>\r\n      <span class=\"stat-item\"><strong>${stats.edgeCount}</strong> edges</span>\r\n      ${stats.communities ? `<span class=\"stat-divider\">•</span><span class=\"stat-item\"><strong>${stats.communities}</strong> communities</span>` : ''}\r\n    `;\r\n  }\r\n}\r\n\r\n/**\r\n * Render entity type filters\r\n */\r\nfunction renderEntityTypeFilters(\r\n  container: HTMLElement,\r\n  entityTypes: Array<{ name: string; label: string; color?: string; icon?: string }>,\r\n  state: GraphExplorerState\r\n): void {\r\n  const el = container.querySelector('#entity-type-filters');\r\n  if (!el) return;\r\n\r\n  if (entityTypes.length === 0) {\r\n    el.innerHTML = '<div class=\"empty-state-small\">No entity types found</div>';\r\n    return;\r\n  }\r\n\r\n  el.innerHTML = entityTypes.map(type => `\r\n    <label class=\"entity-filter-item\">\r\n      <input type=\"checkbox\" checked data-type=\"${type.name}\">\r\n      <span class=\"entity-filter-color\" style=\"background: ${type.color || '#6366f1'}\"></span>\r\n      <span class=\"entity-filter-label\">${type.label || type.name}</span>\r\n    </label>\r\n  `).join('');\r\n\r\n  // Bind checkboxes\r\n  el.querySelectorAll('input[type=\"checkbox\"]').forEach(checkbox => {\r\n    on(checkbox as HTMLElement, 'change', () => {\r\n      const type = checkbox.getAttribute('data-type');\r\n      if (type) {\r\n        const checked = (checkbox as HTMLInputElement).checked;\r\n        if (checked) {\r\n          state.filters.entityTypes = state.filters.entityTypes.filter(t => t !== type);\r\n        } else {\r\n          state.filters.entityTypes.push(type);\r\n        }\r\n        // TODO: Trigger filter update\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\n/**\r\n * Render community filters\r\n */\r\nfunction renderCommunityFilters(\r\n  container: HTMLElement,\r\n  communities: Array<{ id: number; size: number; hub?: { name: string } }>,\r\n  state: GraphExplorerState\r\n): void {\r\n  const el = container.querySelector('#community-filters');\r\n  if (!el) return;\r\n\r\n  if (communities.length === 0) {\r\n    el.innerHTML = '<div class=\"empty-state-small\">No communities detected</div>';\r\n    return;\r\n  }\r\n\r\n  const colors = ['#6366f1', '#22c55e', '#f59e0b', '#ef4444', '#8b5cf6', '#06b6d4', '#ec4899', '#84cc16'];\r\n\r\n  el.innerHTML = `\r\n    <label class=\"community-filter-item\">\r\n      <input type=\"radio\" name=\"community\" value=\"\" checked>\r\n      <span class=\"community-filter-label\">All communities</span>\r\n    </label>\r\n    ${communities.slice(0, 8).map((c, i) => `\r\n      <label class=\"community-filter-item\">\r\n        <input type=\"radio\" name=\"community\" value=\"${c.id}\">\r\n        <span class=\"community-filter-color\" style=\"background: ${colors[i % colors.length]}\"></span>\r\n        <span class=\"community-filter-label\">${c.hub?.name || `Community ${c.id + 1}`} (${c.size})</span>\r\n      </label>\r\n    `).join('')}\r\n  `;\r\n\r\n  // Bind radios\r\n  el.querySelectorAll('input[type=\"radio\"]').forEach(radio => {\r\n    on(radio as HTMLElement, 'change', () => {\r\n      const value = (radio as HTMLInputElement).value;\r\n      state.filters.communityId = value ? parseInt(value) : null;\r\n      // TODO: Trigger filter update\r\n    });\r\n  });\r\n}\r\n\r\n/**\r\n * Render bookmarks\r\n */\r\nfunction renderBookmarks(\r\n  container: HTMLElement,\r\n  bookmarks: Array<{ id: string; node_id: string; node_label: string; node_type: string; node_avatar_url?: string }>\r\n): void {\r\n  const el = container.querySelector('#bookmarks-list');\r\n  if (!el) return;\r\n\r\n  if (bookmarks.length === 0) {\r\n    el.innerHTML = '<div class=\"empty-state-small\">No bookmarks yet</div>';\r\n    return;\r\n  }\r\n\r\n  el.innerHTML = bookmarks.map(b => `\r\n    <div class=\"bookmark-item\" data-node-id=\"${b.node_id}\">\r\n      ${b.node_avatar_url\r\n        ? `<img class=\"bookmark-avatar\" src=\"${b.node_avatar_url}\" alt=\"\">`\r\n        : `<div class=\"bookmark-avatar-placeholder\">${b.node_label.charAt(0)}</div>`\r\n      }\r\n      <div class=\"bookmark-info\">\r\n        <span class=\"bookmark-label\">${b.node_label}</span>\r\n        <span class=\"bookmark-type\">${b.node_type}</span>\r\n      </div>\r\n    </div>\r\n  `).join('');\r\n}\r\n\r\n/**\r\n * Switch tab\r\n */\r\nasync function switchTab(\r\n  container: HTMLElement,\r\n  state: GraphExplorerState,\r\n  tabId: TabId,\r\n  props: GraphExplorerProps\r\n): Promise<void> {\r\n  state.activeTab = tabId;\r\n\r\n  // Update tab buttons\r\n  const tabs = container.querySelectorAll('.graph-tab');\r\n  tabs.forEach(tab => {\r\n    tab.classList.toggle('active', tab.getAttribute('data-tab') === tabId);\r\n  });\r\n\r\n  // Load tab content\r\n  const content = container.querySelector('#graph-content');\r\n  if (!content) return;\r\n\r\n  content.innerHTML = `\r\n    <div class=\"graph-loading\">\r\n      <div class=\"loading-spinner\"></div>\r\n      <p>Loading...</p>\r\n    </div>\r\n  `;\r\n\r\n  try {\r\n    switch (tabId) {\r\n      case 'explorer':\r\n        await loadExplorerTab(content as HTMLElement, state, props);\r\n        break;\r\n      case 'ontology':\r\n        await loadOntologyTab(content as HTMLElement);\r\n        break;\r\n      case 'query':\r\n        await loadQueryTab(content as HTMLElement, props);\r\n        break;\r\n      case 'analytics':\r\n        await loadAnalyticsTab(content as HTMLElement);\r\n        break;\r\n    }\r\n  } catch (error) {\r\n    console.error(`[GraphExplorer] Failed to load ${tabId} tab:`, error);\r\n    content.innerHTML = `\r\n      <div class=\"graph-error\">\r\n        <p>Failed to load ${tabId}</p>\r\n        <button class=\"btn btn-sm\" onclick=\"this.closest('.graph-content').innerHTML = ''\">Retry</button>\r\n      </div>\r\n    `;\r\n  }\r\n}\r\n\r\n/**\r\n * Load Explorer tab\r\n */\r\nasync function loadExplorerTab(\r\n  container: HTMLElement,\r\n  state: GraphExplorerState,\r\n  props: GraphExplorerProps\r\n): Promise<void> {\r\n  container.innerHTML = '';\r\n  \r\n  if (state.renderer === 'falkordb') {\r\n    // Use FalkorDB Canvas (better visuals, official component)\r\n    const { createGraphCanvas } = await import('./GraphCanvas');\r\n    const viz = createGraphCanvas({\r\n      height: container.clientHeight || 600,\r\n      onNodeClick: (node) => {\r\n        state.selectedNode = node;\r\n        props.onNodeSelect?.(node);\r\n        updateNodeDetails(container.closest('.graph-explorer') as HTMLElement, node);\r\n      },\r\n      onNodeRightClick: (node) => {\r\n        // Show context menu\r\n        toast.info(`${node.name || node.label || node.id}`);\r\n      },\r\n      onDataLoaded: (stats) => {\r\n        // Update the stats mini display with actual counts\r\n        state.stats = { ...state.stats, ...stats };\r\n        const explorer = container.closest('.graph-explorer') as HTMLElement;\r\n        if (explorer) {\r\n          updateStatsMini(explorer, state.stats);\r\n        }\r\n      },\r\n    });\r\n    container.appendChild(viz);\r\n  } else {\r\n    // Use vis.js (legacy, fallback)\r\n    const { createGraphVisualization } = await import('./GraphVisualization');\r\n    const viz = createGraphVisualization({\r\n      height: container.clientHeight || 600,\r\n      onNodeClick: (node) => {\r\n        state.selectedNode = node;\r\n        props.onNodeSelect?.(node);\r\n        updateNodeDetails(container.closest('.graph-explorer') as HTMLElement, node);\r\n      },\r\n      onNodeDoubleClick: (node) => {\r\n        toast.info(`Expanding connections for ${node.label || node.name || node.id}`);\r\n      },\r\n    });\r\n    container.appendChild(viz);\r\n  }\r\n}\r\n\r\n/**\r\n * Load Ontology tab\r\n */\r\nasync function loadOntologyTab(container: HTMLElement): Promise<void> {\r\n  const { createOntologyViewer } = await import('./OntologyViewer');\r\n  container.innerHTML = '';\r\n  const viewer = createOntologyViewer({});\r\n  container.appendChild(viewer);\r\n}\r\n\r\n/**\r\n * Load Query tab\r\n */\r\nasync function loadQueryTab(\r\n  container: HTMLElement,\r\n  props: GraphExplorerProps\r\n): Promise<void> {\r\n  const { createQueryBuilder } = await import('./QueryBuilder');\r\n  container.innerHTML = '';\r\n  const builder = createQueryBuilder({\r\n    onExecute: (cypher, results) => {\r\n      props.onQueryExecute?.(cypher);\r\n    },\r\n  });\r\n  container.appendChild(builder);\r\n}\r\n\r\n/**\r\n * Load Analytics tab\r\n */\r\nasync function loadAnalyticsTab(container: HTMLElement): Promise<void> {\r\n  const { createGraphAnalytics } = await import('./GraphAnalytics');\r\n  container.innerHTML = '';\r\n  const analytics = createGraphAnalytics({});\r\n  container.appendChild(analytics);\r\n}\r\n\r\n/**\r\n * Update node details panel\r\n */\r\nfunction updateNodeDetails(container: HTMLElement, node: GraphNode): void {\r\n  const panel = container.querySelector('#node-details-panel');\r\n  if (!panel) return;\r\n\r\n  const avatarUrl = node.avatarUrl || node.photoUrl || (node.properties as Record<string, unknown>)?.avatar_url || (node.properties as Record<string, unknown>)?.photo_url;\r\n  const role = node.role || (node.properties as Record<string, unknown>)?.role;\r\n  const organization = node.organization || (node.properties as Record<string, unknown>)?.organization;\r\n  const email = node.email || (node.properties as Record<string, unknown>)?.email;\r\n\r\n  panel.innerHTML = `\r\n    <div class=\"node-details\">\r\n      <div class=\"node-details-header\">\r\n        ${avatarUrl\r\n          ? `<img class=\"node-avatar-large\" src=\"${avatarUrl}\" alt=\"\" onerror=\"this.style.display='none'\">`\r\n          : `<div class=\"node-avatar-large node-avatar-placeholder\" style=\"background: ${getTypeColor(node.type)}\">${(node.label || node.name || '?').charAt(0).toUpperCase()}</div>`\r\n        }\r\n        <div class=\"node-header-info\">\r\n          <h3 class=\"node-name\">${escapeHtml(node.label || node.name || node.id)}</h3>\r\n          <span class=\"node-type-badge\" style=\"background: ${getTypeColor(node.type)}\">${node.type}</span>\r\n        </div>\r\n        <button class=\"btn-icon node-bookmark-btn\" title=\"Bookmark\">\r\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n            <path d=\"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z\"/>\r\n          </svg>\r\n        </button>\r\n      </div>\r\n      \r\n      ${role || organization ? `\r\n        <div class=\"node-role-info\">\r\n          ${role ? `<span class=\"node-role\">${escapeHtml(String(role))}</span>` : ''}\r\n          ${organization ? `<span class=\"node-org\">@ ${escapeHtml(String(organization))}</span>` : ''}\r\n        </div>\r\n      ` : ''}\r\n      \r\n      ${email ? `\r\n        <div class=\"node-contact-info\">\r\n          <a href=\"mailto:${email}\" class=\"node-email\">\r\n            <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n              <path d=\"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z\"/>\r\n              <polyline points=\"22,6 12,13 2,6\"/>\r\n            </svg>\r\n            ${escapeHtml(String(email))}\r\n          </a>\r\n        </div>\r\n      ` : ''}\r\n      \r\n      <div class=\"node-stats\">\r\n        <div class=\"node-stat\">\r\n          <span class=\"node-stat-value\">${node.connections || 0}</span>\r\n          <span class=\"node-stat-label\">Connections</span>\r\n        </div>\r\n        ${node.centrality ? `\r\n          <div class=\"node-stat\">\r\n            <span class=\"node-stat-value\">${(node.centrality * 100).toFixed(0)}%</span>\r\n            <span class=\"node-stat-label\">Centrality</span>\r\n          </div>\r\n        ` : ''}\r\n        ${node.communityId !== undefined ? `\r\n          <div class=\"node-stat\">\r\n            <span class=\"node-stat-value\">#${node.communityId + 1}</span>\r\n            <span class=\"node-stat-label\">Community</span>\r\n          </div>\r\n        ` : ''}\r\n      </div>\r\n      \r\n      <div class=\"node-actions\">\r\n        <button class=\"btn btn-sm btn-secondary\" data-action=\"expand\">\r\n          <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n            <circle cx=\"12\" cy=\"12\" r=\"10\"/>\r\n            <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"16\"/>\r\n            <line x1=\"8\" y1=\"12\" x2=\"16\" y2=\"12\"/>\r\n          </svg>\r\n          Expand\r\n        </button>\r\n        <button class=\"btn btn-sm btn-secondary\" data-action=\"find-paths\">\r\n          <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n            <path d=\"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6\"/>\r\n            <polyline points=\"15 3 21 3 21 9\"/>\r\n            <line x1=\"10\" y1=\"14\" x2=\"21\" y2=\"3\"/>\r\n          </svg>\r\n          Paths\r\n        </button>\r\n        <button class=\"btn btn-sm btn-secondary\" data-action=\"ai-explain\">\r\n          <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n            <circle cx=\"12\" cy=\"12\" r=\"10\"/>\r\n            <path d=\"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3\"/>\r\n            <line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"/>\r\n          </svg>\r\n          AI Explain\r\n        </button>\r\n      </div>\r\n      \r\n      ${node.properties ? `\r\n        <div class=\"node-properties\">\r\n          <h4>Properties</h4>\r\n          <div class=\"properties-list\">\r\n            ${Object.entries(node.properties)\r\n              .filter(([key]) => !['id', 'name', 'label', 'type', 'avatar_url', 'photo_url', 'avatarUrl', 'photoUrl'].includes(key))\r\n              .slice(0, 10)\r\n              .map(([key, value]) => `\r\n                <div class=\"property-item\">\r\n                  <span class=\"property-key\">${escapeHtml(key)}:</span>\r\n                  <span class=\"property-value\">${escapeHtml(String(value).substring(0, 100))}</span>\r\n                </div>\r\n              `).join('')}\r\n          </div>\r\n        </div>\r\n      ` : ''}\r\n    </div>\r\n  `;\r\n}\r\n\r\n/**\r\n * Toggle AI Copilot\r\n */\r\nfunction toggleAICopilot(container: HTMLElement, state: GraphExplorerState): void {\r\n  state.isCopilotOpen = !state.isCopilotOpen;\r\n  const copilotContainer = container.querySelector('#ai-copilot-container');\r\n  \r\n  if (copilotContainer) {\r\n    if (state.isCopilotOpen) {\r\n      copilotContainer.classList.remove('hidden');\r\n      // Load copilot component if not loaded\r\n      if (!copilotContainer.hasChildNodes()) {\r\n        import('./AICopilot').then(({ createAICopilot }) => {\r\n          const copilot = createAICopilot({\r\n            onClose: () => toggleAICopilot(container, state),\r\n            onHighlightNodes: (nodeIds) => {\r\n              // TODO: Highlight nodes in visualization\r\n              console.log('Highlight nodes:', nodeIds);\r\n            },\r\n          });\r\n          copilotContainer.innerHTML = '';\r\n          copilotContainer.appendChild(copilot);\r\n        });\r\n      }\r\n    } else {\r\n      copilotContainer.classList.add('hidden');\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Toggle Command Palette\r\n */\r\nfunction toggleCommandPalette(container: HTMLElement, state: GraphExplorerState): void {\r\n  state.isCommandPaletteOpen = !state.isCommandPaletteOpen;\r\n  const overlay = container.querySelector('#command-palette-overlay');\r\n  \r\n  if (overlay) {\r\n    if (state.isCommandPaletteOpen) {\r\n      overlay.classList.remove('hidden');\r\n      // Load command palette if not loaded\r\n      if (!overlay.hasChildNodes()) {\r\n        import('./CommandPalette').then(({ createCommandPalette }) => {\r\n          const palette = createCommandPalette({\r\n            onClose: () => toggleCommandPalette(container, state),\r\n            onAction: (action) => {\r\n              handleQuickAction(action, container, state);\r\n              toggleCommandPalette(container, state);\r\n            },\r\n          });\r\n          overlay.innerHTML = '';\r\n          overlay.appendChild(palette);\r\n        });\r\n      }\r\n      // Focus search input\r\n      setTimeout(() => {\r\n        const input = overlay.querySelector('input');\r\n        if (input) input.focus();\r\n      }, 100);\r\n    } else {\r\n      overlay.classList.add('hidden');\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Sync graph\r\n */\r\nasync function syncGraph(container: HTMLElement): Promise<void> {\r\n  toast.info('Syncing data to graph...');\r\n  try {\r\n    await fetch('/api/graph/sync', { method: 'POST' });\r\n    toast.success('Graph synced successfully');\r\n    // Reload data\r\n    const stats = await graphService.getStats();\r\n    updateStatsMini(container, stats);\r\n  } catch {\r\n    toast.error('Failed to sync graph');\r\n  }\r\n}\r\n\r\n/**\r\n * Toggle fullscreen\r\n */\r\nfunction toggleFullscreen(container: HTMLElement): void {\r\n  if (document.fullscreenElement) {\r\n    document.exitFullscreen();\r\n  } else {\r\n    container.requestFullscreen();\r\n  }\r\n}\r\n\r\n/**\r\n * Handle quick action\r\n */\r\nasync function handleQuickAction(action: string, container: HTMLElement, state: GraphExplorerState): Promise<void> {\r\n  switch (action) {\r\n    case 'find-paths':\r\n      toast.info('Select two nodes to find paths between them');\r\n      break;\r\n    case 'detect-communities':\r\n      toast.info('Detecting communities...');\r\n      const communities = await graphService.getCommunities();\r\n      toast.success(`Found ${communities.length} communities`);\r\n      break;\r\n    case 'key-people':\r\n      toast.info('Finding key people...');\r\n      const centrality = await graphService.getCentrality();\r\n      if (centrality.topNodes.length > 0) {\r\n        toast.success(`Top person: ${centrality.topNodes[0].name} (${centrality.topNodes[0].connections} connections)`);\r\n      }\r\n      break;\r\n    case 'export-graph':\r\n      toast.info('Exporting graph...');\r\n      // TODO: Implement export\r\n      break;\r\n    case 'create-snapshot':\r\n      toast.info('Creating snapshot...');\r\n      const data = await graphService.getVisualizationData();\r\n      const stats = await graphService.getStats();\r\n      await graphService.createSnapshot({\r\n        name: `Snapshot ${new Date().toLocaleDateString()}`,\r\n        snapshot_type: 'manual',\r\n        snapshot_data: {\r\n          nodes: data.nodes,\r\n          edges: data.edges,\r\n          stats: stats,\r\n          capturedAt: new Date().toISOString(),\r\n        },\r\n        node_count: stats.nodeCount,\r\n        edge_count: stats.edgeCount,\r\n        is_baseline: false,\r\n      });\r\n      toast.success('Snapshot created');\r\n      break;\r\n    case 'ai-insights':\r\n      toast.info('Generating AI insights...');\r\n      const insights = await graphService.getInsights();\r\n      if (insights.length > 0) {\r\n        toast.success(insights[0].description);\r\n      } else {\r\n        toast.info('No insights available');\r\n      }\r\n      break;\r\n    default:\r\n      console.log('Unknown action:', action);\r\n  }\r\n}\r\n\r\n/**\r\n * Get color for entity type\r\n */\r\nfunction getTypeColor(type: string): string {\r\n  const colors: Record<string, string> = {\r\n    Person: '#6366f1',\r\n    Project: '#22c55e',\r\n    Document: '#8b5cf6',\r\n    Decision: '#06b6d4',\r\n    Risk: '#ef4444',\r\n    Question: '#f59e0b',\r\n    Fact: '#84cc16',\r\n    Meeting: '#ec4899',\r\n    Task: '#3b82f6',\r\n    Technology: '#f97316',\r\n    Organization: '#a855f7',\r\n    Client: '#14b8a6',\r\n    Email: '#e879f9',\r\n  };\r\n  return colors[type] || '#6b7280';\r\n}\r\n\r\n/**\r\n * Escape HTML\r\n */\r\nfunction escapeHtml(text: string): string {\r\n  const div = document.createElement('div');\r\n  div.textContent = text;\r\n  return div.innerHTML;\r\n}\r\n\r\nexport default createGraphExplorer;\r\n"],"file":"GraphExplorer-B97Weli_.js"}
{"version":3,"mappings":"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","names":["createGraphExplorer","props","state","container","createElement","initializeGraphExplorer","tab","on","tabId","switchTab","bottomTabs","t","btnCopilot","toggleAICopilot","btnCommandPalette","toggleCommandPalette","btnSync","syncGraph","btnToggleRenderer","label","tabContent","toast","loadExplorerTab","btnFullscreen","toggleFullscreen","searchInput","e","event","btn","action","handleQuickAction","loadInitialData","stats","graphService","updateStatsMini","entityTypes","renderEntityTypeFilters","communities","renderCommunityFilters","bookmarks","renderBookmarks","error","content","el","graphName","connectionStatus","type","checkbox","colors","c","i","radio","value","b","loadOntologyTab","loadQueryTab","loadAnalyticsTab","createGraphCanvas","viz","node","updateNodeDetails","explorer","createGraphVisualization","createOntologyViewer","__vitePreload","viewer","createQueryBuilder","builder","cypher","results","createGraphAnalytics","analytics","panel","avatarUrl","role","organization","email","getTypeColor","escapeHtml","key","copilotContainer","createAICopilot","copilot","nodeIds","overlay","createCommandPalette","palette","input","centrality","data","insights","text","div"],"ignoreList":[],"sources":["../../frontend/components/graph/GraphExplorer.ts"],"sourcesContent":["/**\n * GraphExplorer - Main SOTA Knowledge Graph UI Component\n * \n * Features:\n * - 3-column layout: Filters | Canvas | Details\n * - Tab navigation: Explorer | Ontology | Query | Analytics\n * - Floating AI Copilot\n * - Command Palette (Cmd+K)\n * - Avatar nodes with semantic zoom\n * - Community coloring\n * - Rich hover cards\n */\n\nimport { createElement, on } from '../../utils/dom';\nimport { graphService, GraphNode, GraphStats } from '../../services/graph';\nimport { toast } from '../../services/toast';\n\nexport interface GraphExplorerProps {\n  onNodeSelect?: (node: GraphNode) => void;\n  onQueryExecute?: (cypher: string) => void;\n}\n\ntype TabId = 'explorer' | 'ontology' | 'query' | 'analytics';\n\ntype RendererType = 'visjs' | 'falkordb';\n\ninterface GraphExplorerState {\n  activeTab: TabId;\n  isLoading: boolean;\n  stats: GraphStats | null;\n  selectedNode: GraphNode | null;\n  isCopilotOpen: boolean;\n  isCommandPaletteOpen: boolean;\n  renderer: RendererType;\n  filters: {\n    entityTypes: string[];\n    communityId: number | null;\n    searchQuery: string;\n  };\n}\n\n/**\n * Create the main GraphExplorer component\n */\nexport function createGraphExplorer(props: GraphExplorerProps = {}): HTMLElement {\n  const state: GraphExplorerState = {\n    activeTab: 'explorer',\n    isLoading: true,\n    stats: null,\n    selectedNode: null,\n    isCopilotOpen: false,\n    isCommandPaletteOpen: false,\n    renderer: 'falkordb', // Default to FalkorDB canvas for better visuals\n    filters: {\n      entityTypes: [],\n      communityId: null,\n      searchQuery: '',\n    },\n  };\n\n  const container = createElement('div', { className: 'graph-explorer' });\n  \n  container.innerHTML = `\n    <div class=\"graph-explorer-header\">\n      <div class=\"graph-header-left\">\n        <h1 class=\"graph-title\">\n          <svg class=\"graph-title-icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <circle cx=\"12\" cy=\"12\" r=\"3\"/>\n            <circle cx=\"4\" cy=\"6\" r=\"2\"/>\n            <circle cx=\"20\" cy=\"6\" r=\"2\"/>\n            <circle cx=\"4\" cy=\"18\" r=\"2\"/>\n            <circle cx=\"20\" cy=\"18\" r=\"2\"/>\n            <line x1=\"6\" y1=\"6\" x2=\"9.5\" y2=\"10\"/>\n            <line x1=\"18\" y1=\"6\" x2=\"14.5\" y2=\"10\"/>\n            <line x1=\"6\" y1=\"18\" x2=\"9.5\" y2=\"14\"/>\n            <line x1=\"18\" y1=\"18\" x2=\"14.5\" y2=\"14\"/>\n          </svg>\n          Knowledge Graph\n        </h1>\n        <div class=\"graph-stats-mini\" id=\"graph-stats-mini\">\n          <span class=\"stat-loading\">Loading...</span>\n        </div>\n      </div>\n      <div class=\"graph-header-tabs\">\n        <button class=\"graph-tab active\" data-tab=\"explorer\">\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <circle cx=\"11\" cy=\"11\" r=\"8\"/>\n            <line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\"/>\n          </svg>\n          Explorer\n        </button>\n        <button class=\"graph-tab\" data-tab=\"ontology\">\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <path d=\"M12 2L2 7l10 5 10-5-10-5z\"/>\n            <path d=\"M2 17l10 5 10-5\"/>\n            <path d=\"M2 12l10 5 10-5\"/>\n          </svg>\n          Ontology\n        </button>\n        <button class=\"graph-tab\" data-tab=\"query\">\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <polyline points=\"16 18 22 12 16 6\"/>\n            <polyline points=\"8 6 2 12 8 18\"/>\n          </svg>\n          Query\n        </button>\n        <button class=\"graph-tab\" data-tab=\"analytics\">\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <line x1=\"18\" y1=\"20\" x2=\"18\" y2=\"10\"/>\n            <line x1=\"12\" y1=\"20\" x2=\"12\" y2=\"4\"/>\n            <line x1=\"6\" y1=\"20\" x2=\"6\" y2=\"14\"/>\n          </svg>\n          Analytics\n        </button>\n      </div>\n      <div class=\"graph-header-actions\">\n        <button class=\"graph-action-btn\" id=\"btn-command-palette\" title=\"Command Palette (Ctrl+K)\">\n          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <circle cx=\"11\" cy=\"11\" r=\"8\"/>\n            <line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\"/>\n          </svg>\n          <span class=\"shortcut-hint\">⌘K</span>\n        </button>\n        <button class=\"graph-action-btn\" id=\"btn-ai-copilot\" title=\"AI Copilot\">\n          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <path d=\"M12 2a10 10 0 0 1 10 10c0 5.5-4.5 10-10 10S2 17.5 2 12 6.5 2 12 2\"/>\n            <circle cx=\"12\" cy=\"12\" r=\"3\"/>\n            <path d=\"M12 6v1\"/>\n            <path d=\"M12 17v1\"/>\n            <path d=\"M6 12h1\"/>\n            <path d=\"M17 12h1\"/>\n          </svg>\n          AI Copilot\n        </button>\n        <button class=\"graph-action-btn\" id=\"btn-sync\" title=\"Sync to Graph\">\n          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <path d=\"M21 2v6h-6\"/>\n            <path d=\"M3 12a9 9 0 0 1 15-6.7L21 8\"/>\n            <path d=\"M3 22v-6h6\"/>\n            <path d=\"M21 12a9 9 0 0 1-15 6.7L3 16\"/>\n          </svg>\n        </button>\n        <button class=\"graph-action-btn\" id=\"btn-toggle-renderer\" title=\"Switch Renderer\">\n          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <rect x=\"3\" y=\"3\" width=\"7\" height=\"7\"/>\n            <rect x=\"14\" y=\"3\" width=\"7\" height=\"7\"/>\n            <rect x=\"14\" y=\"14\" width=\"7\" height=\"7\"/>\n            <rect x=\"3\" y=\"14\" width=\"7\" height=\"7\"/>\n          </svg>\n          <span id=\"renderer-label\" style=\"font-size: 10px; margin-left: 4px;\">FalkorDB</span>\n        </button>\n        <button class=\"graph-action-btn\" id=\"btn-fullscreen\" title=\"Fullscreen\">\n          <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <path d=\"M8 3H5a2 2 0 0 0-2 2v3\"/>\n            <path d=\"M21 8V5a2 2 0 0 0-2-2h-3\"/>\n            <path d=\"M3 16v3a2 2 0 0 0 2 2h3\"/>\n            <path d=\"M16 21h3a2 2 0 0 0 2-2v-3\"/>\n          </svg>\n        </button>\n      </div>\n    </div>\n    \n    <div class=\"graph-explorer-body\">\n      <!-- Left Panel: Filters -->\n      <aside class=\"graph-sidebar graph-sidebar-left\" id=\"graph-sidebar-left\">\n        <div class=\"sidebar-section\">\n          <h3 class=\"sidebar-section-title\">\n            <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n              <polygon points=\"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3\"/>\n            </svg>\n            Filters\n          </h3>\n          <div class=\"filter-search\">\n            <input type=\"text\" id=\"graph-search\" class=\"filter-input\" placeholder=\"Search nodes...\">\n            <svg class=\"search-icon\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n              <circle cx=\"11\" cy=\"11\" r=\"8\"/>\n              <line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\"/>\n            </svg>\n          </div>\n        </div>\n        \n        <div class=\"sidebar-section\">\n          <h3 class=\"sidebar-section-title\">\n            <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n              <rect x=\"3\" y=\"3\" width=\"7\" height=\"7\"/>\n              <rect x=\"14\" y=\"3\" width=\"7\" height=\"7\"/>\n              <rect x=\"14\" y=\"14\" width=\"7\" height=\"7\"/>\n              <rect x=\"3\" y=\"14\" width=\"7\" height=\"7\"/>\n            </svg>\n            Entity Types\n          </h3>\n          <div id=\"entity-type-filters\" class=\"entity-filters\">\n            <div class=\"filter-loading\">Loading types...</div>\n          </div>\n        </div>\n        \n        <div class=\"sidebar-section\">\n          <h3 class=\"sidebar-section-title\">\n            <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n              <circle cx=\"12\" cy=\"12\" r=\"10\"/>\n              <circle cx=\"12\" cy=\"12\" r=\"6\"/>\n              <circle cx=\"12\" cy=\"12\" r=\"2\"/>\n            </svg>\n            Communities\n          </h3>\n          <div id=\"community-filters\" class=\"community-filters\">\n            <div class=\"filter-loading\">Detecting...</div>\n          </div>\n        </div>\n        \n        <div class=\"sidebar-section\">\n          <h3 class=\"sidebar-section-title\">\n            <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n              <path d=\"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z\"/>\n            </svg>\n            Bookmarks\n          </h3>\n          <div id=\"bookmarks-list\" class=\"bookmarks-list\">\n            <div class=\"empty-state-small\">No bookmarks yet</div>\n          </div>\n        </div>\n      </aside>\n      \n      <!-- Center: Main Content Area -->\n      <main class=\"graph-main\">\n        <div class=\"graph-content\" id=\"graph-content\">\n          <!-- Tab content will be rendered here -->\n          <div class=\"graph-loading\">\n            <div class=\"loading-spinner\"></div>\n            <p>Loading Knowledge Graph...</p>\n          </div>\n        </div>\n        \n        <!-- Bottom Bar: Query/Results -->\n        <div class=\"graph-bottom-bar\" id=\"graph-bottom-bar\">\n          <div class=\"bottom-bar-tabs\">\n            <button class=\"bottom-tab active\" data-bottom-tab=\"quick-actions\">Quick Actions</button>\n            <button class=\"bottom-tab\" data-bottom-tab=\"query-history\">Query History</button>\n            <button class=\"bottom-tab\" data-bottom-tab=\"results\">Results</button>\n          </div>\n          <div class=\"bottom-bar-content\" id=\"bottom-bar-content\">\n            <div class=\"quick-actions-grid\">\n              <button class=\"quick-action-btn\" data-action=\"find-paths\">\n                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                  <path d=\"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6\"/>\n                  <polyline points=\"15 3 21 3 21 9\"/>\n                  <line x1=\"10\" y1=\"14\" x2=\"21\" y2=\"3\"/>\n                </svg>\n                Find Paths\n              </button>\n              <button class=\"quick-action-btn\" data-action=\"detect-communities\">\n                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                  <circle cx=\"12\" cy=\"12\" r=\"10\"/>\n                  <circle cx=\"12\" cy=\"12\" r=\"6\"/>\n                  <circle cx=\"12\" cy=\"12\" r=\"2\"/>\n                </svg>\n                Detect Communities\n              </button>\n              <button class=\"quick-action-btn\" data-action=\"key-people\">\n                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                  <path d=\"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2\"/>\n                  <circle cx=\"9\" cy=\"7\" r=\"4\"/>\n                  <path d=\"M23 21v-2a4 4 0 0 0-3-3.87\"/>\n                  <path d=\"M16 3.13a4 4 0 0 1 0 7.75\"/>\n                </svg>\n                Key People\n              </button>\n              <button class=\"quick-action-btn\" data-action=\"export-graph\">\n                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                  <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\"/>\n                  <polyline points=\"7 10 12 15 17 10\"/>\n                  <line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\"/>\n                </svg>\n                Export\n              </button>\n              <button class=\"quick-action-btn\" data-action=\"create-snapshot\">\n                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                  <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"/>\n                  <circle cx=\"8.5\" cy=\"8.5\" r=\"1.5\"/>\n                  <polyline points=\"21 15 16 10 5 21\"/>\n                </svg>\n                Snapshot\n              </button>\n              <button class=\"quick-action-btn\" data-action=\"ai-insights\">\n                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                  <circle cx=\"12\" cy=\"12\" r=\"10\"/>\n                  <path d=\"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3\"/>\n                  <line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"/>\n                </svg>\n                AI Insights\n              </button>\n            </div>\n          </div>\n        </div>\n      </main>\n      \n      <!-- Right Panel: Node Details -->\n      <aside class=\"graph-sidebar graph-sidebar-right\" id=\"graph-sidebar-right\">\n        <div class=\"node-details-panel\" id=\"node-details-panel\">\n          <div class=\"empty-state\">\n            <svg width=\"48\" height=\"48\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\" opacity=\"0.4\">\n              <circle cx=\"12\" cy=\"12\" r=\"10\"/>\n              <line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"12\"/>\n              <line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\"/>\n            </svg>\n            <p>Select a node to view details</p>\n          </div>\n        </div>\n      </aside>\n    </div>\n    \n    <!-- AI Copilot (floating) -->\n    <div class=\"ai-copilot-container hidden\" id=\"ai-copilot-container\">\n      <!-- Will be populated by AICopilot component -->\n    </div>\n    \n    <!-- Command Palette (modal) -->\n    <div class=\"command-palette-overlay hidden\" id=\"command-palette-overlay\">\n      <!-- Will be populated by CommandPalette component -->\n    </div>\n  `;\n\n  // Initialize\n  initializeGraphExplorer(container, state, props);\n\n  return container;\n}\n\n/**\n * Initialize the GraphExplorer\n */\nasync function initializeGraphExplorer(\n  container: HTMLElement,\n  state: GraphExplorerState,\n  props: GraphExplorerProps\n): Promise<void> {\n  // Bind tab switching\n  const tabs = container.querySelectorAll('.graph-tab');\n  tabs.forEach(tab => {\n    on(tab as HTMLElement, 'click', () => {\n      const tabId = tab.getAttribute('data-tab') as TabId;\n      if (tabId) {\n        switchTab(container, state, tabId, props);\n      }\n    });\n  });\n\n  // Bind bottom bar tabs\n  const bottomTabs = container.querySelectorAll('.bottom-tab');\n  bottomTabs.forEach(tab => {\n    on(tab as HTMLElement, 'click', () => {\n      bottomTabs.forEach(t => t.classList.remove('active'));\n      tab.classList.add('active');\n      // TODO: Switch bottom bar content\n    });\n  });\n\n  // Bind header actions\n  const btnCopilot = container.querySelector('#btn-ai-copilot');\n  if (btnCopilot) {\n    on(btnCopilot as HTMLElement, 'click', () => toggleAICopilot(container, state));\n  }\n\n  const btnCommandPalette = container.querySelector('#btn-command-palette');\n  if (btnCommandPalette) {\n    on(btnCommandPalette as HTMLElement, 'click', () => toggleCommandPalette(container, state));\n  }\n\n  const btnSync = container.querySelector('#btn-sync');\n  if (btnSync) {\n    on(btnSync as HTMLElement, 'click', () => syncGraph(container));\n  }\n\n  const btnToggleRenderer = container.querySelector('#btn-toggle-renderer');\n  if (btnToggleRenderer) {\n    on(btnToggleRenderer as HTMLElement, 'click', async () => {\n      // Toggle between renderers\n      state.renderer = state.renderer === 'falkordb' ? 'visjs' : 'falkordb';\n      const label = container.querySelector('#renderer-label');\n      if (label) label.textContent = state.renderer === 'falkordb' ? 'FalkorDB' : 'vis.js';\n      \n      // Reload the explorer tab\n      if (state.activeTab === 'explorer') {\n        const tabContent = container.querySelector('.graph-tab-content') as HTMLElement;\n        if (tabContent) {\n          toast.info(`Switching to ${state.renderer === 'falkordb' ? 'FalkorDB Canvas' : 'vis.js'}...`);\n          await loadExplorerTab(tabContent, state, props);\n        }\n      }\n    });\n  }\n\n  const btnFullscreen = container.querySelector('#btn-fullscreen');\n  if (btnFullscreen) {\n    on(btnFullscreen as HTMLElement, 'click', () => toggleFullscreen(container));\n  }\n\n  // Bind search\n  const searchInput = container.querySelector('#graph-search') as HTMLInputElement;\n  if (searchInput) {\n    on(searchInput, 'input', () => {\n      state.filters.searchQuery = searchInput.value;\n      // TODO: Filter nodes\n    });\n  }\n\n  // Bind keyboard shortcuts\n  on(document, 'keydown', (e: Event) => {\n    const event = e as KeyboardEvent;\n    if ((event.metaKey || event.ctrlKey) && event.key === 'k') {\n      event.preventDefault();\n      toggleCommandPalette(container, state);\n    }\n  });\n\n  // Bind quick actions\n  const quickActionBtns = container.querySelectorAll('.quick-action-btn');\n  quickActionBtns.forEach(btn => {\n    on(btn as HTMLElement, 'click', () => {\n      const action = btn.getAttribute('data-action');\n      if (action) {\n        handleQuickAction(action, container, state);\n      }\n    });\n  });\n\n  // Load initial data\n  await loadInitialData(container, state, props);\n}\n\n/**\n * Load initial data\n */\nasync function loadInitialData(\n  container: HTMLElement,\n  state: GraphExplorerState,\n  props: GraphExplorerProps\n): Promise<void> {\n  try {\n    // Load stats\n    const stats = await graphService.getStats();\n    state.stats = stats;\n    updateStatsMini(container, stats);\n\n    // Load entity types for filters\n    const entityTypes = await graphService.getOntologyEntities();\n    renderEntityTypeFilters(container, entityTypes, state);\n\n    // Load communities\n    const communities = await graphService.getCommunities();\n    renderCommunityFilters(container, communities, state);\n\n    // Load bookmarks\n    const bookmarks = await graphService.getBookmarks();\n    renderBookmarks(container, bookmarks);\n\n    // Load the default tab content\n    state.isLoading = false;\n    await switchTab(container, state, 'explorer', props);\n\n  } catch (error) {\n    console.error('[GraphExplorer] Failed to load initial data:', error);\n    const content = container.querySelector('#graph-content');\n    if (content) {\n      content.innerHTML = `\n        <div class=\"graph-error\">\n          <svg width=\"48\" height=\"48\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\">\n            <circle cx=\"12\" cy=\"12\" r=\"10\"/>\n            <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"12\"/>\n            <line x1=\"12\" y1=\"16\" x2=\"12.01\" y2=\"16\"/>\n          </svg>\n          <h3>Failed to load graph</h3>\n          <p>Please check your graph database connection in Settings.</p>\n          <button class=\"btn btn-primary\" onclick=\"location.reload()\">Retry</button>\n        </div>\n      `;\n    }\n  }\n}\n\n/**\n * Update stats mini display\n */\nfunction updateStatsMini(container: HTMLElement, stats: GraphStats): void {\n  const el = container.querySelector('#graph-stats-mini');\n  if (el) {\n    const graphName = stats.graphName ? `<span class=\"stat-graph-name\" title=\"${stats.graphName}\">${stats.graphName.length > 20 ? stats.graphName.substring(0, 20) + '...' : stats.graphName}</span><span class=\"stat-divider\">•</span>` : '';\n    const connectionStatus = stats.connected === false ? '<span class=\"stat-disconnected\" title=\"Not connected\">⚠️</span>' : '';\n    el.innerHTML = `\n      ${connectionStatus}\n      ${graphName}\n      <span class=\"stat-item\"><strong>${stats.nodeCount}</strong> nodes</span>\n      <span class=\"stat-divider\">•</span>\n      <span class=\"stat-item\"><strong>${stats.edgeCount}</strong> edges</span>\n      ${stats.communities ? `<span class=\"stat-divider\">•</span><span class=\"stat-item\"><strong>${stats.communities}</strong> communities</span>` : ''}\n    `;\n  }\n}\n\n/**\n * Render entity type filters\n */\nfunction renderEntityTypeFilters(\n  container: HTMLElement,\n  entityTypes: Array<{ name: string; label: string; color?: string; icon?: string }>,\n  state: GraphExplorerState\n): void {\n  const el = container.querySelector('#entity-type-filters');\n  if (!el) return;\n\n  if (entityTypes.length === 0) {\n    el.innerHTML = '<div class=\"empty-state-small\">No entity types found</div>';\n    return;\n  }\n\n  el.innerHTML = entityTypes.map(type => `\n    <label class=\"entity-filter-item\">\n      <input type=\"checkbox\" checked data-type=\"${type.name}\">\n      <span class=\"entity-filter-color\" style=\"background: ${type.color || '#6366f1'}\"></span>\n      <span class=\"entity-filter-label\">${type.label || type.name}</span>\n    </label>\n  `).join('');\n\n  // Bind checkboxes\n  el.querySelectorAll('input[type=\"checkbox\"]').forEach(checkbox => {\n    on(checkbox as HTMLElement, 'change', () => {\n      const type = checkbox.getAttribute('data-type');\n      if (type) {\n        const checked = (checkbox as HTMLInputElement).checked;\n        if (checked) {\n          state.filters.entityTypes = state.filters.entityTypes.filter(t => t !== type);\n        } else {\n          state.filters.entityTypes.push(type);\n        }\n        // TODO: Trigger filter update\n      }\n    });\n  });\n}\n\n/**\n * Render community filters\n */\nfunction renderCommunityFilters(\n  container: HTMLElement,\n  communities: Array<{ id: number; size: number; hub?: { name: string } }>,\n  state: GraphExplorerState\n): void {\n  const el = container.querySelector('#community-filters');\n  if (!el) return;\n\n  if (communities.length === 0) {\n    el.innerHTML = '<div class=\"empty-state-small\">No communities detected</div>';\n    return;\n  }\n\n  const colors = ['#6366f1', '#22c55e', '#f59e0b', '#ef4444', '#8b5cf6', '#06b6d4', '#ec4899', '#84cc16'];\n\n  el.innerHTML = `\n    <label class=\"community-filter-item\">\n      <input type=\"radio\" name=\"community\" value=\"\" checked>\n      <span class=\"community-filter-label\">All communities</span>\n    </label>\n    ${communities.slice(0, 8).map((c, i) => `\n      <label class=\"community-filter-item\">\n        <input type=\"radio\" name=\"community\" value=\"${c.id}\">\n        <span class=\"community-filter-color\" style=\"background: ${colors[i % colors.length]}\"></span>\n        <span class=\"community-filter-label\">${c.hub?.name || `Community ${c.id + 1}`} (${c.size})</span>\n      </label>\n    `).join('')}\n  `;\n\n  // Bind radios\n  el.querySelectorAll('input[type=\"radio\"]').forEach(radio => {\n    on(radio as HTMLElement, 'change', () => {\n      const value = (radio as HTMLInputElement).value;\n      state.filters.communityId = value ? parseInt(value) : null;\n      // TODO: Trigger filter update\n    });\n  });\n}\n\n/**\n * Render bookmarks\n */\nfunction renderBookmarks(\n  container: HTMLElement,\n  bookmarks: Array<{ id: string; node_id: string; node_label: string; node_type: string; node_avatar_url?: string }>\n): void {\n  const el = container.querySelector('#bookmarks-list');\n  if (!el) return;\n\n  if (bookmarks.length === 0) {\n    el.innerHTML = '<div class=\"empty-state-small\">No bookmarks yet</div>';\n    return;\n  }\n\n  el.innerHTML = bookmarks.map(b => `\n    <div class=\"bookmark-item\" data-node-id=\"${b.node_id}\">\n      ${b.node_avatar_url\n        ? `<img class=\"bookmark-avatar\" src=\"${b.node_avatar_url}\" alt=\"\">`\n        : `<div class=\"bookmark-avatar-placeholder\">${b.node_label.charAt(0)}</div>`\n      }\n      <div class=\"bookmark-info\">\n        <span class=\"bookmark-label\">${b.node_label}</span>\n        <span class=\"bookmark-type\">${b.node_type}</span>\n      </div>\n    </div>\n  `).join('');\n}\n\n/**\n * Switch tab\n */\nasync function switchTab(\n  container: HTMLElement,\n  state: GraphExplorerState,\n  tabId: TabId,\n  props: GraphExplorerProps\n): Promise<void> {\n  state.activeTab = tabId;\n\n  // Update tab buttons\n  const tabs = container.querySelectorAll('.graph-tab');\n  tabs.forEach(tab => {\n    tab.classList.toggle('active', tab.getAttribute('data-tab') === tabId);\n  });\n\n  // Load tab content\n  const content = container.querySelector('#graph-content');\n  if (!content) return;\n\n  content.innerHTML = `\n    <div class=\"graph-loading\">\n      <div class=\"loading-spinner\"></div>\n      <p>Loading...</p>\n    </div>\n  `;\n\n  try {\n    switch (tabId) {\n      case 'explorer':\n        await loadExplorerTab(content as HTMLElement, state, props);\n        break;\n      case 'ontology':\n        await loadOntologyTab(content as HTMLElement);\n        break;\n      case 'query':\n        await loadQueryTab(content as HTMLElement, props);\n        break;\n      case 'analytics':\n        await loadAnalyticsTab(content as HTMLElement);\n        break;\n    }\n  } catch (error) {\n    console.error(`[GraphExplorer] Failed to load ${tabId} tab:`, error);\n    content.innerHTML = `\n      <div class=\"graph-error\">\n        <p>Failed to load ${tabId}</p>\n        <button class=\"btn btn-sm\" onclick=\"this.closest('.graph-content').innerHTML = ''\">Retry</button>\n      </div>\n    `;\n  }\n}\n\n/**\n * Load Explorer tab\n */\nasync function loadExplorerTab(\n  container: HTMLElement,\n  state: GraphExplorerState,\n  props: GraphExplorerProps\n): Promise<void> {\n  container.innerHTML = '';\n  \n  if (state.renderer === 'falkordb') {\n    // Use FalkorDB Canvas (better visuals, official component)\n    const { createGraphCanvas } = await import('./GraphCanvas');\n    const viz = createGraphCanvas({\n      height: container.clientHeight || 600,\n      onNodeClick: (node) => {\n        state.selectedNode = node;\n        props.onNodeSelect?.(node);\n        updateNodeDetails(container.closest('.graph-explorer') as HTMLElement, node);\n      },\n      onNodeRightClick: (node) => {\n        // Show context menu\n        toast.info(`${node.name || node.label || node.id}`);\n      },\n      onDataLoaded: (stats) => {\n        // Update the stats mini display with actual counts\n        state.stats = { ...state.stats, ...stats };\n        const explorer = container.closest('.graph-explorer') as HTMLElement;\n        if (explorer) {\n          updateStatsMini(explorer, state.stats);\n        }\n      },\n    });\n    container.appendChild(viz);\n  } else {\n    // Use vis.js (legacy, fallback)\n    const { createGraphVisualization } = await import('./GraphVisualization');\n    const viz = createGraphVisualization({\n      height: container.clientHeight || 600,\n      onNodeClick: (node) => {\n        state.selectedNode = node;\n        props.onNodeSelect?.(node);\n        updateNodeDetails(container.closest('.graph-explorer') as HTMLElement, node);\n      },\n      onNodeDoubleClick: (node) => {\n        toast.info(`Expanding connections for ${node.label || node.name || node.id}`);\n      },\n    });\n    container.appendChild(viz);\n  }\n}\n\n/**\n * Load Ontology tab\n */\nasync function loadOntologyTab(container: HTMLElement): Promise<void> {\n  const { createOntologyViewer } = await import('./OntologyViewer');\n  container.innerHTML = '';\n  const viewer = createOntologyViewer({});\n  container.appendChild(viewer);\n}\n\n/**\n * Load Query tab\n */\nasync function loadQueryTab(\n  container: HTMLElement,\n  props: GraphExplorerProps\n): Promise<void> {\n  const { createQueryBuilder } = await import('./QueryBuilder');\n  container.innerHTML = '';\n  const builder = createQueryBuilder({\n    onExecute: (cypher, results) => {\n      props.onQueryExecute?.(cypher);\n    },\n  });\n  container.appendChild(builder);\n}\n\n/**\n * Load Analytics tab\n */\nasync function loadAnalyticsTab(container: HTMLElement): Promise<void> {\n  const { createGraphAnalytics } = await import('./GraphAnalytics');\n  container.innerHTML = '';\n  const analytics = createGraphAnalytics({});\n  container.appendChild(analytics);\n}\n\n/**\n * Update node details panel\n */\nfunction updateNodeDetails(container: HTMLElement, node: GraphNode): void {\n  const panel = container.querySelector('#node-details-panel');\n  if (!panel) return;\n\n  const avatarUrl = node.avatarUrl || node.photoUrl || (node.properties as Record<string, unknown>)?.avatar_url || (node.properties as Record<string, unknown>)?.photo_url;\n  const role = node.role || (node.properties as Record<string, unknown>)?.role;\n  const organization = node.organization || (node.properties as Record<string, unknown>)?.organization;\n  const email = node.email || (node.properties as Record<string, unknown>)?.email;\n\n  panel.innerHTML = `\n    <div class=\"node-details\">\n      <div class=\"node-details-header\">\n        ${avatarUrl\n          ? `<img class=\"node-avatar-large\" src=\"${avatarUrl}\" alt=\"\" onerror=\"this.style.display='none'\">`\n          : `<div class=\"node-avatar-large node-avatar-placeholder\" style=\"background: ${getTypeColor(node.type)}\">${(node.label || node.name || '?').charAt(0).toUpperCase()}</div>`\n        }\n        <div class=\"node-header-info\">\n          <h3 class=\"node-name\">${escapeHtml(node.label || node.name || node.id)}</h3>\n          <span class=\"node-type-badge\" style=\"background: ${getTypeColor(node.type)}\">${node.type}</span>\n        </div>\n        <button class=\"btn-icon node-bookmark-btn\" title=\"Bookmark\">\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <path d=\"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z\"/>\n          </svg>\n        </button>\n      </div>\n      \n      ${role || organization ? `\n        <div class=\"node-role-info\">\n          ${role ? `<span class=\"node-role\">${escapeHtml(String(role))}</span>` : ''}\n          ${organization ? `<span class=\"node-org\">@ ${escapeHtml(String(organization))}</span>` : ''}\n        </div>\n      ` : ''}\n      \n      ${email ? `\n        <div class=\"node-contact-info\">\n          <a href=\"mailto:${email}\" class=\"node-email\">\n            <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n              <path d=\"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z\"/>\n              <polyline points=\"22,6 12,13 2,6\"/>\n            </svg>\n            ${escapeHtml(String(email))}\n          </a>\n        </div>\n      ` : ''}\n      \n      <div class=\"node-stats\">\n        <div class=\"node-stat\">\n          <span class=\"node-stat-value\">${node.connections || 0}</span>\n          <span class=\"node-stat-label\">Connections</span>\n        </div>\n        ${node.centrality ? `\n          <div class=\"node-stat\">\n            <span class=\"node-stat-value\">${(node.centrality * 100).toFixed(0)}%</span>\n            <span class=\"node-stat-label\">Centrality</span>\n          </div>\n        ` : ''}\n        ${node.communityId !== undefined ? `\n          <div class=\"node-stat\">\n            <span class=\"node-stat-value\">#${node.communityId + 1}</span>\n            <span class=\"node-stat-label\">Community</span>\n          </div>\n        ` : ''}\n      </div>\n      \n      <div class=\"node-actions\">\n        <button class=\"btn btn-sm btn-secondary\" data-action=\"expand\">\n          <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <circle cx=\"12\" cy=\"12\" r=\"10\"/>\n            <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"16\"/>\n            <line x1=\"8\" y1=\"12\" x2=\"16\" y2=\"12\"/>\n          </svg>\n          Expand\n        </button>\n        <button class=\"btn btn-sm btn-secondary\" data-action=\"find-paths\">\n          <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <path d=\"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6\"/>\n            <polyline points=\"15 3 21 3 21 9\"/>\n            <line x1=\"10\" y1=\"14\" x2=\"21\" y2=\"3\"/>\n          </svg>\n          Paths\n        </button>\n        <button class=\"btn btn-sm btn-secondary\" data-action=\"ai-explain\">\n          <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <circle cx=\"12\" cy=\"12\" r=\"10\"/>\n            <path d=\"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3\"/>\n            <line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"/>\n          </svg>\n          AI Explain\n        </button>\n      </div>\n      \n      ${node.properties ? `\n        <div class=\"node-properties\">\n          <h4>Properties</h4>\n          <div class=\"properties-list\">\n            ${Object.entries(node.properties)\n              .filter(([key]) => !['id', 'name', 'label', 'type', 'avatar_url', 'photo_url', 'avatarUrl', 'photoUrl'].includes(key))\n              .slice(0, 10)\n              .map(([key, value]) => `\n                <div class=\"property-item\">\n                  <span class=\"property-key\">${escapeHtml(key)}:</span>\n                  <span class=\"property-value\">${escapeHtml(String(value).substring(0, 100))}</span>\n                </div>\n              `).join('')}\n          </div>\n        </div>\n      ` : ''}\n    </div>\n  `;\n}\n\n/**\n * Toggle AI Copilot\n */\nfunction toggleAICopilot(container: HTMLElement, state: GraphExplorerState): void {\n  state.isCopilotOpen = !state.isCopilotOpen;\n  const copilotContainer = container.querySelector('#ai-copilot-container');\n  \n  if (copilotContainer) {\n    if (state.isCopilotOpen) {\n      copilotContainer.classList.remove('hidden');\n      // Load copilot component if not loaded\n      if (!copilotContainer.hasChildNodes()) {\n        import('./AICopilot').then(({ createAICopilot }) => {\n          const copilot = createAICopilot({\n            onClose: () => toggleAICopilot(container, state),\n            onHighlightNodes: (nodeIds) => {\n              // TODO: Highlight nodes in visualization\n              console.log('Highlight nodes:', nodeIds);\n            },\n          });\n          copilotContainer.innerHTML = '';\n          copilotContainer.appendChild(copilot);\n        });\n      }\n    } else {\n      copilotContainer.classList.add('hidden');\n    }\n  }\n}\n\n/**\n * Toggle Command Palette\n */\nfunction toggleCommandPalette(container: HTMLElement, state: GraphExplorerState): void {\n  state.isCommandPaletteOpen = !state.isCommandPaletteOpen;\n  const overlay = container.querySelector('#command-palette-overlay');\n  \n  if (overlay) {\n    if (state.isCommandPaletteOpen) {\n      overlay.classList.remove('hidden');\n      // Load command palette if not loaded\n      if (!overlay.hasChildNodes()) {\n        import('./CommandPalette').then(({ createCommandPalette }) => {\n          const palette = createCommandPalette({\n            onClose: () => toggleCommandPalette(container, state),\n            onAction: (action) => {\n              handleQuickAction(action, container, state);\n              toggleCommandPalette(container, state);\n            },\n          });\n          overlay.innerHTML = '';\n          overlay.appendChild(palette);\n        });\n      }\n      // Focus search input\n      setTimeout(() => {\n        const input = overlay.querySelector('input');\n        if (input) input.focus();\n      }, 100);\n    } else {\n      overlay.classList.add('hidden');\n    }\n  }\n}\n\n/**\n * Sync graph\n */\nasync function syncGraph(container: HTMLElement): Promise<void> {\n  toast.info('Syncing data to graph...');\n  try {\n    await fetch('/api/graph/sync', { method: 'POST' });\n    toast.success('Graph synced successfully');\n    // Reload data\n    const stats = await graphService.getStats();\n    updateStatsMini(container, stats);\n  } catch {\n    toast.error('Failed to sync graph');\n  }\n}\n\n/**\n * Toggle fullscreen\n */\nfunction toggleFullscreen(container: HTMLElement): void {\n  if (document.fullscreenElement) {\n    document.exitFullscreen();\n  } else {\n    container.requestFullscreen();\n  }\n}\n\n/**\n * Handle quick action\n */\nasync function handleQuickAction(action: string, container: HTMLElement, state: GraphExplorerState): Promise<void> {\n  switch (action) {\n    case 'find-paths':\n      toast.info('Select two nodes to find paths between them');\n      break;\n    case 'detect-communities':\n      toast.info('Detecting communities...');\n      const communities = await graphService.getCommunities();\n      toast.success(`Found ${communities.length} communities`);\n      break;\n    case 'key-people':\n      toast.info('Finding key people...');\n      const centrality = await graphService.getCentrality();\n      if (centrality.topNodes.length > 0) {\n        toast.success(`Top person: ${centrality.topNodes[0].name} (${centrality.topNodes[0].connections} connections)`);\n      }\n      break;\n    case 'export-graph':\n      toast.info('Exporting graph...');\n      // TODO: Implement export\n      break;\n    case 'create-snapshot':\n      toast.info('Creating snapshot...');\n      const data = await graphService.getVisualizationData();\n      const stats = await graphService.getStats();\n      await graphService.createSnapshot({\n        name: `Snapshot ${new Date().toLocaleDateString()}`,\n        snapshot_type: 'manual',\n        snapshot_data: {\n          nodes: data.nodes,\n          edges: data.edges,\n          stats: stats,\n          capturedAt: new Date().toISOString(),\n        },\n        node_count: stats.nodeCount,\n        edge_count: stats.edgeCount,\n        is_baseline: false,\n      });\n      toast.success('Snapshot created');\n      break;\n    case 'ai-insights':\n      toast.info('Generating AI insights...');\n      const insights = await graphService.getInsights();\n      if (insights.length > 0) {\n        toast.success(insights[0].description);\n      } else {\n        toast.info('No insights available');\n      }\n      break;\n    default:\n      console.log('Unknown action:', action);\n  }\n}\n\n/**\n * Get color for entity type\n */\nfunction getTypeColor(type: string): string {\n  const colors: Record<string, string> = {\n    Person: '#6366f1',\n    Project: '#22c55e',\n    Document: '#8b5cf6',\n    Decision: '#06b6d4',\n    Risk: '#ef4444',\n    Question: '#f59e0b',\n    Fact: '#84cc16',\n    Meeting: '#ec4899',\n    Task: '#3b82f6',\n    Technology: '#f97316',\n    Organization: '#a855f7',\n    Client: '#14b8a6',\n    Email: '#e879f9',\n  };\n  return colors[type] || '#6b7280';\n}\n\n/**\n * Escape HTML\n */\nfunction escapeHtml(text: string): string {\n  const div = document.createElement('div');\n  div.textContent = text;\n  return div.innerHTML;\n}\n\nexport default createGraphExplorer;\n"],"file":"GraphExplorer-S4ugv9np.js"}
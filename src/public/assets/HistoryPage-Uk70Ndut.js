import{c as O,r as n,b as ve,g as je,j as e,a as c,ce as Ne,d3 as we,d4 as ke,C as te,P as ie,b2 as Ce,a3 as Se,a2 as ae,an as Ee,a1 as oe,d5 as Te,cJ as ne,Z as _e,ad as Le,U,K as A,$ as De,_ as Ae,L as Ie}from"./main-DPJZnN-g.js";import{E as $e}from"./ErrorState-CGhToI5I.js";import{S as k}from"./skeleton-Cz6AWlMP.js";import{C as ce}from"./cpu-BXdDwRd1.js";import{C as le}from"./chevron-down-DvtyaUz8.js";import{F as Fe}from"./funnel-DXgEGOkL.js";import{K as P}from"./key-DrUrK2UH.js";import{U as de}from"./user-plus-CgA2QXux.js";import{U as Me}from"./upload-C1xl8nMH.js";import{R as Ue}from"./rotate-cw-CScwxFr9.js";import{P as Re}from"./plus-D_qMNj9L.js";import{G as Ke}from"./git-commit-horizontal-DVlBM63l.js";import{S as Pe}from"./square-check-big-grc8ESP1.js";import{L as Oe}from"./lightbulb-BXp-zQLH.js";const He=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],Ye=O("log-in",He);const Be=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],me=O("pencil",Be);const qe=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],ze=O("user-minus",qe),Ge={xs:{box:"w-6 h-6",text:"text-[8px]",img:"w-6 h-6"},sm:{box:"w-8 h-8",text:"text-[10px]",img:"w-8 h-8"},md:{box:"w-10 h-10",text:"text-xs",img:"w-10 h-10"},lg:{box:"w-14 h-14",text:"text-sm",img:"w-14 h-14"},xl:{box:"w-20 h-20",text:"text-lg",img:"w-20 h-20"}},re=["from-blue-500 to-indigo-600","from-emerald-500 to-teal-600","from-violet-500 to-purple-600","from-amber-500 to-orange-600","from-rose-500 to-pink-600","from-cyan-500 to-sky-600"];function Ve(t){let r=0;for(let s=0;s<t.length;s++)r=t.charCodeAt(s)+((r<<5)-r);return re[Math.abs(r)%re.length]}function Je({person:t,size:r="md",className:s,showInfo:o,infoClassName:d}){const[u,m]=n.useState(!1),l=ve(t),b=String(t?.name||t?.display_name||t?.username||t?.email||""),v=je(b),C=Ge[r],h=String(t?.cargo||t?.role||t?.title||""),S=String(t?.empresa||t?.organization||t?.company||""),j=l&&!u?e.jsx("img",{src:l,alt:b,onError:()=>m(!0),className:c(C.img,"rounded-full object-cover flex-shrink-0",s)}):e.jsx("div",{className:c(C.box,"rounded-full flex items-center justify-center flex-shrink-0 bg-gradient-to-br",Ve(b),s),children:e.jsx("span",{className:c(C.text,"font-bold text-white leading-none"),children:v})});return o?e.jsxs("div",{className:c("flex items-center gap-2.5 min-w-0",d),children:[j,e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-[var(--gm-text-primary)] truncate",children:b||"Unknown"}),(h||S)&&e.jsxs("p",{className:"text-[10px] text-[var(--gm-text-tertiary)] truncate",children:[h,h&&S?" · ":"",S]})]})]}):j}const H="rounded-xl border border-[var(--gm-border-primary)] bg-[var(--gm-surface-primary)] shadow-[var(--shadow-sm)] transition-all duration-200",Qe="inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg bg-[var(--gm-interactive-primary)] text-[var(--gm-text-on-brand)] hover:bg-[var(--gm-interactive-primary-hover)] shadow-sm transition-all duration-150 disabled:opacity-50",D="inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg bg-[var(--gm-interactive-secondary)] text-[var(--gm-text-primary)] hover:bg-[var(--gm-interactive-secondary-hover)] border border-[var(--gm-border-primary)] transition-all duration-150",R="w-full bg-[var(--gm-bg-tertiary)] border border-[var(--gm-border-primary)] rounded-lg px-3 py-2 text-sm text-[var(--gm-text-primary)] placeholder:text-[var(--gm-text-placeholder)] focus:outline-none focus:border-[var(--gm-border-focus)] focus:shadow-[var(--shadow-focus)] transition-all duration-150",Ze=[{id:"activity",label:"Activity Log",icon:ie},{id:"processing",label:"Processing",icon:ce}];function Xe({title:t,subtitle:r}){return e.jsxs("div",{className:"mb-5",children:[e.jsx("h2",{className:"text-lg font-bold text-[var(--gm-text-primary)]",children:t}),r&&e.jsx("p",{className:"text-xs text-[var(--gm-text-tertiary)] mt-0.5",children:r})]})}const We={created:{icon:Re,color:"text-green-500",bg:"bg-green-500/10",border:"border-green-500/30",label:"Created"},updated:{icon:me,color:"text-blue-500",bg:"bg-blue-500/10",border:"border-blue-500/30",label:"Updated"},deleted:{icon:Le,color:"text-red-500",bg:"bg-red-500/10",border:"border-red-500/30",label:"Deleted"},restored:{icon:Ue,color:"text-yellow-500",bg:"bg-yellow-500/10",border:"border-yellow-500/30",label:"Restored"},processed:{icon:_e,color:"text-cyan-500",bg:"bg-cyan-500/10",border:"border-cyan-500/30",label:"Processed"},uploaded:{icon:Me,color:"text-purple-500",bg:"bg-purple-500/10",border:"border-purple-500/30",label:"Uploaded"},added:{icon:de,color:"text-emerald-500",bg:"bg-emerald-500/10",border:"border-emerald-500/30",label:"Added"},removed:{icon:ze,color:"text-orange-500",bg:"bg-orange-500/10",border:"border-orange-500/30",label:"Removed"},changed:{icon:ne,color:"text-indigo-500",bg:"bg-indigo-500/10",border:"border-indigo-500/30",label:"Changed"},login:{icon:Ye,color:"text-teal-500",bg:"bg-teal-500/10",border:"border-teal-500/30",label:"Login"},logout:{icon:Te,color:"text-slate-500",bg:"bg-slate-500/10",border:"border-slate-500/30",label:"Logout"},access:{icon:P,color:"text-rose-500",bg:"bg-rose-500/10",border:"border-rose-500/30",label:"Access"},comment:{icon:oe,color:"text-sky-500",bg:"bg-sky-500/10",border:"border-sky-500/30",label:"Comment"}},et={project:{icon:A,label:"Project"},document:{icon:A,label:"Document"},fact:{icon:Oe,label:"Fact"},question:{icon:Ie,label:"Question"},risk:{icon:Ae,label:"Risk"},action:{icon:Pe,label:"Action"},decision:{icon:Ke,label:"Decision"},contact:{icon:U,label:"Contact"},email:{icon:De,label:"Email"},member:{icon:U,label:"Member"},invite:{icon:de,label:"Invite"},content:{icon:A,label:"Content"},comment:{icon:oe,label:"Comment"},settings:{icon:ne,label:"Settings"},user:{icon:U,label:"User"},password:{icon:P,label:"Auth"},admin:{icon:P,label:"Admin"}},tt={icon:me,color:"text-blue-500",bg:"bg-blue-500/10",border:"border-blue-500/30",label:"Action"},at={icon:A,label:"Item"};function rt(t){const r=t.split("."),s=r[0]||"item";return{actionKey:r[1]||"updated",entityKey:s}}function Y(t){return We[t]||tt}function B(t){return et[t]||at}function st(t){return t?new Date(t).toISOString().split("T")[0]:"unknown"}function it(t){const r=new Date(t),s=new Date,o=new Date(s.getFullYear(),s.getMonth(),s.getDate()),d=Math.floor((o.getTime()-new Date(r.getFullYear(),r.getMonth(),r.getDate()).getTime())/864e5);return d===0?"Today":d===1?"Yesterday":d<7?r.toLocaleDateString("en-US",{weekday:"long"}):r.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:r.getFullYear()!==s.getFullYear()?"numeric":void 0})}function ot(t){const r=Math.floor((Date.now()-new Date(t).getTime())/6e4);if(r<1)return"just now";if(r<60)return`${r}m ago`;const s=Math.floor(r/60);if(s<24)return`${s}h ago`;const o=Math.floor(s/24);return o<7?`${o}d ago`:new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric"})}function nt(t){return t.replace(/_/g," ").replace(/\b\w/g,r=>r.toUpperCase())}function ct(t){const{actionKey:r,entityKey:s}=rt(t.action),o=t.metadata||{},d=String(o.name||o.target_name||o.filename||""),u=Y(r),m=B(s);return{id:t.id,actionKey:r,entityKey:s,title:d||`${m.label} ${u.label.toLowerCase()}`,description:o.description?String(o.description):void 0,timestamp:t.created_at,actor:t.actor?{name:t.actor.display_name||t.actor.username||"Unknown",avatar_url:t.actor.avatar_url||void 0}:void 0,metadata:o,source:"activity"}}function lt(t,r){const s=[];return t.facts_extracted&&s.push(`${t.facts_extracted} facts`),t.questions_added&&s.push(`${t.questions_added} questions`),t.decisions_added&&s.push(`${t.decisions_added} decisions`),t.risks_added&&s.push(`${t.risks_added} risks`),t.actions_added&&s.push(`${t.actions_added} actions`),t.people_added&&s.push(`${t.people_added} contacts`),{id:`proc-${r}-${t.timestamp}`,actionKey:"processed",entityKey:"document",title:t.filename||"Document processing",description:s.length?`Extracted: ${s.join(", ")}`:void 0,timestamp:t.timestamp,metadata:{status:t.status,model:t.model_used,tokens:t.tokens_used,duration_ms:t.duration_ms,files_processed:t.files_processed},source:"processing"}}function dt(){return e.jsxs("div",{className:"flex-1 p-6 space-y-5 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(k,{className:"h-6 w-36 bg-[var(--gm-surface-secondary)]"}),e.jsx(k,{className:"h-8 w-48 rounded-lg bg-[var(--gm-surface-secondary)]"})]}),e.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(t=>e.jsx(k,{className:"h-7 w-20 rounded-lg bg-[var(--gm-surface-secondary)]"},t))}),[1,2,3].map(t=>e.jsxs("div",{className:"space-y-3",children:[e.jsx(k,{className:"h-4 w-40 bg-[var(--gm-surface-secondary)]"}),[1,2,3].map(r=>e.jsxs("div",{className:c(H,"flex items-start gap-3 p-3"),children:[e.jsx(k,{className:"h-9 w-9 rounded-lg shrink-0 bg-[var(--gm-surface-secondary)]"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(k,{className:"h-3 w-2/3 bg-[var(--gm-surface-secondary)]"}),e.jsx(k,{className:"h-2.5 w-1/3 bg-[var(--gm-surface-secondary)]"})]})]},r))]},t))]})}function se({active:t,onClick:r,icon:s,label:o,activeColor:d,activeBg:u,activeBorder:m}){return e.jsxs("button",{onClick:r,"aria-pressed":t,className:c("px-2 py-1 rounded-md text-[10px] font-medium transition-all border flex items-center gap-1",t?`${u||"bg-blue-500/10"} ${m||"border-blue-500/30"} ${d||"text-blue-500"}`:"bg-[var(--gm-surface-secondary)] border-transparent text-[var(--gm-text-tertiary)] hover:text-[var(--gm-text-primary)] hover:border-[var(--gm-border-primary)]"),children:[e.jsx(s,{className:"w-3 h-3"})," ",o]})}function mt({entry:t,isOpen:r,onToggle:s}){const o=Y(t.actionKey),d=B(t.entityKey),u=o.icon,m=t.metadata;return e.jsxs("div",{className:c(H,"overflow-hidden hover:border-[var(--gm-interactive-primary)] hover:shadow-md"),children:[e.jsxs("div",{className:"py-3 px-4 flex items-start gap-3 cursor-pointer",onClick:s,children:[e.jsx("div",{className:c("rounded-lg flex items-center justify-center shrink-0 h-8 w-8",o.bg),children:e.jsx(u,{className:c("w-4 h-4",o.color)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:c("text-[10px] font-medium px-1.5 py-0.5 rounded border",o.bg,o.border,o.color),children:o.label}),e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-[var(--gm-surface-secondary)] text-[var(--gm-text-tertiary)]",children:d.label})]}),e.jsx("p",{className:"text-sm text-[var(--gm-text-primary)] mt-1 leading-snug truncate",children:t.title}),t.description&&e.jsx("p",{className:"text-[10px] text-[var(--gm-text-tertiary)] mt-0.5 truncate",children:t.description}),e.jsxs("div",{className:"flex items-center gap-3 mt-1.5",children:[t.actor&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Je,{person:{name:t.actor.name,avatar_url:t.actor.avatar_url},size:"xs"}),e.jsx("span",{className:"text-[10px] text-[var(--gm-text-tertiary)]",children:t.actor.name})]}),t.timestamp&&e.jsx("span",{className:"text-[10px] text-[var(--gm-text-tertiary)] opacity-60",title:new Date(t.timestamp).toLocaleString(),children:ot(t.timestamp)}),t.source==="processing"&&m?.model&&e.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-[var(--gm-surface-secondary)] text-[var(--gm-text-tertiary)]",children:String(m.model)})]})]}),e.jsx(le,{className:c("w-3.5 h-3.5 text-[var(--gm-text-tertiary)] transition-transform mt-1",r&&"rotate-180")})]}),r&&m&&Object.keys(m).length>0&&e.jsx("div",{className:"px-4 pb-3 border-t border-[var(--gm-border-primary)] pt-3",children:e.jsx("div",{className:"grid grid-cols-[auto_1fr] gap-x-4 gap-y-1",children:Object.entries(m).filter(([,l])=>l!=null&&l!=="").map(([l,b])=>e.jsxs("div",{className:"contents",children:[e.jsx("span",{className:"text-[10px] font-medium text-[var(--gm-text-tertiary)]",children:nt(l)}),e.jsx("span",{className:"text-[10px] text-[var(--gm-text-secondary)] truncate",children:typeof b=="object"?JSON.stringify(b):String(b)})]},l))})})]})}const K=50,xt=[{key:"created",label:"Created"},{key:"updated",label:"Updated"},{key:"deleted",label:"Deleted"},{key:"processed",label:"Processed"},{key:"uploaded",label:"Uploaded"},{key:"added",label:"Added"},{key:"removed",label:"Removed"},{key:"changed",label:"Changed"}],gt=["project","document","content","member","invite","fact","question","risk","action","decision","contact","email"];function Tt(){const{project:t}=Ne(),[r,s]=n.useState("activity"),[o,d]=n.useState(""),[u,m]=n.useState(""),[l,b]=n.useState(""),[v,C]=n.useState(""),[h,S]=n.useState(""),[j,q]=n.useState(""),[z,I]=n.useState(null),[E,$]=n.useState(!1),[_,G]=n.useState(K),V=n.useRef(null),F=n.useRef(null),x=we({limit:500}),g=ke(),[J,xe]=n.useState(!1);n.useEffect(()=>{if(!J&&!x.isLoading&&!g.isLoading){const a=x.data?.activities?.length??0,i=(g.data??[]).length;a===0&&i>0&&(s("processing"),xe(!0))}},[x.isLoading,g.isLoading,x.data,g.data,J]);const ge=r==="activity"?x.isLoading:g.isLoading,ue=r==="activity"?x.isError:g.isError,pe=r==="activity"?x.refetch:g.refetch;n.useEffect(()=>{const a=setTimeout(()=>m(o),200);return()=>clearTimeout(a)},[o]),n.useEffect(()=>{G(K),I(null)},[r,l,v,h,j,u]);const L=n.useMemo(()=>r==="activity"?(x.data?.activities??[]).map(ct):(g.data??[]).map(lt),[r,x.data,g.data]),y=n.useMemo(()=>L.filter(a=>{if(l&&a.actionKey!==l||v&&a.entityKey!==v||h&&a.timestamp<h)return!1;if(j){const i=j+"T23:59:59.999Z";if(a.timestamp>i)return!1}return!(u&&!`${a.title} ${a.description||""} ${a.actor?.name||""} ${a.actionKey} ${a.entityKey}`.toLowerCase().includes(u.toLowerCase()))}),[L,l,v,h,j,u]),Q=n.useMemo(()=>y.slice(0,_),[y,_]),Z=_<y.length,be=n.useMemo(()=>{const a=new Map,i=[];Q.forEach(p=>{const w=st(p.timestamp);a.has(w)||(a.set(w,[]),i.push(w)),a.get(w).push(p)});const f=new Date().toISOString().split("T")[0];return i.map(p=>({dateKey:p,label:p==="unknown"?"Unknown Date":it(p),isToday:p===f,entries:a.get(p)}))},[Q]),X=n.useCallback(()=>{d(""),b(""),C(""),S(""),q("")},[]),T=o||l||v||h||j,W=n.useCallback(a=>{$(!1);const i=y.map(N=>({action:N.actionKey,entity:N.entityKey,title:N.title,description:N.description||"",actor:N.actor?.name||"",timestamp:N.timestamp}));let f,p;const w=new Date().toISOString().split("T")[0];if(a==="json")f=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),p=`history-${w}.json`;else{const N=Object.keys(i[0]||{}),he=[N.join(","),...i.map(ye=>N.map(fe=>`"${String(ye[fe]||"").replace(/"/g,'""')}"`).join(","))];f=new Blob([he.join(`
`)],{type:"text/csv"}),p=`history-${w}.csv`}const ee=URL.createObjectURL(f),M=document.createElement("a");M.href=ee,M.download=p,M.click(),URL.revokeObjectURL(ee)},[y]);return n.useEffect(()=>{const a=i=>{if(i.target instanceof HTMLInputElement||i.target instanceof HTMLTextAreaElement){i.key==="Escape"&&(i.target.blur(),d(""));return}i.key==="/"&&(i.preventDefault(),V.current?.focus()),i.key==="Escape"&&I(null)};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[]),n.useEffect(()=>{if(!E)return;const a=i=>{F.current&&!F.current.contains(i.target)&&$(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[E]),e.jsxs("div",{className:"flex h-[calc(100vh-4rem)] bg-[var(--gm-bg-primary)]",children:[e.jsxs("aside",{className:"w-52 shrink-0 border-r border-[var(--gm-border-primary)] bg-[var(--gm-surface-primary)] flex flex-col",children:[e.jsx("div",{className:"px-4 py-4 border-b border-[var(--gm-border-primary)]",children:e.jsxs("h1",{className:"text-sm font-bold text-[var(--gm-text-primary)] flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4 text-[var(--gm-accent-primary)]"})," History"]})}),e.jsx("nav",{className:"flex-1 p-2 space-y-0.5",children:Ze.map(a=>{const i=a.icon,f=r===a.id;return e.jsxs("button",{onClick:()=>s(a.id),className:c("w-full flex items-center gap-2.5 px-3 py-2 rounded-lg text-xs font-medium transition-all duration-150",f?"bg-[var(--gm-interactive-primary)] text-[var(--gm-text-on-brand)] shadow-sm":"text-[var(--gm-text-secondary)] hover:bg-[var(--gm-surface-secondary)] hover:text-[var(--gm-text-primary)]"),children:[e.jsx(i,{className:"w-3.5 h-3.5"}),a.label,a.id==="activity"&&x.data?.total!==void 0&&x.data.total>0&&e.jsx("span",{className:c("ml-auto text-[9px] px-1.5 py-0.5 rounded-full",f?"bg-white/20 text-white":"bg-[var(--gm-surface-secondary)] text-[var(--gm-text-tertiary)]"),children:x.data.total}),a.id==="processing"&&!g.isLoading&&(g.data??[]).length>0&&e.jsx("span",{className:c("ml-auto text-[9px] px-1.5 py-0.5 rounded-full",f?"bg-white/20 text-white":"bg-[var(--gm-surface-secondary)] text-[var(--gm-text-tertiary)]"),children:(g.data??[]).length})]},a.id)})})]}),e.jsxs("main",{className:"flex-1 flex flex-col min-w-0 overflow-hidden",children:[e.jsx("div",{className:"shrink-0 border-b border-[var(--gm-border-primary)] bg-[var(--gm-surface-primary)]",children:e.jsxs("div",{className:"px-5 py-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(Xe,{title:r==="activity"?"Activity Log":"Processing History",subtitle:r==="activity"?"All actions and changes in this project":"Document processing sessions and results"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-[10px] text-[var(--gm-text-tertiary)] bg-[var(--gm-surface-secondary)] px-2 py-0.5 rounded-full",children:[y.length,L.length>y.length?` / ${L.length}`:""," entries"]}),e.jsxs("div",{className:"relative",ref:F,children:[e.jsxs("button",{onClick:()=>$(!E),"aria-expanded":E,className:D,children:[e.jsx(Ce,{className:"w-3.5 h-3.5"})," Export ",e.jsx(le,{className:"w-3 h-3"})]}),E&&e.jsxs("div",{className:c(H,"absolute right-0 top-full mt-1 z-30 min-w-[130px] overflow-hidden"),children:[e.jsx("button",{onClick:()=>W("csv"),className:"w-full text-left px-3 py-2 text-xs text-[var(--gm-text-primary)] hover:bg-[var(--gm-surface-secondary)] transition-colors",children:"Export CSV"}),e.jsx("button",{onClick:()=>W("json"),className:"w-full text-left px-3 py-2 text-xs text-[var(--gm-text-primary)] hover:bg-[var(--gm-surface-secondary)] transition-colors",children:"Export JSON"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(Se,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-[var(--gm-text-tertiary)]"}),e.jsx("input",{ref:V,value:o,onChange:a=>d(a.target.value),placeholder:"Search history... (press / to focus)","aria-label":"Search history",className:c(R,"!pl-8 !pr-8 !py-1.5 !text-xs")}),o&&e.jsx("button",{onClick:()=>d(""),"aria-label":"Clear search",className:"absolute right-2 top-1/2 -translate-y-1/2 text-[var(--gm-text-tertiary)] hover:text-[var(--gm-text-primary)]",children:e.jsx(ae,{className:"w-3.5 h-3.5"})})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Ee,{className:"w-3.5 h-3.5 text-[var(--gm-text-tertiary)]"}),e.jsx("input",{type:"date",value:h,onChange:a=>S(a.target.value),"aria-label":"Date from",className:c(R,"!w-[130px] !py-1.5 !text-[10px]")}),e.jsx("span",{className:"text-[10px] text-[var(--gm-text-tertiary)]",children:"to"}),e.jsx("input",{type:"date",value:j,onChange:a=>q(a.target.value),"aria-label":"Date to",className:c(R,"!w-[130px] !py-1.5 !text-[10px]")})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap mb-1.5",role:"toolbar","aria-label":"Filter by action type",children:[e.jsx(Fe,{className:"w-3 h-3 text-[var(--gm-text-tertiary)] mr-0.5"}),xt.map(a=>{const i=Y(a.key);return e.jsx(se,{active:l===a.key,onClick:()=>b(l===a.key?"":a.key),icon:i.icon,label:a.label,activeColor:i.color,activeBg:i.bg,activeBorder:i.border},a.key)})]}),e.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap",role:"toolbar","aria-label":"Filter by entity type",children:[e.jsx("span",{className:"w-3 mr-0.5"}),gt.map(a=>{const i=B(a);return e.jsx(se,{active:v===a,onClick:()=>C(v===a?"":a),icon:i.icon,label:i.label,activeColor:"text-blue-400",activeBg:"bg-blue-500/10",activeBorder:"border-blue-500/30"},a)}),T&&e.jsxs("button",{onClick:X,className:"px-2 py-1 rounded-md text-[10px] font-medium text-[var(--gm-text-tertiary)] hover:text-red-500 transition-colors flex items-center gap-1",children:[e.jsx(ae,{className:"w-3 h-3"})," Clear all"]})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:ge?e.jsx(dt,{}):ue?e.jsx("div",{className:"p-6",children:e.jsx($e,{message:`Failed to load ${r==="activity"?"activity log":"processing history"}.`,onRetry:()=>pe()})}):y.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-5",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-[var(--gm-surface-secondary)] flex items-center justify-center mb-4",children:e.jsx(te,{className:"w-10 h-10 text-[var(--gm-text-tertiary)] opacity-30"})}),e.jsx("p",{className:"text-sm font-medium text-[var(--gm-text-secondary)] mb-1",children:r==="activity"?"No activity found":"No processing history"}),e.jsx("p",{className:"text-xs text-[var(--gm-text-tertiary)] opacity-60 max-w-sm mb-4",children:T?"Try adjusting your filters or search terms.":r==="activity"?"Activity will appear here as changes are made to the project.":"Processing history will appear here after documents are processed."}),e.jsxs("div",{className:"flex items-center gap-2",children:[T&&e.jsx("button",{onClick:X,className:Qe,children:"Clear Filters"}),!T&&r==="activity"&&(g.data??[]).length>0&&e.jsxs("button",{onClick:()=>s("processing"),className:D,children:[e.jsx(ce,{className:"w-3.5 h-3.5"})," View Processing History"]}),!T&&r==="processing"&&(x.data?.activities?.length??0)>0&&e.jsxs("button",{onClick:()=>s("activity"),className:D,children:[e.jsx(ie,{className:"w-3.5 h-3.5"})," View Activity Log"]})]})]}):e.jsxs("div",{className:"px-5 py-4",children:[be.map(a=>e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"sticky top-0 z-10 flex items-center gap-3 py-2 bg-[var(--gm-bg-primary)]",children:[e.jsx("div",{className:c("w-2.5 h-2.5 rounded-full shrink-0",a.isToday?"bg-[var(--gm-interactive-primary)] ring-2 ring-blue-500/30":"bg-[var(--gm-text-tertiary)] opacity-40")}),e.jsx("span",{className:c("text-[11px] font-semibold uppercase tracking-wider",a.isToday?"text-[var(--gm-interactive-primary)]":"text-[var(--gm-text-tertiary)]"),children:a.label}),e.jsx("span",{className:"text-[10px] text-[var(--gm-text-tertiary)] opacity-50",children:a.entries.length}),e.jsx("div",{className:"flex-1 h-px bg-[var(--gm-border-primary)]"})]}),e.jsx("div",{className:"ml-[5px] border-l-2 border-[var(--gm-border-primary)] space-y-1.5 pl-5",children:a.entries.map(i=>e.jsx(mt,{entry:i,isOpen:z===i.id,onToggle:()=>I(z===i.id?null:i.id)},i.id))})]},a.dateKey)),Z&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsxs("button",{onClick:()=>G(a=>a+K),className:D,children:["Load More (",y.length-_," remaining)"]})}),!Z&&y.length>0&&e.jsxs("div",{className:"flex items-center justify-center gap-3 py-3 text-[9px] text-[var(--gm-text-tertiary)] opacity-40",children:[e.jsx("span",{children:"End of history"}),e.jsx("span",{className:"mx-2",children:"·"}),e.jsxs("span",{children:[e.jsx("kbd",{className:"px-1 py-0.5 rounded bg-[var(--gm-surface-secondary)] border border-[var(--gm-border-primary)] text-[8px]",children:"/"})," search"]}),e.jsxs("span",{children:[e.jsx("kbd",{className:"px-1 py-0.5 rounded bg-[var(--gm-surface-secondary)] border border-[var(--gm-border-primary)] text-[8px]",children:"Esc"})," collapse"]})]})]})})]})]})}export{Tt as default};
//# sourceMappingURL=HistoryPage-Uk70Ndut.js.map

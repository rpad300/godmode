{"version":3,"file":"CostsPage-CVXcg9Q4.js","sources":["../../frontend/src/pages/CostsPage.tsx"],"sourcesContent":["import { useState, useMemo } from 'react';\nimport {\n  DollarSign, Download, Loader2, BarChart3, TrendingUp, TrendingDown,\n  Cpu, Layers, Zap, Clock, AlertTriangle, Settings, ChevronDown,\n  ChevronUp, ArrowUpRight, ArrowDownRight, Minus, FileText,\n  RefreshCw, Target, Search,\n} from 'lucide-react';\nimport { toast } from 'sonner';\nimport {\n  useCostsSummary, useRecentLLMRequests, useModelStats,\n  usePricingTable, useBudget, useSetBudget, useResetCosts,\n} from '../hooks/useGodMode';\nimport { Dialog, DialogContent, DialogTitle } from '../components/ui/Dialog';\nimport { cn } from '../lib/utils';\nimport { apiClient } from '../lib/api-client';\nimport { ErrorState } from '../components/shared/ErrorState';\n\ntype Period = 'day' | 'week' | 'month' | 'all';\n\nconst periods: { value: Period; label: string; short: string }[] = [\n  { value: 'day', label: 'Today', short: '24h' },\n  { value: 'week', label: 'This Week', short: '7d' },\n  { value: 'month', label: 'This Month', short: '30d' },\n  { value: 'all', label: 'All Time', short: 'All' },\n];\n\nexport default function CostsPage() {\n  const [period, setPeriod] = useState<Period>('month');\n  const [showBudget, setShowBudget] = useState(false);\n  const [showPricing, setShowPricing] = useState(false);\n  const [showRecent, setShowRecent] = useState(false);\n  const [recentSearch, setRecentSearch] = useState('');\n  const [expandedBreakdown, setExpandedBreakdown] = useState<string | null>('model');\n\n  const summary = useCostsSummary(period);\n  const recent = useRecentLLMRequests(50);\n  const modelStats = useModelStats();\n  const pricing = usePricingTable();\n  const budget = useBudget(period === 'day' || period === 'all' ? 'month' : period);\n  const resetCosts = useResetCosts();\n\n  const data = summary.data as Record<string, unknown> | undefined;\n  const totalCost = Number(data?.total ?? 0);\n  const byProvider = (data?.byProvider || {}) as Record<string, number>;\n  const byModel = (data?.byModel || {}) as Record<string, number>;\n  const byOperation = (data?.byOperation || {}) as Record<string, number>;\n  const byContext = (data?.byContext || {}) as Record<string, number>;\n  const dailyBreakdown = (data?.dailyBreakdown || []) as Array<{ date: string; cost: number; calls: number }>;\n  const totalInputTokens = Number(data?.totalInputTokens ?? 0);\n  const totalOutputTokens = Number(data?.totalOutputTokens ?? 0);\n  const previousCost = data?.previousPeriodCost as number | null | undefined;\n  const percentChange = data?.percentChange as number | null | undefined;\n  const budgetLimit = data?.budgetLimit as number | null | undefined;\n  const budgetUsedPercent = data?.budgetUsedPercent as number | null | undefined;\n  const budgetAlertTriggered = !!data?.budgetAlertTriggered;\n  const periodInfo = data?.period as Record<string, string> | undefined;\n\n  const budgetData = (budget.data as Record<string, unknown>)?.budget as Record<string, unknown> | null;\n\n  const recentRequests = useMemo(() => {\n    const list = ((recent.data as Record<string, unknown>)?.requests || []) as Array<Record<string, unknown>>;\n    if (!recentSearch.trim()) return list;\n    const q = recentSearch.toLowerCase();\n    return list.filter(r => JSON.stringify(r).toLowerCase().includes(q));\n  }, [recent.data, recentSearch]);\n\n  const maxDailyCost = Math.max(...dailyBreakdown.map(d => d.cost), 0.001);\n\n  const handleExport = async (format: 'json' | 'csv') => {\n    try {\n      const data = await apiClient.get<string | Record<string, unknown>>(`/api/costs/export?period=${period}&format=${format}`);\n      const content = typeof data === 'string' ? data : JSON.stringify(data, null, 2);\n      const mime = format === 'csv' ? 'text/csv' : 'application/json';\n      const blob = new Blob([content], { type: mime });\n      const link = document.createElement('a');\n      link.href = URL.createObjectURL(blob);\n      link.download = `llm-costs-${period}-${new Date().toISOString().split('T')[0]}.${format}`;\n      link.click();\n      URL.revokeObjectURL(link.href);\n      toast.success(`Exported as ${format.toUpperCase()}`);\n    } catch {\n      toast.error('Export failed');\n    }\n  };\n\n  const handleReset = () => {\n    if (!confirm('Reset in-memory cost tracking? This does not affect persisted data.')) return;\n    resetCosts.mutate(undefined, {\n      onSuccess: () => toast.success('Cost tracking reset'),\n      onError: () => toast.error('Failed to reset'),\n    });\n  };\n\n  return (\n    <div className=\"p-6 space-y-4\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gm-text-primary\">LLM Costs</h1>\n          <p className=\"text-xs text-gm-text-tertiary mt-0.5\">\n            {periodInfo?.start && periodInfo?.end\n              ? `${periodInfo.start.split('T')[0]} → ${periodInfo.end.split('T')[0]}`\n              : periods.find(p => p.value === period)?.label}\n          </p>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          {/* Period selector */}\n          <div className=\"flex bg-gm-surface-secondary rounded-lg border border-gm-border-primary overflow-hidden\">\n            {periods.map(p => (\n              <button key={p.value} onClick={() => setPeriod(p.value)}\n                className={cn('px-3 py-1.5 text-xs font-medium transition-colors',\n                  period === p.value\n                    ? 'bg-gm-interactive-primary text-gm-text-on-brand'\n                    : 'text-gm-text-tertiary hover:text-gm-text-primary')}>\n                {p.short}\n              </button>\n            ))}\n          </div>\n          <button onClick={() => setShowBudget(true)} className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-xs text-gm-text-primary hover:bg-gm-surface-hover flex items-center gap-1.5 transition-colors\">\n            <Target className=\"w-3.5 h-3.5\" /> Budget\n          </button>\n          <button onClick={() => setShowPricing(true)} className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-xs text-gm-text-primary hover:bg-gm-surface-hover flex items-center gap-1.5 transition-colors\">\n            <Settings className=\"w-3.5 h-3.5\" /> Pricing\n          </button>\n          <div className=\"relative group\">\n            <button className=\"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover flex items-center gap-1.5 transition-colors\">\n              <Download className=\"w-3.5 h-3.5\" /> Export\n            </button>\n            <div className=\"absolute right-0 top-full mt-1 bg-gm-surface-primary border border-gm-border-primary rounded-lg shadow-lg z-10 hidden group-hover:block\">\n              <button onClick={() => handleExport('json')} className=\"block w-full px-4 py-2 text-xs text-gm-text-primary hover:bg-gm-surface-hover text-left\">JSON</button>\n              <button onClick={() => handleExport('csv')} className=\"block w-full px-4 py-2 text-xs text-gm-text-primary hover:bg-gm-surface-hover text-left\">CSV</button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {summary.error ? (\n        <ErrorState message=\"Failed to load cost data.\" onRetry={() => summary.refetch()} />\n      ) : summary.isLoading ? (\n        <div className=\"flex items-center justify-center h-64\"><Loader2 className=\"h-8 w-8 animate-spin text-gm-interactive-primary\" /></div>\n      ) : (\n        <>\n          {/* Budget Bar */}\n          {budgetLimit && budgetLimit > 0 && (\n            <div className={cn('rounded-xl p-4 border', budgetAlertTriggered ? 'bg-gm-status-danger-bg border-red-500/20' : 'bg-gm-surface-secondary border-gm-border-primary')}>\n              <div className=\"flex items-center justify-between mb-2\">\n                <span className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\">\n                  <Target className=\"w-3.5 h-3.5 text-gm-interactive-primary\" /> Budget\n                </span>\n                <span className=\"text-xs text-gm-text-tertiary\">\n                  ${totalCost.toFixed(2)} / ${budgetLimit.toFixed(2)} USD\n                </span>\n              </div>\n              <div className=\"w-full h-2.5 bg-gm-surface-secondary rounded-full overflow-hidden\">\n                <div className={cn('h-full rounded-full transition-all',\n                  (budgetUsedPercent ?? 0) > 90 ? 'bg-gm-status-danger' :\n                  (budgetUsedPercent ?? 0) > 70 ? 'bg-gm-status-warning' : 'bg-gm-interactive-primary')}\n                  style={{ width: `${Math.min(budgetUsedPercent ?? 0, 100)}%` }} />\n              </div>\n              <div className=\"flex items-center justify-between mt-1\">\n                <span className=\"text-[10px] text-gm-text-tertiary\">{(budgetUsedPercent ?? 0).toFixed(1)}% used</span>\n                {budgetAlertTriggered && (\n                  <span className=\"text-[10px] text-gm-status-danger flex items-center gap-1\">\n                    <AlertTriangle className=\"w-3 h-3\" /> Budget alert triggered\n                  </span>\n                )}\n              </div>\n            </div>\n          )}\n\n          {/* Stats Cards */}\n          <div className=\"grid grid-cols-5 gap-3\">\n            <StatCard icon={DollarSign} label=\"Total Cost\" value={`$${totalCost.toFixed(4)}`} color=\"text-green-500\" bgColor=\"bg-green-500/10\" />\n            <StatCard icon={Zap} label=\"Input Tokens\" value={formatTokens(totalInputTokens)} color=\"text-gm-interactive-primary\" bgColor=\"bg-blue-600/10\" />\n            <StatCard icon={Zap} label=\"Output Tokens\" value={formatTokens(totalOutputTokens)} color=\"text-purple-500\" bgColor=\"bg-purple-500/10\" />\n            <StatCard icon={BarChart3} label=\"Models Used\" value={String(Object.keys(byModel).length)} color=\"text-orange-500\" bgColor=\"bg-orange-500/10\" />\n            <StatCard icon={TrendingUp} label=\"vs Previous\"\n              value={percentChange != null ? `${percentChange > 0 ? '+' : ''}${percentChange.toFixed(1)}%` : 'N/A'}\n              color={percentChange != null ? (percentChange > 0 ? 'text-gm-status-danger' : percentChange < 0 ? 'text-gm-status-success' : 'text-gm-text-tertiary') : 'text-gm-text-tertiary'}\n              bgColor={percentChange != null && percentChange > 0 ? 'bg-red-500/10' : percentChange != null && percentChange < 0 ? 'bg-green-500/10' : 'bg-gm-surface-secondary'}\n              subIcon={percentChange != null ? (percentChange > 0 ? ArrowUpRight : percentChange < 0 ? ArrowDownRight : Minus) : undefined} />\n          </div>\n\n          {/* Daily Chart */}\n          {dailyBreakdown.length > 0 && (\n            <div className=\"bg-gm-surface-primary border border-gm-border-primary rounded-xl p-5\">\n              <h3 className=\"text-xs font-semibold text-gm-text-tertiary uppercase tracking-wider mb-4 flex items-center gap-1.5\">\n                <BarChart3 className=\"w-3.5 h-3.5\" /> Daily Cost Trend\n              </h3>\n              <div className=\"flex items-end gap-[2px] h-32\">\n                {dailyBreakdown.map((d, i) => {\n                  const height = Math.max((d.cost / maxDailyCost) * 100, 2);\n                  const dayLabel = d.date.split('-').slice(1).join('/');\n                  return (\n                    <div key={i} className=\"flex-1 flex flex-col items-center group relative\">\n                      <div className=\"absolute bottom-full mb-1 bg-gm-surface-primary border border-gm-border-primary rounded-lg shadow-lg p-2 text-[10px] hidden group-hover:block z-10 whitespace-nowrap\">\n                        <p className=\"font-semibold text-gm-text-primary\">{d.date}</p>\n                        <p className=\"text-green-500\">${d.cost.toFixed(4)}</p>\n                        <p className=\"text-gm-text-tertiary\">{d.calls} calls</p>\n                      </div>\n                      <div className={cn('w-full rounded-t transition-all hover:opacity-80',\n                        d.cost > (budgetLimit ? budgetLimit / (dailyBreakdown.length || 30) : Infinity) ? 'bg-gm-status-warning' : 'bg-gm-interactive-primary')}\n                        style={{ height: `${height}%`, minHeight: '2px' }} />\n                      {dailyBreakdown.length <= 14 && (\n                        <span className=\"text-[8px] text-gm-text-tertiary mt-1 -rotate-45 origin-top-left\">{dayLabel}</span>\n                      )}\n                    </div>\n                  );\n                })}\n              </div>\n            </div>\n          )}\n\n          {/* Breakdowns Grid */}\n          <div className=\"grid grid-cols-2 gap-3\">\n            <BreakdownCard title=\"By Provider\" icon={Layers} data={byProvider} expanded={expandedBreakdown === 'provider'} onToggle={() => setExpandedBreakdown(expandedBreakdown === 'provider' ? null : 'provider')} totalCost={totalCost} />\n            <BreakdownCard title=\"By Model\" icon={Cpu} data={byModel} expanded={expandedBreakdown === 'model'} onToggle={() => setExpandedBreakdown(expandedBreakdown === 'model' ? null : 'model')} totalCost={totalCost} />\n            <BreakdownCard title=\"By Operation\" icon={Zap} data={byOperation} expanded={expandedBreakdown === 'operation'} onToggle={() => setExpandedBreakdown(expandedBreakdown === 'operation' ? null : 'operation')} totalCost={totalCost} />\n            <BreakdownCard title=\"By Context\" icon={FileText} data={byContext} expanded={expandedBreakdown === 'context'} onToggle={() => setExpandedBreakdown(expandedBreakdown === 'context' ? null : 'context')} totalCost={totalCost} />\n          </div>\n\n          {/* Recent Requests */}\n          <div className=\"bg-gm-surface-primary border border-gm-border-primary rounded-xl\">\n            <button onClick={() => setShowRecent(!showRecent)} className=\"w-full flex items-center justify-between p-4 text-left\">\n              <h3 className=\"text-xs font-semibold text-gm-text-tertiary uppercase tracking-wider flex items-center gap-1.5\">\n                <Clock className=\"w-3.5 h-3.5\" /> Recent LLM Requests\n                {recentRequests.length > 0 && <span className=\"text-[10px] px-1.5 py-0.5 rounded-full bg-gm-surface-secondary\">{recentRequests.length}</span>}\n              </h3>\n              {showRecent ? <ChevronUp className=\"w-4 h-4 text-gm-text-tertiary\" /> : <ChevronDown className=\"w-4 h-4 text-gm-text-tertiary\" />}\n            </button>\n            {showRecent && (\n              <div className=\"px-4 pb-4 space-y-2\">\n                <div className=\"relative\">\n                  <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gm-text-tertiary\" />\n                  <input value={recentSearch} onChange={e => setRecentSearch(e.target.value)} placeholder=\"Search requests...\"\n                    className=\"w-full pl-9 pr-3 py-1.5 bg-gm-surface-secondary border border-gm-border-primary rounded-lg text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus\" />\n                </div>\n                {recent.isLoading ? (\n                  <Loader2 className=\"w-5 h-5 animate-spin text-gm-interactive-primary mx-auto my-4\" />\n                ) : recentRequests.length === 0 ? (\n                  <p className=\"text-xs text-gm-text-tertiary text-center py-4\">No recent requests.</p>\n                ) : (\n                  <div className=\"max-h-64 overflow-y-auto space-y-1\">\n                    {recentRequests.map((r, i) => (\n                      <div key={i} className=\"flex items-center gap-3 bg-[var(--gm-surface-hover)] rounded-lg p-2.5 group hover:bg-gm-surface-secondary transition-colors\">\n                        <Cpu className=\"w-3.5 h-3.5 text-gm-text-tertiary shrink-0\" />\n                        <div className=\"flex-1 min-w-0\">\n                          <div className=\"flex items-center gap-2\">\n                            <span className=\"text-xs font-medium text-gm-text-primary truncate\">{String(r.model || r.llm_model || '—')}</span>\n                            <span className=\"text-[10px] px-1.5 py-0.5 rounded bg-gm-surface-secondary text-gm-text-tertiary capitalize\">{String(r.operation || r.context || '—')}</span>\n                          </div>\n                          <div className=\"flex items-center gap-2 mt-0.5 text-[10px] text-gm-text-tertiary\">\n                            <span>{String(r.provider || r.llm_provider || '—')}</span>\n                            {r.input_tokens && <span>{Number(r.input_tokens).toLocaleString()} in</span>}\n                            {r.output_tokens && <span>{Number(r.output_tokens).toLocaleString()} out</span>}\n                            {r.latency_ms && <span>{Number(r.latency_ms)}ms</span>}\n                          </div>\n                        </div>\n                        <div className=\"text-right shrink-0\">\n                          <span className=\"text-xs font-mono font-medium text-green-500\">${Number(r.cost_usd || r.cost || 0).toFixed(4)}</span>\n                          {r.created_at && <p className=\"text-[10px] text-gm-text-tertiary\">{new Date(String(r.created_at)).toLocaleTimeString()}</p>}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            )}\n          </div>\n\n          {/* Footer actions */}\n          <div className=\"flex justify-end\">\n            <button onClick={handleReset} disabled={resetCosts.isPending}\n              className=\"px-3 py-1.5 rounded-lg text-xs text-gm-text-tertiary hover:text-gm-status-danger flex items-center gap-1.5 transition-colors\">\n              <RefreshCw className={cn('w-3.5 h-3.5', resetCosts.isPending && 'animate-spin')} /> Reset Tracking\n            </button>\n          </div>\n        </>\n      )}\n\n      {/* Budget Modal */}\n      <BudgetModal open={showBudget} onClose={() => setShowBudget(false)} currentBudget={budgetData} period={period === 'day' || period === 'all' ? 'month' : period} />\n\n      {/* Pricing Modal */}\n      <PricingModal open={showPricing} onClose={() => setShowPricing(false)} pricing={((pricing.data as Record<string, unknown>)?.pricing || []) as Array<Record<string, unknown>>} isLoading={pricing.isLoading} />\n    </div>\n  );\n}\n\nfunction StatCard({ icon: Icon, label, value, color, bgColor, subIcon: SubIcon }: {\n  icon: typeof DollarSign; label: string; value: string; color: string; bgColor: string; subIcon?: typeof ArrowUpRight;\n}) {\n  return (\n    <div className=\"bg-gm-surface-primary border border-gm-border-primary rounded-xl px-4 py-3\">\n      <div className=\"flex items-center gap-2\">\n        <div className={cn('w-8 h-8 rounded-lg flex items-center justify-center', bgColor)}>\n          <Icon className={cn('w-4 h-4', color)} />\n        </div>\n        <div>\n          <div className=\"flex items-center gap-1\">\n            <span className={cn('text-lg font-bold', color)}>{value}</span>\n            {SubIcon && <SubIcon className={cn('w-3.5 h-3.5', color)} />}\n          </div>\n          <p className=\"text-[10px] text-gm-text-tertiary uppercase tracking-wider\">{label}</p>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction BreakdownCard({ title, icon: Icon, data, expanded, onToggle, totalCost }: {\n  title: string; icon: typeof Layers; data: Record<string, number>; expanded: boolean; onToggle: () => void; totalCost: number;\n}) {\n  const entries = Object.entries(data).sort(([, a], [, b]) => b - a);\n  if (entries.length === 0) return null;\n\n  return (\n    <div className=\"bg-gm-surface-primary border border-gm-border-primary rounded-xl overflow-hidden\">\n      <button onClick={onToggle} className=\"w-full flex items-center justify-between p-4 text-left hover:bg-[var(--gm-surface-hover)] transition-colors\">\n        <h3 className=\"text-xs font-semibold text-gm-text-tertiary uppercase tracking-wider flex items-center gap-1.5\">\n          <Icon className=\"w-3.5 h-3.5\" /> {title}\n          <span className=\"text-[10px] px-1.5 py-0.5 rounded-full bg-gm-surface-secondary\">{entries.length}</span>\n        </h3>\n        {expanded ? <ChevronUp className=\"w-4 h-4 text-gm-text-tertiary\" /> : <ChevronDown className=\"w-4 h-4 text-gm-text-tertiary\" />}\n      </button>\n      {expanded && (\n        <div className=\"px-4 pb-4 space-y-2\">\n          {entries.map(([key, cost]) => {\n            const pct = totalCost > 0 ? (cost / totalCost) * 100 : 0;\n            return (\n              <div key={key}>\n                <div className=\"flex items-center justify-between text-xs mb-1\">\n                  <span className=\"text-gm-text-primary truncate mr-2\">{key}</span>\n                  <span className=\"font-mono text-green-500 shrink-0\">${cost.toFixed(4)}</span>\n                </div>\n                <div className=\"w-full h-1.5 bg-gm-surface-secondary rounded-full overflow-hidden\">\n                  <div className=\"h-full bg-gm-interactive-primary rounded-full transition-all\" style={{ width: `${Math.max(pct, 1)}%` }} />\n                </div>\n                <span className=\"text-[10px] text-gm-text-tertiary\">{pct.toFixed(1)}%</span>\n              </div>\n            );\n          })}\n        </div>\n      )}\n    </div>\n  );\n}\n\nfunction BudgetModal({ open, onClose, currentBudget, period }: {\n  open: boolean; onClose: () => void; currentBudget: Record<string, unknown> | null; period: string;\n}) {\n  const [limitUsd, setLimitUsd] = useState(String(currentBudget?.limit_usd || ''));\n  const [alertPercent, setAlertPercent] = useState(String(currentBudget?.alert_threshold_percent || '80'));\n  const setBudget = useSetBudget();\n\n  const handleSave = () => {\n    const limit = parseFloat(limitUsd);\n    if (!limit || limit <= 0) { toast.error('Enter a valid budget limit'); return; }\n    setBudget.mutate({ period, limit_usd: limit, alert_threshold_percent: parseInt(alertPercent) || 80 }, {\n      onSuccess: () => { toast.success('Budget updated'); onClose(); },\n      onError: () => toast.error('Failed to update budget'),\n    });\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={o => !o && onClose()}>\n      <DialogContent className=\"max-w-sm\">\n        <DialogTitle className=\"text-base font-semibold text-gm-text-primary\">Set Budget</DialogTitle>\n        <div className=\"space-y-4 mt-4\">\n          <div>\n            <label className=\"text-[10px] font-semibold text-gm-text-tertiary uppercase tracking-wider\">Period</label>\n            <p className=\"text-sm text-gm-text-primary capitalize mt-1\">{period}</p>\n          </div>\n          <div>\n            <label className=\"text-[10px] font-semibold text-gm-text-tertiary uppercase tracking-wider\">Budget Limit (USD)</label>\n            <input type=\"number\" step=\"0.01\" min=\"0\" value={limitUsd} onChange={e => setLimitUsd(e.target.value)} placeholder=\"e.g. 50.00\"\n              className=\"mt-1 w-full bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-2 text-sm text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus\" />\n          </div>\n          <div>\n            <label className=\"text-[10px] font-semibold text-gm-text-tertiary uppercase tracking-wider\">Alert Threshold (%)</label>\n            <input type=\"number\" min=\"0\" max=\"100\" value={alertPercent} onChange={e => setAlertPercent(e.target.value)} placeholder=\"80\"\n              className=\"mt-1 w-full bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-2 text-sm text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus\" />\n            <p className=\"text-[10px] text-gm-text-tertiary mt-1\">Alert triggers when spend exceeds this % of the limit</p>\n          </div>\n          {currentBudget && (\n            <div className=\"bg-gm-surface-secondary rounded-lg p-3\">\n              <p className=\"text-[10px] text-gm-text-tertiary\">Current budget: ${Number(currentBudget.limit_usd || 0).toFixed(2)} USD ({currentBudget.alert_threshold_percent || 80}% alert)</p>\n            </div>\n          )}\n          <div className=\"flex justify-end gap-2 pt-2\">\n            <button onClick={onClose} className=\"px-4 py-2 rounded-lg bg-gm-surface-secondary text-gm-text-primary text-sm hover:bg-gm-surface-hover border border-gm-border-primary transition-colors\">Cancel</button>\n            <button onClick={handleSave} disabled={setBudget.isPending}\n              className=\"px-4 py-2 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-sm font-medium hover:bg-gm-interactive-primary-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\n              {setBudget.isPending ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : <Target className=\"w-4 h-4\" />} Save Budget\n            </button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\nfunction PricingModal({ open, onClose, pricing, isLoading }: {\n  open: boolean; onClose: () => void; pricing: Array<Record<string, unknown>>; isLoading: boolean;\n}) {\n  const [search, setSearch] = useState('');\n  const filtered = pricing.filter(p => !search || String(p.model || '').toLowerCase().includes(search.toLowerCase()));\n\n  return (\n    <Dialog open={open} onOpenChange={o => !o && onClose()}>\n      <DialogContent className=\"max-w-xl p-0 overflow-hidden max-h-[80vh] flex flex-col\">\n        <DialogTitle className=\"text-base font-semibold text-gm-text-primary p-5 pb-0\">Model Pricing</DialogTitle>\n        <div className=\"px-5 pt-3 pb-2\">\n          <input value={search} onChange={e => setSearch(e.target.value)} placeholder=\"Search models...\"\n            className=\"w-full bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-1.5 text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus\" />\n        </div>\n        <div className=\"flex-1 overflow-y-auto px-5 pb-5\">\n          {isLoading ? (\n            <Loader2 className=\"w-6 h-6 animate-spin text-gm-interactive-primary mx-auto my-8\" />\n          ) : filtered.length === 0 ? (\n            <p className=\"text-xs text-gm-text-tertiary text-center py-8\">No pricing data available.</p>\n          ) : (\n            <table className=\"w-full text-xs\">\n              <thead>\n                <tr className=\"border-b border-gm-border-primary text-gm-text-tertiary\">\n                  <th className=\"py-2 text-left font-medium\">Model</th>\n                  <th className=\"py-2 text-right font-medium\">Input / 1M tokens</th>\n                  <th className=\"py-2 text-right font-medium\">Output / 1M tokens</th>\n                </tr>\n              </thead>\n              <tbody>\n                {filtered.map((p, i) => (\n                  <tr key={i} className=\"border-b border-[var(--gm-border-primary)] last:border-0 hover:bg-[var(--gm-surface-hover)] transition-colors\">\n                    <td className=\"py-2 font-medium text-gm-text-primary\">{String(p.model)}</td>\n                    <td className=\"py-2 text-right font-mono text-gm-text-secondary\">${Number(p.inputPer1M || 0).toFixed(2)}</td>\n                    <td className=\"py-2 text-right font-mono text-gm-text-secondary\">${Number(p.outputPer1M || 0).toFixed(2)}</td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          )}\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\nfunction formatTokens(n: number): string {\n  if (n >= 1_000_000) return `${(n / 1_000_000).toFixed(1)}M`;\n  if (n >= 1_000) return `${(n / 1_000).toFixed(1)}K`;\n  return String(n);\n}\n"],"names":["periods","CostsPage","period","setPeriod","useState","showBudget","setShowBudget","showPricing","setShowPricing","showRecent","setShowRecent","recentSearch","setRecentSearch","expandedBreakdown","setExpandedBreakdown","summary","useCostsSummary","recent","useRecentLLMRequests","useModelStats","pricing","usePricingTable","budget","useBudget","resetCosts","useResetCosts","data","totalCost","byProvider","byModel","byOperation","byContext","dailyBreakdown","totalInputTokens","totalOutputTokens","percentChange","budgetLimit","budgetUsedPercent","budgetAlertTriggered","periodInfo","budgetData","recentRequests","useMemo","list","q","r","maxDailyCost","d","handleExport","format","apiClient","content","mime","blob","link","toast","handleReset","jsxs","jsx","p","cn","Target","Settings","Download","ErrorState","Loader2","Fragment","AlertTriangle","StatCard","DollarSign","Zap","formatTokens","BarChart3","TrendingUp","ArrowUpRight","ArrowDownRight","Minus","i","height","dayLabel","BreakdownCard","Layers","Cpu","FileText","Clock","ChevronUp","ChevronDown","Search","e","RefreshCw","BudgetModal","PricingModal","Icon","label","value","color","bgColor","SubIcon","title","expanded","onToggle","entries","a","b","key","cost","pct","open","onClose","currentBudget","limitUsd","setLimitUsd","alertPercent","setAlertPercent","setBudget","useSetBudget","handleSave","limit","Dialog","o","DialogContent","DialogTitle","isLoading","search","setSearch","filtered","n"],"mappings":"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"}
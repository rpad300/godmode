import{c as _}from"./vendor-markdown-Cu8AM8lU.js";import{r as a,j as e}from"./vendor-react-CZ-WyKWZ.js";import{g as $,ad as A,aV as D,c as i,L as E,X as q}from"./main-B3DZn5B_.js";import{U as Q}from"./upload-C00nhlDV.js";import{L as Y}from"./link-2-CvGSt01y.js";const ee=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],te=_("camera",ee);const ae=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],ue=_("image",ae),re={md:{box:"w-16 h-16",text:"text-lg",icon:"w-4 h-4"},lg:{box:"w-24 h-24",text:"text-2xl",icon:"w-5 h-5"},xl:{box:"w-32 h-32",text:"text-3xl",icon:"w-6 h-6"}},P=["from-blue-500 to-indigo-600","from-emerald-500 to-teal-600","from-violet-500 to-purple-600","from-amber-500 to-orange-600","from-rose-500 to-pink-600"];function se(o){let r=0;for(let n=0;n<o.length;n++)r=o.charCodeAt(n)+((r<<5)-r);return P[Math.abs(r)%P.length]}const ne="image/jpeg,image/png,image/gif,image/webp",ie=5*1024*1024;function ge({currentUrl:o,name:r="",onUpload:n,uploadEndpoint:x,deleteEndpoint:u,onUrlChange:g,onRemove:f,onUploaded:y,onRemoved:F,size:M="lg",showUrlInput:O=!0,className:V}){const[p,b]=a.useState(!1),[w,j]=a.useState(!1),[G,d]=a.useState(!1),[N,k]=a.useState(!1),[h,I]=a.useState(""),[T,l]=a.useState(!1),[z,c]=a.useState(null),v=a.useRef(null),m=re[M],H=$(r),C=z||(A(o)?o:null),S=C&&!T,W=!!(f||u),X=O&&!!g,L=a.useCallback(async t=>{if(!t.type.startsWith("image/")||t.size>ie)return;const s=URL.createObjectURL(t);c(s),l(!1),b(!0);try{if(n)await n(t);else if(x){const R=new FormData;R.append("file",t);const K=await D.upload(x,R);y?.(K.avatar_url)}}catch{c(null)}finally{b(!1),URL.revokeObjectURL(s)}},[n,x,y]),Z=t=>{const s=t.target.files?.[0];s&&L(s),t.target.value=""},B=t=>{t.preventDefault(),d(!1);const s=t.dataTransfer.files[0];s&&L(s)},U=()=>{h.trim()&&g&&(g(h.trim()),k(!1),I(""),l(!1),c(null))},J=async()=>{j(!0);try{f?await f():u&&(await D.delete(u),F?.()),c(null),l(!1)}finally{j(!1)}};return e.jsxs("div",{className:i("flex flex-col items-center gap-3",V),children:[e.jsxs("div",{className:i(m.box,"relative rounded-full overflow-hidden cursor-pointer group transition-all",G&&"ring-2 ring-[var(--gm-accent-primary)] ring-offset-2 ring-offset-[var(--gm-bg-primary)]","hover:ring-2 hover:ring-[var(--gm-accent-primary)]/40"),onDragOver:t=>{t.preventDefault(),d(!0)},onDragLeave:()=>d(!1),onDrop:B,onClick:()=>v.current?.click(),children:[S?e.jsx("img",{src:C,alt:r,className:"w-full h-full object-cover",onError:()=>l(!0)}):e.jsx("div",{className:i("w-full h-full flex items-center justify-center bg-gradient-to-br",se(r)),children:e.jsx("span",{className:i(m.text,"font-bold text-white"),children:H})}),e.jsx("div",{className:i("absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",p&&"opacity-100"),children:p?e.jsx(E,{className:i(m.icon,"text-white animate-spin")}):e.jsx(te,{className:i(m.icon,"text-white")})})]}),e.jsx("input",{ref:v,type:"file",accept:ne,onChange:Z,className:"hidden"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("button",{type:"button",onClick:()=>v.current?.click(),disabled:p,className:"flex items-center gap-1 px-2 py-1 rounded text-[10px] font-medium text-[var(--gm-text-secondary)] hover:text-[var(--gm-accent-primary)] hover:bg-[var(--gm-surface-hover)] transition-colors disabled:opacity-50",children:[e.jsx(Q,{className:"w-3 h-3"})," Upload"]}),X&&e.jsxs("button",{type:"button",onClick:()=>k(!N),className:"flex items-center gap-1 px-2 py-1 rounded text-[10px] font-medium text-[var(--gm-text-secondary)] hover:text-[var(--gm-accent-primary)] hover:bg-[var(--gm-surface-hover)] transition-colors",children:[e.jsx(Y,{className:"w-3 h-3"})," URL"]}),(S||A(o))&&W&&e.jsxs("button",{type:"button",onClick:J,disabled:w,className:"flex items-center gap-1 px-2 py-1 rounded text-[10px] font-medium text-[var(--color-danger-500)] hover:bg-[var(--color-danger-500)]/10 transition-colors disabled:opacity-50",children:[w?e.jsx(E,{className:"w-3 h-3 animate-spin"}):e.jsx(q,{className:"w-3 h-3"}),"Remove"]})]}),N&&e.jsxs("div",{className:"flex items-center gap-1.5 w-full max-w-xs",children:[e.jsx("input",{type:"url",value:h,onChange:t=>I(t.target.value),placeholder:"https://...",onKeyDown:t=>t.key==="Enter"&&U(),className:"flex-1 h-7 px-2 text-[10px] rounded border border-[var(--gm-border-primary)] bg-[var(--gm-bg-secondary)] text-[var(--gm-text-primary)] focus:outline-none focus:ring-1 focus:ring-[var(--gm-accent-primary)]"}),e.jsx("button",{type:"button",onClick:U,className:"h-7 px-2 rounded text-[10px] font-medium bg-[var(--gm-accent-primary)] text-white hover:opacity-90 transition-opacity",children:"Set"})]}),e.jsx("p",{className:"text-[9px] text-[var(--gm-text-tertiary)] text-center",children:"JPG, PNG, GIF or WebP Â· Max 5 MB"})]})}export{ge as A,ue as I};
//# sourceMappingURL=AvatarUpload-gChxksHY.js.map

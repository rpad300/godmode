{"version":3,"file":"CommandPalette-DQLS9MsD.js","sources":["../../frontend/components/graph/CommandPalette.ts"],"sourcesContent":["/**\n * CommandPalette - Quick action launcher (Cmd+K)\n * \n * Features:\n * - Fuzzy search\n * - Keyboard navigation\n * - Action categories\n * - Recent actions\n */\n\nimport { createElement, on } from '../../utils/dom';\n\nexport interface CommandPaletteProps {\n  onClose?: () => void;\n  onAction?: (actionId: string, data?: unknown) => void;\n}\n\ninterface Command {\n  id: string;\n  label: string;\n  description?: string;\n  category: string;\n  icon: string;\n  shortcut?: string;\n  keywords?: string[];\n}\n\nconst COMMANDS: Command[] = [\n  // Navigation\n  { id: 'go-explorer', label: 'Go to Explorer', category: 'Navigation', icon: 'üîç', shortcut: '1' },\n  { id: 'go-ontology', label: 'Go to Ontology', category: 'Navigation', icon: 'üìö', shortcut: '2' },\n  { id: 'go-query', label: 'Go to Query Builder', category: 'Navigation', icon: 'üíª', shortcut: '3' },\n  { id: 'go-analytics', label: 'Go to Analytics', category: 'Navigation', icon: 'üìä', shortcut: '4' },\n  \n  // Graph Actions\n  { id: 'fit-view', label: 'Fit Graph to View', category: 'Graph', icon: '‚¨ú', keywords: ['zoom', 'fit', 'center'] },\n  { id: 'find-paths', label: 'Find Paths Between Nodes', category: 'Graph', icon: 'üîó', keywords: ['path', 'connection', 'route'] },\n  { id: 'detect-communities', label: 'Detect Communities', category: 'Graph', icon: 'üéØ', keywords: ['cluster', 'group'] },\n  { id: 'export-graph', label: 'Export Graph', category: 'Graph', icon: 'üì§', keywords: ['download', 'save', 'export'] },\n  { id: 'create-snapshot', label: 'Create Snapshot', category: 'Graph', icon: 'üì∏', keywords: ['save', 'backup', 'snapshot'] },\n  \n  // Filter Actions\n  { id: 'filter-people', label: 'Show Only People', category: 'Filter', icon: 'üë•', keywords: ['person', 'people', 'filter'] },\n  { id: 'filter-projects', label: 'Show Only Projects', category: 'Filter', icon: 'üìÅ', keywords: ['project', 'filter'] },\n  { id: 'filter-decisions', label: 'Show Only Decisions', category: 'Filter', icon: '‚úÖ', keywords: ['decision', 'filter'] },\n  { id: 'filter-risks', label: 'Show Only Risks', category: 'Filter', icon: '‚ö†Ô∏è', keywords: ['risk', 'filter'] },\n  { id: 'clear-filters', label: 'Clear All Filters', category: 'Filter', icon: 'üîÑ', keywords: ['reset', 'clear'] },\n  \n  // AI Actions\n  { id: 'ai-copilot', label: 'Open AI Copilot', category: 'AI', icon: 'ü§ñ', shortcut: 'C' },\n  { id: 'ai-insights', label: 'Generate AI Insights', category: 'AI', icon: 'üí°', keywords: ['insight', 'analysis'] },\n  { id: 'ai-summarize', label: 'Summarize Selection', category: 'AI', icon: 'üìù', keywords: ['summary', 'summarize'] },\n  { id: 'ai-explain', label: 'Explain Connection', category: 'AI', icon: '‚ùì', keywords: ['explain', 'why'] },\n  \n  // Query Actions\n  { id: 'new-query', label: 'New Cypher Query', category: 'Query', icon: '‚ûï', keywords: ['query', 'cypher', 'new'] },\n  { id: 'query-history', label: 'View Query History', category: 'Query', icon: 'üìú', keywords: ['history', 'past'] },\n  { id: 'query-templates', label: 'Browse Query Templates', category: 'Query', icon: 'üìã', keywords: ['template', 'pattern'] },\n  \n  // Settings\n  { id: 'toggle-theme', label: 'Toggle Dark/Light Mode', category: 'Settings', icon: 'üåô', keywords: ['theme', 'dark', 'light', 'mode'] },\n  { id: 'toggle-labels', label: 'Toggle Node Labels', category: 'Settings', icon: 'üè∑Ô∏è', keywords: ['label', 'text'] },\n  { id: 'toggle-physics', label: 'Toggle Physics Simulation', category: 'Settings', icon: '‚ö°', keywords: ['physics', 'animation'] },\n];\n\n/**\n * Create the command palette component\n */\nexport function createCommandPalette(props: CommandPaletteProps = {}): HTMLElement {\n  const container = createElement('div', { className: 'command-palette' });\n  \n  container.innerHTML = `\n    <div class=\"palette-search\">\n      <svg class=\"search-icon\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n        <circle cx=\"11\" cy=\"11\" r=\"8\"/>\n        <line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\"/>\n      </svg>\n      <input type=\"text\" id=\"palette-input\" class=\"palette-input\" placeholder=\"Type a command or search...\" autofocus>\n      <div class=\"palette-shortcut\">\n        <kbd>Esc</kbd> to close\n      </div>\n    </div>\n    \n    <div class=\"palette-results\" id=\"palette-results\">\n      <!-- Results will be rendered here -->\n    </div>\n    \n    <div class=\"palette-footer\">\n      <div class=\"footer-hint\">\n        <kbd>‚Üë‚Üì</kbd> to navigate\n        <kbd>Enter</kbd> to select\n      </div>\n    </div>\n  `;\n\n  // Initialize\n  initPalette(container, props);\n\n  return container;\n}\n\n/**\n * Initialize palette\n */\nfunction initPalette(container: HTMLElement, props: CommandPaletteProps): void {\n  const input = container.querySelector('#palette-input') as HTMLInputElement;\n  const results = container.querySelector('#palette-results') as HTMLElement;\n  \n  let selectedIndex = 0;\n  let filteredCommands = [...COMMANDS];\n\n  // Initial render\n  renderResults(results, filteredCommands, selectedIndex, props);\n\n  // Filter on input\n  on(input, 'input', () => {\n    const query = input.value.toLowerCase().trim();\n    \n    if (!query) {\n      filteredCommands = [...COMMANDS];\n    } else {\n      filteredCommands = COMMANDS.filter(cmd => {\n        const searchText = [\n          cmd.label,\n          cmd.description || '',\n          cmd.category,\n          ...(cmd.keywords || []),\n        ].join(' ').toLowerCase();\n        \n        return searchText.includes(query) || fuzzyMatch(query, cmd.label.toLowerCase());\n      });\n    }\n    \n    selectedIndex = 0;\n    renderResults(results, filteredCommands, selectedIndex, props);\n  });\n\n  // Keyboard navigation\n  on(input, 'keydown', (e: Event) => {\n    const event = e as KeyboardEvent;\n    \n    switch (event.key) {\n      case 'ArrowDown':\n        event.preventDefault();\n        selectedIndex = Math.min(selectedIndex + 1, filteredCommands.length - 1);\n        renderResults(results, filteredCommands, selectedIndex, props);\n        break;\n        \n      case 'ArrowUp':\n        event.preventDefault();\n        selectedIndex = Math.max(selectedIndex - 1, 0);\n        renderResults(results, filteredCommands, selectedIndex, props);\n        break;\n        \n      case 'Enter':\n        event.preventDefault();\n        if (filteredCommands[selectedIndex]) {\n          executeCommand(filteredCommands[selectedIndex], props);\n        }\n        break;\n        \n      case 'Escape':\n        event.preventDefault();\n        props.onClose?.();\n        break;\n    }\n  });\n\n  // Click outside to close\n  on(container, 'click', (e: Event) => {\n    if (e.target === container) {\n      props.onClose?.();\n    }\n  });\n}\n\n/**\n * Render results\n */\nfunction renderResults(\n  container: HTMLElement,\n  commands: Command[],\n  selectedIndex: number,\n  props: CommandPaletteProps\n): void {\n  if (commands.length === 0) {\n    container.innerHTML = `\n      <div class=\"palette-empty\">\n        <p>No commands found</p>\n      </div>\n    `;\n    return;\n  }\n\n  // Group by category\n  const byCategory: Record<string, Command[]> = {};\n  commands.forEach(cmd => {\n    if (!byCategory[cmd.category]) byCategory[cmd.category] = [];\n    byCategory[cmd.category].push(cmd);\n  });\n\n  let globalIndex = 0;\n  \n  container.innerHTML = Object.entries(byCategory).map(([category, cmds]) => `\n    <div class=\"palette-category\">\n      <div class=\"category-label\">${escapeHtml(category)}</div>\n      ${cmds.map(cmd => {\n        const index = globalIndex++;\n        const isSelected = index === selectedIndex;\n        return `\n          <div class=\"palette-item ${isSelected ? 'selected' : ''}\" data-id=\"${cmd.id}\" data-index=\"${index}\">\n            <span class=\"item-icon\">${cmd.icon}</span>\n            <span class=\"item-label\">${escapeHtml(cmd.label)}</span>\n            ${cmd.description ? `<span class=\"item-description\">${escapeHtml(cmd.description)}</span>` : ''}\n            ${cmd.shortcut ? `<kbd class=\"item-shortcut\">${cmd.shortcut}</kbd>` : ''}\n          </div>\n        `;\n      }).join('')}\n    </div>\n  `).join('');\n\n  // Bind click events\n  container.querySelectorAll('.palette-item').forEach(item => {\n    on(item as HTMLElement, 'click', () => {\n      const id = item.getAttribute('data-id');\n      const cmd = commands.find(c => c.id === id);\n      if (cmd) {\n        executeCommand(cmd, props);\n      }\n    });\n\n    // Hover to select\n    on(item as HTMLElement, 'mouseenter', () => {\n      container.querySelectorAll('.palette-item').forEach(i => i.classList.remove('selected'));\n      item.classList.add('selected');\n    });\n  });\n\n  // Scroll selected into view\n  const selectedEl = container.querySelector('.palette-item.selected');\n  if (selectedEl) {\n    selectedEl.scrollIntoView({ block: 'nearest' });\n  }\n}\n\n/**\n * Execute command\n */\nfunction executeCommand(command: Command, props: CommandPaletteProps): void {\n  props.onAction?.(command.id);\n  props.onClose?.();\n}\n\n/**\n * Fuzzy match\n */\nfunction fuzzyMatch(query: string, text: string): boolean {\n  let qi = 0;\n  for (let ti = 0; ti < text.length && qi < query.length; ti++) {\n    if (text[ti] === query[qi]) qi++;\n  }\n  return qi === query.length;\n}\n\n/**\n * Show command palette (helper)\n */\nexport function showCommandPalette(props: CommandPaletteProps = {}): void {\n  // Remove existing palette\n  const existing = document.querySelector('.command-palette-overlay');\n  if (existing) existing.remove();\n\n  // Create new palette\n  const overlay = createElement('div', { className: 'command-palette-overlay' });\n  const palette = createCommandPalette({\n    ...props,\n    onClose: () => {\n      overlay.remove();\n      props.onClose?.();\n    },\n  });\n  \n  overlay.appendChild(palette);\n  document.body.appendChild(overlay);\n\n  // Focus input\n  const input = overlay.querySelector('input');\n  if (input) input.focus();\n}\n\n/**\n * Escape HTML\n */\nfunction escapeHtml(text: string): string {\n  const div = document.createElement('div');\n  div.textContent = text;\n  return div.innerHTML;\n}\n\nexport default createCommandPalette;\n"],"names":["COMMANDS","createCommandPalette","props","container","createElement","initPalette","input","results","selectedIndex","filteredCommands","renderResults","on","query","cmd","fuzzyMatch","e","event","executeCommand","commands","byCategory","globalIndex","category","cmds","escapeHtml","index","item","id","c","i","selectedEl","command","text","qi","ti","div"],"mappings":"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"}
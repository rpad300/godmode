{"version":3,"file":"GraphOntology-DgitACNp.js","sources":["../../../node_modules/lucide-react/dist/esm/icons/flask-conical.js","../../../node_modules/lucide-react/dist/esm/icons/git-branch.js","../../../node_modules/lucide-react/dist/esm/icons/pause.js","../../../node_modules/lucide-react/dist/esm/icons/power-off.js","../../../node_modules/lucide-react/dist/esm/icons/power.js","../../../node_modules/events/events.js","../../../node_modules/graphology/dist/graphology.mjs","../../../node_modules/graphology-utils/is-graph.js","../../../node_modules/graphology-utils/defaults.js","../../../node_modules/mnemonist/utils/typed-arrays.js","../../../node_modules/graphology-utils/getters.js","../../../node_modules/graphology-indices/neighborhood.js","../../../node_modules/graphology-metrics/centrality/pagerank.js","../../frontend/src/lib/graph-transformer.ts","../../frontend/src/components/graph/GraphOntology.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.564.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2\",\n      key: \"18mbvz\"\n    }\n  ],\n  [\"path\", { d: \"M6.453 15h11.094\", key: \"3shlmq\" }],\n  [\"path\", { d: \"M8.5 2h7\", key: \"csnxdl\" }]\n];\nconst FlaskConical = createLucideIcon(\"flask-conical\", __iconNode);\n\nexport { __iconNode, FlaskConical as default };\n//# sourceMappingURL=flask-conical.js.map\n","/**\n * @license lucide-react v0.564.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M15 6a9 9 0 0 0-9 9V3\", key: \"1cii5b\" }],\n  [\"circle\", { cx: \"18\", cy: \"6\", r: \"3\", key: \"1h7g24\" }],\n  [\"circle\", { cx: \"6\", cy: \"18\", r: \"3\", key: \"fqmcym\" }]\n];\nconst GitBranch = createLucideIcon(\"git-branch\", __iconNode);\n\nexport { __iconNode, GitBranch as default };\n//# sourceMappingURL=git-branch.js.map\n","/**\n * @license lucide-react v0.564.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"rect\", { x: \"14\", y: \"3\", width: \"5\", height: \"18\", rx: \"1\", key: \"kaeet6\" }],\n  [\"rect\", { x: \"5\", y: \"3\", width: \"5\", height: \"18\", rx: \"1\", key: \"1wsw3u\" }]\n];\nconst Pause = createLucideIcon(\"pause\", __iconNode);\n\nexport { __iconNode, Pause as default };\n//# sourceMappingURL=pause.js.map\n","/**\n * @license lucide-react v0.564.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M18.36 6.64A9 9 0 0 1 20.77 15\", key: \"dxknvb\" }],\n  [\"path\", { d: \"M6.16 6.16a9 9 0 1 0 12.68 12.68\", key: \"1x7qb5\" }],\n  [\"path\", { d: \"M12 2v4\", key: \"3427ic\" }],\n  [\"path\", { d: \"m2 2 20 20\", key: \"1ooewy\" }]\n];\nconst PowerOff = createLucideIcon(\"power-off\", __iconNode);\n\nexport { __iconNode, PowerOff as default };\n//# sourceMappingURL=power-off.js.map\n","/**\n * @license lucide-react v0.564.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M12 2v10\", key: \"mnfbl\" }],\n  [\"path\", { d: \"M18.4 6.6a9 9 0 1 1-12.77.04\", key: \"obofu9\" }]\n];\nconst Power = createLucideIcon(\"power\", __iconNode);\n\nexport { __iconNode, Power as default };\n//# sourceMappingURL=power.js.map\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\nmodule.exports.once = once;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\nfunction once(emitter, name) {\n  return new Promise(function (resolve, reject) {\n    function errorListener(err) {\n      emitter.removeListener(name, resolver);\n      reject(err);\n    }\n\n    function resolver() {\n      if (typeof emitter.removeListener === 'function') {\n        emitter.removeListener('error', errorListener);\n      }\n      resolve([].slice.call(arguments));\n    };\n\n    eventTargetAgnosticAddListener(emitter, name, resolver, { once: true });\n    if (name !== 'error') {\n      addErrorHandlerIfEventEmitter(emitter, errorListener, { once: true });\n    }\n  });\n}\n\nfunction addErrorHandlerIfEventEmitter(emitter, handler, flags) {\n  if (typeof emitter.on === 'function') {\n    eventTargetAgnosticAddListener(emitter, 'error', handler, flags);\n  }\n}\n\nfunction eventTargetAgnosticAddListener(emitter, name, listener, flags) {\n  if (typeof emitter.on === 'function') {\n    if (flags.once) {\n      emitter.once(name, listener);\n    } else {\n      emitter.on(name, listener);\n    }\n  } else if (typeof emitter.addEventListener === 'function') {\n    // EventTarget does not have `error` event semantics like Node\n    // EventEmitters, we do not listen for `error` events here.\n    emitter.addEventListener(name, function wrapListener(arg) {\n      // IE does not have builtin `{ once: true }` support so we\n      // have to do it manually.\n      if (flags.once) {\n        emitter.removeEventListener(name, wrapListener);\n      }\n      listener(arg);\n    });\n  } else {\n    throw new TypeError('The \"emitter\" argument must be of type EventEmitter. Received type ' + typeof emitter);\n  }\n}\n","import { EventEmitter } from 'events';\n\n/**\n * Graphology Utilities\n * =====================\n *\n * Collection of helpful functions used by the implementation.\n */\n\n/**\n * Object.assign-like polyfill.\n *\n * @param  {object} target       - First object.\n * @param  {object} [...objects] - Objects to merge.\n * @return {object}\n */\nfunction assignPolyfill() {\n  const target = arguments[0];\n\n  for (let i = 1, l = arguments.length; i < l; i++) {\n    if (!arguments[i]) continue;\n\n    for (const k in arguments[i]) target[k] = arguments[i][k];\n  }\n\n  return target;\n}\n\nlet assign = assignPolyfill;\n\nif (typeof Object.assign === 'function') assign = Object.assign;\n\n/**\n * Function returning the first matching edge for given path.\n * Note: this function does not check the existence of source & target. This\n * must be performed by the caller.\n *\n * @param  {Graph}  graph  - Target graph.\n * @param  {any}    source - Source node.\n * @param  {any}    target - Target node.\n * @param  {string} type   - Type of the edge (mixed, directed or undirected).\n * @return {string|null}\n */\nfunction getMatchingEdge(graph, source, target, type) {\n  const sourceData = graph._nodes.get(source);\n\n  let edge = null;\n\n  if (!sourceData) return edge;\n\n  if (type === 'mixed') {\n    edge =\n      (sourceData.out && sourceData.out[target]) ||\n      (sourceData.undirected && sourceData.undirected[target]);\n  } else if (type === 'directed') {\n    edge = sourceData.out && sourceData.out[target];\n  } else {\n    edge = sourceData.undirected && sourceData.undirected[target];\n  }\n\n  return edge;\n}\n\n/**\n * Checks whether the given value is a plain object.\n *\n * @param  {mixed}   value - Target value.\n * @return {boolean}\n */\nfunction isPlainObject(value) {\n  // NOTE: as per https://github.com/graphology/graphology/issues/149\n  // this function has been loosened not to reject object instances\n  // coming from other JavaScript contexts. It has also been chosen\n  // not to improve it to avoid obvious false positives and avoid\n  // taking a performance hit. People should really use TypeScript\n  // if they want to avoid feeding subtly irrelvant attribute objects.\n  return typeof value === 'object' && value !== null;\n}\n\n/**\n * Checks whether the given object is empty.\n *\n * @param  {object}  o - Target Object.\n * @return {boolean}\n */\nfunction isEmpty(o) {\n  let k;\n\n  for (k in o) return false;\n\n  return true;\n}\n\n/**\n * Creates a \"private\" property for the given member name by concealing it\n * using the `enumerable` option.\n *\n * @param {object} target - Target object.\n * @param {string} name   - Member name.\n */\nfunction privateProperty(target, name, value) {\n  Object.defineProperty(target, name, {\n    enumerable: false,\n    configurable: false,\n    writable: true,\n    value\n  });\n}\n\n/**\n * Creates a read-only property for the given member name & the given getter.\n *\n * @param {object}   target - Target object.\n * @param {string}   name   - Member name.\n * @param {mixed}    value  - The attached getter or fixed value.\n */\nfunction readOnlyProperty(target, name, value) {\n  const descriptor = {\n    enumerable: true,\n    configurable: true\n  };\n\n  if (typeof value === 'function') {\n    descriptor.get = value;\n  } else {\n    descriptor.value = value;\n    descriptor.writable = false;\n  }\n\n  Object.defineProperty(target, name, descriptor);\n}\n\n/**\n * Returns whether the given object constitute valid hints.\n *\n * @param {object} hints - Target object.\n */\nfunction validateHints(hints) {\n  if (!isPlainObject(hints)) return false;\n\n  if (hints.attributes && !Array.isArray(hints.attributes)) return false;\n\n  return true;\n}\n\n/**\n * Creates a function generating incremental ids for edges.\n *\n * @return {function}\n */\nfunction incrementalIdStartingFromRandomByte() {\n  let i = Math.floor(Math.random() * 256) & 0xff;\n\n  return () => {\n    return i++;\n  };\n}\n\n/**\n * Chains multiple iterators into a single iterator.\n *\n * @param {...Iterator} iterables\n * @returns {Iterator}\n */\nfunction chain() {\n  const iterables = arguments;\n  let current = null;\n  let i = -1;\n\n  return {\n    [Symbol.iterator]() {\n      return this;\n    },\n    next() {\n      let step = null;\n\n      do {\n        if (current === null) {\n          i++;\n          if (i >= iterables.length) return {done: true};\n          current = iterables[i][Symbol.iterator]();\n        }\n        step = current.next();\n        if (step.done) {\n          current = null;\n          continue;\n        }\n        break;\n        // eslint-disable-next-line no-constant-condition\n      } while (true);\n\n      return step;\n    }\n  };\n}\n\nfunction emptyIterator() {\n  return {\n    [Symbol.iterator]() {\n      return this;\n    },\n    next() {\n      return {done: true};\n    }\n  };\n}\n\n/**\n * Graphology Custom Errors\n * =========================\n *\n * Defining custom errors for ease of use & easy unit tests across\n * implementations (normalized typology rather than relying on error\n * messages to check whether the correct error was found).\n */\nclass GraphError extends Error {\n  constructor(message) {\n    super();\n    this.name = 'GraphError';\n    this.message = message;\n  }\n}\n\nclass InvalidArgumentsGraphError extends GraphError {\n  constructor(message) {\n    super(message);\n    this.name = 'InvalidArgumentsGraphError';\n\n    // This is V8 specific to enhance stack readability\n    if (typeof Error.captureStackTrace === 'function')\n      Error.captureStackTrace(\n        this,\n        InvalidArgumentsGraphError.prototype.constructor\n      );\n  }\n}\n\nclass NotFoundGraphError extends GraphError {\n  constructor(message) {\n    super(message);\n    this.name = 'NotFoundGraphError';\n\n    // This is V8 specific to enhance stack readability\n    if (typeof Error.captureStackTrace === 'function')\n      Error.captureStackTrace(this, NotFoundGraphError.prototype.constructor);\n  }\n}\n\nclass UsageGraphError extends GraphError {\n  constructor(message) {\n    super(message);\n    this.name = 'UsageGraphError';\n\n    // This is V8 specific to enhance stack readability\n    if (typeof Error.captureStackTrace === 'function')\n      Error.captureStackTrace(this, UsageGraphError.prototype.constructor);\n  }\n}\n\n/**\n * Graphology Internal Data Classes\n * =================================\n *\n * Internal classes hopefully reduced to structs by engines & storing\n * necessary information for nodes & edges.\n *\n * Note that those classes don't rely on the `class` keyword to avoid some\n * cruft introduced by most of ES2015 transpilers.\n */\n\n/**\n * MixedNodeData class.\n *\n * @constructor\n * @param {string} string     - The node's key.\n * @param {object} attributes - Node's attributes.\n */\nfunction MixedNodeData(key, attributes) {\n  // Attributes\n  this.key = key;\n  this.attributes = attributes;\n\n  this.clear();\n}\n\nMixedNodeData.prototype.clear = function () {\n  // Degrees\n  this.inDegree = 0;\n  this.outDegree = 0;\n  this.undirectedDegree = 0;\n  this.undirectedLoops = 0;\n  this.directedLoops = 0;\n\n  // Indices\n  this.in = {};\n  this.out = {};\n  this.undirected = {};\n};\n\n/**\n * DirectedNodeData class.\n *\n * @constructor\n * @param {string} string     - The node's key.\n * @param {object} attributes - Node's attributes.\n */\nfunction DirectedNodeData(key, attributes) {\n  // Attributes\n  this.key = key;\n  this.attributes = attributes;\n\n  this.clear();\n}\n\nDirectedNodeData.prototype.clear = function () {\n  // Degrees\n  this.inDegree = 0;\n  this.outDegree = 0;\n  this.directedLoops = 0;\n\n  // Indices\n  this.in = {};\n  this.out = {};\n};\n\n/**\n * UndirectedNodeData class.\n *\n * @constructor\n * @param {string} string     - The node's key.\n * @param {object} attributes - Node's attributes.\n */\nfunction UndirectedNodeData(key, attributes) {\n  // Attributes\n  this.key = key;\n  this.attributes = attributes;\n\n  this.clear();\n}\n\nUndirectedNodeData.prototype.clear = function () {\n  // Degrees\n  this.undirectedDegree = 0;\n  this.undirectedLoops = 0;\n\n  // Indices\n  this.undirected = {};\n};\n\n/**\n * EdgeData class.\n *\n * @constructor\n * @param {boolean} undirected   - Whether the edge is undirected.\n * @param {string}  string       - The edge's key.\n * @param {string}  source       - Source of the edge.\n * @param {string}  target       - Target of the edge.\n * @param {object}  attributes   - Edge's attributes.\n */\nfunction EdgeData(undirected, key, source, target, attributes) {\n  // Attributes\n  this.key = key;\n  this.attributes = attributes;\n  this.undirected = undirected;\n\n  // Extremities\n  this.source = source;\n  this.target = target;\n}\n\nEdgeData.prototype.attach = function () {\n  let outKey = 'out';\n  let inKey = 'in';\n\n  if (this.undirected) outKey = inKey = 'undirected';\n\n  const source = this.source.key;\n  const target = this.target.key;\n\n  // Handling source\n  this.source[outKey][target] = this;\n\n  if (this.undirected && source === target) return;\n\n  // Handling target\n  this.target[inKey][source] = this;\n};\n\nEdgeData.prototype.attachMulti = function () {\n  let outKey = 'out';\n  let inKey = 'in';\n\n  const source = this.source.key;\n  const target = this.target.key;\n\n  if (this.undirected) outKey = inKey = 'undirected';\n\n  // Handling source\n  const adj = this.source[outKey];\n  const head = adj[target];\n\n  if (typeof head === 'undefined') {\n    adj[target] = this;\n\n    // Self-loop optimization\n    if (!(this.undirected && source === target)) {\n      // Handling target\n      this.target[inKey][source] = this;\n    }\n\n    return;\n  }\n\n  // Prepending to doubly-linked list\n  head.previous = this;\n  this.next = head;\n\n  // Pointing to new head\n  // NOTE: use mutating swap later to avoid lookup?\n  adj[target] = this;\n  this.target[inKey][source] = this;\n};\n\nEdgeData.prototype.detach = function () {\n  const source = this.source.key;\n  const target = this.target.key;\n\n  let outKey = 'out';\n  let inKey = 'in';\n\n  if (this.undirected) outKey = inKey = 'undirected';\n\n  delete this.source[outKey][target];\n\n  // No-op delete in case of undirected self-loop\n  delete this.target[inKey][source];\n};\n\nEdgeData.prototype.detachMulti = function () {\n  const source = this.source.key;\n  const target = this.target.key;\n\n  let outKey = 'out';\n  let inKey = 'in';\n\n  if (this.undirected) outKey = inKey = 'undirected';\n\n  // Deleting from doubly-linked list\n  if (this.previous === undefined) {\n    // We are dealing with the head\n\n    // Should we delete the adjacency entry because it is now empty?\n    if (this.next === undefined) {\n      delete this.source[outKey][target];\n\n      // No-op delete in case of undirected self-loop\n      delete this.target[inKey][source];\n    } else {\n      // Detaching\n      this.next.previous = undefined;\n\n      // NOTE: could avoid the lookups by creating a #.become mutating method\n      this.source[outKey][target] = this.next;\n\n      // No-op delete in case of undirected self-loop\n      this.target[inKey][source] = this.next;\n    }\n  } else {\n    // We are dealing with another list node\n    this.previous.next = this.next;\n\n    // If not last\n    if (this.next !== undefined) {\n      this.next.previous = this.previous;\n    }\n  }\n};\n\n/**\n * Graphology Node Attributes methods\n * ===================================\n */\n\nconst NODE = 0;\nconst SOURCE = 1;\nconst TARGET = 2;\nconst OPPOSITE = 3;\n\nfunction findRelevantNodeData(\n  graph,\n  method,\n  mode,\n  nodeOrEdge,\n  nameOrEdge,\n  add1,\n  add2\n) {\n  let nodeData, edgeData, arg1, arg2;\n\n  nodeOrEdge = '' + nodeOrEdge;\n\n  if (mode === NODE) {\n    nodeData = graph._nodes.get(nodeOrEdge);\n\n    if (!nodeData)\n      throw new NotFoundGraphError(\n        `Graph.${method}: could not find the \"${nodeOrEdge}\" node in the graph.`\n      );\n\n    arg1 = nameOrEdge;\n    arg2 = add1;\n  } else if (mode === OPPOSITE) {\n    nameOrEdge = '' + nameOrEdge;\n\n    edgeData = graph._edges.get(nameOrEdge);\n\n    if (!edgeData)\n      throw new NotFoundGraphError(\n        `Graph.${method}: could not find the \"${nameOrEdge}\" edge in the graph.`\n      );\n\n    const source = edgeData.source.key;\n    const target = edgeData.target.key;\n\n    if (nodeOrEdge === source) {\n      nodeData = edgeData.target;\n    } else if (nodeOrEdge === target) {\n      nodeData = edgeData.source;\n    } else {\n      throw new NotFoundGraphError(\n        `Graph.${method}: the \"${nodeOrEdge}\" node is not attached to the \"${nameOrEdge}\" edge (${source}, ${target}).`\n      );\n    }\n\n    arg1 = add1;\n    arg2 = add2;\n  } else {\n    edgeData = graph._edges.get(nodeOrEdge);\n\n    if (!edgeData)\n      throw new NotFoundGraphError(\n        `Graph.${method}: could not find the \"${nodeOrEdge}\" edge in the graph.`\n      );\n\n    if (mode === SOURCE) {\n      nodeData = edgeData.source;\n    } else {\n      nodeData = edgeData.target;\n    }\n\n    arg1 = nameOrEdge;\n    arg2 = add1;\n  }\n\n  return [nodeData, arg1, arg2];\n}\n\nfunction attachNodeAttributeGetter(Class, method, mode) {\n  Class.prototype[method] = function (nodeOrEdge, nameOrEdge, add1) {\n    const [data, name] = findRelevantNodeData(\n      this,\n      method,\n      mode,\n      nodeOrEdge,\n      nameOrEdge,\n      add1\n    );\n\n    return data.attributes[name];\n  };\n}\n\nfunction attachNodeAttributesGetter(Class, method, mode) {\n  Class.prototype[method] = function (nodeOrEdge, nameOrEdge) {\n    const [data] = findRelevantNodeData(\n      this,\n      method,\n      mode,\n      nodeOrEdge,\n      nameOrEdge\n    );\n\n    return data.attributes;\n  };\n}\n\nfunction attachNodeAttributeChecker(Class, method, mode) {\n  Class.prototype[method] = function (nodeOrEdge, nameOrEdge, add1) {\n    const [data, name] = findRelevantNodeData(\n      this,\n      method,\n      mode,\n      nodeOrEdge,\n      nameOrEdge,\n      add1\n    );\n\n    return data.attributes.hasOwnProperty(name);\n  };\n}\n\nfunction attachNodeAttributeSetter(Class, method, mode) {\n  Class.prototype[method] = function (nodeOrEdge, nameOrEdge, add1, add2) {\n    const [data, name, value] = findRelevantNodeData(\n      this,\n      method,\n      mode,\n      nodeOrEdge,\n      nameOrEdge,\n      add1,\n      add2\n    );\n\n    data.attributes[name] = value;\n\n    // Emitting\n    this.emit('nodeAttributesUpdated', {\n      key: data.key,\n      type: 'set',\n      attributes: data.attributes,\n      name\n    });\n\n    return this;\n  };\n}\n\nfunction attachNodeAttributeUpdater(Class, method, mode) {\n  Class.prototype[method] = function (nodeOrEdge, nameOrEdge, add1, add2) {\n    const [data, name, updater] = findRelevantNodeData(\n      this,\n      method,\n      mode,\n      nodeOrEdge,\n      nameOrEdge,\n      add1,\n      add2\n    );\n\n    if (typeof updater !== 'function')\n      throw new InvalidArgumentsGraphError(\n        `Graph.${method}: updater should be a function.`\n      );\n\n    const attributes = data.attributes;\n    const value = updater(attributes[name]);\n\n    attributes[name] = value;\n\n    // Emitting\n    this.emit('nodeAttributesUpdated', {\n      key: data.key,\n      type: 'set',\n      attributes: data.attributes,\n      name\n    });\n\n    return this;\n  };\n}\n\nfunction attachNodeAttributeRemover(Class, method, mode) {\n  Class.prototype[method] = function (nodeOrEdge, nameOrEdge, add1) {\n    const [data, name] = findRelevantNodeData(\n      this,\n      method,\n      mode,\n      nodeOrEdge,\n      nameOrEdge,\n      add1\n    );\n\n    delete data.attributes[name];\n\n    // Emitting\n    this.emit('nodeAttributesUpdated', {\n      key: data.key,\n      type: 'remove',\n      attributes: data.attributes,\n      name\n    });\n\n    return this;\n  };\n}\n\nfunction attachNodeAttributesReplacer(Class, method, mode) {\n  Class.prototype[method] = function (nodeOrEdge, nameOrEdge, add1) {\n    const [data, attributes] = findRelevantNodeData(\n      this,\n      method,\n      mode,\n      nodeOrEdge,\n      nameOrEdge,\n      add1\n    );\n\n    if (!isPlainObject(attributes))\n      throw new InvalidArgumentsGraphError(\n        `Graph.${method}: provided attributes are not a plain object.`\n      );\n\n    data.attributes = attributes;\n\n    // Emitting\n    this.emit('nodeAttributesUpdated', {\n      key: data.key,\n      type: 'replace',\n      attributes: data.attributes\n    });\n\n    return this;\n  };\n}\n\nfunction attachNodeAttributesMerger(Class, method, mode) {\n  Class.prototype[method] = function (nodeOrEdge, nameOrEdge, add1) {\n    const [data, attributes] = findRelevantNodeData(\n      this,\n      method,\n      mode,\n      nodeOrEdge,\n      nameOrEdge,\n      add1\n    );\n\n    if (!isPlainObject(attributes))\n      throw new InvalidArgumentsGraphError(\n        `Graph.${method}: provided attributes are not a plain object.`\n      );\n\n    assign(data.attributes, attributes);\n\n    // Emitting\n    this.emit('nodeAttributesUpdated', {\n      key: data.key,\n      type: 'merge',\n      attributes: data.attributes,\n      data: attributes\n    });\n\n    return this;\n  };\n}\n\nfunction attachNodeAttributesUpdater(Class, method, mode) {\n  Class.prototype[method] = function (nodeOrEdge, nameOrEdge, add1) {\n    const [data, updater] = findRelevantNodeData(\n      this,\n      method,\n      mode,\n      nodeOrEdge,\n      nameOrEdge,\n      add1\n    );\n\n    if (typeof updater !== 'function')\n      throw new InvalidArgumentsGraphError(\n        `Graph.${method}: provided updater is not a function.`\n      );\n\n    data.attributes = updater(data.attributes);\n\n    // Emitting\n    this.emit('nodeAttributesUpdated', {\n      key: data.key,\n      type: 'update',\n      attributes: data.attributes\n    });\n\n    return this;\n  };\n}\n\n/**\n * List of methods to attach.\n */\nconst NODE_ATTRIBUTES_METHODS = [\n  {\n    name: element => `get${element}Attribute`,\n    attacher: attachNodeAttributeGetter\n  },\n  {\n    name: element => `get${element}Attributes`,\n    attacher: attachNodeAttributesGetter\n  },\n  {\n    name: element => `has${element}Attribute`,\n    attacher: attachNodeAttributeChecker\n  },\n  {\n    name: element => `set${element}Attribute`,\n    attacher: attachNodeAttributeSetter\n  },\n  {\n    name: element => `update${element}Attribute`,\n    attacher: attachNodeAttributeUpdater\n  },\n  {\n    name: element => `remove${element}Attribute`,\n    attacher: attachNodeAttributeRemover\n  },\n  {\n    name: element => `replace${element}Attributes`,\n    attacher: attachNodeAttributesReplacer\n  },\n  {\n    name: element => `merge${element}Attributes`,\n    attacher: attachNodeAttributesMerger\n  },\n  {\n    name: element => `update${element}Attributes`,\n    attacher: attachNodeAttributesUpdater\n  }\n];\n\n/**\n * Attach every attributes-related methods to a Graph class.\n *\n * @param {function} Graph - Target class.\n */\nfunction attachNodeAttributesMethods(Graph) {\n  NODE_ATTRIBUTES_METHODS.forEach(function ({name, attacher}) {\n    // For nodes\n    attacher(Graph, name('Node'), NODE);\n\n    // For sources\n    attacher(Graph, name('Source'), SOURCE);\n\n    // For targets\n    attacher(Graph, name('Target'), TARGET);\n\n    // For opposites\n    attacher(Graph, name('Opposite'), OPPOSITE);\n  });\n}\n\n/**\n * Graphology Edge Attributes methods\n * ===================================\n */\n\n/**\n * Attach an attribute getter method onto the provided class.\n *\n * @param {function} Class         - Target class.\n * @param {string}   method        - Method name.\n * @param {string}   type          - Type of the edge to find.\n */\nfunction attachEdgeAttributeGetter(Class, method, type) {\n  /**\n   * Get the desired attribute for the given element (node or edge).\n   *\n   * Arity 2:\n   * @param  {any}    element - Target element.\n   * @param  {string} name    - Attribute's name.\n   *\n   * Arity 3 (only for edges):\n   * @param  {any}     source - Source element.\n   * @param  {any}     target - Target element.\n   * @param  {string}  name   - Attribute's name.\n   *\n   * @return {mixed}          - The attribute's value.\n   *\n   * @throws {Error} - Will throw if too many arguments are provided.\n   * @throws {Error} - Will throw if any of the elements is not found.\n   */\n  Class.prototype[method] = function (element, name) {\n    let data;\n\n    if (this.type !== 'mixed' && type !== 'mixed' && type !== this.type)\n      throw new UsageGraphError(\n        `Graph.${method}: cannot find this type of edges in your ${this.type} graph.`\n      );\n\n    if (arguments.length > 2) {\n      if (this.multi)\n        throw new UsageGraphError(\n          `Graph.${method}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`\n        );\n\n      const source = '' + element;\n      const target = '' + name;\n\n      name = arguments[2];\n\n      data = getMatchingEdge(this, source, target, type);\n\n      if (!data)\n        throw new NotFoundGraphError(\n          `Graph.${method}: could not find an edge for the given path (\"${source}\" - \"${target}\").`\n        );\n    } else {\n      if (type !== 'mixed')\n        throw new UsageGraphError(\n          `Graph.${method}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`\n        );\n\n      element = '' + element;\n      data = this._edges.get(element);\n\n      if (!data)\n        throw new NotFoundGraphError(\n          `Graph.${method}: could not find the \"${element}\" edge in the graph.`\n        );\n    }\n\n    return data.attributes[name];\n  };\n}\n\n/**\n * Attach an attributes getter method onto the provided class.\n *\n * @param {function} Class       - Target class.\n * @param {string}   method      - Method name.\n * @param {string}   type        - Type of the edge to find.\n */\nfunction attachEdgeAttributesGetter(Class, method, type) {\n  /**\n   * Retrieves all the target element's attributes.\n   *\n   * Arity 2:\n   * @param  {any}    element - Target element.\n   *\n   * Arity 3 (only for edges):\n   * @param  {any}     source - Source element.\n   * @param  {any}     target - Target element.\n   *\n   * @return {object}          - The element's attributes.\n   *\n   * @throws {Error} - Will throw if too many arguments are provided.\n   * @throws {Error} - Will throw if any of the elements is not found.\n   */\n  Class.prototype[method] = function (element) {\n    let data;\n\n    if (this.type !== 'mixed' && type !== 'mixed' && type !== this.type)\n      throw new UsageGraphError(\n        `Graph.${method}: cannot find this type of edges in your ${this.type} graph.`\n      );\n\n    if (arguments.length > 1) {\n      if (this.multi)\n        throw new UsageGraphError(\n          `Graph.${method}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`\n        );\n\n      const source = '' + element,\n        target = '' + arguments[1];\n\n      data = getMatchingEdge(this, source, target, type);\n\n      if (!data)\n        throw new NotFoundGraphError(\n          `Graph.${method}: could not find an edge for the given path (\"${source}\" - \"${target}\").`\n        );\n    } else {\n      if (type !== 'mixed')\n        throw new UsageGraphError(\n          `Graph.${method}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`\n        );\n\n      element = '' + element;\n      data = this._edges.get(element);\n\n      if (!data)\n        throw new NotFoundGraphError(\n          `Graph.${method}: could not find the \"${element}\" edge in the graph.`\n        );\n    }\n\n    return data.attributes;\n  };\n}\n\n/**\n * Attach an attribute checker method onto the provided class.\n *\n * @param {function} Class       - Target class.\n * @param {string}   method      - Method name.\n * @param {string}   type        - Type of the edge to find.\n */\nfunction attachEdgeAttributeChecker(Class, method, type) {\n  /**\n   * Checks whether the desired attribute is set for the given element (node or edge).\n   *\n   * Arity 2:\n   * @param  {any}    element - Target element.\n   * @param  {string} name    - Attribute's name.\n   *\n   * Arity 3 (only for edges):\n   * @param  {any}     source - Source element.\n   * @param  {any}     target - Target element.\n   * @param  {string}  name   - Attribute's name.\n   *\n   * @return {boolean}\n   *\n   * @throws {Error} - Will throw if too many arguments are provided.\n   * @throws {Error} - Will throw if any of the elements is not found.\n   */\n  Class.prototype[method] = function (element, name) {\n    let data;\n\n    if (this.type !== 'mixed' && type !== 'mixed' && type !== this.type)\n      throw new UsageGraphError(\n        `Graph.${method}: cannot find this type of edges in your ${this.type} graph.`\n      );\n\n    if (arguments.length > 2) {\n      if (this.multi)\n        throw new UsageGraphError(\n          `Graph.${method}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`\n        );\n\n      const source = '' + element;\n      const target = '' + name;\n\n      name = arguments[2];\n\n      data = getMatchingEdge(this, source, target, type);\n\n      if (!data)\n        throw new NotFoundGraphError(\n          `Graph.${method}: could not find an edge for the given path (\"${source}\" - \"${target}\").`\n        );\n    } else {\n      if (type !== 'mixed')\n        throw new UsageGraphError(\n          `Graph.${method}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`\n        );\n\n      element = '' + element;\n      data = this._edges.get(element);\n\n      if (!data)\n        throw new NotFoundGraphError(\n          `Graph.${method}: could not find the \"${element}\" edge in the graph.`\n        );\n    }\n\n    return data.attributes.hasOwnProperty(name);\n  };\n}\n\n/**\n * Attach an attribute setter method onto the provided class.\n *\n * @param {function} Class         - Target class.\n * @param {string}   method        - Method name.\n * @param {string}   type          - Type of the edge to find.\n */\nfunction attachEdgeAttributeSetter(Class, method, type) {\n  /**\n   * Set the desired attribute for the given element (node or edge).\n   *\n   * Arity 2:\n   * @param  {any}    element - Target element.\n   * @param  {string} name    - Attribute's name.\n   * @param  {mixed}  value   - New attribute value.\n   *\n   * Arity 3 (only for edges):\n   * @param  {any}     source - Source element.\n   * @param  {any}     target - Target element.\n   * @param  {string}  name   - Attribute's name.\n   * @param  {mixed}  value   - New attribute value.\n   *\n   * @return {Graph}          - Returns itself for chaining.\n   *\n   * @throws {Error} - Will throw if too many arguments are provided.\n   * @throws {Error} - Will throw if any of the elements is not found.\n   */\n  Class.prototype[method] = function (element, name, value) {\n    let data;\n\n    if (this.type !== 'mixed' && type !== 'mixed' && type !== this.type)\n      throw new UsageGraphError(\n        `Graph.${method}: cannot find this type of edges in your ${this.type} graph.`\n      );\n\n    if (arguments.length > 3) {\n      if (this.multi)\n        throw new UsageGraphError(\n          `Graph.${method}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`\n        );\n\n      const source = '' + element;\n      const target = '' + name;\n\n      name = arguments[2];\n      value = arguments[3];\n\n      data = getMatchingEdge(this, source, target, type);\n\n      if (!data)\n        throw new NotFoundGraphError(\n          `Graph.${method}: could not find an edge for the given path (\"${source}\" - \"${target}\").`\n        );\n    } else {\n      if (type !== 'mixed')\n        throw new UsageGraphError(\n          `Graph.${method}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`\n        );\n\n      element = '' + element;\n      data = this._edges.get(element);\n\n      if (!data)\n        throw new NotFoundGraphError(\n          `Graph.${method}: could not find the \"${element}\" edge in the graph.`\n        );\n    }\n\n    data.attributes[name] = value;\n\n    // Emitting\n    this.emit('edgeAttributesUpdated', {\n      key: data.key,\n      type: 'set',\n      attributes: data.attributes,\n      name\n    });\n\n    return this;\n  };\n}\n\n/**\n * Attach an attribute updater method onto the provided class.\n *\n * @param {function} Class         - Target class.\n * @param {string}   method        - Method name.\n * @param {string}   type          - Type of the edge to find.\n */\nfunction attachEdgeAttributeUpdater(Class, method, type) {\n  /**\n   * Update the desired attribute for the given element (node or edge) using\n   * the provided function.\n   *\n   * Arity 2:\n   * @param  {any}      element - Target element.\n   * @param  {string}   name    - Attribute's name.\n   * @param  {function} updater - Updater function.\n   *\n   * Arity 3 (only for edges):\n   * @param  {any}      source  - Source element.\n   * @param  {any}      target  - Target element.\n   * @param  {string}   name    - Attribute's name.\n   * @param  {function} updater - Updater function.\n   *\n   * @return {Graph}            - Returns itself for chaining.\n   *\n   * @throws {Error} - Will throw if too many arguments are provided.\n   * @throws {Error} - Will throw if any of the elements is not found.\n   */\n  Class.prototype[method] = function (element, name, updater) {\n    let data;\n\n    if (this.type !== 'mixed' && type !== 'mixed' && type !== this.type)\n      throw new UsageGraphError(\n        `Graph.${method}: cannot find this type of edges in your ${this.type} graph.`\n      );\n\n    if (arguments.length > 3) {\n      if (this.multi)\n        throw new UsageGraphError(\n          `Graph.${method}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`\n        );\n\n      const source = '' + element;\n      const target = '' + name;\n\n      name = arguments[2];\n      updater = arguments[3];\n\n      data = getMatchingEdge(this, source, target, type);\n\n      if (!data)\n        throw new NotFoundGraphError(\n          `Graph.${method}: could not find an edge for the given path (\"${source}\" - \"${target}\").`\n        );\n    } else {\n      if (type !== 'mixed')\n        throw new UsageGraphError(\n          `Graph.${method}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`\n        );\n\n      element = '' + element;\n      data = this._edges.get(element);\n\n      if (!data)\n        throw new NotFoundGraphError(\n          `Graph.${method}: could not find the \"${element}\" edge in the graph.`\n        );\n    }\n\n    if (typeof updater !== 'function')\n      throw new InvalidArgumentsGraphError(\n        `Graph.${method}: updater should be a function.`\n      );\n\n    data.attributes[name] = updater(data.attributes[name]);\n\n    // Emitting\n    this.emit('edgeAttributesUpdated', {\n      key: data.key,\n      type: 'set',\n      attributes: data.attributes,\n      name\n    });\n\n    return this;\n  };\n}\n\n/**\n * Attach an attribute remover method onto the provided class.\n *\n * @param {function} Class         - Target class.\n * @param {string}   method        - Method name.\n * @param {string}   type          - Type of the edge to find.\n */\nfunction attachEdgeAttributeRemover(Class, method, type) {\n  /**\n   * Remove the desired attribute for the given element (node or edge).\n   *\n   * Arity 2:\n   * @param  {any}    element - Target element.\n   * @param  {string} name    - Attribute's name.\n   *\n   * Arity 3 (only for edges):\n   * @param  {any}     source - Source element.\n   * @param  {any}     target - Target element.\n   * @param  {string}  name   - Attribute's name.\n   *\n   * @return {Graph}          - Returns itself for chaining.\n   *\n   * @throws {Error} - Will throw if too many arguments are provided.\n   * @throws {Error} - Will throw if any of the elements is not found.\n   */\n  Class.prototype[method] = function (element, name) {\n    let data;\n\n    if (this.type !== 'mixed' && type !== 'mixed' && type !== this.type)\n      throw new UsageGraphError(\n        `Graph.${method}: cannot find this type of edges in your ${this.type} graph.`\n      );\n\n    if (arguments.length > 2) {\n      if (this.multi)\n        throw new UsageGraphError(\n          `Graph.${method}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`\n        );\n\n      const source = '' + element;\n      const target = '' + name;\n\n      name = arguments[2];\n\n      data = getMatchingEdge(this, source, target, type);\n\n      if (!data)\n        throw new NotFoundGraphError(\n          `Graph.${method}: could not find an edge for the given path (\"${source}\" - \"${target}\").`\n        );\n    } else {\n      if (type !== 'mixed')\n        throw new UsageGraphError(\n          `Graph.${method}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`\n        );\n\n      element = '' + element;\n      data = this._edges.get(element);\n\n      if (!data)\n        throw new NotFoundGraphError(\n          `Graph.${method}: could not find the \"${element}\" edge in the graph.`\n        );\n    }\n\n    delete data.attributes[name];\n\n    // Emitting\n    this.emit('edgeAttributesUpdated', {\n      key: data.key,\n      type: 'remove',\n      attributes: data.attributes,\n      name\n    });\n\n    return this;\n  };\n}\n\n/**\n * Attach an attribute replacer method onto the provided class.\n *\n * @param {function} Class         - Target class.\n * @param {string}   method        - Method name.\n * @param {string}   type          - Type of the edge to find.\n */\nfunction attachEdgeAttributesReplacer(Class, method, type) {\n  /**\n   * Replace the attributes for the given element (node or edge).\n   *\n   * Arity 2:\n   * @param  {any}    element    - Target element.\n   * @param  {object} attributes - New attributes.\n   *\n   * Arity 3 (only for edges):\n   * @param  {any}     source     - Source element.\n   * @param  {any}     target     - Target element.\n   * @param  {object}  attributes - New attributes.\n   *\n   * @return {Graph}              - Returns itself for chaining.\n   *\n   * @throws {Error} - Will throw if too many arguments are provided.\n   * @throws {Error} - Will throw if any of the elements is not found.\n   */\n  Class.prototype[method] = function (element, attributes) {\n    let data;\n\n    if (this.type !== 'mixed' && type !== 'mixed' && type !== this.type)\n      throw new UsageGraphError(\n        `Graph.${method}: cannot find this type of edges in your ${this.type} graph.`\n      );\n\n    if (arguments.length > 2) {\n      if (this.multi)\n        throw new UsageGraphError(\n          `Graph.${method}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`\n        );\n\n      const source = '' + element,\n        target = '' + attributes;\n\n      attributes = arguments[2];\n\n      data = getMatchingEdge(this, source, target, type);\n\n      if (!data)\n        throw new NotFoundGraphError(\n          `Graph.${method}: could not find an edge for the given path (\"${source}\" - \"${target}\").`\n        );\n    } else {\n      if (type !== 'mixed')\n        throw new UsageGraphError(\n          `Graph.${method}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`\n        );\n\n      element = '' + element;\n      data = this._edges.get(element);\n\n      if (!data)\n        throw new NotFoundGraphError(\n          `Graph.${method}: could not find the \"${element}\" edge in the graph.`\n        );\n    }\n\n    if (!isPlainObject(attributes))\n      throw new InvalidArgumentsGraphError(\n        `Graph.${method}: provided attributes are not a plain object.`\n      );\n\n    data.attributes = attributes;\n\n    // Emitting\n    this.emit('edgeAttributesUpdated', {\n      key: data.key,\n      type: 'replace',\n      attributes: data.attributes\n    });\n\n    return this;\n  };\n}\n\n/**\n * Attach an attribute merger method onto the provided class.\n *\n * @param {function} Class         - Target class.\n * @param {string}   method        - Method name.\n * @param {string}   type          - Type of the edge to find.\n */\nfunction attachEdgeAttributesMerger(Class, method, type) {\n  /**\n   * Merge the attributes for the given element (node or edge).\n   *\n   * Arity 2:\n   * @param  {any}    element    - Target element.\n   * @param  {object} attributes - Attributes to merge.\n   *\n   * Arity 3 (only for edges):\n   * @param  {any}     source     - Source element.\n   * @param  {any}     target     - Target element.\n   * @param  {object}  attributes - Attributes to merge.\n   *\n   * @return {Graph}              - Returns itself for chaining.\n   *\n   * @throws {Error} - Will throw if too many arguments are provided.\n   * @throws {Error} - Will throw if any of the elements is not found.\n   */\n  Class.prototype[method] = function (element, attributes) {\n    let data;\n\n    if (this.type !== 'mixed' && type !== 'mixed' && type !== this.type)\n      throw new UsageGraphError(\n        `Graph.${method}: cannot find this type of edges in your ${this.type} graph.`\n      );\n\n    if (arguments.length > 2) {\n      if (this.multi)\n        throw new UsageGraphError(\n          `Graph.${method}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`\n        );\n\n      const source = '' + element,\n        target = '' + attributes;\n\n      attributes = arguments[2];\n\n      data = getMatchingEdge(this, source, target, type);\n\n      if (!data)\n        throw new NotFoundGraphError(\n          `Graph.${method}: could not find an edge for the given path (\"${source}\" - \"${target}\").`\n        );\n    } else {\n      if (type !== 'mixed')\n        throw new UsageGraphError(\n          `Graph.${method}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`\n        );\n\n      element = '' + element;\n      data = this._edges.get(element);\n\n      if (!data)\n        throw new NotFoundGraphError(\n          `Graph.${method}: could not find the \"${element}\" edge in the graph.`\n        );\n    }\n\n    if (!isPlainObject(attributes))\n      throw new InvalidArgumentsGraphError(\n        `Graph.${method}: provided attributes are not a plain object.`\n      );\n\n    assign(data.attributes, attributes);\n\n    // Emitting\n    this.emit('edgeAttributesUpdated', {\n      key: data.key,\n      type: 'merge',\n      attributes: data.attributes,\n      data: attributes\n    });\n\n    return this;\n  };\n}\n\n/**\n * Attach an attribute updater method onto the provided class.\n *\n * @param {function} Class         - Target class.\n * @param {string}   method        - Method name.\n * @param {string}   type          - Type of the edge to find.\n */\nfunction attachEdgeAttributesUpdater(Class, method, type) {\n  /**\n   * Update the attributes of the given element (node or edge).\n   *\n   * Arity 2:\n   * @param  {any}      element - Target element.\n   * @param  {function} updater - Updater function.\n   *\n   * Arity 3 (only for edges):\n   * @param  {any}      source  - Source element.\n   * @param  {any}      target  - Target element.\n   * @param  {function} updater - Updater function.\n   *\n   * @return {Graph}            - Returns itself for chaining.\n   *\n   * @throws {Error} - Will throw if too many arguments are provided.\n   * @throws {Error} - Will throw if any of the elements is not found.\n   */\n  Class.prototype[method] = function (element, updater) {\n    let data;\n\n    if (this.type !== 'mixed' && type !== 'mixed' && type !== this.type)\n      throw new UsageGraphError(\n        `Graph.${method}: cannot find this type of edges in your ${this.type} graph.`\n      );\n\n    if (arguments.length > 2) {\n      if (this.multi)\n        throw new UsageGraphError(\n          `Graph.${method}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`\n        );\n\n      const source = '' + element,\n        target = '' + updater;\n\n      updater = arguments[2];\n\n      data = getMatchingEdge(this, source, target, type);\n\n      if (!data)\n        throw new NotFoundGraphError(\n          `Graph.${method}: could not find an edge for the given path (\"${source}\" - \"${target}\").`\n        );\n    } else {\n      if (type !== 'mixed')\n        throw new UsageGraphError(\n          `Graph.${method}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`\n        );\n\n      element = '' + element;\n      data = this._edges.get(element);\n\n      if (!data)\n        throw new NotFoundGraphError(\n          `Graph.${method}: could not find the \"${element}\" edge in the graph.`\n        );\n    }\n\n    if (typeof updater !== 'function')\n      throw new InvalidArgumentsGraphError(\n        `Graph.${method}: provided updater is not a function.`\n      );\n\n    data.attributes = updater(data.attributes);\n\n    // Emitting\n    this.emit('edgeAttributesUpdated', {\n      key: data.key,\n      type: 'update',\n      attributes: data.attributes\n    });\n\n    return this;\n  };\n}\n\n/**\n * List of methods to attach.\n */\nconst EDGE_ATTRIBUTES_METHODS = [\n  {\n    name: element => `get${element}Attribute`,\n    attacher: attachEdgeAttributeGetter\n  },\n  {\n    name: element => `get${element}Attributes`,\n    attacher: attachEdgeAttributesGetter\n  },\n  {\n    name: element => `has${element}Attribute`,\n    attacher: attachEdgeAttributeChecker\n  },\n  {\n    name: element => `set${element}Attribute`,\n    attacher: attachEdgeAttributeSetter\n  },\n  {\n    name: element => `update${element}Attribute`,\n    attacher: attachEdgeAttributeUpdater\n  },\n  {\n    name: element => `remove${element}Attribute`,\n    attacher: attachEdgeAttributeRemover\n  },\n  {\n    name: element => `replace${element}Attributes`,\n    attacher: attachEdgeAttributesReplacer\n  },\n  {\n    name: element => `merge${element}Attributes`,\n    attacher: attachEdgeAttributesMerger\n  },\n  {\n    name: element => `update${element}Attributes`,\n    attacher: attachEdgeAttributesUpdater\n  }\n];\n\n/**\n * Attach every attributes-related methods to a Graph class.\n *\n * @param {function} Graph - Target class.\n */\nfunction attachEdgeAttributesMethods(Graph) {\n  EDGE_ATTRIBUTES_METHODS.forEach(function ({name, attacher}) {\n    // For edges\n    attacher(Graph, name('Edge'), 'mixed');\n\n    // For directed edges\n    attacher(Graph, name('DirectedEdge'), 'directed');\n\n    // For undirected edges\n    attacher(Graph, name('UndirectedEdge'), 'undirected');\n  });\n}\n\n/**\n * Graphology Edge Iteration\n * ==========================\n *\n * Attaching some methods to the Graph class to be able to iterate over a\n * graph's edges.\n */\n\n/**\n * Definitions.\n */\nconst EDGES_ITERATION = [\n  {\n    name: 'edges',\n    type: 'mixed'\n  },\n  {\n    name: 'inEdges',\n    type: 'directed',\n    direction: 'in'\n  },\n  {\n    name: 'outEdges',\n    type: 'directed',\n    direction: 'out'\n  },\n  {\n    name: 'inboundEdges',\n    type: 'mixed',\n    direction: 'in'\n  },\n  {\n    name: 'outboundEdges',\n    type: 'mixed',\n    direction: 'out'\n  },\n  {\n    name: 'directedEdges',\n    type: 'directed'\n  },\n  {\n    name: 'undirectedEdges',\n    type: 'undirected'\n  }\n];\n\n/**\n * Function iterating over edges from the given object to match one of them.\n *\n * @param {object}   object   - Target object.\n * @param {function} callback - Function to call.\n */\nfunction forEachSimple(breakable, object, callback, avoid) {\n  let shouldBreak = false;\n\n  for (const k in object) {\n    if (k === avoid) continue;\n\n    const edgeData = object[k];\n\n    shouldBreak = callback(\n      edgeData.key,\n      edgeData.attributes,\n      edgeData.source.key,\n      edgeData.target.key,\n      edgeData.source.attributes,\n      edgeData.target.attributes,\n      edgeData.undirected\n    );\n\n    if (breakable && shouldBreak) return edgeData.key;\n  }\n\n  return;\n}\n\nfunction forEachMulti(breakable, object, callback, avoid) {\n  let edgeData, source, target;\n\n  let shouldBreak = false;\n\n  for (const k in object) {\n    if (k === avoid) continue;\n\n    edgeData = object[k];\n\n    do {\n      source = edgeData.source;\n      target = edgeData.target;\n\n      shouldBreak = callback(\n        edgeData.key,\n        edgeData.attributes,\n        source.key,\n        target.key,\n        source.attributes,\n        target.attributes,\n        edgeData.undirected\n      );\n\n      if (breakable && shouldBreak) return edgeData.key;\n\n      edgeData = edgeData.next;\n    } while (edgeData !== undefined);\n  }\n\n  return;\n}\n\n/**\n * Function returning an iterator over edges from the given object.\n *\n * @param  {object}   object - Target object.\n * @return {Iterator}\n */\nfunction createIterator(object, avoid) {\n  const keys = Object.keys(object);\n  const l = keys.length;\n\n  let edgeData;\n  let i = 0;\n\n  return {\n    [Symbol.iterator]() {\n      return this;\n    },\n    next() {\n      do {\n        if (!edgeData) {\n          if (i >= l) return {done: true};\n\n          const k = keys[i++];\n\n          if (k === avoid) {\n            edgeData = undefined;\n            continue;\n          }\n\n          edgeData = object[k];\n        } else {\n          edgeData = edgeData.next;\n        }\n      } while (!edgeData);\n\n      return {\n        done: false,\n        value: {\n          edge: edgeData.key,\n          attributes: edgeData.attributes,\n          source: edgeData.source.key,\n          target: edgeData.target.key,\n          sourceAttributes: edgeData.source.attributes,\n          targetAttributes: edgeData.target.attributes,\n          undirected: edgeData.undirected\n        }\n      };\n    }\n  };\n}\n\n/**\n * Function iterating over the egdes from the object at given key to match\n * one of them.\n *\n * @param {object}   object   - Target object.\n * @param {mixed}    k        - Neighbor key.\n * @param {function} callback - Callback to use.\n */\nfunction forEachForKeySimple(breakable, object, k, callback) {\n  const edgeData = object[k];\n\n  if (!edgeData) return;\n\n  const sourceData = edgeData.source;\n  const targetData = edgeData.target;\n\n  if (\n    callback(\n      edgeData.key,\n      edgeData.attributes,\n      sourceData.key,\n      targetData.key,\n      sourceData.attributes,\n      targetData.attributes,\n      edgeData.undirected\n    ) &&\n    breakable\n  )\n    return edgeData.key;\n}\n\nfunction forEachForKeyMulti(breakable, object, k, callback) {\n  let edgeData = object[k];\n\n  if (!edgeData) return;\n\n  let shouldBreak = false;\n\n  do {\n    shouldBreak = callback(\n      edgeData.key,\n      edgeData.attributes,\n      edgeData.source.key,\n      edgeData.target.key,\n      edgeData.source.attributes,\n      edgeData.target.attributes,\n      edgeData.undirected\n    );\n\n    if (breakable && shouldBreak) return edgeData.key;\n\n    edgeData = edgeData.next;\n  } while (edgeData !== undefined);\n\n  return;\n}\n\n/**\n * Function returning an iterator over the egdes from the object at given key.\n *\n * @param  {object}   object   - Target object.\n * @param  {mixed}    k        - Neighbor key.\n * @return {Iterator}\n */\nfunction createIteratorForKey(object, k) {\n  let edgeData = object[k];\n\n  if (edgeData.next !== undefined) {\n    return {\n      [Symbol.iterator]() {\n        return this;\n      },\n      next() {\n        if (!edgeData) return {done: true};\n\n        const value = {\n          edge: edgeData.key,\n          attributes: edgeData.attributes,\n          source: edgeData.source.key,\n          target: edgeData.target.key,\n          sourceAttributes: edgeData.source.attributes,\n          targetAttributes: edgeData.target.attributes,\n          undirected: edgeData.undirected\n        };\n\n        edgeData = edgeData.next;\n\n        return {\n          done: false,\n          value\n        };\n      }\n    };\n  }\n\n  let done = false;\n  return {\n    [Symbol.iterator]() {\n      return this;\n    },\n    next() {\n      if (done === true) return {done: true};\n      done = true;\n      return {\n        done: false,\n        value: {\n          edge: edgeData.key,\n          attributes: edgeData.attributes,\n          source: edgeData.source.key,\n          target: edgeData.target.key,\n          sourceAttributes: edgeData.source.attributes,\n          targetAttributes: edgeData.target.attributes,\n          undirected: edgeData.undirected\n        }\n      };\n    }\n  };\n}\n\n/**\n * Function creating an array of edges for the given type.\n *\n * @param  {Graph}   graph - Target Graph instance.\n * @param  {string}  type  - Type of edges to retrieve.\n * @return {array}         - Array of edges.\n */\nfunction createEdgeArray(graph, type) {\n  if (graph.size === 0) return [];\n\n  if (type === 'mixed' || type === graph.type) {\n    return Array.from(graph._edges.keys());\n  }\n\n  const size =\n    type === 'undirected' ? graph.undirectedSize : graph.directedSize;\n\n  const list = new Array(size),\n    mask = type === 'undirected';\n\n  const iterator = graph._edges.values();\n\n  let i = 0;\n  let step, data;\n\n  while (((step = iterator.next()), step.done !== true)) {\n    data = step.value;\n\n    if (data.undirected === mask) list[i++] = data.key;\n  }\n\n  return list;\n}\n\n/**\n * Function iterating over a graph's edges using a callback to match one of\n * them.\n *\n * @param  {Graph}    graph    - Target Graph instance.\n * @param  {string}   type     - Type of edges to retrieve.\n * @param  {function} callback - Function to call.\n */\nfunction forEachEdge(breakable, graph, type, callback) {\n  if (graph.size === 0) return;\n\n  const shouldFilter = type !== 'mixed' && type !== graph.type;\n  const mask = type === 'undirected';\n\n  let step, data;\n  let shouldBreak = false;\n  const iterator = graph._edges.values();\n\n  while (((step = iterator.next()), step.done !== true)) {\n    data = step.value;\n\n    if (shouldFilter && data.undirected !== mask) continue;\n\n    const {key, attributes, source, target} = data;\n\n    shouldBreak = callback(\n      key,\n      attributes,\n      source.key,\n      target.key,\n      source.attributes,\n      target.attributes,\n      data.undirected\n    );\n\n    if (breakable && shouldBreak) return key;\n  }\n\n  return;\n}\n\n/**\n * Function creating an iterator of edges for the given type.\n *\n * @param  {Graph}    graph - Target Graph instance.\n * @param  {string}   type  - Type of edges to retrieve.\n * @return {Iterator}\n */\nfunction createEdgeIterator(graph, type) {\n  if (graph.size === 0) return emptyIterator();\n\n  const shouldFilter = type !== 'mixed' && type !== graph.type;\n  const mask = type === 'undirected';\n\n  const iterator = graph._edges.values();\n\n  return {\n    [Symbol.iterator]() {\n      return this;\n    },\n    next() {\n      let step, data;\n\n      // eslint-disable-next-line no-constant-condition\n      while (true) {\n        step = iterator.next();\n\n        if (step.done) return step;\n\n        data = step.value;\n\n        if (shouldFilter && data.undirected !== mask) continue;\n\n        break;\n      }\n\n      const value = {\n        edge: data.key,\n        attributes: data.attributes,\n        source: data.source.key,\n        target: data.target.key,\n        sourceAttributes: data.source.attributes,\n        targetAttributes: data.target.attributes,\n        undirected: data.undirected\n      };\n\n      return {value, done: false};\n    }\n  };\n}\n\n/**\n * Function iterating over a node's edges using a callback to match one of them.\n *\n * @param  {boolean}  multi     - Whether the graph is multi or not.\n * @param  {string}   type      - Type of edges to retrieve.\n * @param  {string}   direction - In or out?\n * @param  {any}      nodeData  - Target node's data.\n * @param  {function} callback  - Function to call.\n */\nfunction forEachEdgeForNode(\n  breakable,\n  multi,\n  type,\n  direction,\n  nodeData,\n  callback\n) {\n  const fn = multi ? forEachMulti : forEachSimple;\n\n  let found;\n\n  if (type !== 'undirected') {\n    if (direction !== 'out') {\n      found = fn(breakable, nodeData.in, callback);\n\n      if (breakable && found) return found;\n    }\n    if (direction !== 'in') {\n      found = fn(\n        breakable,\n        nodeData.out,\n        callback,\n        !direction ? nodeData.key : undefined\n      );\n\n      if (breakable && found) return found;\n    }\n  }\n\n  if (type !== 'directed') {\n    found = fn(breakable, nodeData.undirected, callback);\n\n    if (breakable && found) return found;\n  }\n\n  return;\n}\n\n/**\n * Function creating an array of edges for the given type & the given node.\n *\n * @param  {boolean} multi     - Whether the graph is multi or not.\n * @param  {string}  type      - Type of edges to retrieve.\n * @param  {string}  direction - In or out?\n * @param  {any}     nodeData  - Target node's data.\n * @return {array}             - Array of edges.\n */\nfunction createEdgeArrayForNode(multi, type, direction, nodeData) {\n  const edges = []; // TODO: possibility to know size beforehand or factorize with map\n\n  forEachEdgeForNode(false, multi, type, direction, nodeData, function (key) {\n    edges.push(key);\n  });\n\n  return edges;\n}\n\n/**\n * Function iterating over a node's edges using a callback.\n *\n * @param  {string}   type      - Type of edges to retrieve.\n * @param  {string}   direction - In or out?\n * @param  {any}      nodeData  - Target node's data.\n * @return {Iterator}\n */\nfunction createEdgeIteratorForNode(type, direction, nodeData) {\n  let iterator = emptyIterator();\n\n  if (type !== 'undirected') {\n    if (direction !== 'out' && typeof nodeData.in !== 'undefined')\n      iterator = chain(iterator, createIterator(nodeData.in));\n    if (direction !== 'in' && typeof nodeData.out !== 'undefined')\n      iterator = chain(\n        iterator,\n        createIterator(nodeData.out, !direction ? nodeData.key : undefined)\n      );\n  }\n\n  if (type !== 'directed' && typeof nodeData.undirected !== 'undefined') {\n    iterator = chain(iterator, createIterator(nodeData.undirected));\n  }\n\n  return iterator;\n}\n\n/**\n * Function iterating over edges for the given path using a callback to match\n * one of them.\n *\n * @param  {string}   type       - Type of edges to retrieve.\n * @param  {boolean}  multi      - Whether the graph is multi.\n * @param  {string}   direction  - In or out?\n * @param  {NodeData} sourceData - Source node's data.\n * @param  {string}   target     - Target node.\n * @param  {function} callback   - Function to call.\n */\nfunction forEachEdgeForPath(\n  breakable,\n  type,\n  multi,\n  direction,\n  sourceData,\n  target,\n  callback\n) {\n  const fn = multi ? forEachForKeyMulti : forEachForKeySimple;\n\n  let found;\n\n  if (type !== 'undirected') {\n    if (typeof sourceData.in !== 'undefined' && direction !== 'out') {\n      found = fn(breakable, sourceData.in, target, callback);\n\n      if (breakable && found) return found;\n    }\n\n    if (\n      typeof sourceData.out !== 'undefined' &&\n      direction !== 'in' &&\n      (direction || sourceData.key !== target)\n    ) {\n      found = fn(breakable, sourceData.out, target, callback);\n\n      if (breakable && found) return found;\n    }\n  }\n\n  if (type !== 'directed') {\n    if (typeof sourceData.undirected !== 'undefined') {\n      found = fn(breakable, sourceData.undirected, target, callback);\n\n      if (breakable && found) return found;\n    }\n  }\n\n  return;\n}\n\n/**\n * Function creating an array of edges for the given path.\n *\n * @param  {string}   type       - Type of edges to retrieve.\n * @param  {boolean}  multi      - Whether the graph is multi.\n * @param  {string}   direction  - In or out?\n * @param  {NodeData} sourceData - Source node's data.\n * @param  {any}      target     - Target node.\n * @return {array}               - Array of edges.\n */\nfunction createEdgeArrayForPath(type, multi, direction, sourceData, target) {\n  const edges = []; // TODO: possibility to know size beforehand or factorize with map\n\n  forEachEdgeForPath(\n    false,\n    type,\n    multi,\n    direction,\n    sourceData,\n    target,\n    function (key) {\n      edges.push(key);\n    }\n  );\n\n  return edges;\n}\n\n/**\n * Function returning an iterator over edges for the given path.\n *\n * @param  {string}   type       - Type of edges to retrieve.\n * @param  {string}   direction  - In or out?\n * @param  {NodeData} sourceData - Source node's data.\n * @param  {string}   target     - Target node.\n * @param  {function} callback   - Function to call.\n */\nfunction createEdgeIteratorForPath(type, direction, sourceData, target) {\n  let iterator = emptyIterator();\n\n  if (type !== 'undirected') {\n    if (\n      typeof sourceData.in !== 'undefined' &&\n      direction !== 'out' &&\n      target in sourceData.in\n    )\n      iterator = chain(iterator, createIteratorForKey(sourceData.in, target));\n\n    if (\n      typeof sourceData.out !== 'undefined' &&\n      direction !== 'in' &&\n      target in sourceData.out &&\n      (direction || sourceData.key !== target)\n    )\n      iterator = chain(iterator, createIteratorForKey(sourceData.out, target));\n  }\n\n  if (type !== 'directed') {\n    if (\n      typeof sourceData.undirected !== 'undefined' &&\n      target in sourceData.undirected\n    )\n      iterator = chain(\n        iterator,\n        createIteratorForKey(sourceData.undirected, target)\n      );\n  }\n\n  return iterator;\n}\n\n/**\n * Function attaching an edge array creator method to the Graph prototype.\n *\n * @param {function} Class       - Target class.\n * @param {object}   description - Method description.\n */\nfunction attachEdgeArrayCreator(Class, description) {\n  const {name, type, direction} = description;\n\n  /**\n   * Function returning an array of certain edges.\n   *\n   * Arity 0: Return all the relevant edges.\n   *\n   * Arity 1: Return all of a node's relevant edges.\n   * @param  {any}   node   - Target node.\n   *\n   * Arity 2: Return the relevant edges across the given path.\n   * @param  {any}   source - Source node.\n   * @param  {any}   target - Target node.\n   *\n   * @return {array|number} - The edges or the number of edges.\n   *\n   * @throws {Error} - Will throw if there are too many arguments.\n   */\n  Class.prototype[name] = function (source, target) {\n    // Early termination\n    if (type !== 'mixed' && this.type !== 'mixed' && type !== this.type)\n      return [];\n\n    if (!arguments.length) return createEdgeArray(this, type);\n\n    if (arguments.length === 1) {\n      source = '' + source;\n\n      const nodeData = this._nodes.get(source);\n\n      if (typeof nodeData === 'undefined')\n        throw new NotFoundGraphError(\n          `Graph.${name}: could not find the \"${source}\" node in the graph.`\n        );\n\n      // Iterating over a node's edges\n      return createEdgeArrayForNode(\n        this.multi,\n        type === 'mixed' ? this.type : type,\n        direction,\n        nodeData\n      );\n    }\n\n    if (arguments.length === 2) {\n      source = '' + source;\n      target = '' + target;\n\n      const sourceData = this._nodes.get(source);\n\n      if (!sourceData)\n        throw new NotFoundGraphError(\n          `Graph.${name}:  could not find the \"${source}\" source node in the graph.`\n        );\n\n      if (!this._nodes.has(target))\n        throw new NotFoundGraphError(\n          `Graph.${name}:  could not find the \"${target}\" target node in the graph.`\n        );\n\n      // Iterating over the edges between source & target\n      return createEdgeArrayForPath(\n        type,\n        this.multi,\n        direction,\n        sourceData,\n        target\n      );\n    }\n\n    throw new InvalidArgumentsGraphError(\n      `Graph.${name}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`\n    );\n  };\n}\n\n/**\n * Function attaching a edge callback iterator method to the Graph prototype.\n *\n * @param {function} Class       - Target class.\n * @param {object}   description - Method description.\n */\nfunction attachForEachEdge(Class, description) {\n  const {name, type, direction} = description;\n\n  const forEachName = 'forEach' + name[0].toUpperCase() + name.slice(1, -1);\n\n  /**\n   * Function iterating over the graph's relevant edges by applying the given\n   * callback.\n   *\n   * Arity 1: Iterate over all the relevant edges.\n   * @param  {function} callback - Callback to use.\n   *\n   * Arity 2: Iterate over all of a node's relevant edges.\n   * @param  {any}      node     - Target node.\n   * @param  {function} callback - Callback to use.\n   *\n   * Arity 3: Iterate over the relevant edges across the given path.\n   * @param  {any}      source   - Source node.\n   * @param  {any}      target   - Target node.\n   * @param  {function} callback - Callback to use.\n   *\n   * @return {undefined}\n   *\n   * @throws {Error} - Will throw if there are too many arguments.\n   */\n  Class.prototype[forEachName] = function (source, target, callback) {\n    // Early termination\n    if (type !== 'mixed' && this.type !== 'mixed' && type !== this.type) return;\n\n    if (arguments.length === 1) {\n      callback = source;\n      return forEachEdge(false, this, type, callback);\n    }\n\n    if (arguments.length === 2) {\n      source = '' + source;\n      callback = target;\n\n      const nodeData = this._nodes.get(source);\n\n      if (typeof nodeData === 'undefined')\n        throw new NotFoundGraphError(\n          `Graph.${forEachName}: could not find the \"${source}\" node in the graph.`\n        );\n\n      // Iterating over a node's edges\n      // TODO: maybe attach the sub method to the instance dynamically?\n      return forEachEdgeForNode(\n        false,\n        this.multi,\n        type === 'mixed' ? this.type : type,\n        direction,\n        nodeData,\n        callback\n      );\n    }\n\n    if (arguments.length === 3) {\n      source = '' + source;\n      target = '' + target;\n\n      const sourceData = this._nodes.get(source);\n\n      if (!sourceData)\n        throw new NotFoundGraphError(\n          `Graph.${forEachName}:  could not find the \"${source}\" source node in the graph.`\n        );\n\n      if (!this._nodes.has(target))\n        throw new NotFoundGraphError(\n          `Graph.${forEachName}:  could not find the \"${target}\" target node in the graph.`\n        );\n\n      // Iterating over the edges between source & target\n      return forEachEdgeForPath(\n        false,\n        type,\n        this.multi,\n        direction,\n        sourceData,\n        target,\n        callback\n      );\n    }\n\n    throw new InvalidArgumentsGraphError(\n      `Graph.${forEachName}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`\n    );\n  };\n\n  /**\n   * Function mapping the graph's relevant edges by applying the given\n   * callback.\n   *\n   * Arity 1: Map all the relevant edges.\n   * @param  {function} callback - Callback to use.\n   *\n   * Arity 2: Map all of a node's relevant edges.\n   * @param  {any}      node     - Target node.\n   * @param  {function} callback - Callback to use.\n   *\n   * Arity 3: Map the relevant edges across the given path.\n   * @param  {any}      source   - Source node.\n   * @param  {any}      target   - Target node.\n   * @param  {function} callback - Callback to use.\n   *\n   * @return {undefined}\n   *\n   * @throws {Error} - Will throw if there are too many arguments.\n   */\n  const mapName = 'map' + name[0].toUpperCase() + name.slice(1);\n\n  Class.prototype[mapName] = function () {\n    const args = Array.prototype.slice.call(arguments);\n    const callback = args.pop();\n\n    let result;\n\n    // We know the result length beforehand\n    if (args.length === 0) {\n      let length = 0;\n\n      if (type !== 'directed') length += this.undirectedSize;\n      if (type !== 'undirected') length += this.directedSize;\n\n      result = new Array(length);\n\n      let i = 0;\n\n      args.push((e, ea, s, t, sa, ta, u) => {\n        result[i++] = callback(e, ea, s, t, sa, ta, u);\n      });\n    }\n\n    // We don't know the result length beforehand\n    // TODO: we can in some instances of simple graphs, knowing degree\n    else {\n      result = [];\n\n      args.push((e, ea, s, t, sa, ta, u) => {\n        result.push(callback(e, ea, s, t, sa, ta, u));\n      });\n    }\n\n    this[forEachName].apply(this, args);\n\n    return result;\n  };\n\n  /**\n   * Function filtering the graph's relevant edges using the provided predicate\n   * function.\n   *\n   * Arity 1: Filter all the relevant edges.\n   * @param  {function} predicate - Predicate to use.\n   *\n   * Arity 2: Filter all of a node's relevant edges.\n   * @param  {any}      node      - Target node.\n   * @param  {function} predicate - Predicate to use.\n   *\n   * Arity 3: Filter the relevant edges across the given path.\n   * @param  {any}      source    - Source node.\n   * @param  {any}      target    - Target node.\n   * @param  {function} predicate - Predicate to use.\n   *\n   * @return {undefined}\n   *\n   * @throws {Error} - Will throw if there are too many arguments.\n   */\n  const filterName = 'filter' + name[0].toUpperCase() + name.slice(1);\n\n  Class.prototype[filterName] = function () {\n    const args = Array.prototype.slice.call(arguments);\n    const callback = args.pop();\n\n    const result = [];\n\n    args.push((e, ea, s, t, sa, ta, u) => {\n      if (callback(e, ea, s, t, sa, ta, u)) result.push(e);\n    });\n\n    this[forEachName].apply(this, args);\n\n    return result;\n  };\n\n  /**\n   * Function reducing the graph's relevant edges using the provided accumulator\n   * function.\n   *\n   * Arity 1: Reduce all the relevant edges.\n   * @param  {function} accumulator  - Accumulator to use.\n   * @param  {any}      initialValue - Initial value.\n   *\n   * Arity 2: Reduce all of a node's relevant edges.\n   * @param  {any}      node         - Target node.\n   * @param  {function} accumulator  - Accumulator to use.\n   * @param  {any}      initialValue - Initial value.\n   *\n   * Arity 3: Reduce the relevant edges across the given path.\n   * @param  {any}      source       - Source node.\n   * @param  {any}      target       - Target node.\n   * @param  {function} accumulator  - Accumulator to use.\n   * @param  {any}      initialValue - Initial value.\n   *\n   * @return {undefined}\n   *\n   * @throws {Error} - Will throw if there are too many arguments.\n   */\n  const reduceName = 'reduce' + name[0].toUpperCase() + name.slice(1);\n\n  Class.prototype[reduceName] = function () {\n    let args = Array.prototype.slice.call(arguments);\n\n    if (args.length < 2 || args.length > 4) {\n      throw new InvalidArgumentsGraphError(\n        `Graph.${reduceName}: invalid number of arguments (expecting 2, 3 or 4 and got ${args.length}).`\n      );\n    }\n\n    if (\n      typeof args[args.length - 1] === 'function' &&\n      typeof args[args.length - 2] !== 'function'\n    ) {\n      throw new InvalidArgumentsGraphError(\n        `Graph.${reduceName}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`\n      );\n    }\n\n    let callback;\n    let initialValue;\n\n    if (args.length === 2) {\n      callback = args[0];\n      initialValue = args[1];\n      args = [];\n    } else if (args.length === 3) {\n      callback = args[1];\n      initialValue = args[2];\n      args = [args[0]];\n    } else if (args.length === 4) {\n      callback = args[2];\n      initialValue = args[3];\n      args = [args[0], args[1]];\n    }\n\n    let accumulator = initialValue;\n\n    args.push((e, ea, s, t, sa, ta, u) => {\n      accumulator = callback(accumulator, e, ea, s, t, sa, ta, u);\n    });\n\n    this[forEachName].apply(this, args);\n\n    return accumulator;\n  };\n}\n\n/**\n * Function attaching a breakable edge callback iterator method to the Graph\n * prototype.\n *\n * @param {function} Class       - Target class.\n * @param {object}   description - Method description.\n */\nfunction attachFindEdge(Class, description) {\n  const {name, type, direction} = description;\n\n  const findEdgeName = 'find' + name[0].toUpperCase() + name.slice(1, -1);\n\n  /**\n   * Function iterating over the graph's relevant edges in order to match\n   * one of them using the provided predicate function.\n   *\n   * Arity 1: Iterate over all the relevant edges.\n   * @param  {function} callback - Callback to use.\n   *\n   * Arity 2: Iterate over all of a node's relevant edges.\n   * @param  {any}      node     - Target node.\n   * @param  {function} callback - Callback to use.\n   *\n   * Arity 3: Iterate over the relevant edges across the given path.\n   * @param  {any}      source   - Source node.\n   * @param  {any}      target   - Target node.\n   * @param  {function} callback - Callback to use.\n   *\n   * @return {undefined}\n   *\n   * @throws {Error} - Will throw if there are too many arguments.\n   */\n  Class.prototype[findEdgeName] = function (source, target, callback) {\n    // Early termination\n    if (type !== 'mixed' && this.type !== 'mixed' && type !== this.type)\n      return false;\n\n    if (arguments.length === 1) {\n      callback = source;\n      return forEachEdge(true, this, type, callback);\n    }\n\n    if (arguments.length === 2) {\n      source = '' + source;\n      callback = target;\n\n      const nodeData = this._nodes.get(source);\n\n      if (typeof nodeData === 'undefined')\n        throw new NotFoundGraphError(\n          `Graph.${findEdgeName}: could not find the \"${source}\" node in the graph.`\n        );\n\n      // Iterating over a node's edges\n      // TODO: maybe attach the sub method to the instance dynamically?\n      return forEachEdgeForNode(\n        true,\n        this.multi,\n        type === 'mixed' ? this.type : type,\n        direction,\n        nodeData,\n        callback\n      );\n    }\n\n    if (arguments.length === 3) {\n      source = '' + source;\n      target = '' + target;\n\n      const sourceData = this._nodes.get(source);\n\n      if (!sourceData)\n        throw new NotFoundGraphError(\n          `Graph.${findEdgeName}:  could not find the \"${source}\" source node in the graph.`\n        );\n\n      if (!this._nodes.has(target))\n        throw new NotFoundGraphError(\n          `Graph.${findEdgeName}:  could not find the \"${target}\" target node in the graph.`\n        );\n\n      // Iterating over the edges between source & target\n      return forEachEdgeForPath(\n        true,\n        type,\n        this.multi,\n        direction,\n        sourceData,\n        target,\n        callback\n      );\n    }\n\n    throw new InvalidArgumentsGraphError(\n      `Graph.${findEdgeName}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`\n    );\n  };\n\n  /**\n   * Function iterating over the graph's relevant edges in order to assert\n   * whether any one of them matches the provided predicate function.\n   *\n   * Arity 1: Iterate over all the relevant edges.\n   * @param  {function} callback - Callback to use.\n   *\n   * Arity 2: Iterate over all of a node's relevant edges.\n   * @param  {any}      node     - Target node.\n   * @param  {function} callback - Callback to use.\n   *\n   * Arity 3: Iterate over the relevant edges across the given path.\n   * @param  {any}      source   - Source node.\n   * @param  {any}      target   - Target node.\n   * @param  {function} callback - Callback to use.\n   *\n   * @return {undefined}\n   *\n   * @throws {Error} - Will throw if there are too many arguments.\n   */\n  const someName = 'some' + name[0].toUpperCase() + name.slice(1, -1);\n\n  Class.prototype[someName] = function () {\n    const args = Array.prototype.slice.call(arguments);\n    const callback = args.pop();\n\n    args.push((e, ea, s, t, sa, ta, u) => {\n      return callback(e, ea, s, t, sa, ta, u);\n    });\n\n    const found = this[findEdgeName].apply(this, args);\n\n    if (found) return true;\n\n    return false;\n  };\n\n  /**\n   * Function iterating over the graph's relevant edges in order to assert\n   * whether all of them matche the provided predicate function.\n   *\n   * Arity 1: Iterate over all the relevant edges.\n   * @param  {function} callback - Callback to use.\n   *\n   * Arity 2: Iterate over all of a node's relevant edges.\n   * @param  {any}      node     - Target node.\n   * @param  {function} callback - Callback to use.\n   *\n   * Arity 3: Iterate over the relevant edges across the given path.\n   * @param  {any}      source   - Source node.\n   * @param  {any}      target   - Target node.\n   * @param  {function} callback - Callback to use.\n   *\n   * @return {undefined}\n   *\n   * @throws {Error} - Will throw if there are too many arguments.\n   */\n  const everyName = 'every' + name[0].toUpperCase() + name.slice(1, -1);\n\n  Class.prototype[everyName] = function () {\n    const args = Array.prototype.slice.call(arguments);\n    const callback = args.pop();\n\n    args.push((e, ea, s, t, sa, ta, u) => {\n      return !callback(e, ea, s, t, sa, ta, u);\n    });\n\n    const found = this[findEdgeName].apply(this, args);\n\n    if (found) return false;\n\n    return true;\n  };\n}\n\n/**\n * Function attaching an edge iterator method to the Graph prototype.\n *\n * @param {function} Class       - Target class.\n * @param {object}   description - Method description.\n */\nfunction attachEdgeIteratorCreator(Class, description) {\n  const {name: originalName, type, direction} = description;\n\n  const name = originalName.slice(0, -1) + 'Entries';\n\n  /**\n   * Function returning an iterator over the graph's edges.\n   *\n   * Arity 0: Iterate over all the relevant edges.\n   *\n   * Arity 1: Iterate over all of a node's relevant edges.\n   * @param  {any}   node   - Target node.\n   *\n   * Arity 2: Iterate over the relevant edges across the given path.\n   * @param  {any}   source - Source node.\n   * @param  {any}   target - Target node.\n   *\n   * @return {array|number} - The edges or the number of edges.\n   *\n   * @throws {Error} - Will throw if there are too many arguments.\n   */\n  Class.prototype[name] = function (source, target) {\n    // Early termination\n    if (type !== 'mixed' && this.type !== 'mixed' && type !== this.type)\n      return emptyIterator();\n\n    if (!arguments.length) return createEdgeIterator(this, type);\n\n    if (arguments.length === 1) {\n      source = '' + source;\n\n      const sourceData = this._nodes.get(source);\n\n      if (!sourceData)\n        throw new NotFoundGraphError(\n          `Graph.${name}: could not find the \"${source}\" node in the graph.`\n        );\n\n      // Iterating over a node's edges\n      return createEdgeIteratorForNode(type, direction, sourceData);\n    }\n\n    if (arguments.length === 2) {\n      source = '' + source;\n      target = '' + target;\n\n      const sourceData = this._nodes.get(source);\n\n      if (!sourceData)\n        throw new NotFoundGraphError(\n          `Graph.${name}:  could not find the \"${source}\" source node in the graph.`\n        );\n\n      if (!this._nodes.has(target))\n        throw new NotFoundGraphError(\n          `Graph.${name}:  could not find the \"${target}\" target node in the graph.`\n        );\n\n      // Iterating over the edges between source & target\n      return createEdgeIteratorForPath(type, direction, sourceData, target);\n    }\n\n    throw new InvalidArgumentsGraphError(\n      `Graph.${name}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`\n    );\n  };\n}\n\n/**\n * Function attaching every edge iteration method to the Graph class.\n *\n * @param {function} Graph - Graph class.\n */\nfunction attachEdgeIterationMethods(Graph) {\n  EDGES_ITERATION.forEach(description => {\n    attachEdgeArrayCreator(Graph, description);\n    attachForEachEdge(Graph, description);\n    attachFindEdge(Graph, description);\n    attachEdgeIteratorCreator(Graph, description);\n  });\n}\n\n/**\n * Graphology Neighbor Iteration\n * ==============================\n *\n * Attaching some methods to the Graph class to be able to iterate over\n * neighbors.\n */\n\n/**\n * Definitions.\n */\nconst NEIGHBORS_ITERATION = [\n  {\n    name: 'neighbors',\n    type: 'mixed'\n  },\n  {\n    name: 'inNeighbors',\n    type: 'directed',\n    direction: 'in'\n  },\n  {\n    name: 'outNeighbors',\n    type: 'directed',\n    direction: 'out'\n  },\n  {\n    name: 'inboundNeighbors',\n    type: 'mixed',\n    direction: 'in'\n  },\n  {\n    name: 'outboundNeighbors',\n    type: 'mixed',\n    direction: 'out'\n  },\n  {\n    name: 'directedNeighbors',\n    type: 'directed'\n  },\n  {\n    name: 'undirectedNeighbors',\n    type: 'undirected'\n  }\n];\n\n/**\n * Helpers.\n */\nfunction CompositeSetWrapper() {\n  this.A = null;\n  this.B = null;\n}\n\nCompositeSetWrapper.prototype.wrap = function (set) {\n  if (this.A === null) this.A = set;\n  else if (this.B === null) this.B = set;\n};\n\nCompositeSetWrapper.prototype.has = function (key) {\n  if (this.A !== null && key in this.A) return true;\n  if (this.B !== null && key in this.B) return true;\n  return false;\n};\n\n/**\n * Function iterating over the given node's relevant neighbors to match\n * one of them using a predicated function.\n *\n * @param  {string}   type      - Type of neighbors.\n * @param  {string}   direction - Direction.\n * @param  {any}      nodeData  - Target node's data.\n * @param  {function} callback  - Callback to use.\n */\nfunction forEachInObjectOnce(breakable, visited, nodeData, object, callback) {\n  for (const k in object) {\n    const edgeData = object[k];\n\n    const sourceData = edgeData.source;\n    const targetData = edgeData.target;\n\n    const neighborData = sourceData === nodeData ? targetData : sourceData;\n\n    if (visited && visited.has(neighborData.key)) continue;\n\n    const shouldBreak = callback(neighborData.key, neighborData.attributes);\n\n    if (breakable && shouldBreak) return neighborData.key;\n  }\n\n  return;\n}\n\nfunction forEachNeighbor(breakable, type, direction, nodeData, callback) {\n  // If we want only undirected or in or out, we can roll some optimizations\n  if (type !== 'mixed') {\n    if (type === 'undirected')\n      return forEachInObjectOnce(\n        breakable,\n        null,\n        nodeData,\n        nodeData.undirected,\n        callback\n      );\n\n    if (typeof direction === 'string')\n      return forEachInObjectOnce(\n        breakable,\n        null,\n        nodeData,\n        nodeData[direction],\n        callback\n      );\n  }\n\n  // Else we need to keep a set of neighbors not to return duplicates\n  // We cheat by querying the other adjacencies\n  const visited = new CompositeSetWrapper();\n\n  let found;\n\n  if (type !== 'undirected') {\n    if (direction !== 'out') {\n      found = forEachInObjectOnce(\n        breakable,\n        null,\n        nodeData,\n        nodeData.in,\n        callback\n      );\n\n      if (breakable && found) return found;\n\n      visited.wrap(nodeData.in);\n    }\n    if (direction !== 'in') {\n      found = forEachInObjectOnce(\n        breakable,\n        visited,\n        nodeData,\n        nodeData.out,\n        callback\n      );\n\n      if (breakable && found) return found;\n\n      visited.wrap(nodeData.out);\n    }\n  }\n\n  if (type !== 'directed') {\n    found = forEachInObjectOnce(\n      breakable,\n      visited,\n      nodeData,\n      nodeData.undirected,\n      callback\n    );\n\n    if (breakable && found) return found;\n  }\n\n  return;\n}\n\n/**\n * Function creating an array of relevant neighbors for the given node.\n *\n * @param  {string}       type      - Type of neighbors.\n * @param  {string}       direction - Direction.\n * @param  {any}          nodeData  - Target node's data.\n * @return {Array}                  - The list of neighbors.\n */\nfunction createNeighborArrayForNode(type, direction, nodeData) {\n  // If we want only undirected or in or out, we can roll some optimizations\n  if (type !== 'mixed') {\n    if (type === 'undirected') return Object.keys(nodeData.undirected);\n\n    if (typeof direction === 'string') return Object.keys(nodeData[direction]);\n  }\n\n  const neighbors = [];\n\n  forEachNeighbor(false, type, direction, nodeData, function (key) {\n    neighbors.push(key);\n  });\n\n  return neighbors;\n}\n\n/**\n * Function returning an iterator over the given node's relevant neighbors.\n *\n * @param  {string}   type      - Type of neighbors.\n * @param  {string}   direction - Direction.\n * @param  {any}      nodeData  - Target node's data.\n * @return {Iterator}\n */\nfunction createDedupedObjectIterator(visited, nodeData, object) {\n  const keys = Object.keys(object);\n  const l = keys.length;\n\n  let i = 0;\n\n  return {\n    [Symbol.iterator]() {\n      return this;\n    },\n    next() {\n      let neighborData = null;\n\n      do {\n        if (i >= l) {\n          if (visited) visited.wrap(object);\n          return {done: true};\n        }\n\n        const edgeData = object[keys[i++]];\n\n        const sourceData = edgeData.source;\n        const targetData = edgeData.target;\n\n        neighborData = sourceData === nodeData ? targetData : sourceData;\n\n        if (visited && visited.has(neighborData.key)) {\n          neighborData = null;\n          continue;\n        }\n      } while (neighborData === null);\n\n      return {\n        done: false,\n        value: {neighbor: neighborData.key, attributes: neighborData.attributes}\n      };\n    }\n  };\n}\n\nfunction createNeighborIterator(type, direction, nodeData) {\n  // If we want only undirected or in or out, we can roll some optimizations\n  if (type !== 'mixed') {\n    if (type === 'undirected')\n      return createDedupedObjectIterator(null, nodeData, nodeData.undirected);\n\n    if (typeof direction === 'string')\n      return createDedupedObjectIterator(null, nodeData, nodeData[direction]);\n  }\n\n  let iterator = emptyIterator();\n\n  // Else we need to keep a set of neighbors not to return duplicates\n  // We cheat by querying the other adjacencies\n  const visited = new CompositeSetWrapper();\n\n  if (type !== 'undirected') {\n    if (direction !== 'out') {\n      iterator = chain(\n        iterator,\n        createDedupedObjectIterator(visited, nodeData, nodeData.in)\n      );\n    }\n    if (direction !== 'in') {\n      iterator = chain(\n        iterator,\n        createDedupedObjectIterator(visited, nodeData, nodeData.out)\n      );\n    }\n  }\n\n  if (type !== 'directed') {\n    iterator = chain(\n      iterator,\n      createDedupedObjectIterator(visited, nodeData, nodeData.undirected)\n    );\n  }\n\n  return iterator;\n}\n\n/**\n * Function attaching a neighbors array creator method to the Graph prototype.\n *\n * @param {function} Class       - Target class.\n * @param {object}   description - Method description.\n */\nfunction attachNeighborArrayCreator(Class, description) {\n  const {name, type, direction} = description;\n\n  /**\n   * Function returning an array of certain neighbors.\n   *\n   * @param  {any}   node   - Target node.\n   * @return {array} - The neighbors of neighbors.\n   *\n   * @throws {Error} - Will throw if node is not found in the graph.\n   */\n  Class.prototype[name] = function (node) {\n    // Early termination\n    if (type !== 'mixed' && this.type !== 'mixed' && type !== this.type)\n      return [];\n\n    node = '' + node;\n\n    const nodeData = this._nodes.get(node);\n\n    if (typeof nodeData === 'undefined')\n      throw new NotFoundGraphError(\n        `Graph.${name}: could not find the \"${node}\" node in the graph.`\n      );\n\n    // Here, we want to iterate over a node's relevant neighbors\n    return createNeighborArrayForNode(\n      type === 'mixed' ? this.type : type,\n      direction,\n      nodeData\n    );\n  };\n}\n\n/**\n * Function attaching a neighbors callback iterator method to the Graph prototype.\n *\n * @param {function} Class       - Target class.\n * @param {object}   description - Method description.\n */\nfunction attachForEachNeighbor(Class, description) {\n  const {name, type, direction} = description;\n\n  const forEachName = 'forEach' + name[0].toUpperCase() + name.slice(1, -1);\n\n  /**\n   * Function iterating over all the relevant neighbors using a callback.\n   *\n   * @param  {any}      node     - Target node.\n   * @param  {function} callback - Callback to use.\n   * @return {undefined}\n   *\n   * @throws {Error} - Will throw if there are too many arguments.\n   */\n  Class.prototype[forEachName] = function (node, callback) {\n    // Early termination\n    if (type !== 'mixed' && this.type !== 'mixed' && type !== this.type) return;\n\n    node = '' + node;\n\n    const nodeData = this._nodes.get(node);\n\n    if (typeof nodeData === 'undefined')\n      throw new NotFoundGraphError(\n        `Graph.${forEachName}: could not find the \"${node}\" node in the graph.`\n      );\n\n    // Here, we want to iterate over a node's relevant neighbors\n    forEachNeighbor(\n      false,\n      type === 'mixed' ? this.type : type,\n      direction,\n      nodeData,\n      callback\n    );\n  };\n\n  /**\n   * Function mapping the relevant neighbors using a callback.\n   *\n   * @param  {any}      node     - Target node.\n   * @param  {function} callback - Callback to use.\n   *\n   * @throws {Error} - Will throw if there are too many arguments.\n   */\n  const mapName = 'map' + name[0].toUpperCase() + name.slice(1);\n\n  Class.prototype[mapName] = function (node, callback) {\n    // TODO: optimize when size is known beforehand\n    const result = [];\n\n    this[forEachName](node, (n, a) => {\n      result.push(callback(n, a));\n    });\n\n    return result;\n  };\n\n  /**\n   * Function filtering the relevant neighbors using a callback.\n   *\n   * @param  {any}      node     - Target node.\n   * @param  {function} callback - Callback to use.\n   *\n   * @throws {Error} - Will throw if there are too many arguments.\n   */\n  const filterName = 'filter' + name[0].toUpperCase() + name.slice(1);\n\n  Class.prototype[filterName] = function (node, callback) {\n    const result = [];\n\n    this[forEachName](node, (n, a) => {\n      if (callback(n, a)) result.push(n);\n    });\n\n    return result;\n  };\n\n  /**\n   * Function reducing the relevant neighbors using a callback.\n   *\n   * @param  {any}      node     - Target node.\n   * @param  {function} callback - Callback to use.\n   *\n   * @throws {Error} - Will throw if there are too many arguments.\n   */\n  const reduceName = 'reduce' + name[0].toUpperCase() + name.slice(1);\n\n  Class.prototype[reduceName] = function (node, callback, initialValue) {\n    if (arguments.length < 3)\n      throw new InvalidArgumentsGraphError(\n        `Graph.${reduceName}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`\n      );\n\n    let accumulator = initialValue;\n\n    this[forEachName](node, (n, a) => {\n      accumulator = callback(accumulator, n, a);\n    });\n\n    return accumulator;\n  };\n}\n\n/**\n * Function attaching a breakable neighbors callback iterator method to the\n * Graph prototype.\n *\n * @param {function} Class       - Target class.\n * @param {object}   description - Method description.\n */\nfunction attachFindNeighbor(Class, description) {\n  const {name, type, direction} = description;\n\n  const capitalizedSingular = name[0].toUpperCase() + name.slice(1, -1);\n\n  const findName = 'find' + capitalizedSingular;\n\n  /**\n   * Function iterating over all the relevant neighbors using a callback.\n   *\n   * @param  {any}      node     - Target node.\n   * @param  {function} callback - Callback to use.\n   * @return {undefined}\n   *\n   * @throws {Error} - Will throw if there are too many arguments.\n   */\n  Class.prototype[findName] = function (node, callback) {\n    // Early termination\n    if (type !== 'mixed' && this.type !== 'mixed' && type !== this.type) return;\n\n    node = '' + node;\n\n    const nodeData = this._nodes.get(node);\n\n    if (typeof nodeData === 'undefined')\n      throw new NotFoundGraphError(\n        `Graph.${findName}: could not find the \"${node}\" node in the graph.`\n      );\n\n    // Here, we want to iterate over a node's relevant neighbors\n    return forEachNeighbor(\n      true,\n      type === 'mixed' ? this.type : type,\n      direction,\n      nodeData,\n      callback\n    );\n  };\n\n  /**\n   * Function iterating over all the relevant neighbors to find if any of them\n   * matches the given predicate.\n   *\n   * @param  {any}      node     - Target node.\n   * @param  {function} callback - Callback to use.\n   * @return {boolean}\n   *\n   * @throws {Error} - Will throw if there are too many arguments.\n   */\n  const someName = 'some' + capitalizedSingular;\n\n  Class.prototype[someName] = function (node, callback) {\n    const found = this[findName](node, callback);\n\n    if (found) return true;\n\n    return false;\n  };\n\n  /**\n   * Function iterating over all the relevant neighbors to find if all of them\n   * matche the given predicate.\n   *\n   * @param  {any}      node     - Target node.\n   * @param  {function} callback - Callback to use.\n   * @return {boolean}\n   *\n   * @throws {Error} - Will throw if there are too many arguments.\n   */\n  const everyName = 'every' + capitalizedSingular;\n\n  Class.prototype[everyName] = function (node, callback) {\n    const found = this[findName](node, (n, a) => {\n      return !callback(n, a);\n    });\n\n    if (found) return false;\n\n    return true;\n  };\n}\n\n/**\n * Function attaching a neighbors callback iterator method to the Graph prototype.\n *\n * @param {function} Class       - Target class.\n * @param {object}   description - Method description.\n */\nfunction attachNeighborIteratorCreator(Class, description) {\n  const {name, type, direction} = description;\n\n  const iteratorName = name.slice(0, -1) + 'Entries';\n\n  /**\n   * Function returning an iterator over all the relevant neighbors.\n   *\n   * @param  {any}      node     - Target node.\n   * @return {Iterator}\n   *\n   * @throws {Error} - Will throw if there are too many arguments.\n   */\n  Class.prototype[iteratorName] = function (node) {\n    // Early termination\n    if (type !== 'mixed' && this.type !== 'mixed' && type !== this.type)\n      return emptyIterator();\n\n    node = '' + node;\n\n    const nodeData = this._nodes.get(node);\n\n    if (typeof nodeData === 'undefined')\n      throw new NotFoundGraphError(\n        `Graph.${iteratorName}: could not find the \"${node}\" node in the graph.`\n      );\n\n    // Here, we want to iterate over a node's relevant neighbors\n    return createNeighborIterator(\n      type === 'mixed' ? this.type : type,\n      direction,\n      nodeData\n    );\n  };\n}\n\n/**\n * Function attaching every neighbor iteration method to the Graph class.\n *\n * @param {function} Graph - Graph class.\n */\nfunction attachNeighborIterationMethods(Graph) {\n  NEIGHBORS_ITERATION.forEach(description => {\n    attachNeighborArrayCreator(Graph, description);\n    attachForEachNeighbor(Graph, description);\n    attachFindNeighbor(Graph, description);\n    attachNeighborIteratorCreator(Graph, description);\n  });\n}\n\n/**\n * Graphology Adjacency Iteration\n * ===============================\n *\n * Attaching some methods to the Graph class to be able to iterate over a\n * graph's adjacency.\n */\n\n/**\n * Function iterating over a simple graph's adjacency using a callback.\n *\n * @param {boolean}  breakable         - Can we break?\n * @param {boolean}  assymetric        - Whether to emit undirected edges only once.\n * @param {boolean}  disconnectedNodes - Whether to emit disconnected nodes.\n * @param {Graph}    graph             - Target Graph instance.\n * @param {callback} function          - Iteration callback.\n */\nfunction forEachAdjacency(\n  breakable,\n  assymetric,\n  disconnectedNodes,\n  graph,\n  callback\n) {\n  const iterator = graph._nodes.values();\n\n  const type = graph.type;\n\n  let step, sourceData, neighbor, adj, edgeData, targetData, shouldBreak;\n\n  while (((step = iterator.next()), step.done !== true)) {\n    let hasEdges = false;\n\n    sourceData = step.value;\n\n    if (type !== 'undirected') {\n      adj = sourceData.out;\n\n      for (neighbor in adj) {\n        edgeData = adj[neighbor];\n\n        do {\n          targetData = edgeData.target;\n\n          hasEdges = true;\n          shouldBreak = callback(\n            sourceData.key,\n            targetData.key,\n            sourceData.attributes,\n            targetData.attributes,\n            edgeData.key,\n            edgeData.attributes,\n            edgeData.undirected\n          );\n\n          if (breakable && shouldBreak) return edgeData;\n\n          edgeData = edgeData.next;\n        } while (edgeData);\n      }\n    }\n\n    if (type !== 'directed') {\n      adj = sourceData.undirected;\n\n      for (neighbor in adj) {\n        if (assymetric && sourceData.key > neighbor) continue;\n\n        edgeData = adj[neighbor];\n\n        do {\n          targetData = edgeData.target;\n\n          if (targetData.key !== neighbor) targetData = edgeData.source;\n\n          hasEdges = true;\n          shouldBreak = callback(\n            sourceData.key,\n            targetData.key,\n            sourceData.attributes,\n            targetData.attributes,\n            edgeData.key,\n            edgeData.attributes,\n            edgeData.undirected\n          );\n\n          if (breakable && shouldBreak) return edgeData;\n\n          edgeData = edgeData.next;\n        } while (edgeData);\n      }\n    }\n\n    if (disconnectedNodes && !hasEdges) {\n      shouldBreak = callback(\n        sourceData.key,\n        null,\n        sourceData.attributes,\n        null,\n        null,\n        null,\n        null\n      );\n\n      if (breakable && shouldBreak) return null;\n    }\n  }\n\n  return;\n}\n\n/**\n * Graphology Serialization Utilities\n * ===================================\n *\n * Collection of functions used by the graph serialization schemes.\n */\n\n/**\n * Formats internal node data into a serialized node.\n *\n * @param  {any}    key  - The node's key.\n * @param  {object} data - Internal node's data.\n * @return {array}       - The serialized node.\n */\nfunction serializeNode(key, data) {\n  const serialized = {key};\n\n  if (!isEmpty(data.attributes))\n    serialized.attributes = assign({}, data.attributes);\n\n  return serialized;\n}\n\n/**\n * Formats internal edge data into a serialized edge.\n *\n * @param  {string} type - The graph's type.\n * @param  {any}    key  - The edge's key.\n * @param  {object} data - Internal edge's data.\n * @return {array}       - The serialized edge.\n */\nfunction serializeEdge(type, key, data) {\n  const serialized = {\n    key,\n    source: data.source.key,\n    target: data.target.key\n  };\n\n  if (!isEmpty(data.attributes))\n    serialized.attributes = assign({}, data.attributes);\n\n  if (type === 'mixed' && data.undirected) serialized.undirected = true;\n\n  return serialized;\n}\n\n/**\n * Checks whether the given value is a serialized node.\n *\n * @param  {mixed} value - Target value.\n * @return {string|null}\n */\nfunction validateSerializedNode(value) {\n  if (!isPlainObject(value))\n    throw new InvalidArgumentsGraphError(\n      'Graph.import: invalid serialized node. A serialized node should be a plain object with at least a \"key\" property.'\n    );\n\n  if (!('key' in value))\n    throw new InvalidArgumentsGraphError(\n      'Graph.import: serialized node is missing its key.'\n    );\n\n  if (\n    'attributes' in value &&\n    (!isPlainObject(value.attributes) || value.attributes === null)\n  )\n    throw new InvalidArgumentsGraphError(\n      'Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.'\n    );\n}\n\n/**\n * Checks whether the given value is a serialized edge.\n *\n * @param  {mixed} value - Target value.\n * @return {string|null}\n */\nfunction validateSerializedEdge(value) {\n  if (!isPlainObject(value))\n    throw new InvalidArgumentsGraphError(\n      'Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a \"source\" & \"target\" property.'\n    );\n\n  if (!('source' in value))\n    throw new InvalidArgumentsGraphError(\n      'Graph.import: serialized edge is missing its source.'\n    );\n\n  if (!('target' in value))\n    throw new InvalidArgumentsGraphError(\n      'Graph.import: serialized edge is missing its target.'\n    );\n\n  if (\n    'attributes' in value &&\n    (!isPlainObject(value.attributes) || value.attributes === null)\n  )\n    throw new InvalidArgumentsGraphError(\n      'Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.'\n    );\n\n  if ('undirected' in value && typeof value.undirected !== 'boolean')\n    throw new InvalidArgumentsGraphError(\n      'Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.'\n    );\n}\n\n/* eslint no-nested-ternary: 0 */\n\n/**\n * Constants.\n */\nconst INSTANCE_ID = incrementalIdStartingFromRandomByte();\n\n/**\n * Enums.\n */\nconst TYPES = new Set(['directed', 'undirected', 'mixed']);\n\nconst EMITTER_PROPS = new Set([\n  'domain',\n  '_events',\n  '_eventsCount',\n  '_maxListeners'\n]);\n\nconst EDGE_ADD_METHODS = [\n  {\n    name: verb => `${verb}Edge`,\n    generateKey: true\n  },\n  {\n    name: verb => `${verb}DirectedEdge`,\n    generateKey: true,\n    type: 'directed'\n  },\n  {\n    name: verb => `${verb}UndirectedEdge`,\n    generateKey: true,\n    type: 'undirected'\n  },\n  {\n    name: verb => `${verb}EdgeWithKey`\n  },\n  {\n    name: verb => `${verb}DirectedEdgeWithKey`,\n    type: 'directed'\n  },\n  {\n    name: verb => `${verb}UndirectedEdgeWithKey`,\n    type: 'undirected'\n  }\n];\n\n/**\n * Default options.\n */\nconst DEFAULTS = {\n  allowSelfLoops: true,\n  multi: false,\n  type: 'mixed'\n};\n\n/**\n * Abstract functions used by the Graph class for various methods.\n */\n\n/**\n * Internal method used to add a node to the given graph\n *\n * @param  {Graph}   graph           - Target graph.\n * @param  {any}     node            - The node's key.\n * @param  {object}  [attributes]    - Optional attributes.\n * @return {NodeData}                - Created node data.\n */\nfunction addNode(graph, node, attributes) {\n  if (attributes && !isPlainObject(attributes))\n    throw new InvalidArgumentsGraphError(\n      `Graph.addNode: invalid attributes. Expecting an object but got \"${attributes}\"`\n    );\n\n  // String coercion\n  node = '' + node;\n  attributes = attributes || {};\n\n  if (graph._nodes.has(node))\n    throw new UsageGraphError(\n      `Graph.addNode: the \"${node}\" node already exist in the graph.`\n    );\n\n  const data = new graph.NodeDataClass(node, attributes);\n\n  // Adding the node to internal register\n  graph._nodes.set(node, data);\n\n  // Emitting\n  graph.emit('nodeAdded', {\n    key: node,\n    attributes\n  });\n\n  return data;\n}\n\n/**\n * Same as the above but without sanity checks because we call this in contexts\n * where necessary checks were already done.\n */\nfunction unsafeAddNode(graph, node, attributes) {\n  const data = new graph.NodeDataClass(node, attributes);\n\n  graph._nodes.set(node, data);\n\n  graph.emit('nodeAdded', {\n    key: node,\n    attributes\n  });\n\n  return data;\n}\n\n/**\n * Internal method used to add an arbitrary edge to the given graph.\n *\n * @param  {Graph}   graph           - Target graph.\n * @param  {string}  name            - Name of the child method for errors.\n * @param  {boolean} mustGenerateKey - Should the graph generate an id?\n * @param  {boolean} undirected      - Whether the edge is undirected.\n * @param  {any}     edge            - The edge's key.\n * @param  {any}     source          - The source node.\n * @param  {any}     target          - The target node.\n * @param  {object}  [attributes]    - Optional attributes.\n * @return {any}                     - The edge.\n *\n * @throws {Error} - Will throw if the graph is of the wrong type.\n * @throws {Error} - Will throw if the given attributes are not an object.\n * @throws {Error} - Will throw if source or target doesn't exist.\n * @throws {Error} - Will throw if the edge already exist.\n */\nfunction addEdge(\n  graph,\n  name,\n  mustGenerateKey,\n  undirected,\n  edge,\n  source,\n  target,\n  attributes\n) {\n  // Checking validity of operation\n  if (!undirected && graph.type === 'undirected')\n    throw new UsageGraphError(\n      `Graph.${name}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`\n    );\n\n  if (undirected && graph.type === 'directed')\n    throw new UsageGraphError(\n      `Graph.${name}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`\n    );\n\n  if (attributes && !isPlainObject(attributes))\n    throw new InvalidArgumentsGraphError(\n      `Graph.${name}: invalid attributes. Expecting an object but got \"${attributes}\"`\n    );\n\n  // Coercion of source & target:\n  source = '' + source;\n  target = '' + target;\n  attributes = attributes || {};\n\n  if (!graph.allowSelfLoops && source === target)\n    throw new UsageGraphError(\n      `Graph.${name}: source & target are the same (\"${source}\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`\n    );\n\n  const sourceData = graph._nodes.get(source),\n    targetData = graph._nodes.get(target);\n\n  if (!sourceData)\n    throw new NotFoundGraphError(\n      `Graph.${name}: source node \"${source}\" not found.`\n    );\n\n  if (!targetData)\n    throw new NotFoundGraphError(\n      `Graph.${name}: target node \"${target}\" not found.`\n    );\n\n  // Must the graph generate an id for this edge?\n  const eventData = {\n    key: null,\n    undirected,\n    source,\n    target,\n    attributes\n  };\n\n  if (mustGenerateKey) {\n    // NOTE: in this case we can guarantee that the key does not already\n    // exist and is already correctly casted as a string\n    edge = graph._edgeKeyGenerator();\n  } else {\n    // Coercion of edge key\n    edge = '' + edge;\n\n    // Here, we have a key collision\n    if (graph._edges.has(edge))\n      throw new UsageGraphError(\n        `Graph.${name}: the \"${edge}\" edge already exists in the graph.`\n      );\n  }\n\n  // Here, we might have a source / target collision\n  if (\n    !graph.multi &&\n    (undirected\n      ? typeof sourceData.undirected[target] !== 'undefined'\n      : typeof sourceData.out[target] !== 'undefined')\n  ) {\n    throw new UsageGraphError(\n      `Graph.${name}: an edge linking \"${source}\" to \"${target}\" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`\n    );\n  }\n\n  // Storing some data\n  const edgeData = new EdgeData(\n    undirected,\n    edge,\n    sourceData,\n    targetData,\n    attributes\n  );\n\n  // Adding the edge to the internal register\n  graph._edges.set(edge, edgeData);\n\n  // Incrementing node degree counters\n  const isSelfLoop = source === target;\n\n  if (undirected) {\n    sourceData.undirectedDegree++;\n    targetData.undirectedDegree++;\n\n    if (isSelfLoop) {\n      sourceData.undirectedLoops++;\n      graph._undirectedSelfLoopCount++;\n    }\n  } else {\n    sourceData.outDegree++;\n    targetData.inDegree++;\n\n    if (isSelfLoop) {\n      sourceData.directedLoops++;\n      graph._directedSelfLoopCount++;\n    }\n  }\n\n  // Updating relevant index\n  if (graph.multi) edgeData.attachMulti();\n  else edgeData.attach();\n\n  if (undirected) graph._undirectedSize++;\n  else graph._directedSize++;\n\n  // Emitting\n  eventData.key = edge;\n\n  graph.emit('edgeAdded', eventData);\n\n  return edge;\n}\n\n/**\n * Internal method used to add an arbitrary edge to the given graph.\n *\n * @param  {Graph}   graph           - Target graph.\n * @param  {string}  name            - Name of the child method for errors.\n * @param  {boolean} mustGenerateKey - Should the graph generate an id?\n * @param  {boolean} undirected      - Whether the edge is undirected.\n * @param  {any}     edge            - The edge's key.\n * @param  {any}     source          - The source node.\n * @param  {any}     target          - The target node.\n * @param  {object}  [attributes]    - Optional attributes.\n * @param  {boolean} [asUpdater]       - Are we updating or merging?\n * @return {any}                     - The edge.\n *\n * @throws {Error} - Will throw if the graph is of the wrong type.\n * @throws {Error} - Will throw if the given attributes are not an object.\n * @throws {Error} - Will throw if source or target doesn't exist.\n * @throws {Error} - Will throw if the edge already exist.\n */\nfunction mergeEdge(\n  graph,\n  name,\n  mustGenerateKey,\n  undirected,\n  edge,\n  source,\n  target,\n  attributes,\n  asUpdater\n) {\n  // Checking validity of operation\n  if (!undirected && graph.type === 'undirected')\n    throw new UsageGraphError(\n      `Graph.${name}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`\n    );\n\n  if (undirected && graph.type === 'directed')\n    throw new UsageGraphError(\n      `Graph.${name}: you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`\n    );\n\n  if (attributes) {\n    if (asUpdater) {\n      if (typeof attributes !== 'function')\n        throw new InvalidArgumentsGraphError(\n          `Graph.${name}: invalid updater function. Expecting a function but got \"${attributes}\"`\n        );\n    } else {\n      if (!isPlainObject(attributes))\n        throw new InvalidArgumentsGraphError(\n          `Graph.${name}: invalid attributes. Expecting an object but got \"${attributes}\"`\n        );\n    }\n  }\n\n  // Coercion of source & target:\n  source = '' + source;\n  target = '' + target;\n\n  let updater;\n\n  if (asUpdater) {\n    updater = attributes;\n    attributes = undefined;\n  }\n\n  if (!graph.allowSelfLoops && source === target)\n    throw new UsageGraphError(\n      `Graph.${name}: source & target are the same (\"${source}\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`\n    );\n\n  let sourceData = graph._nodes.get(source);\n  let targetData = graph._nodes.get(target);\n  let edgeData;\n\n  // Do we need to handle duplicate?\n  let alreadyExistingEdgeData;\n\n  if (!mustGenerateKey) {\n    edgeData = graph._edges.get(edge);\n\n    if (edgeData) {\n      // Here, we need to ensure, if the user gave a key, that source & target\n      // are consistent\n      if (edgeData.source.key !== source || edgeData.target.key !== target) {\n        // If source or target inconsistent\n        if (\n          !undirected ||\n          edgeData.source.key !== target ||\n          edgeData.target.key !== source\n        ) {\n          // If directed, or source/target aren't flipped\n          throw new UsageGraphError(\n            `Graph.${name}: inconsistency detected when attempting to merge the \"${edge}\" edge with \"${source}\" source & \"${target}\" target vs. (\"${edgeData.source.key}\", \"${edgeData.target.key}\").`\n          );\n        }\n      }\n\n      alreadyExistingEdgeData = edgeData;\n    }\n  }\n\n  // Here, we might have a source / target collision\n  if (!alreadyExistingEdgeData && !graph.multi && sourceData) {\n    alreadyExistingEdgeData = undirected\n      ? sourceData.undirected[target]\n      : sourceData.out[target];\n  }\n\n  // Handling duplicates\n  if (alreadyExistingEdgeData) {\n    const info = [alreadyExistingEdgeData.key, false, false, false];\n\n    // We can skip the attribute merging part if the user did not provide them\n    if (asUpdater ? !updater : !attributes) return info;\n\n    // Updating the attributes\n    if (asUpdater) {\n      const oldAttributes = alreadyExistingEdgeData.attributes;\n      alreadyExistingEdgeData.attributes = updater(oldAttributes);\n\n      graph.emit('edgeAttributesUpdated', {\n        type: 'replace',\n        key: alreadyExistingEdgeData.key,\n        attributes: alreadyExistingEdgeData.attributes\n      });\n    }\n\n    // Merging the attributes\n    else {\n      assign(alreadyExistingEdgeData.attributes, attributes);\n\n      graph.emit('edgeAttributesUpdated', {\n        type: 'merge',\n        key: alreadyExistingEdgeData.key,\n        attributes: alreadyExistingEdgeData.attributes,\n        data: attributes\n      });\n    }\n\n    return info;\n  }\n\n  attributes = attributes || {};\n\n  if (asUpdater && updater) attributes = updater(attributes);\n\n  // Must the graph generate an id for this edge?\n  const eventData = {\n    key: null,\n    undirected,\n    source,\n    target,\n    attributes\n  };\n\n  if (mustGenerateKey) {\n    // NOTE: in this case we can guarantee that the key does not already\n    // exist and is already correctly casted as a string\n    edge = graph._edgeKeyGenerator();\n  } else {\n    // Coercion of edge key\n    edge = '' + edge;\n\n    // Here, we have a key collision\n    if (graph._edges.has(edge))\n      throw new UsageGraphError(\n        `Graph.${name}: the \"${edge}\" edge already exists in the graph.`\n      );\n  }\n\n  let sourceWasAdded = false;\n  let targetWasAdded = false;\n\n  if (!sourceData) {\n    sourceData = unsafeAddNode(graph, source, {});\n    sourceWasAdded = true;\n\n    if (source === target) {\n      targetData = sourceData;\n      targetWasAdded = true;\n    }\n  }\n  if (!targetData) {\n    targetData = unsafeAddNode(graph, target, {});\n    targetWasAdded = true;\n  }\n\n  // Storing some data\n  edgeData = new EdgeData(undirected, edge, sourceData, targetData, attributes);\n\n  // Adding the edge to the internal register\n  graph._edges.set(edge, edgeData);\n\n  // Incrementing node degree counters\n  const isSelfLoop = source === target;\n\n  if (undirected) {\n    sourceData.undirectedDegree++;\n    targetData.undirectedDegree++;\n\n    if (isSelfLoop) {\n      sourceData.undirectedLoops++;\n      graph._undirectedSelfLoopCount++;\n    }\n  } else {\n    sourceData.outDegree++;\n    targetData.inDegree++;\n\n    if (isSelfLoop) {\n      sourceData.directedLoops++;\n      graph._directedSelfLoopCount++;\n    }\n  }\n\n  // Updating relevant index\n  if (graph.multi) edgeData.attachMulti();\n  else edgeData.attach();\n\n  if (undirected) graph._undirectedSize++;\n  else graph._directedSize++;\n\n  // Emitting\n  eventData.key = edge;\n\n  graph.emit('edgeAdded', eventData);\n\n  return [edge, true, sourceWasAdded, targetWasAdded];\n}\n\n/**\n * Internal method used to drop an edge.\n *\n * @param  {Graph}    graph    - Target graph.\n * @param  {EdgeData} edgeData - Data of the edge to drop.\n */\nfunction dropEdgeFromData(graph, edgeData) {\n  // Dropping the edge from the register\n  graph._edges.delete(edgeData.key);\n\n  // Updating related degrees\n  const {source: sourceData, target: targetData, attributes} = edgeData;\n\n  const undirected = edgeData.undirected;\n\n  const isSelfLoop = sourceData === targetData;\n\n  if (undirected) {\n    sourceData.undirectedDegree--;\n    targetData.undirectedDegree--;\n\n    if (isSelfLoop) {\n      sourceData.undirectedLoops--;\n      graph._undirectedSelfLoopCount--;\n    }\n  } else {\n    sourceData.outDegree--;\n    targetData.inDegree--;\n\n    if (isSelfLoop) {\n      sourceData.directedLoops--;\n      graph._directedSelfLoopCount--;\n    }\n  }\n\n  // Clearing index\n  if (graph.multi) edgeData.detachMulti();\n  else edgeData.detach();\n\n  if (undirected) graph._undirectedSize--;\n  else graph._directedSize--;\n\n  // Emitting\n  graph.emit('edgeDropped', {\n    key: edgeData.key,\n    attributes,\n    source: sourceData.key,\n    target: targetData.key,\n    undirected\n  });\n}\n\n/**\n * Graph class\n *\n * @constructor\n * @param  {object}  [options] - Options:\n * @param  {boolean}   [allowSelfLoops] - Allow self loops?\n * @param  {string}    [type]           - Type of the graph.\n * @param  {boolean}   [map]            - Allow references as keys?\n * @param  {boolean}   [multi]          - Allow parallel edges?\n *\n * @throws {Error} - Will throw if the arguments are not valid.\n */\nclass Graph extends EventEmitter {\n  constructor(options) {\n    super();\n\n    //-- Solving options\n    options = assign({}, DEFAULTS, options);\n\n    // Enforcing options validity\n    if (typeof options.multi !== 'boolean')\n      throw new InvalidArgumentsGraphError(\n        `Graph.constructor: invalid 'multi' option. Expecting a boolean but got \"${options.multi}\".`\n      );\n\n    if (!TYPES.has(options.type))\n      throw new InvalidArgumentsGraphError(\n        `Graph.constructor: invalid 'type' option. Should be one of \"mixed\", \"directed\" or \"undirected\" but got \"${options.type}\".`\n      );\n\n    if (typeof options.allowSelfLoops !== 'boolean')\n      throw new InvalidArgumentsGraphError(\n        `Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got \"${options.allowSelfLoops}\".`\n      );\n\n    //-- Private properties\n\n    // Utilities\n    const NodeDataClass =\n      options.type === 'mixed'\n        ? MixedNodeData\n        : options.type === 'directed'\n        ? DirectedNodeData\n        : UndirectedNodeData;\n\n    privateProperty(this, 'NodeDataClass', NodeDataClass);\n\n    // Internal edge key generator\n\n    // NOTE: this internal generator produce keys that are strings\n    // composed of a weird prefix, an incremental instance id starting from\n    // a random byte and finally an internal instance incremental id.\n    // All this to avoid intra-frame and cross-frame adversarial inputs\n    // that can force a single #.addEdge call to degenerate into a O(n)\n    // available key search loop.\n\n    // It also ensures that automatically generated edge keys are unlikely\n    // to produce collisions with arbitrary keys given by users.\n    const instancePrefix = 'geid_' + INSTANCE_ID() + '_';\n    let edgeId = 0;\n\n    const edgeKeyGenerator = () => {\n      let availableEdgeKey;\n\n      do {\n        availableEdgeKey = instancePrefix + edgeId++;\n      } while (this._edges.has(availableEdgeKey));\n\n      return availableEdgeKey;\n    };\n\n    // Indexes\n    privateProperty(this, '_attributes', {});\n    privateProperty(this, '_nodes', new Map());\n    privateProperty(this, '_edges', new Map());\n    privateProperty(this, '_directedSize', 0);\n    privateProperty(this, '_undirectedSize', 0);\n    privateProperty(this, '_directedSelfLoopCount', 0);\n    privateProperty(this, '_undirectedSelfLoopCount', 0);\n    privateProperty(this, '_edgeKeyGenerator', edgeKeyGenerator);\n\n    // Options\n    privateProperty(this, '_options', options);\n\n    // Emitter properties\n    EMITTER_PROPS.forEach(prop => privateProperty(this, prop, this[prop]));\n\n    //-- Properties readers\n    readOnlyProperty(this, 'order', () => this._nodes.size);\n    readOnlyProperty(this, 'size', () => this._edges.size);\n    readOnlyProperty(this, 'directedSize', () => this._directedSize);\n    readOnlyProperty(this, 'undirectedSize', () => this._undirectedSize);\n    readOnlyProperty(\n      this,\n      'selfLoopCount',\n      () => this._directedSelfLoopCount + this._undirectedSelfLoopCount\n    );\n    readOnlyProperty(\n      this,\n      'directedSelfLoopCount',\n      () => this._directedSelfLoopCount\n    );\n    readOnlyProperty(\n      this,\n      'undirectedSelfLoopCount',\n      () => this._undirectedSelfLoopCount\n    );\n    readOnlyProperty(this, 'multi', this._options.multi);\n    readOnlyProperty(this, 'type', this._options.type);\n    readOnlyProperty(this, 'allowSelfLoops', this._options.allowSelfLoops);\n    readOnlyProperty(this, 'implementation', () => 'graphology');\n  }\n\n  _resetInstanceCounters() {\n    this._directedSize = 0;\n    this._undirectedSize = 0;\n    this._directedSelfLoopCount = 0;\n    this._undirectedSelfLoopCount = 0;\n  }\n\n  /**---------------------------------------------------------------------------\n   * Read\n   **---------------------------------------------------------------------------\n   */\n\n  /**\n   * Method returning whether the given node is found in the graph.\n   *\n   * @param  {any}     node - The node.\n   * @return {boolean}\n   */\n  hasNode(node) {\n    return this._nodes.has('' + node);\n  }\n\n  /**\n   * Method returning whether the given directed edge is found in the graph.\n   *\n   * Arity 1:\n   * @param  {any}     edge - The edge's key.\n   *\n   * Arity 2:\n   * @param  {any}     source - The edge's source.\n   * @param  {any}     target - The edge's target.\n   *\n   * @return {boolean}\n   *\n   * @throws {Error} - Will throw if the arguments are invalid.\n   */\n  hasDirectedEdge(source, target) {\n    // Early termination\n    if (this.type === 'undirected') return false;\n\n    if (arguments.length === 1) {\n      const edge = '' + source;\n\n      const edgeData = this._edges.get(edge);\n\n      return !!edgeData && !edgeData.undirected;\n    } else if (arguments.length === 2) {\n      source = '' + source;\n      target = '' + target;\n\n      // If the node source or the target is not in the graph we break\n      const nodeData = this._nodes.get(source);\n\n      if (!nodeData) return false;\n\n      // Is there a directed edge pointing toward target?\n      return nodeData.out.hasOwnProperty(target);\n    }\n\n    throw new InvalidArgumentsGraphError(\n      `Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`\n    );\n  }\n\n  /**\n   * Method returning whether the given undirected edge is found in the graph.\n   *\n   * Arity 1:\n   * @param  {any}     edge - The edge's key.\n   *\n   * Arity 2:\n   * @param  {any}     source - The edge's source.\n   * @param  {any}     target - The edge's target.\n   *\n   * @return {boolean}\n   *\n   * @throws {Error} - Will throw if the arguments are invalid.\n   */\n  hasUndirectedEdge(source, target) {\n    // Early termination\n    if (this.type === 'directed') return false;\n\n    if (arguments.length === 1) {\n      const edge = '' + source;\n\n      const edgeData = this._edges.get(edge);\n\n      return !!edgeData && edgeData.undirected;\n    } else if (arguments.length === 2) {\n      source = '' + source;\n      target = '' + target;\n\n      // If the node source or the target is not in the graph we break\n      const nodeData = this._nodes.get(source);\n\n      if (!nodeData) return false;\n\n      // Is there a directed edge pointing toward target?\n      return nodeData.undirected.hasOwnProperty(target);\n    }\n\n    throw new InvalidArgumentsGraphError(\n      `Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`\n    );\n  }\n\n  /**\n   * Method returning whether the given edge is found in the graph.\n   *\n   * Arity 1:\n   * @param  {any}     edge - The edge's key.\n   *\n   * Arity 2:\n   * @param  {any}     source - The edge's source.\n   * @param  {any}     target - The edge's target.\n   *\n   * @return {boolean}\n   *\n   * @throws {Error} - Will throw if the arguments are invalid.\n   */\n  hasEdge(source, target) {\n    if (arguments.length === 1) {\n      const edge = '' + source;\n\n      return this._edges.has(edge);\n    } else if (arguments.length === 2) {\n      source = '' + source;\n      target = '' + target;\n\n      // If the node source or the target is not in the graph we break\n      const nodeData = this._nodes.get(source);\n\n      if (!nodeData) return false;\n\n      // Is there a directed edge pointing toward target?\n      return (\n        (typeof nodeData.out !== 'undefined' &&\n          nodeData.out.hasOwnProperty(target)) ||\n        (typeof nodeData.undirected !== 'undefined' &&\n          nodeData.undirected.hasOwnProperty(target))\n      );\n    }\n\n    throw new InvalidArgumentsGraphError(\n      `Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`\n    );\n  }\n\n  /**\n   * Method returning the edge matching source & target in a directed fashion.\n   *\n   * @param  {any} source - The edge's source.\n   * @param  {any} target - The edge's target.\n   *\n   * @return {any|undefined}\n   *\n   * @throws {Error} - Will throw if the graph is multi.\n   * @throws {Error} - Will throw if source or target doesn't exist.\n   */\n  directedEdge(source, target) {\n    if (this.type === 'undirected') return;\n\n    source = '' + source;\n    target = '' + target;\n\n    if (this.multi)\n      throw new UsageGraphError(\n        'Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.'\n      );\n\n    const sourceData = this._nodes.get(source);\n\n    if (!sourceData)\n      throw new NotFoundGraphError(\n        `Graph.directedEdge: could not find the \"${source}\" source node in the graph.`\n      );\n\n    if (!this._nodes.has(target))\n      throw new NotFoundGraphError(\n        `Graph.directedEdge: could not find the \"${target}\" target node in the graph.`\n      );\n\n    const edgeData = (sourceData.out && sourceData.out[target]) || undefined;\n\n    if (edgeData) return edgeData.key;\n  }\n\n  /**\n   * Method returning the edge matching source & target in a undirected fashion.\n   *\n   * @param  {any} source - The edge's source.\n   * @param  {any} target - The edge's target.\n   *\n   * @return {any|undefined}\n   *\n   * @throws {Error} - Will throw if the graph is multi.\n   * @throws {Error} - Will throw if source or target doesn't exist.\n   */\n  undirectedEdge(source, target) {\n    if (this.type === 'directed') return;\n\n    source = '' + source;\n    target = '' + target;\n\n    if (this.multi)\n      throw new UsageGraphError(\n        'Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.'\n      );\n\n    const sourceData = this._nodes.get(source);\n\n    if (!sourceData)\n      throw new NotFoundGraphError(\n        `Graph.undirectedEdge: could not find the \"${source}\" source node in the graph.`\n      );\n\n    if (!this._nodes.has(target))\n      throw new NotFoundGraphError(\n        `Graph.undirectedEdge: could not find the \"${target}\" target node in the graph.`\n      );\n\n    const edgeData =\n      (sourceData.undirected && sourceData.undirected[target]) || undefined;\n\n    if (edgeData) return edgeData.key;\n  }\n\n  /**\n   * Method returning the edge matching source & target in a mixed fashion.\n   *\n   * @param  {any} source - The edge's source.\n   * @param  {any} target - The edge's target.\n   *\n   * @return {any|undefined}\n   *\n   * @throws {Error} - Will throw if the graph is multi.\n   * @throws {Error} - Will throw if source or target doesn't exist.\n   */\n  edge(source, target) {\n    if (this.multi)\n      throw new UsageGraphError(\n        'Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.'\n      );\n\n    source = '' + source;\n    target = '' + target;\n\n    const sourceData = this._nodes.get(source);\n\n    if (!sourceData)\n      throw new NotFoundGraphError(\n        `Graph.edge: could not find the \"${source}\" source node in the graph.`\n      );\n\n    if (!this._nodes.has(target))\n      throw new NotFoundGraphError(\n        `Graph.edge: could not find the \"${target}\" target node in the graph.`\n      );\n\n    const edgeData =\n      (sourceData.out && sourceData.out[target]) ||\n      (sourceData.undirected && sourceData.undirected[target]) ||\n      undefined;\n\n    if (edgeData) return edgeData.key;\n  }\n\n  /**\n   * Method returning whether two nodes are directed neighbors.\n   *\n   * @param  {any}     node     - The node's key.\n   * @param  {any}     neighbor - The neighbor's key.\n   * @return {boolean}\n   *\n   * @throws {Error} - Will throw if the node isn't in the graph.\n   */\n  areDirectedNeighbors(node, neighbor) {\n    node = '' + node;\n    neighbor = '' + neighbor;\n\n    const nodeData = this._nodes.get(node);\n\n    if (!nodeData)\n      throw new NotFoundGraphError(\n        `Graph.areDirectedNeighbors: could not find the \"${node}\" node in the graph.`\n      );\n\n    if (this.type === 'undirected') return false;\n\n    return neighbor in nodeData.in || neighbor in nodeData.out;\n  }\n\n  /**\n   * Method returning whether two nodes are out neighbors.\n   *\n   * @param  {any}     node     - The node's key.\n   * @param  {any}     neighbor - The neighbor's key.\n   * @return {boolean}\n   *\n   * @throws {Error} - Will throw if the node isn't in the graph.\n   */\n  areOutNeighbors(node, neighbor) {\n    node = '' + node;\n    neighbor = '' + neighbor;\n\n    const nodeData = this._nodes.get(node);\n\n    if (!nodeData)\n      throw new NotFoundGraphError(\n        `Graph.areOutNeighbors: could not find the \"${node}\" node in the graph.`\n      );\n\n    if (this.type === 'undirected') return false;\n\n    return neighbor in nodeData.out;\n  }\n\n  /**\n   * Method returning whether two nodes are in neighbors.\n   *\n   * @param  {any}     node     - The node's key.\n   * @param  {any}     neighbor - The neighbor's key.\n   * @return {boolean}\n   *\n   * @throws {Error} - Will throw if the node isn't in the graph.\n   */\n  areInNeighbors(node, neighbor) {\n    node = '' + node;\n    neighbor = '' + neighbor;\n\n    const nodeData = this._nodes.get(node);\n\n    if (!nodeData)\n      throw new NotFoundGraphError(\n        `Graph.areInNeighbors: could not find the \"${node}\" node in the graph.`\n      );\n\n    if (this.type === 'undirected') return false;\n\n    return neighbor in nodeData.in;\n  }\n\n  /**\n   * Method returning whether two nodes are undirected neighbors.\n   *\n   * @param  {any}     node     - The node's key.\n   * @param  {any}     neighbor - The neighbor's key.\n   * @return {boolean}\n   *\n   * @throws {Error} - Will throw if the node isn't in the graph.\n   */\n  areUndirectedNeighbors(node, neighbor) {\n    node = '' + node;\n    neighbor = '' + neighbor;\n\n    const nodeData = this._nodes.get(node);\n\n    if (!nodeData)\n      throw new NotFoundGraphError(\n        `Graph.areUndirectedNeighbors: could not find the \"${node}\" node in the graph.`\n      );\n\n    if (this.type === 'directed') return false;\n\n    return neighbor in nodeData.undirected;\n  }\n\n  /**\n   * Method returning whether two nodes are neighbors.\n   *\n   * @param  {any}     node     - The node's key.\n   * @param  {any}     neighbor - The neighbor's key.\n   * @return {boolean}\n   *\n   * @throws {Error} - Will throw if the node isn't in the graph.\n   */\n  areNeighbors(node, neighbor) {\n    node = '' + node;\n    neighbor = '' + neighbor;\n\n    const nodeData = this._nodes.get(node);\n\n    if (!nodeData)\n      throw new NotFoundGraphError(\n        `Graph.areNeighbors: could not find the \"${node}\" node in the graph.`\n      );\n\n    if (this.type !== 'undirected') {\n      if (neighbor in nodeData.in || neighbor in nodeData.out) return true;\n    }\n\n    if (this.type !== 'directed') {\n      if (neighbor in nodeData.undirected) return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Method returning whether two nodes are inbound neighbors.\n   *\n   * @param  {any}     node     - The node's key.\n   * @param  {any}     neighbor - The neighbor's key.\n   * @return {boolean}\n   *\n   * @throws {Error} - Will throw if the node isn't in the graph.\n   */\n  areInboundNeighbors(node, neighbor) {\n    node = '' + node;\n    neighbor = '' + neighbor;\n\n    const nodeData = this._nodes.get(node);\n\n    if (!nodeData)\n      throw new NotFoundGraphError(\n        `Graph.areInboundNeighbors: could not find the \"${node}\" node in the graph.`\n      );\n\n    if (this.type !== 'undirected') {\n      if (neighbor in nodeData.in) return true;\n    }\n\n    if (this.type !== 'directed') {\n      if (neighbor in nodeData.undirected) return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Method returning whether two nodes are outbound neighbors.\n   *\n   * @param  {any}     node     - The node's key.\n   * @param  {any}     neighbor - The neighbor's key.\n   * @return {boolean}\n   *\n   * @throws {Error} - Will throw if the node isn't in the graph.\n   */\n  areOutboundNeighbors(node, neighbor) {\n    node = '' + node;\n    neighbor = '' + neighbor;\n\n    const nodeData = this._nodes.get(node);\n\n    if (!nodeData)\n      throw new NotFoundGraphError(\n        `Graph.areOutboundNeighbors: could not find the \"${node}\" node in the graph.`\n      );\n\n    if (this.type !== 'undirected') {\n      if (neighbor in nodeData.out) return true;\n    }\n\n    if (this.type !== 'directed') {\n      if (neighbor in nodeData.undirected) return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Method returning the given node's in degree.\n   *\n   * @param  {any}     node - The node's key.\n   * @return {number}       - The node's in degree.\n   *\n   * @throws {Error} - Will throw if the node isn't in the graph.\n   */\n  inDegree(node) {\n    node = '' + node;\n\n    const nodeData = this._nodes.get(node);\n\n    if (!nodeData)\n      throw new NotFoundGraphError(\n        `Graph.inDegree: could not find the \"${node}\" node in the graph.`\n      );\n\n    if (this.type === 'undirected') return 0;\n\n    return nodeData.inDegree;\n  }\n\n  /**\n   * Method returning the given node's out degree.\n   *\n   * @param  {any}     node - The node's key.\n   * @return {number}       - The node's in degree.\n   *\n   * @throws {Error} - Will throw if the node isn't in the graph.\n   */\n  outDegree(node) {\n    node = '' + node;\n\n    const nodeData = this._nodes.get(node);\n\n    if (!nodeData)\n      throw new NotFoundGraphError(\n        `Graph.outDegree: could not find the \"${node}\" node in the graph.`\n      );\n\n    if (this.type === 'undirected') return 0;\n\n    return nodeData.outDegree;\n  }\n\n  /**\n   * Method returning the given node's directed degree.\n   *\n   * @param  {any}     node - The node's key.\n   * @return {number}       - The node's in degree.\n   *\n   * @throws {Error} - Will throw if the node isn't in the graph.\n   */\n  directedDegree(node) {\n    node = '' + node;\n\n    const nodeData = this._nodes.get(node);\n\n    if (!nodeData)\n      throw new NotFoundGraphError(\n        `Graph.directedDegree: could not find the \"${node}\" node in the graph.`\n      );\n\n    if (this.type === 'undirected') return 0;\n\n    return nodeData.inDegree + nodeData.outDegree;\n  }\n\n  /**\n   * Method returning the given node's undirected degree.\n   *\n   * @param  {any}     node - The node's key.\n   * @return {number}       - The node's in degree.\n   *\n   * @throws {Error} - Will throw if the node isn't in the graph.\n   */\n  undirectedDegree(node) {\n    node = '' + node;\n\n    const nodeData = this._nodes.get(node);\n\n    if (!nodeData)\n      throw new NotFoundGraphError(\n        `Graph.undirectedDegree: could not find the \"${node}\" node in the graph.`\n      );\n\n    if (this.type === 'directed') return 0;\n\n    return nodeData.undirectedDegree;\n  }\n\n  /**\n   * Method returning the given node's inbound degree.\n   *\n   * @param  {any}     node - The node's key.\n   * @return {number}       - The node's inbound degree.\n   *\n   * @throws {Error} - Will throw if the node isn't in the graph.\n   */\n  inboundDegree(node) {\n    node = '' + node;\n\n    const nodeData = this._nodes.get(node);\n\n    if (!nodeData)\n      throw new NotFoundGraphError(\n        `Graph.inboundDegree: could not find the \"${node}\" node in the graph.`\n      );\n\n    let degree = 0;\n\n    if (this.type !== 'directed') {\n      degree += nodeData.undirectedDegree;\n    }\n\n    if (this.type !== 'undirected') {\n      degree += nodeData.inDegree;\n    }\n\n    return degree;\n  }\n\n  /**\n   * Method returning the given node's outbound degree.\n   *\n   * @param  {any}     node - The node's key.\n   * @return {number}       - The node's outbound degree.\n   *\n   * @throws {Error} - Will throw if the node isn't in the graph.\n   */\n  outboundDegree(node) {\n    node = '' + node;\n\n    const nodeData = this._nodes.get(node);\n\n    if (!nodeData)\n      throw new NotFoundGraphError(\n        `Graph.outboundDegree: could not find the \"${node}\" node in the graph.`\n      );\n\n    let degree = 0;\n\n    if (this.type !== 'directed') {\n      degree += nodeData.undirectedDegree;\n    }\n\n    if (this.type !== 'undirected') {\n      degree += nodeData.outDegree;\n    }\n\n    return degree;\n  }\n\n  /**\n   * Method returning the given node's directed degree.\n   *\n   * @param  {any}     node - The node's key.\n   * @return {number}       - The node's degree.\n   *\n   * @throws {Error} - Will throw if the node isn't in the graph.\n   */\n  degree(node) {\n    node = '' + node;\n\n    const nodeData = this._nodes.get(node);\n\n    if (!nodeData)\n      throw new NotFoundGraphError(\n        `Graph.degree: could not find the \"${node}\" node in the graph.`\n      );\n\n    let degree = 0;\n\n    if (this.type !== 'directed') {\n      degree += nodeData.undirectedDegree;\n    }\n\n    if (this.type !== 'undirected') {\n      degree += nodeData.inDegree + nodeData.outDegree;\n    }\n\n    return degree;\n  }\n\n  /**\n   * Method returning the given node's in degree without considering self loops.\n   *\n   * @param  {any}     node - The node's key.\n   * @return {number}       - The node's in degree.\n   *\n   * @throws {Error} - Will throw if the node isn't in the graph.\n   */\n  inDegreeWithoutSelfLoops(node) {\n    node = '' + node;\n\n    const nodeData = this._nodes.get(node);\n\n    if (!nodeData)\n      throw new NotFoundGraphError(\n        `Graph.inDegreeWithoutSelfLoops: could not find the \"${node}\" node in the graph.`\n      );\n\n    if (this.type === 'undirected') return 0;\n\n    return nodeData.inDegree - nodeData.directedLoops;\n  }\n\n  /**\n   * Method returning the given node's out degree without considering self loops.\n   *\n   * @param  {any}     node - The node's key.\n   * @return {number}       - The node's in degree.\n   *\n   * @throws {Error} - Will throw if the node isn't in the graph.\n   */\n  outDegreeWithoutSelfLoops(node) {\n    node = '' + node;\n\n    const nodeData = this._nodes.get(node);\n\n    if (!nodeData)\n      throw new NotFoundGraphError(\n        `Graph.outDegreeWithoutSelfLoops: could not find the \"${node}\" node in the graph.`\n      );\n\n    if (this.type === 'undirected') return 0;\n\n    return nodeData.outDegree - nodeData.directedLoops;\n  }\n\n  /**\n   * Method returning the given node's directed degree without considering self loops.\n   *\n   * @param  {any}     node - The node's key.\n   * @return {number}       - The node's in degree.\n   *\n   * @throws {Error} - Will throw if the node isn't in the graph.\n   */\n  directedDegreeWithoutSelfLoops(node) {\n    node = '' + node;\n\n    const nodeData = this._nodes.get(node);\n\n    if (!nodeData)\n      throw new NotFoundGraphError(\n        `Graph.directedDegreeWithoutSelfLoops: could not find the \"${node}\" node in the graph.`\n      );\n\n    if (this.type === 'undirected') return 0;\n\n    return nodeData.inDegree + nodeData.outDegree - nodeData.directedLoops * 2;\n  }\n\n  /**\n   * Method returning the given node's undirected degree without considering self loops.\n   *\n   * @param  {any}     node - The node's key.\n   * @return {number}       - The node's in degree.\n   *\n   * @throws {Error} - Will throw if the node isn't in the graph.\n   */\n  undirectedDegreeWithoutSelfLoops(node) {\n    node = '' + node;\n\n    const nodeData = this._nodes.get(node);\n\n    if (!nodeData)\n      throw new NotFoundGraphError(\n        `Graph.undirectedDegreeWithoutSelfLoops: could not find the \"${node}\" node in the graph.`\n      );\n\n    if (this.type === 'directed') return 0;\n\n    return nodeData.undirectedDegree - nodeData.undirectedLoops * 2;\n  }\n\n  /**\n   * Method returning the given node's inbound degree without considering self loops.\n   *\n   * @param  {any}     node - The node's key.\n   * @return {number}       - The node's inbound degree.\n   *\n   * @throws {Error} - Will throw if the node isn't in the graph.\n   */\n  inboundDegreeWithoutSelfLoops(node) {\n    node = '' + node;\n\n    const nodeData = this._nodes.get(node);\n\n    if (!nodeData)\n      throw new NotFoundGraphError(\n        `Graph.inboundDegreeWithoutSelfLoops: could not find the \"${node}\" node in the graph.`\n      );\n\n    let degree = 0;\n    let loops = 0;\n\n    if (this.type !== 'directed') {\n      degree += nodeData.undirectedDegree;\n      loops += nodeData.undirectedLoops * 2;\n    }\n\n    if (this.type !== 'undirected') {\n      degree += nodeData.inDegree;\n      loops += nodeData.directedLoops;\n    }\n\n    return degree - loops;\n  }\n\n  /**\n   * Method returning the given node's outbound degree without considering self loops.\n   *\n   * @param  {any}     node - The node's key.\n   * @return {number}       - The node's outbound degree.\n   *\n   * @throws {Error} - Will throw if the node isn't in the graph.\n   */\n  outboundDegreeWithoutSelfLoops(node) {\n    node = '' + node;\n\n    const nodeData = this._nodes.get(node);\n\n    if (!nodeData)\n      throw new NotFoundGraphError(\n        `Graph.outboundDegreeWithoutSelfLoops: could not find the \"${node}\" node in the graph.`\n      );\n\n    let degree = 0;\n    let loops = 0;\n\n    if (this.type !== 'directed') {\n      degree += nodeData.undirectedDegree;\n      loops += nodeData.undirectedLoops * 2;\n    }\n\n    if (this.type !== 'undirected') {\n      degree += nodeData.outDegree;\n      loops += nodeData.directedLoops;\n    }\n\n    return degree - loops;\n  }\n\n  /**\n   * Method returning the given node's directed degree without considering self loops.\n   *\n   * @param  {any}     node - The node's key.\n   * @return {number}       - The node's degree.\n   *\n   * @throws {Error} - Will throw if the node isn't in the graph.\n   */\n  degreeWithoutSelfLoops(node) {\n    node = '' + node;\n\n    const nodeData = this._nodes.get(node);\n\n    if (!nodeData)\n      throw new NotFoundGraphError(\n        `Graph.degreeWithoutSelfLoops: could not find the \"${node}\" node in the graph.`\n      );\n\n    let degree = 0;\n    let loops = 0;\n\n    if (this.type !== 'directed') {\n      degree += nodeData.undirectedDegree;\n      loops += nodeData.undirectedLoops * 2;\n    }\n\n    if (this.type !== 'undirected') {\n      degree += nodeData.inDegree + nodeData.outDegree;\n      loops += nodeData.directedLoops * 2;\n    }\n\n    return degree - loops;\n  }\n\n  /**\n   * Method returning the given edge's source.\n   *\n   * @param  {any} edge - The edge's key.\n   * @return {any}      - The edge's source.\n   *\n   * @throws {Error} - Will throw if the edge isn't in the graph.\n   */\n  source(edge) {\n    edge = '' + edge;\n\n    const data = this._edges.get(edge);\n\n    if (!data)\n      throw new NotFoundGraphError(\n        `Graph.source: could not find the \"${edge}\" edge in the graph.`\n      );\n\n    return data.source.key;\n  }\n\n  /**\n   * Method returning the given edge's target.\n   *\n   * @param  {any} edge - The edge's key.\n   * @return {any}      - The edge's target.\n   *\n   * @throws {Error} - Will throw if the edge isn't in the graph.\n   */\n  target(edge) {\n    edge = '' + edge;\n\n    const data = this._edges.get(edge);\n\n    if (!data)\n      throw new NotFoundGraphError(\n        `Graph.target: could not find the \"${edge}\" edge in the graph.`\n      );\n\n    return data.target.key;\n  }\n\n  /**\n   * Method returning the given edge's extremities.\n   *\n   * @param  {any}   edge - The edge's key.\n   * @return {array}      - The edge's extremities.\n   *\n   * @throws {Error} - Will throw if the edge isn't in the graph.\n   */\n  extremities(edge) {\n    edge = '' + edge;\n\n    const edgeData = this._edges.get(edge);\n\n    if (!edgeData)\n      throw new NotFoundGraphError(\n        `Graph.extremities: could not find the \"${edge}\" edge in the graph.`\n      );\n\n    return [edgeData.source.key, edgeData.target.key];\n  }\n\n  /**\n   * Given a node & an edge, returns the other extremity of the edge.\n   *\n   * @param  {any}   node - The node's key.\n   * @param  {any}   edge - The edge's key.\n   * @return {any}        - The related node.\n   *\n   * @throws {Error} - Will throw if the edge isn't in the graph or if the\n   *                   edge & node are not related.\n   */\n  opposite(node, edge) {\n    node = '' + node;\n    edge = '' + edge;\n\n    const data = this._edges.get(edge);\n\n    if (!data)\n      throw new NotFoundGraphError(\n        `Graph.opposite: could not find the \"${edge}\" edge in the graph.`\n      );\n\n    const source = data.source.key;\n    const target = data.target.key;\n\n    if (node === source) return target;\n    if (node === target) return source;\n\n    throw new NotFoundGraphError(\n      `Graph.opposite: the \"${node}\" node is not attached to the \"${edge}\" edge (${source}, ${target}).`\n    );\n  }\n\n  /**\n   * Returns whether the given edge has the given node as extremity.\n   *\n   * @param  {any}     edge - The edge's key.\n   * @param  {any}     node - The node's key.\n   * @return {boolean}      - The related node.\n   *\n   * @throws {Error} - Will throw if either the node or the edge isn't in the graph.\n   */\n  hasExtremity(edge, node) {\n    edge = '' + edge;\n    node = '' + node;\n\n    const data = this._edges.get(edge);\n\n    if (!data)\n      throw new NotFoundGraphError(\n        `Graph.hasExtremity: could not find the \"${edge}\" edge in the graph.`\n      );\n\n    return data.source.key === node || data.target.key === node;\n  }\n\n  /**\n   * Method returning whether the given edge is undirected.\n   *\n   * @param  {any}     edge - The edge's key.\n   * @return {boolean}\n   *\n   * @throws {Error} - Will throw if the edge isn't in the graph.\n   */\n  isUndirected(edge) {\n    edge = '' + edge;\n\n    const data = this._edges.get(edge);\n\n    if (!data)\n      throw new NotFoundGraphError(\n        `Graph.isUndirected: could not find the \"${edge}\" edge in the graph.`\n      );\n\n    return data.undirected;\n  }\n\n  /**\n   * Method returning whether the given edge is directed.\n   *\n   * @param  {any}     edge - The edge's key.\n   * @return {boolean}\n   *\n   * @throws {Error} - Will throw if the edge isn't in the graph.\n   */\n  isDirected(edge) {\n    edge = '' + edge;\n\n    const data = this._edges.get(edge);\n\n    if (!data)\n      throw new NotFoundGraphError(\n        `Graph.isDirected: could not find the \"${edge}\" edge in the graph.`\n      );\n\n    return !data.undirected;\n  }\n\n  /**\n   * Method returning whether the given edge is a self loop.\n   *\n   * @param  {any}     edge - The edge's key.\n   * @return {boolean}\n   *\n   * @throws {Error} - Will throw if the edge isn't in the graph.\n   */\n  isSelfLoop(edge) {\n    edge = '' + edge;\n\n    const data = this._edges.get(edge);\n\n    if (!data)\n      throw new NotFoundGraphError(\n        `Graph.isSelfLoop: could not find the \"${edge}\" edge in the graph.`\n      );\n\n    return data.source === data.target;\n  }\n\n  /**---------------------------------------------------------------------------\n   * Mutation\n   **---------------------------------------------------------------------------\n   */\n\n  /**\n   * Method used to add a node to the graph.\n   *\n   * @param  {any}    node         - The node.\n   * @param  {object} [attributes] - Optional attributes.\n   * @return {any}                 - The node.\n   *\n   * @throws {Error} - Will throw if the given node already exist.\n   * @throws {Error} - Will throw if the given attributes are not an object.\n   */\n  addNode(node, attributes) {\n    const nodeData = addNode(this, node, attributes);\n\n    return nodeData.key;\n  }\n\n  /**\n   * Method used to merge a node into the graph.\n   *\n   * @param  {any}    node         - The node.\n   * @param  {object} [attributes] - Optional attributes.\n   * @return {any}                 - The node.\n   */\n  mergeNode(node, attributes) {\n    if (attributes && !isPlainObject(attributes))\n      throw new InvalidArgumentsGraphError(\n        `Graph.mergeNode: invalid attributes. Expecting an object but got \"${attributes}\"`\n      );\n\n    // String coercion\n    node = '' + node;\n    attributes = attributes || {};\n\n    // If the node already exists, we merge the attributes\n    let data = this._nodes.get(node);\n\n    if (data) {\n      if (attributes) {\n        assign(data.attributes, attributes);\n\n        this.emit('nodeAttributesUpdated', {\n          type: 'merge',\n          key: node,\n          attributes: data.attributes,\n          data: attributes\n        });\n      }\n      return [node, false];\n    }\n\n    data = new this.NodeDataClass(node, attributes);\n\n    // Adding the node to internal register\n    this._nodes.set(node, data);\n\n    // Emitting\n    this.emit('nodeAdded', {\n      key: node,\n      attributes\n    });\n\n    return [node, true];\n  }\n\n  /**\n   * Method used to add a node if it does not exist in the graph or else to\n   * update its attributes using a function.\n   *\n   * @param  {any}      node      - The node.\n   * @param  {function} [updater] - Optional updater function.\n   * @return {any}                - The node.\n   */\n  updateNode(node, updater) {\n    if (updater && typeof updater !== 'function')\n      throw new InvalidArgumentsGraphError(\n        `Graph.updateNode: invalid updater function. Expecting a function but got \"${updater}\"`\n      );\n\n    // String coercion\n    node = '' + node;\n\n    // If the node already exists, we update the attributes\n    let data = this._nodes.get(node);\n\n    if (data) {\n      if (updater) {\n        const oldAttributes = data.attributes;\n        data.attributes = updater(oldAttributes);\n\n        this.emit('nodeAttributesUpdated', {\n          type: 'replace',\n          key: node,\n          attributes: data.attributes\n        });\n      }\n      return [node, false];\n    }\n\n    const attributes = updater ? updater({}) : {};\n\n    data = new this.NodeDataClass(node, attributes);\n\n    // Adding the node to internal register\n    this._nodes.set(node, data);\n\n    // Emitting\n    this.emit('nodeAdded', {\n      key: node,\n      attributes\n    });\n\n    return [node, true];\n  }\n\n  /**\n   * Method used to drop a single node & all its attached edges from the graph.\n   *\n   * @param  {any}    node - The node.\n   * @return {Graph}\n   *\n   * @throws {Error} - Will throw if the node doesn't exist.\n   */\n  dropNode(node) {\n    node = '' + node;\n\n    const nodeData = this._nodes.get(node);\n\n    if (!nodeData)\n      throw new NotFoundGraphError(\n        `Graph.dropNode: could not find the \"${node}\" node in the graph.`\n      );\n\n    let edgeData;\n\n    // Removing attached edges\n    // NOTE: we could be faster here, but this is such a pain to maintain\n    if (this.type !== 'undirected') {\n      for (const neighbor in nodeData.out) {\n        edgeData = nodeData.out[neighbor];\n\n        do {\n          dropEdgeFromData(this, edgeData);\n          edgeData = edgeData.next;\n        } while (edgeData);\n      }\n\n      for (const neighbor in nodeData.in) {\n        edgeData = nodeData.in[neighbor];\n\n        do {\n          dropEdgeFromData(this, edgeData);\n          edgeData = edgeData.next;\n        } while (edgeData);\n      }\n    }\n\n    if (this.type !== 'directed') {\n      for (const neighbor in nodeData.undirected) {\n        edgeData = nodeData.undirected[neighbor];\n\n        do {\n          dropEdgeFromData(this, edgeData);\n          edgeData = edgeData.next;\n        } while (edgeData);\n      }\n    }\n\n    // Dropping the node from the register\n    this._nodes.delete(node);\n\n    // Emitting\n    this.emit('nodeDropped', {\n      key: node,\n      attributes: nodeData.attributes\n    });\n  }\n\n  /**\n   * Method used to drop a single edge from the graph.\n   *\n   * Arity 1:\n   * @param  {any}    edge - The edge.\n   *\n   * Arity 2:\n   * @param  {any}    source - Source node.\n   * @param  {any}    target - Target node.\n   *\n   * @return {Graph}\n   *\n   * @throws {Error} - Will throw if the edge doesn't exist.\n   */\n  dropEdge(edge) {\n    let edgeData;\n\n    if (arguments.length > 1) {\n      const source = '' + arguments[0];\n      const target = '' + arguments[1];\n\n      edgeData = getMatchingEdge(this, source, target, this.type);\n\n      if (!edgeData)\n        throw new NotFoundGraphError(\n          `Graph.dropEdge: could not find the \"${source}\" -> \"${target}\" edge in the graph.`\n        );\n    } else {\n      edge = '' + edge;\n\n      edgeData = this._edges.get(edge);\n\n      if (!edgeData)\n        throw new NotFoundGraphError(\n          `Graph.dropEdge: could not find the \"${edge}\" edge in the graph.`\n        );\n    }\n\n    dropEdgeFromData(this, edgeData);\n\n    return this;\n  }\n\n  /**\n   * Method used to drop a single directed edge from the graph.\n   *\n   * @param  {any}    source - Source node.\n   * @param  {any}    target - Target node.\n   *\n   * @return {Graph}\n   *\n   * @throws {Error} - Will throw if the edge doesn't exist.\n   */\n  dropDirectedEdge(source, target) {\n    if (arguments.length < 2)\n      throw new UsageGraphError(\n        'Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.'\n      );\n\n    if (this.multi)\n      throw new UsageGraphError(\n        'Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.'\n      );\n\n    source = '' + source;\n    target = '' + target;\n\n    const edgeData = getMatchingEdge(this, source, target, 'directed');\n\n    if (!edgeData)\n      throw new NotFoundGraphError(\n        `Graph.dropDirectedEdge: could not find a \"${source}\" -> \"${target}\" edge in the graph.`\n      );\n\n    dropEdgeFromData(this, edgeData);\n\n    return this;\n  }\n\n  /**\n   * Method used to drop a single undirected edge from the graph.\n   *\n   * @param  {any}    source - Source node.\n   * @param  {any}    target - Target node.\n   *\n   * @return {Graph}\n   *\n   * @throws {Error} - Will throw if the edge doesn't exist.\n   */\n  dropUndirectedEdge(source, target) {\n    if (arguments.length < 2)\n      throw new UsageGraphError(\n        'Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.'\n      );\n\n    if (this.multi)\n      throw new UsageGraphError(\n        'Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.'\n      );\n\n    const edgeData = getMatchingEdge(this, source, target, 'undirected');\n\n    if (!edgeData)\n      throw new NotFoundGraphError(\n        `Graph.dropUndirectedEdge: could not find a \"${source}\" -> \"${target}\" edge in the graph.`\n      );\n\n    dropEdgeFromData(this, edgeData);\n\n    return this;\n  }\n\n  /**\n   * Method used to remove every edge & every node from the graph.\n   *\n   * @return {Graph}\n   */\n  clear() {\n    // Clearing edges\n    this._edges.clear();\n\n    // Clearing nodes\n    this._nodes.clear();\n\n    // Reset counters\n    this._resetInstanceCounters();\n\n    // Emitting\n    this.emit('cleared');\n  }\n\n  /**\n   * Method used to remove every edge from the graph.\n   *\n   * @return {Graph}\n   */\n  clearEdges() {\n    // Clearing structure index\n    const iterator = this._nodes.values();\n\n    let step;\n\n    while (((step = iterator.next()), step.done !== true)) {\n      step.value.clear();\n    }\n\n    // Clearing edges\n    this._edges.clear();\n\n    // Reset counters\n    this._resetInstanceCounters();\n\n    // Emitting\n    this.emit('edgesCleared');\n  }\n\n  /**---------------------------------------------------------------------------\n   * Attributes-related methods\n   **---------------------------------------------------------------------------\n   */\n\n  /**\n   * Method returning the desired graph's attribute.\n   *\n   * @param  {string} name - Name of the attribute.\n   * @return {any}\n   */\n  getAttribute(name) {\n    return this._attributes[name];\n  }\n\n  /**\n   * Method returning the graph's attributes.\n   *\n   * @return {object}\n   */\n  getAttributes() {\n    return this._attributes;\n  }\n\n  /**\n   * Method returning whether the graph has the desired attribute.\n   *\n   * @param  {string}  name - Name of the attribute.\n   * @return {boolean}\n   */\n  hasAttribute(name) {\n    return this._attributes.hasOwnProperty(name);\n  }\n\n  /**\n   * Method setting a value for the desired graph's attribute.\n   *\n   * @param  {string}  name  - Name of the attribute.\n   * @param  {any}     value - Value for the attribute.\n   * @return {Graph}\n   */\n  setAttribute(name, value) {\n    this._attributes[name] = value;\n\n    // Emitting\n    this.emit('attributesUpdated', {\n      type: 'set',\n      attributes: this._attributes,\n      name\n    });\n\n    return this;\n  }\n\n  /**\n   * Method using a function to update the desired graph's attribute's value.\n   *\n   * @param  {string}   name    - Name of the attribute.\n   * @param  {function} updater - Function use to update the attribute's value.\n   * @return {Graph}\n   */\n  updateAttribute(name, updater) {\n    if (typeof updater !== 'function')\n      throw new InvalidArgumentsGraphError(\n        'Graph.updateAttribute: updater should be a function.'\n      );\n\n    const value = this._attributes[name];\n\n    this._attributes[name] = updater(value);\n\n    // Emitting\n    this.emit('attributesUpdated', {\n      type: 'set',\n      attributes: this._attributes,\n      name\n    });\n\n    return this;\n  }\n\n  /**\n   * Method removing the desired graph's attribute.\n   *\n   * @param  {string} name  - Name of the attribute.\n   * @return {Graph}\n   */\n  removeAttribute(name) {\n    delete this._attributes[name];\n\n    // Emitting\n    this.emit('attributesUpdated', {\n      type: 'remove',\n      attributes: this._attributes,\n      name\n    });\n\n    return this;\n  }\n\n  /**\n   * Method replacing the graph's attributes.\n   *\n   * @param  {object} attributes - New attributes.\n   * @return {Graph}\n   *\n   * @throws {Error} - Will throw if given attributes are not a plain object.\n   */\n  replaceAttributes(attributes) {\n    if (!isPlainObject(attributes))\n      throw new InvalidArgumentsGraphError(\n        'Graph.replaceAttributes: provided attributes are not a plain object.'\n      );\n\n    this._attributes = attributes;\n\n    // Emitting\n    this.emit('attributesUpdated', {\n      type: 'replace',\n      attributes: this._attributes\n    });\n\n    return this;\n  }\n\n  /**\n   * Method merging the graph's attributes.\n   *\n   * @param  {object} attributes - Attributes to merge.\n   * @return {Graph}\n   *\n   * @throws {Error} - Will throw if given attributes are not a plain object.\n   */\n  mergeAttributes(attributes) {\n    if (!isPlainObject(attributes))\n      throw new InvalidArgumentsGraphError(\n        'Graph.mergeAttributes: provided attributes are not a plain object.'\n      );\n\n    assign(this._attributes, attributes);\n\n    // Emitting\n    this.emit('attributesUpdated', {\n      type: 'merge',\n      attributes: this._attributes,\n      data: attributes\n    });\n\n    return this;\n  }\n\n  /**\n   * Method updating the graph's attributes.\n   *\n   * @param  {function} updater - Function used to update the attributes.\n   * @return {Graph}\n   *\n   * @throws {Error} - Will throw if given updater is not a function.\n   */\n  updateAttributes(updater) {\n    if (typeof updater !== 'function')\n      throw new InvalidArgumentsGraphError(\n        'Graph.updateAttributes: provided updater is not a function.'\n      );\n\n    this._attributes = updater(this._attributes);\n\n    // Emitting\n    this.emit('attributesUpdated', {\n      type: 'update',\n      attributes: this._attributes\n    });\n\n    return this;\n  }\n\n  /**\n   * Method used to update each node's attributes using the given function.\n   *\n   * @param {function}  updater - Updater function to use.\n   * @param {object}    [hints] - Optional hints.\n   */\n  updateEachNodeAttributes(updater, hints) {\n    if (typeof updater !== 'function')\n      throw new InvalidArgumentsGraphError(\n        'Graph.updateEachNodeAttributes: expecting an updater function.'\n      );\n\n    if (hints && !validateHints(hints))\n      throw new InvalidArgumentsGraphError(\n        'Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}'\n      );\n\n    const iterator = this._nodes.values();\n\n    let step, nodeData;\n\n    while (((step = iterator.next()), step.done !== true)) {\n      nodeData = step.value;\n      nodeData.attributes = updater(nodeData.key, nodeData.attributes);\n    }\n\n    this.emit('eachNodeAttributesUpdated', {\n      hints: hints ? hints : null\n    });\n  }\n\n  /**\n   * Method used to update each edge's attributes using the given function.\n   *\n   * @param {function}  updater - Updater function to use.\n   * @param {object}    [hints] - Optional hints.\n   */\n  updateEachEdgeAttributes(updater, hints) {\n    if (typeof updater !== 'function')\n      throw new InvalidArgumentsGraphError(\n        'Graph.updateEachEdgeAttributes: expecting an updater function.'\n      );\n\n    if (hints && !validateHints(hints))\n      throw new InvalidArgumentsGraphError(\n        'Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}'\n      );\n\n    const iterator = this._edges.values();\n\n    let step, edgeData, sourceData, targetData;\n\n    while (((step = iterator.next()), step.done !== true)) {\n      edgeData = step.value;\n      sourceData = edgeData.source;\n      targetData = edgeData.target;\n\n      edgeData.attributes = updater(\n        edgeData.key,\n        edgeData.attributes,\n        sourceData.key,\n        targetData.key,\n        sourceData.attributes,\n        targetData.attributes,\n        edgeData.undirected\n      );\n    }\n\n    this.emit('eachEdgeAttributesUpdated', {\n      hints: hints ? hints : null\n    });\n  }\n\n  /**---------------------------------------------------------------------------\n   * Iteration-related methods\n   **---------------------------------------------------------------------------\n   */\n\n  /**\n   * Method iterating over the graph's adjacency using the given callback.\n   *\n   * @param  {function}  callback - Callback to use.\n   */\n  forEachAdjacencyEntry(callback) {\n    if (typeof callback !== 'function')\n      throw new InvalidArgumentsGraphError(\n        'Graph.forEachAdjacencyEntry: expecting a callback.'\n      );\n\n    forEachAdjacency(false, false, false, this, callback);\n  }\n  forEachAdjacencyEntryWithOrphans(callback) {\n    if (typeof callback !== 'function')\n      throw new InvalidArgumentsGraphError(\n        'Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.'\n      );\n\n    forEachAdjacency(false, false, true, this, callback);\n  }\n\n  /**\n   * Method iterating over the graph's assymetric adjacency using the given callback.\n   *\n   * @param  {function}  callback - Callback to use.\n   */\n  forEachAssymetricAdjacencyEntry(callback) {\n    if (typeof callback !== 'function')\n      throw new InvalidArgumentsGraphError(\n        'Graph.forEachAssymetricAdjacencyEntry: expecting a callback.'\n      );\n\n    forEachAdjacency(false, true, false, this, callback);\n  }\n  forEachAssymetricAdjacencyEntryWithOrphans(callback) {\n    if (typeof callback !== 'function')\n      throw new InvalidArgumentsGraphError(\n        'Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.'\n      );\n\n    forEachAdjacency(false, true, true, this, callback);\n  }\n\n  /**\n   * Method returning the list of the graph's nodes.\n   *\n   * @return {array} - The nodes.\n   */\n  nodes() {\n    return Array.from(this._nodes.keys());\n  }\n\n  /**\n   * Method iterating over the graph's nodes using the given callback.\n   *\n   * @param  {function}  callback - Callback (key, attributes, index).\n   */\n  forEachNode(callback) {\n    if (typeof callback !== 'function')\n      throw new InvalidArgumentsGraphError(\n        'Graph.forEachNode: expecting a callback.'\n      );\n\n    const iterator = this._nodes.values();\n\n    let step, nodeData;\n\n    while (((step = iterator.next()), step.done !== true)) {\n      nodeData = step.value;\n      callback(nodeData.key, nodeData.attributes);\n    }\n  }\n\n  /**\n   * Method iterating attempting to find a node matching the given predicate\n   * function.\n   *\n   * @param  {function}  callback - Callback (key, attributes).\n   */\n  findNode(callback) {\n    if (typeof callback !== 'function')\n      throw new InvalidArgumentsGraphError(\n        'Graph.findNode: expecting a callback.'\n      );\n\n    const iterator = this._nodes.values();\n\n    let step, nodeData;\n\n    while (((step = iterator.next()), step.done !== true)) {\n      nodeData = step.value;\n\n      if (callback(nodeData.key, nodeData.attributes)) return nodeData.key;\n    }\n\n    return;\n  }\n\n  /**\n   * Method mapping nodes.\n   *\n   * @param  {function}  callback - Callback (key, attributes).\n   */\n  mapNodes(callback) {\n    if (typeof callback !== 'function')\n      throw new InvalidArgumentsGraphError(\n        'Graph.mapNode: expecting a callback.'\n      );\n\n    const iterator = this._nodes.values();\n\n    let step, nodeData;\n\n    const result = new Array(this.order);\n    let i = 0;\n\n    while (((step = iterator.next()), step.done !== true)) {\n      nodeData = step.value;\n      result[i++] = callback(nodeData.key, nodeData.attributes);\n    }\n\n    return result;\n  }\n\n  /**\n   * Method returning whether some node verify the given predicate.\n   *\n   * @param  {function}  callback - Callback (key, attributes).\n   */\n  someNode(callback) {\n    if (typeof callback !== 'function')\n      throw new InvalidArgumentsGraphError(\n        'Graph.someNode: expecting a callback.'\n      );\n\n    const iterator = this._nodes.values();\n\n    let step, nodeData;\n\n    while (((step = iterator.next()), step.done !== true)) {\n      nodeData = step.value;\n\n      if (callback(nodeData.key, nodeData.attributes)) return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Method returning whether all node verify the given predicate.\n   *\n   * @param  {function}  callback - Callback (key, attributes).\n   */\n  everyNode(callback) {\n    if (typeof callback !== 'function')\n      throw new InvalidArgumentsGraphError(\n        'Graph.everyNode: expecting a callback.'\n      );\n\n    const iterator = this._nodes.values();\n\n    let step, nodeData;\n\n    while (((step = iterator.next()), step.done !== true)) {\n      nodeData = step.value;\n\n      if (!callback(nodeData.key, nodeData.attributes)) return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Method filtering nodes.\n   *\n   * @param  {function}  callback - Callback (key, attributes).\n   */\n  filterNodes(callback) {\n    if (typeof callback !== 'function')\n      throw new InvalidArgumentsGraphError(\n        'Graph.filterNodes: expecting a callback.'\n      );\n\n    const iterator = this._nodes.values();\n\n    let step, nodeData;\n\n    const result = [];\n\n    while (((step = iterator.next()), step.done !== true)) {\n      nodeData = step.value;\n\n      if (callback(nodeData.key, nodeData.attributes))\n        result.push(nodeData.key);\n    }\n\n    return result;\n  }\n\n  /**\n   * Method reducing nodes.\n   *\n   * @param  {function}  callback - Callback (accumulator, key, attributes).\n   */\n  reduceNodes(callback, initialValue) {\n    if (typeof callback !== 'function')\n      throw new InvalidArgumentsGraphError(\n        'Graph.reduceNodes: expecting a callback.'\n      );\n\n    if (arguments.length < 2)\n      throw new InvalidArgumentsGraphError(\n        'Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.'\n      );\n\n    let accumulator = initialValue;\n\n    const iterator = this._nodes.values();\n\n    let step, nodeData;\n\n    while (((step = iterator.next()), step.done !== true)) {\n      nodeData = step.value;\n      accumulator = callback(accumulator, nodeData.key, nodeData.attributes);\n    }\n\n    return accumulator;\n  }\n\n  /**\n   * Method returning an iterator over the graph's node entries.\n   *\n   * @return {Iterator}\n   */\n  nodeEntries() {\n    const iterator = this._nodes.values();\n\n    return {\n      [Symbol.iterator]() {\n        return this;\n      },\n      next() {\n        const step = iterator.next();\n        if (step.done) return step;\n        const data = step.value;\n        return {\n          value: {node: data.key, attributes: data.attributes},\n          done: false\n        };\n      }\n    };\n  }\n\n  /**---------------------------------------------------------------------------\n   * Serialization\n   **---------------------------------------------------------------------------\n   */\n\n  /**\n   * Method used to export the whole graph.\n   *\n   * @return {object} - The serialized graph.\n   */\n  export() {\n    const nodes = new Array(this._nodes.size);\n\n    let i = 0;\n\n    this._nodes.forEach((data, key) => {\n      nodes[i++] = serializeNode(key, data);\n    });\n\n    const edges = new Array(this._edges.size);\n\n    i = 0;\n\n    this._edges.forEach((data, key) => {\n      edges[i++] = serializeEdge(this.type, key, data);\n    });\n\n    return {\n      options: {\n        type: this.type,\n        multi: this.multi,\n        allowSelfLoops: this.allowSelfLoops\n      },\n      attributes: this.getAttributes(),\n      nodes,\n      edges\n    };\n  }\n\n  /**\n   * Method used to import a serialized graph.\n   *\n   * @param  {object|Graph} data  - The serialized graph.\n   * @param  {boolean}      merge - Whether to merge data.\n   * @return {Graph}              - Returns itself for chaining.\n   */\n  import(data, merge = false) {\n    // Importing a Graph instance directly\n    if (data instanceof Graph) {\n      // Nodes\n      data.forEachNode((n, a) => {\n        if (merge) this.mergeNode(n, a);\n        else this.addNode(n, a);\n      });\n\n      // Edges\n      data.forEachEdge((e, a, s, t, _sa, _ta, u) => {\n        if (merge) {\n          if (u) this.mergeUndirectedEdgeWithKey(e, s, t, a);\n          else this.mergeDirectedEdgeWithKey(e, s, t, a);\n        } else {\n          if (u) this.addUndirectedEdgeWithKey(e, s, t, a);\n          else this.addDirectedEdgeWithKey(e, s, t, a);\n        }\n      });\n\n      return this;\n    }\n\n    // Importing a serialized graph\n    if (!isPlainObject(data))\n      throw new InvalidArgumentsGraphError(\n        'Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.'\n      );\n\n    if (data.attributes) {\n      if (!isPlainObject(data.attributes))\n        throw new InvalidArgumentsGraphError(\n          'Graph.import: invalid attributes. Expecting a plain object.'\n        );\n\n      if (merge) this.mergeAttributes(data.attributes);\n      else this.replaceAttributes(data.attributes);\n    }\n\n    let i, l, list, node, edge;\n\n    if (data.nodes) {\n      list = data.nodes;\n\n      if (!Array.isArray(list))\n        throw new InvalidArgumentsGraphError(\n          'Graph.import: invalid nodes. Expecting an array.'\n        );\n\n      for (i = 0, l = list.length; i < l; i++) {\n        node = list[i];\n\n        // Validating\n        validateSerializedNode(node);\n\n        // Adding the node\n        const {key, attributes} = node;\n\n        if (merge) this.mergeNode(key, attributes);\n        else this.addNode(key, attributes);\n      }\n    }\n\n    if (data.edges) {\n      let undirectedByDefault = false;\n\n      if (this.type === 'undirected') {\n        undirectedByDefault = true;\n      }\n\n      list = data.edges;\n\n      if (!Array.isArray(list))\n        throw new InvalidArgumentsGraphError(\n          'Graph.import: invalid edges. Expecting an array.'\n        );\n\n      for (i = 0, l = list.length; i < l; i++) {\n        edge = list[i];\n\n        // Validating\n        validateSerializedEdge(edge);\n\n        // Adding the edge\n        const {\n          source,\n          target,\n          attributes,\n          undirected = undirectedByDefault\n        } = edge;\n\n        let method;\n\n        if ('key' in edge) {\n          method = merge\n            ? undirected\n              ? this.mergeUndirectedEdgeWithKey\n              : this.mergeDirectedEdgeWithKey\n            : undirected\n            ? this.addUndirectedEdgeWithKey\n            : this.addDirectedEdgeWithKey;\n\n          method.call(this, edge.key, source, target, attributes);\n        } else {\n          method = merge\n            ? undirected\n              ? this.mergeUndirectedEdge\n              : this.mergeDirectedEdge\n            : undirected\n            ? this.addUndirectedEdge\n            : this.addDirectedEdge;\n\n          method.call(this, source, target, attributes);\n        }\n      }\n    }\n\n    return this;\n  }\n\n  /**---------------------------------------------------------------------------\n   * Utils\n   **---------------------------------------------------------------------------\n   */\n\n  /**\n   * Method returning a null copy of the graph, i.e. a graph without nodes\n   * & edges but with the exact same options.\n   *\n   * @param  {object} options - Options to merge with the current ones.\n   * @return {Graph}          - The null copy.\n   */\n  nullCopy(options) {\n    const graph = new Graph(assign({}, this._options, options));\n    graph.replaceAttributes(assign({}, this.getAttributes()));\n    return graph;\n  }\n\n  /**\n   * Method returning an empty copy of the graph, i.e. a graph without edges but\n   * with the exact same options.\n   *\n   * @param  {object} options - Options to merge with the current ones.\n   * @return {Graph}          - The empty copy.\n   */\n  emptyCopy(options) {\n    const graph = this.nullCopy(options);\n\n    this._nodes.forEach((nodeData, key) => {\n      const attributes = assign({}, nodeData.attributes);\n\n      // NOTE: no need to emit events since user cannot access the instance yet\n      nodeData = new graph.NodeDataClass(key, attributes);\n      graph._nodes.set(key, nodeData);\n    });\n\n    return graph;\n  }\n\n  /**\n   * Method returning an exact copy of the graph.\n   *\n   * @param  {object} options - Upgrade options.\n   * @return {Graph}          - The copy.\n   */\n  copy(options) {\n    options = options || {};\n\n    if (\n      typeof options.type === 'string' &&\n      options.type !== this.type &&\n      options.type !== 'mixed'\n    )\n      throw new UsageGraphError(\n        `Graph.copy: cannot create an incompatible copy from \"${this.type}\" type to \"${options.type}\" because this would mean losing information about the current graph.`\n      );\n\n    if (\n      typeof options.multi === 'boolean' &&\n      options.multi !== this.multi &&\n      options.multi !== true\n    )\n      throw new UsageGraphError(\n        'Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.'\n      );\n\n    if (\n      typeof options.allowSelfLoops === 'boolean' &&\n      options.allowSelfLoops !== this.allowSelfLoops &&\n      options.allowSelfLoops !== true\n    )\n      throw new UsageGraphError(\n        'Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.'\n      );\n\n    const graph = this.emptyCopy(options);\n\n    const iterator = this._edges.values();\n\n    let step, edgeData;\n\n    while (((step = iterator.next()), step.done !== true)) {\n      edgeData = step.value;\n\n      // NOTE: no need to emit events since user cannot access the instance yet\n      addEdge(\n        graph,\n        'copy',\n        false,\n        edgeData.undirected,\n        edgeData.key,\n        edgeData.source.key,\n        edgeData.target.key,\n        assign({}, edgeData.attributes)\n      );\n    }\n\n    return graph;\n  }\n\n  /**---------------------------------------------------------------------------\n   * Known methods\n   **---------------------------------------------------------------------------\n   */\n\n  /**\n   * Method used by JavaScript to perform JSON serialization.\n   *\n   * @return {object} - The serialized graph.\n   */\n  toJSON() {\n    return this.export();\n  }\n\n  /**\n   * Method returning [object Graph].\n   */\n  toString() {\n    return '[object Graph]';\n  }\n\n  /**\n   * Method used internally by node's console to display a custom object.\n   *\n   * @return {object} - Formatted object representation of the graph.\n   */\n  inspect() {\n    const nodes = {};\n    this._nodes.forEach((data, key) => {\n      nodes[key] = data.attributes;\n    });\n\n    const edges = {},\n      multiIndex = {};\n\n    this._edges.forEach((data, key) => {\n      const direction = data.undirected ? '--' : '->';\n\n      let label = '';\n\n      let source = data.source.key;\n      let target = data.target.key;\n      let tmp;\n\n      if (data.undirected && source > target) {\n        tmp = source;\n        source = target;\n        target = tmp;\n      }\n\n      const desc = `(${source})${direction}(${target})`;\n\n      if (!key.startsWith('geid_')) {\n        label += `[${key}]: `;\n      } else if (this.multi) {\n        if (typeof multiIndex[desc] === 'undefined') {\n          multiIndex[desc] = 0;\n        } else {\n          multiIndex[desc]++;\n        }\n\n        label += `${multiIndex[desc]}. `;\n      }\n\n      label += desc;\n\n      edges[label] = data.attributes;\n    });\n\n    const dummy = {};\n\n    for (const k in this) {\n      if (\n        this.hasOwnProperty(k) &&\n        !EMITTER_PROPS.has(k) &&\n        typeof this[k] !== 'function' &&\n        typeof k !== 'symbol'\n      )\n        dummy[k] = this[k];\n    }\n\n    dummy.attributes = this._attributes;\n    dummy.nodes = nodes;\n    dummy.edges = edges;\n\n    privateProperty(dummy, 'constructor', this.constructor);\n\n    return dummy;\n  }\n}\n\n/**\n * Attaching methods to the prototype.\n *\n * Here, we are attaching a wide variety of methods to the Graph class'\n * prototype when those are very numerous and when their creation is\n * abstracted.\n */\n\n/**\n * Attaching custom inspect method for node >= 10.\n */\nif (typeof Symbol !== 'undefined')\n  Graph.prototype[Symbol.for('nodejs.util.inspect.custom')] =\n    Graph.prototype.inspect;\n\n/**\n * Related to edge addition.\n */\nEDGE_ADD_METHODS.forEach(method => {\n  ['add', 'merge', 'update'].forEach(verb => {\n    const name = method.name(verb);\n    const fn = verb === 'add' ? addEdge : mergeEdge;\n\n    if (method.generateKey) {\n      Graph.prototype[name] = function (source, target, attributes) {\n        return fn(\n          this,\n          name,\n          true,\n          (method.type || this.type) === 'undirected',\n          null,\n          source,\n          target,\n          attributes,\n          verb === 'update'\n        );\n      };\n    } else {\n      Graph.prototype[name] = function (edge, source, target, attributes) {\n        return fn(\n          this,\n          name,\n          false,\n          (method.type || this.type) === 'undirected',\n          edge,\n          source,\n          target,\n          attributes,\n          verb === 'update'\n        );\n      };\n    }\n  });\n});\n\n/**\n * Attributes-related.\n */\nattachNodeAttributesMethods(Graph);\nattachEdgeAttributesMethods(Graph);\n\n/**\n * Edge iteration-related.\n */\nattachEdgeIterationMethods(Graph);\n\n/**\n * Neighbor iteration-related.\n */\nattachNeighborIterationMethods(Graph);\n\n/**\n * Graphology Helper Classes\n * ==========================\n *\n * Building some higher-order classes instantiating the graph with\n * predefinite options.\n */\n\n/**\n * Alternative constructors.\n */\nclass DirectedGraph extends Graph {\n  constructor(options) {\n    const finalOptions = assign({type: 'directed'}, options);\n\n    if ('multi' in finalOptions && finalOptions.multi !== false)\n      throw new InvalidArgumentsGraphError(\n        'DirectedGraph.from: inconsistent indication that the graph should be multi in given options!'\n      );\n\n    if (finalOptions.type !== 'directed')\n      throw new InvalidArgumentsGraphError(\n        'DirectedGraph.from: inconsistent \"' +\n          finalOptions.type +\n          '\" type in given options!'\n      );\n\n    super(finalOptions);\n  }\n}\nclass UndirectedGraph extends Graph {\n  constructor(options) {\n    const finalOptions = assign({type: 'undirected'}, options);\n\n    if ('multi' in finalOptions && finalOptions.multi !== false)\n      throw new InvalidArgumentsGraphError(\n        'UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!'\n      );\n\n    if (finalOptions.type !== 'undirected')\n      throw new InvalidArgumentsGraphError(\n        'UndirectedGraph.from: inconsistent \"' +\n          finalOptions.type +\n          '\" type in given options!'\n      );\n\n    super(finalOptions);\n  }\n}\nclass MultiGraph extends Graph {\n  constructor(options) {\n    const finalOptions = assign({multi: true}, options);\n\n    if ('multi' in finalOptions && finalOptions.multi !== true)\n      throw new InvalidArgumentsGraphError(\n        'MultiGraph.from: inconsistent indication that the graph should be simple in given options!'\n      );\n\n    super(finalOptions);\n  }\n}\nclass MultiDirectedGraph extends Graph {\n  constructor(options) {\n    const finalOptions = assign({type: 'directed', multi: true}, options);\n\n    if ('multi' in finalOptions && finalOptions.multi !== true)\n      throw new InvalidArgumentsGraphError(\n        'MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!'\n      );\n\n    if (finalOptions.type !== 'directed')\n      throw new InvalidArgumentsGraphError(\n        'MultiDirectedGraph.from: inconsistent \"' +\n          finalOptions.type +\n          '\" type in given options!'\n      );\n\n    super(finalOptions);\n  }\n}\nclass MultiUndirectedGraph extends Graph {\n  constructor(options) {\n    const finalOptions = assign({type: 'undirected', multi: true}, options);\n\n    if ('multi' in finalOptions && finalOptions.multi !== true)\n      throw new InvalidArgumentsGraphError(\n        'MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!'\n      );\n\n    if (finalOptions.type !== 'undirected')\n      throw new InvalidArgumentsGraphError(\n        'MultiUndirectedGraph.from: inconsistent \"' +\n          finalOptions.type +\n          '\" type in given options!'\n      );\n\n    super(finalOptions);\n  }\n}\n\n/**\n * Attaching static #.from method to each of the constructors.\n */\nfunction attachStaticFromMethod(Class) {\n  /**\n   * Builds a graph from serialized data or another graph's data.\n   *\n   * @param  {Graph|SerializedGraph} data      - Hydratation data.\n   * @param  {object}                [options] - Options.\n   * @return {Class}\n   */\n  Class.from = function (data, options) {\n    // Merging given options with serialized ones\n    const finalOptions = assign({}, data.options, options);\n\n    const instance = new Class(finalOptions);\n    instance.import(data);\n\n    return instance;\n  };\n}\n\nattachStaticFromMethod(Graph);\nattachStaticFromMethod(DirectedGraph);\nattachStaticFromMethod(UndirectedGraph);\nattachStaticFromMethod(MultiGraph);\nattachStaticFromMethod(MultiDirectedGraph);\nattachStaticFromMethod(MultiUndirectedGraph);\n\nGraph.Graph = Graph;\nGraph.DirectedGraph = DirectedGraph;\nGraph.UndirectedGraph = UndirectedGraph;\nGraph.MultiGraph = MultiGraph;\nGraph.MultiDirectedGraph = MultiDirectedGraph;\nGraph.MultiUndirectedGraph = MultiUndirectedGraph;\n\nGraph.InvalidArgumentsGraphError = InvalidArgumentsGraphError;\nGraph.NotFoundGraphError = NotFoundGraphError;\nGraph.UsageGraphError = UsageGraphError;\n\n/**\n * Graphology ESM Endoint\n * =======================\n *\n * Endpoint for ESM modules consumers.\n */\n\nexport { DirectedGraph, Graph, InvalidArgumentsGraphError, MultiDirectedGraph, MultiGraph, MultiUndirectedGraph, NotFoundGraphError, UndirectedGraph, UsageGraphError, Graph as default };\n//# sourceMappingURL=graphology.mjs.map\n","/**\n * Graphology isGraph\n * ===================\n *\n * Very simple function aiming at ensuring the given variable is a\n * graphology instance.\n */\n\n/**\n * Checking the value is a graphology instance.\n *\n * @param  {any}     value - Target value.\n * @return {boolean}\n */\nmodule.exports = function isGraph(value) {\n  return (\n    value !== null &&\n    typeof value === 'object' &&\n    typeof value.addUndirectedEdgeWithKey === 'function' &&\n    typeof value.dropNode === 'function' &&\n    typeof value.multi === 'boolean'\n  );\n};\n","/**\n * Graphology Defaults\n * ====================\n *\n * Helper function used throughout the standard lib to resolve defaults.\n */\nfunction isLeaf(o) {\n  return (\n    !o ||\n    typeof o !== 'object' ||\n    typeof o === 'function' ||\n    Array.isArray(o) ||\n    o instanceof Set ||\n    o instanceof Map ||\n    o instanceof RegExp ||\n    o instanceof Date\n  );\n}\n\nfunction resolveDefaults(target, defaults) {\n  target = target || {};\n\n  var output = {};\n\n  for (var k in defaults) {\n    var existing = target[k];\n    var def = defaults[k];\n\n    // Recursion\n    if (!isLeaf(def)) {\n      output[k] = resolveDefaults(existing, def);\n\n      continue;\n    }\n\n    // Leaf\n    if (existing === undefined) {\n      output[k] = def;\n    } else {\n      output[k] = existing;\n    }\n  }\n\n  return output;\n}\n\nmodule.exports = resolveDefaults;\n","/**\n * Mnemonist Typed Array Helpers\n * ==============================\n *\n * Miscellaneous helpers related to typed arrays.\n */\n\n/**\n * When using an unsigned integer array to store pointers, one might want to\n * choose the optimal word size in regards to the actual numbers of pointers\n * to store.\n *\n * This helpers does just that.\n *\n * @param  {number} size - Expected size of the array to map.\n * @return {TypedArray}\n */\nvar MAX_8BIT_INTEGER = Math.pow(2, 8) - 1,\n    MAX_16BIT_INTEGER = Math.pow(2, 16) - 1,\n    MAX_32BIT_INTEGER = Math.pow(2, 32) - 1;\n\nvar MAX_SIGNED_8BIT_INTEGER = Math.pow(2, 7) - 1,\n    MAX_SIGNED_16BIT_INTEGER = Math.pow(2, 15) - 1,\n    MAX_SIGNED_32BIT_INTEGER = Math.pow(2, 31) - 1;\n\nexports.getPointerArray = function(size) {\n  var maxIndex = size - 1;\n\n  if (maxIndex <= MAX_8BIT_INTEGER)\n    return Uint8Array;\n\n  if (maxIndex <= MAX_16BIT_INTEGER)\n    return Uint16Array;\n\n  if (maxIndex <= MAX_32BIT_INTEGER)\n    return Uint32Array;\n\n  throw new Error('mnemonist: Pointer Array of size > 4294967295 is not supported.');\n};\n\nexports.getSignedPointerArray = function(size) {\n  var maxIndex = size - 1;\n\n  if (maxIndex <= MAX_SIGNED_8BIT_INTEGER)\n    return Int8Array;\n\n  if (maxIndex <= MAX_SIGNED_16BIT_INTEGER)\n    return Int16Array;\n\n  if (maxIndex <= MAX_SIGNED_32BIT_INTEGER)\n    return Int32Array;\n\n  return Float64Array;\n};\n\n/**\n * Function returning the minimal type able to represent the given number.\n *\n * @param  {number} value - Value to test.\n * @return {TypedArrayClass}\n */\nexports.getNumberType = function(value) {\n\n  // <= 32 bits itnteger?\n  if (value === (value | 0)) {\n\n    // Negative\n    if (Math.sign(value) === -1) {\n      if (value <= 127 && value >= -128)\n        return Int8Array;\n\n      if (value <= 32767 && value >= -32768)\n        return Int16Array;\n\n      return Int32Array;\n    }\n    else {\n\n      if (value <= 255)\n        return Uint8Array;\n\n      if (value <= 65535)\n        return Uint16Array;\n\n      return Uint32Array;\n    }\n  }\n\n  // 53 bits integer & floats\n  // NOTE: it's kinda hard to tell whether we could use 32bits or not...\n  return Float64Array;\n};\n\n/**\n * Function returning the minimal type able to represent the given array\n * of JavaScript numbers.\n *\n * @param  {array}    array  - Array to represent.\n * @param  {function} getter - Optional getter.\n * @return {TypedArrayClass}\n */\nvar TYPE_PRIORITY = {\n  Uint8Array: 1,\n  Int8Array: 2,\n  Uint16Array: 3,\n  Int16Array: 4,\n  Uint32Array: 5,\n  Int32Array: 6,\n  Float32Array: 7,\n  Float64Array: 8\n};\n\n// TODO: make this a one-shot for one value\nexports.getMinimalRepresentation = function(array, getter) {\n  var maxType = null,\n      maxPriority = 0,\n      p,\n      t,\n      v,\n      i,\n      l;\n\n  for (i = 0, l = array.length; i < l; i++) {\n    v = getter ? getter(array[i]) : array[i];\n    t = exports.getNumberType(v);\n    p = TYPE_PRIORITY[t.name];\n\n    if (p > maxPriority) {\n      maxPriority = p;\n      maxType = t;\n    }\n  }\n\n  return maxType;\n};\n\n/**\n * Function returning whether the given value is a typed array.\n *\n * @param  {any} value - Value to test.\n * @return {boolean}\n */\nexports.isTypedArray = function(value) {\n  return typeof ArrayBuffer !== 'undefined' && ArrayBuffer.isView(value);\n};\n\n/**\n * Function used to concat byte arrays.\n *\n * @param  {...ByteArray}\n * @return {ByteArray}\n */\nexports.concat = function() {\n  var length = 0,\n      i,\n      o,\n      l;\n\n  for (i = 0, l = arguments.length; i < l; i++)\n    length += arguments[i].length;\n\n  var array = new (arguments[0].constructor)(length);\n\n  for (i = 0, o = 0; i < l; i++) {\n    array.set(arguments[i], o);\n    o += arguments[i].length;\n  }\n\n  return array;\n};\n\n/**\n * Function used to initialize a byte array of indices.\n *\n * @param  {number}    length - Length of target.\n * @return {ByteArray}\n */\nexports.indices = function(length) {\n  var PointerArray = exports.getPointerArray(length);\n\n  var array = new PointerArray(length);\n\n  for (var i = 0; i < length; i++)\n    array[i] = i;\n\n  return array;\n};\n","/**\n * Graphology Weight Getter\n * =========================\n *\n * Function creating weight getters.\n */\nfunction coerceWeight(value) {\n  // Ensuring target value is a correct number\n  if (typeof value !== 'number' || isNaN(value)) return 1;\n\n  return value;\n}\n\nfunction createNodeValueGetter(nameOrFunction, defaultValue) {\n  var getter = {};\n\n  var coerceToDefault = function (v) {\n    if (typeof v === 'undefined') return defaultValue;\n\n    return v;\n  };\n\n  if (typeof defaultValue === 'function') coerceToDefault = defaultValue;\n\n  var get = function (attributes) {\n    return coerceToDefault(attributes[nameOrFunction]);\n  };\n\n  var returnDefault = function () {\n    return coerceToDefault(undefined);\n  };\n\n  if (typeof nameOrFunction === 'string') {\n    getter.fromAttributes = get;\n    getter.fromGraph = function (graph, node) {\n      return get(graph.getNodeAttributes(node));\n    };\n    getter.fromEntry = function (node, attributes) {\n      return get(attributes);\n    };\n  } else if (typeof nameOrFunction === 'function') {\n    getter.fromAttributes = function () {\n      throw new Error(\n        'graphology-utils/getters/createNodeValueGetter: irrelevant usage.'\n      );\n    };\n    getter.fromGraph = function (graph, node) {\n      return coerceToDefault(\n        nameOrFunction(node, graph.getNodeAttributes(node))\n      );\n    };\n    getter.fromEntry = function (node, attributes) {\n      return coerceToDefault(nameOrFunction(node, attributes));\n    };\n  } else {\n    getter.fromAttributes = returnDefault;\n    getter.fromGraph = returnDefault;\n    getter.fromEntry = returnDefault;\n  }\n\n  return getter;\n}\n\nfunction createEdgeValueGetter(nameOrFunction, defaultValue) {\n  var getter = {};\n\n  var coerceToDefault = function (v) {\n    if (typeof v === 'undefined') return defaultValue;\n\n    return v;\n  };\n\n  if (typeof defaultValue === 'function') coerceToDefault = defaultValue;\n\n  var get = function (attributes) {\n    return coerceToDefault(attributes[nameOrFunction]);\n  };\n\n  var returnDefault = function () {\n    return coerceToDefault(undefined);\n  };\n\n  if (typeof nameOrFunction === 'string') {\n    getter.fromAttributes = get;\n    getter.fromGraph = function (graph, edge) {\n      return get(graph.getEdgeAttributes(edge));\n    };\n    getter.fromEntry = function (edge, attributes) {\n      return get(attributes);\n    };\n    getter.fromPartialEntry = getter.fromEntry;\n    getter.fromMinimalEntry = getter.fromEntry;\n  } else if (typeof nameOrFunction === 'function') {\n    getter.fromAttributes = function () {\n      throw new Error(\n        'graphology-utils/getters/createEdgeValueGetter: irrelevant usage.'\n      );\n    };\n    getter.fromGraph = function (graph, edge) {\n      // TODO: we can do better, check #310\n      var extremities = graph.extremities(edge);\n      return coerceToDefault(\n        nameOrFunction(\n          edge,\n          graph.getEdgeAttributes(edge),\n          extremities[0],\n          extremities[1],\n          graph.getNodeAttributes(extremities[0]),\n          graph.getNodeAttributes(extremities[1]),\n          graph.isUndirected(edge)\n        )\n      );\n    };\n    getter.fromEntry = function (e, a, s, t, sa, ta, u) {\n      return coerceToDefault(nameOrFunction(e, a, s, t, sa, ta, u));\n    };\n    getter.fromPartialEntry = function (e, a, s, t) {\n      return coerceToDefault(nameOrFunction(e, a, s, t));\n    };\n    getter.fromMinimalEntry = function (e, a) {\n      return coerceToDefault(nameOrFunction(e, a));\n    };\n  } else {\n    getter.fromAttributes = returnDefault;\n    getter.fromGraph = returnDefault;\n    getter.fromEntry = returnDefault;\n    getter.fromMinimalEntry = returnDefault;\n  }\n\n  return getter;\n}\n\nexports.createNodeValueGetter = createNodeValueGetter;\nexports.createEdgeValueGetter = createEdgeValueGetter;\nexports.createEdgeWeightGetter = function (name) {\n  return createEdgeValueGetter(name, coerceWeight);\n};\n","/**\n * Graphology Neighborhood Indices\n * ================================\n */\nvar typed = require('mnemonist/utils/typed-arrays');\nvar createEdgeWeightGetter =\n  require('graphology-utils/getters').createEdgeWeightGetter;\n\nfunction upperBoundPerMethod(method, graph) {\n  if (method === 'outbound' || method === 'inbound')\n    return graph.directedSize + graph.undirectedSize * 2;\n\n  if (method === 'in' || method === 'out' || method === 'directed')\n    return graph.directedSize;\n\n  return graph.undirectedSize * 2;\n}\n\nfunction NeighborhoodIndex(graph, method) {\n  method = method || 'outbound';\n  var getNeighbors = graph[method + 'Neighbors'].bind(graph);\n\n  var upperBound = upperBoundPerMethod(method, graph);\n\n  var NeighborhoodPointerArray = typed.getPointerArray(upperBound);\n  var NodesPointerArray = typed.getPointerArray(graph.order);\n\n  // NOTE: directedSize + undirectedSize * 2 is an upper bound for\n  // neighborhood size\n  this.graph = graph;\n  this.neighborhood = new NodesPointerArray(upperBound);\n\n  this.starts = new NeighborhoodPointerArray(graph.order + 1);\n\n  this.nodes = graph.nodes();\n\n  var ids = {};\n\n  var i, l, j, m, node, neighbors;\n\n  var n = 0;\n\n  for (i = 0, l = graph.order; i < l; i++) ids[this.nodes[i]] = i;\n\n  for (i = 0, l = graph.order; i < l; i++) {\n    node = this.nodes[i];\n    neighbors = getNeighbors(node);\n\n    this.starts[i] = n;\n\n    for (j = 0, m = neighbors.length; j < m; j++)\n      this.neighborhood[n++] = ids[neighbors[j]];\n  }\n\n  // NOTE: we keep one more index as upper bound to simplify iteration\n  this.starts[i] = upperBound;\n}\n\nNeighborhoodIndex.prototype.bounds = function (i) {\n  return [this.starts[i], this.starts[i + 1]];\n};\n\nNeighborhoodIndex.prototype.project = function () {\n  var self = this;\n\n  var projection = {};\n\n  self.nodes.forEach(function (node, i) {\n    projection[node] = Array.from(\n      self.neighborhood.slice(self.starts[i], self.starts[i + 1])\n    ).map(function (j) {\n      return self.nodes[j];\n    });\n  });\n\n  return projection;\n};\n\nNeighborhoodIndex.prototype.collect = function (results) {\n  var i, l;\n\n  var o = {};\n\n  for (i = 0, l = results.length; i < l; i++) o[this.nodes[i]] = results[i];\n\n  return o;\n};\n\nNeighborhoodIndex.prototype.assign = function (prop, results) {\n  var i = 0;\n\n  this.graph.updateEachNodeAttributes(\n    function (_, attr) {\n      attr[prop] = results[i++];\n\n      return attr;\n    },\n    {attributes: [prop]}\n  );\n};\n\nexports.NeighborhoodIndex = NeighborhoodIndex;\n\nfunction WeightedNeighborhoodIndex(graph, getEdgeWeight, method) {\n  method = method || 'outbound';\n  var getEdges = graph[method + 'Edges'].bind(graph);\n\n  var upperBound = upperBoundPerMethod(method, graph);\n\n  var NeighborhoodPointerArray = typed.getPointerArray(upperBound);\n  var NodesPointerArray = typed.getPointerArray(graph.order);\n\n  var weightGetter = createEdgeWeightGetter(getEdgeWeight).fromMinimalEntry;\n\n  // NOTE: directedSize + undirectedSize * 2 is an upper bound for\n  // neighborhood size\n  this.graph = graph;\n  this.neighborhood = new NodesPointerArray(upperBound);\n  this.weights = new Float64Array(upperBound);\n  this.outDegrees = new Float64Array(graph.order);\n\n  this.starts = new NeighborhoodPointerArray(graph.order + 1);\n\n  this.nodes = graph.nodes();\n\n  var ids = {};\n\n  var i, l, j, m, node, neighbor, edges, edge, weight;\n\n  var n = 0;\n\n  for (i = 0, l = graph.order; i < l; i++) ids[this.nodes[i]] = i;\n\n  for (i = 0, l = graph.order; i < l; i++) {\n    node = this.nodes[i];\n    edges = getEdges(node);\n\n    this.starts[i] = n;\n\n    for (j = 0, m = edges.length; j < m; j++) {\n      edge = edges[j];\n      neighbor = graph.opposite(node, edge);\n      weight = weightGetter(edge, graph.getEdgeAttributes(edge));\n\n      // NOTE: for weighted mixed beware of merging weights if twice the same neighbor\n      this.neighborhood[n] = ids[neighbor];\n      this.weights[n++] = weight;\n      this.outDegrees[i] += weight;\n    }\n  }\n\n  // NOTE: we keep one more index as upper bound to simplify iteration\n  this.starts[i] = upperBound;\n}\n\nWeightedNeighborhoodIndex.prototype.bounds = NeighborhoodIndex.prototype.bounds;\nWeightedNeighborhoodIndex.prototype.project =\n  NeighborhoodIndex.prototype.project;\nWeightedNeighborhoodIndex.prototype.collect =\n  NeighborhoodIndex.prototype.collect;\nWeightedNeighborhoodIndex.prototype.assign = NeighborhoodIndex.prototype.assign;\n\nexports.WeightedNeighborhoodIndex = WeightedNeighborhoodIndex;\n","/**\n * Graphology Pagerank\n * ====================\n *\n * JavaScript implementation of the pagerank algorithm for graphology.\n *\n * [Reference]:\n * Page, Lawrence; Brin, Sergey; Motwani, Rajeev and Winograd, Terry,\n * The PageRank citation ranking: Bringing order to the Web. 1999\n */\nvar isGraph = require('graphology-utils/is-graph');\nvar resolveDefaults = require('graphology-utils/defaults');\nvar WeightedNeighborhoodIndex =\n  require('graphology-indices/neighborhood').WeightedNeighborhoodIndex;\n\n/**\n * Defaults.\n */\nvar DEFAULTS = {\n  nodePagerankAttribute: 'pagerank',\n  getEdgeWeight: 'weight',\n  alpha: 0.85,\n  maxIterations: 100,\n  tolerance: 1e-6\n};\n\n/**\n * Abstract function applying the pagerank algorithm to the given graph.\n *\n * @param  {boolean}  assign        - Should we assign the result to nodes.\n * @param  {Graph}    graph         - Target graph.\n * @param  {?object}  option        - Options:\n * @param  {?object}    attributes  - Custom attribute names:\n * @param  {?string}      pagerank  - Name of the pagerank attribute to assign.\n * @param  {?string}      weight    - Name of the weight algorithm.\n * @param  {?number}  alpha         - Damping parameter.\n * @param  {?number}  maxIterations - Maximum number of iterations to perform.\n * @param  {?number}  tolerance     - Error tolerance when checking for convergence.\n * @param  {?boolean} weighted      - Should we use the graph's weights.\n * @return {object|undefined}\n */\nfunction abstractPagerank(assign, graph, options) {\n  if (!isGraph(graph))\n    throw new Error(\n      'graphology-metrics/centrality/pagerank: the given graph is not a valid graphology instance.'\n    );\n\n  options = resolveDefaults(options, DEFAULTS);\n\n  var alpha = options.alpha;\n  var maxIterations = options.maxIterations;\n  var tolerance = options.tolerance;\n\n  var pagerankAttribute = options.nodePagerankAttribute;\n\n  var N = graph.order;\n  var p = 1 / N;\n\n  var index = new WeightedNeighborhoodIndex(graph, options.getEdgeWeight);\n\n  var i, j, l, d;\n\n  var x = new Float64Array(graph.order);\n\n  // Normalizing edge weights & indexing dangling nodes\n  var normalizedEdgeWeights = new Float64Array(index.weights.length);\n  var danglingNodes = [];\n\n  for (i = 0; i < N; i++) {\n    x[i] = p;\n    l = index.starts[i + 1];\n    d = index.outDegrees[i];\n\n    if (d === 0) danglingNodes.push(i);\n\n    for (j = index.starts[i]; j < l; j++) {\n      normalizedEdgeWeights[j] = index.weights[j] / d;\n    }\n  }\n\n  // Power iterations\n  var iteration = 0;\n  var error = 0;\n  var dangleSum, neighbor, xLast;\n  var converged = false;\n\n  while (iteration < maxIterations) {\n    xLast = x;\n    x = new Float64Array(graph.order); // TODO: it should be possible to swap two arrays to avoid allocations (bench)\n\n    dangleSum = 0;\n\n    for (i = 0, l = danglingNodes.length; i < l; i++)\n      dangleSum += xLast[danglingNodes[i]];\n\n    dangleSum *= alpha;\n\n    for (i = 0; i < N; i++) {\n      l = index.starts[i + 1];\n\n      for (j = index.starts[i]; j < l; j++) {\n        neighbor = index.neighborhood[j];\n        x[neighbor] += alpha * xLast[i] * normalizedEdgeWeights[j];\n      }\n\n      x[i] += dangleSum * p + (1 - alpha) * p;\n    }\n\n    // Checking convergence\n    error = 0;\n\n    for (i = 0; i < N; i++) {\n      error += Math.abs(x[i] - xLast[i]);\n    }\n\n    if (error < N * tolerance) {\n      converged = true;\n      break;\n    }\n\n    iteration++;\n  }\n\n  if (!converged)\n    throw Error('graphology-metrics/centrality/pagerank: failed to converge.');\n\n  if (assign) {\n    index.assign(pagerankAttribute, x);\n    return;\n  }\n\n  return index.collect(x);\n}\n\n/**\n * Exporting.\n */\nvar pagerank = abstractPagerank.bind(null, false);\npagerank.assign = abstractPagerank.bind(null, true);\n\nmodule.exports = pagerank;\n","/**\r\n * Transforms raw graph data from the database into a styled, de-duplicated,\r\n * and display-ready format. Handles tier assignment, edge styling,\r\n * Person/Contact merging, and parallel-edge curvature offsets.\r\n *\r\n * Also provides `toSigmaGraph()` to convert the internal GraphNode/GraphEdge\r\n * arrays into a Graphology Graph for Sigma.js rendering.\r\n */\r\nimport { GraphNode, GraphEdge } from '@/types/graph';\r\n\r\n// ---------------------------------------------------------------------------\r\n// CONFIGURATION MAPS (Rule 4.1 & 4.2)\r\n// ---------------------------------------------------------------------------\r\n\r\n// Tier Configuration (0 = Center/Project, 1 = Entities, 2 = Details)\r\nexport const TIER_CONFIG: Record<string, number> = {\r\n    'Project': 0,\r\n    'Company': 0,\r\n    // Tier 1\r\n    'Person': 1,\r\n    'Team': 1,\r\n    'Sprint': 1,\r\n    'Document': 1,\r\n    'Email': 1,\r\n    'CalendarEvent': 1,\r\n    'Contact': 1,\r\n    // Tier 2\r\n    'Risk': 2,\r\n    'Action': 2,\r\n    'Fact': 2,\r\n    'Decision': 2,\r\n    'Question': 2,\r\n    'UserStory': 2,\r\n    'Task': 2\r\n};\r\n\r\n// Node Dimensions by Type\r\nexport const NODE_DIMENSIONS: Record<string, { w: number, h: number }> = {\r\n    'Project': { w: 280, h: 120 },\r\n    'Company': { w: 260, h: 100 },\r\n    'Document': { w: 220, h: 90 },\r\n    'Person': { w: 200, h: 80 },\r\n    'Contact': { w: 200, h: 85 },\r\n    'Team': { w: 220, h: 85 },\r\n    'Sprint': { w: 200, h: 65 },\r\n    'Email': { w: 220, h: 80 },\r\n    'CalendarEvent': { w: 210, h: 80 },\r\n    'Fact': { w: 200, h: 80 },\r\n    'Decision': { w: 200, h: 80 },\r\n    'Risk': { w: 210, h: 95 },\r\n    'Action': { w: 220, h: 90 },\r\n    'Question': { w: 200, h: 75 },\r\n    'UserStory': { w: 210, h: 80 },\r\n    'Task': { w: 220, h: 90 },\r\n    // Default fallback\r\n    'default': { w: 200, h: 80 }\r\n};\r\n\r\n// Edge Styles by Type (Rule 4)\r\nconst EDGE_STYLES: Record<string, { stroke: string, width: number, opacity: number, dash?: string }> = {\r\n    // Structural\r\n    'BELONGS_TO_PROJECT': { stroke: '#cbd5e1', width: 1, opacity: 0.0, dash: '5 5' },\r\n    'BELONGS_TO_COMPANY': { stroke: '#0d9488', width: 1.5, opacity: 0.6, dash: '4 4' },\r\n    // Extraction/Workflow\r\n    'EXTRACTED_FROM': { stroke: '#f59e0b', width: 2, opacity: 0.8 }, // amber-500\r\n    'IMPLEMENTS': { stroke: '#3b82f6', width: 2, opacity: 0.9 }, // blue-500\r\n    'DEPENDS_ON': { stroke: '#3b82f6', width: 2, opacity: 0.9 },\r\n    // Attribution\r\n    'ASSIGNED_TO': { stroke: '#10b981', width: 1.5, opacity: 0.7 }, // emerald-500\r\n    'OWNS': { stroke: '#22c55e', width: 2.5, opacity: 0.9 }, // green-500, prominent\r\n    'OWNED_BY': { stroke: '#10b981', width: 1.5, opacity: 0.7 },\r\n    'AUTHORED_BY': { stroke: '#10b981', width: 1.5, opacity: 0.7 },\r\n    // People\r\n    'MEMBER_OF_TEAM': { stroke: '#a855f7', width: 1.5, opacity: 0.7 }, // purple-500\r\n    'MEMBER_OF': { stroke: '#a855f7', width: 2, opacity: 0.8 }, // purple-500\r\n    'PART_OF': { stroke: '#8b5cf6', width: 2, opacity: 0.8 }, // violet-500\r\n    'WORKS_WITH': { stroke: '#4ade80', width: 1, opacity: 0.4 }, // green-400, thinner, transparent\r\n    'IS_CONTACT_OF': { stroke: '#22d3ee', width: 1.5, opacity: 0.6, dash: '4 4' }, // cyan-400\r\n    'WORKS_AT': { stroke: '#0d9488', width: 1.5, opacity: 0.7 }, // teal-600\r\n    // Semantic\r\n    'SIMILAR_TO': { stroke: '#facc15', width: 1, opacity: 0.5, dash: '4 4' }, // yellow-400\r\n    // Hierarchy\r\n    'REPORTS_TO': { stroke: '#22c55e', width: 1.5, opacity: 0.7 }, // green-500\r\n    'MANAGES': { stroke: '#22c55e', width: 1.5, opacity: 0.7 },\r\n    'LEADS_TEAM': { stroke: '#a855f7', width: 2, opacity: 0.8 }, // purple-500\r\n    'PARENT_OF': { stroke: '#3b82f6', width: 1.5, opacity: 0.7 }, // blue-500\r\n    // Planning\r\n    'PLANNED_IN': { stroke: '#6366f1', width: 1.5, opacity: 0.7 }, // indigo-500\r\n    // Communication\r\n    'SENT_BY': { stroke: '#94a3b8', width: 1.5, opacity: 0.7 }, // slate-400\r\n    'SENT_TO': { stroke: '#94a3b8', width: 1.5, opacity: 0.7 },\r\n    'MENTIONS': { stroke: '#f59e0b', width: 1.5, opacity: 0.8 }, // amber-500\r\n    'INVOLVES': { stroke: '#06b6d4', width: 1.5, opacity: 0.8 }, // cyan-500\r\n    'LINKED_TO': { stroke: '#a855f7', width: 1.5, opacity: 0.7 }, // purple-500\r\n    'DERIVED_FROM': { stroke: '#94a3b8', width: 1.5, opacity: 0.7 }, // slate-400\r\n    'REPLY_TO': { stroke: '#94a3b8', width: 1, opacity: 0.5, dash: '3 3' }, // slate-400\r\n    'HAS_ATTACHMENT': { stroke: '#f59e0b', width: 1, opacity: 0.6, dash: '3 3' }, // amber-500\r\n    // Default\r\n    'default': { stroke: '#64748b', width: 1, opacity: 0.5 } // slate-500\r\n};\r\n\r\n// Canonical hex colors for each node type (used by MiniMap, legend, filter badges)\r\nexport const NODE_COLORS: Record<string, string> = {\r\n    'Project': '#6366f1', 'Company': '#0d9488', 'Person': '#22c55e',\r\n    'Contact': '#14b8a6', 'Team': '#a855f7', 'Sprint': '#6366f1',\r\n    'Document': '#f59e0b', 'Email': '#64748b', 'CalendarEvent': '#06b6d4',\r\n    'Risk': '#ef4444', 'Action': '#22c55e', 'Task': '#10b981',\r\n    'Fact': '#0ea5e9', 'Decision': '#f97316', 'Question': '#8b5cf6',\r\n    'UserStory': '#ec4899', 'Meeting': '#06b6d4', 'Technology': '#3b82f6',\r\n    'Answer': '#10b981', 'Briefing': '#6366f1', 'Client': '#1abc9c',\r\n    'Conversation': '#9c27b0', 'Organization': '#8e44ad',\r\n    'Regulation': '#e74c3c',\r\n};\r\n\r\n// ---------------------------------------------------------------------------\r\n// TRANSFORM LOGIC\r\n// ---------------------------------------------------------------------------\r\n\r\n// Edges that should NEVER be rendered to prevent hairball\r\nconst HIDDEN_EDGE_TYPES = new Set([\r\n    'WORKS_WITH',\r\n    'BELONGS_TO_PROJECT',\r\n]);\r\n\r\n/**\r\n * Transforms raw graph nodes and edges into styled, de-duplicated structures.\r\n * Handles Person/Contact merging, tier assignment, edge styling, and edge bundling.\r\n */\r\nexport function transformGraphData(rawNodes: GraphNode[], rawEdges: GraphEdge[]) {\r\n\r\n    // ---------------------------------------------------------------------------\r\n    // -1. PRE-PASS: De-duplicate prefixed IDs (e.g. \"person_UUID\" vs \"UUID\")\r\n    //     Old sync runs may have created nodes with label-prefixed IDs. We keep\r\n    //     the *canonical* plain-UUID node and redirect all edges from the\r\n    //     prefixed duplicate to the canonical one.\r\n    // ---------------------------------------------------------------------------\r\n    const LABEL_PREFIXES = ['person_', 'contact_', 'document_', 'fact_', 'decision_', 'risk_', 'question_', 'team_', 'action_', 'sprint_', 'email_', 'calendarevent_', 'userstory_', 'task_', 'company_'];\r\n\r\n    const nodeIdSet = new Set(rawNodes.map(n => n.id));\r\n    const prefixRedirectMap = new Map<string, string>();\r\n    const prefixedIdsToRemove = new Set<string>();\r\n\r\n    for (const node of rawNodes) {\r\n        const id = node.id;\r\n        for (const prefix of LABEL_PREFIXES) {\r\n            if (id.startsWith(prefix)) {\r\n                const strippedId = id.slice(prefix.length);\r\n                if (nodeIdSet.has(strippedId)) {\r\n                    prefixRedirectMap.set(id, strippedId);\r\n                    prefixedIdsToRemove.add(id);\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    const deduplicatedNodes = rawNodes.filter(n => !prefixedIdsToRemove.has(n.id));\r\n\r\n    // ---------------------------------------------------------------------------\r\n    // 0. Person / Contact merging\r\n    // ---------------------------------------------------------------------------\r\n    const personToContactMap = new Map<string, string>();\r\n    const contactLinkedPersonIds = new Set<string>();\r\n    const nameToContactMap = new Map<string, string>();\r\n    const normalize = (s: string) => s?.trim().toLowerCase() || '';\r\n\r\n    deduplicatedNodes.forEach(node => {\r\n        if (node.label === 'Contact') {\r\n            const contactId = node.id;\r\n            if (node.data.linked_person_id) {\r\n                contactLinkedPersonIds.add(node.data.linked_person_id);\r\n                personToContactMap.set(node.data.linked_person_id, contactId);\r\n            }\r\n            if (node.data.name) nameToContactMap.set(normalize(node.data.name), contactId);\r\n            if (node.data.label) nameToContactMap.set(normalize(node.data.label), contactId);\r\n            if (Array.isArray(node.data.aliases)) {\r\n                node.data.aliases.forEach((alias: string) => {\r\n                    if (alias) nameToContactMap.set(normalize(alias), contactId);\r\n                });\r\n            }\r\n        }\r\n    });\r\n\r\n    // Also merge Person nodes that share the same normalised name (keeps first)\r\n    const seenPersonNames = new Map<string, string>();\r\n\r\n    // 1. Process Nodes\r\n    const nodes: GraphNode[] = [];\r\n    const processedPersonIds = new Set<string>();\r\n\r\n    deduplicatedNodes.forEach(node => {\r\n        if (node.label === 'Person') {\r\n            let shouldMerge = false;\r\n            let targetId = '';\r\n\r\n            if (contactLinkedPersonIds.has(node.id)) {\r\n                shouldMerge = true;\r\n                targetId = personToContactMap.get(node.id)!;\r\n            } else {\r\n                const normalizedLabel = normalize(node.data.label || node.data.name);\r\n                if (nameToContactMap.has(normalizedLabel)) {\r\n                    shouldMerge = true;\r\n                    targetId = nameToContactMap.get(normalizedLabel)!;\r\n                    personToContactMap.set(node.id, targetId);\r\n                } else if (normalizedLabel && seenPersonNames.has(normalizedLabel)) {\r\n                    shouldMerge = true;\r\n                    targetId = seenPersonNames.get(normalizedLabel)!;\r\n                    personToContactMap.set(node.id, targetId);\r\n                }\r\n            }\r\n\r\n            if (shouldMerge) {\r\n                processedPersonIds.add(node.id);\r\n                return;\r\n            }\r\n\r\n            const nn = normalize(node.data.label || node.data.name);\r\n            if (nn) seenPersonNames.set(nn, node.id);\r\n        }\r\n\r\n        const type = node.label || 'default';\r\n        const tier = TIER_CONFIG[type] ?? 2;\r\n        const dims = NODE_DIMENSIONS[type] ?? NODE_DIMENSIONS['default'];\r\n\r\n        nodes.push({\r\n            ...node,\r\n            width: dims.w,\r\n            height: dims.h,\r\n            data: {\r\n                ...node.data,\r\n                tier,\r\n                label: node.data.label || node.label,\r\n                _display: {\r\n                    width: dims.w,\r\n                    height: dims.h,\r\n                    colorToken: getNodeColorToken(type)\r\n                }\r\n            }\r\n        });\r\n    });\r\n\r\n    // Build a set of valid node IDs so we can drop orphan edges\r\n    const validNodeIds = new Set(nodes.map(n => n.id));\r\n\r\n    // Helper: resolve an edge endpoint through all redirect maps\r\n    const resolveId = (id: string): string => {\r\n        if (prefixRedirectMap.has(id)) id = prefixRedirectMap.get(id)!;\r\n        if (personToContactMap.has(id)) id = personToContactMap.get(id)!;\r\n        return id;\r\n    };\r\n\r\n    // 2. Filter & Process Edges\r\n    const processedEdges: GraphEdge[] = [];\r\n\r\n    rawEdges.forEach(edge => {\r\n        if (HIDDEN_EDGE_TYPES.has(edge.label || '')) return;\r\n\r\n        let source = resolveId(edge.source);\r\n        let target = resolveId(edge.target);\r\n\r\n        if (source === target) return;\r\n        if (!validNodeIds.has(source) || !validNodeIds.has(target)) return;\r\n\r\n        const styleConfig = EDGE_STYLES[edge.label || ''] || EDGE_STYLES['default'];\r\n\r\n        processedEdges.push({\r\n            ...edge,\r\n            id: edge.id || `${source}-${target}-${edge.label}`,\r\n            source,\r\n            target,\r\n            type: 'default',\r\n            style: {\r\n                stroke: styleConfig.stroke,\r\n                strokeWidth: styleConfig.width,\r\n                opacity: styleConfig.opacity,\r\n                strokeDasharray: styleConfig.dash\r\n            },\r\n            animated: edge.label === 'SIMILAR_TO' || edge.label === 'DEPENDS_ON' || edge.label === 'INVOLVES',\r\n            data: {\r\n                ...edge.data,\r\n                originalLabel: edge.label\r\n            },\r\n            label: undefined\r\n        });\r\n    });\r\n\r\n    // 3. Enrich Team nodes with computed member counts from edges\r\n    const MEMBERSHIP_EDGES = new Set(['MEMBER_OF_TEAM', 'MEMBER_OF', 'PART_OF', 'LEADS_TEAM']);\r\n    const teamNodeIds = new Set(nodes.filter(n => n.label === 'Team').map(n => n.id));\r\n    if (teamNodeIds.size > 0) {\r\n        const teamMemberCounts = new Map<string, number>();\r\n        for (const edge of processedEdges) {\r\n            if (!MEMBERSHIP_EDGES.has(edge.data?.originalLabel || edge.label || '')) continue;\r\n            if (teamNodeIds.has(edge.target)) {\r\n                teamMemberCounts.set(edge.target, (teamMemberCounts.get(edge.target) || 0) + 1);\r\n            }\r\n            if (teamNodeIds.has(edge.source)) {\r\n                teamMemberCounts.set(edge.source, (teamMemberCounts.get(edge.source) || 0) + 1);\r\n            }\r\n        }\r\n        // Also count from ALL raw edges (including hidden ones) so we don't miss members\r\n        for (const edge of rawEdges) {\r\n            if (!MEMBERSHIP_EDGES.has(edge.label || '')) continue;\r\n            const src = resolveId(edge.source);\r\n            const tgt = resolveId(edge.target);\r\n            if (teamNodeIds.has(tgt) && !teamMemberCounts.has(tgt)) {\r\n                teamMemberCounts.set(tgt, (teamMemberCounts.get(tgt) || 0) + 1);\r\n            }\r\n            if (teamNodeIds.has(src) && !teamMemberCounts.has(src)) {\r\n                teamMemberCounts.set(src, (teamMemberCounts.get(src) || 0) + 1);\r\n            }\r\n        }\r\n        for (const node of nodes) {\r\n            if (node.label === 'Team' && teamMemberCounts.has(node.id)) {\r\n                node.data = { ...node.data, memberCount: teamMemberCounts.get(node.id)! };\r\n            }\r\n        }\r\n    }\r\n\r\n    // 4. Compute curvature offsets for parallel edges between the same node pair\r\n    const pairCounts = new Map<string, number>();\r\n    const pairIndex = new Map<string, number>();\r\n    for (const edge of processedEdges) {\r\n        const pairKey = [edge.source, edge.target].sort().join('__');\r\n        pairCounts.set(pairKey, (pairCounts.get(pairKey) || 0) + 1);\r\n    }\r\n    for (const edge of processedEdges) {\r\n        const pairKey = [edge.source, edge.target].sort().join('__');\r\n        const total = pairCounts.get(pairKey) || 1;\r\n        if (total > 1) {\r\n            const idx = pairIndex.get(pairKey) || 0;\r\n            pairIndex.set(pairKey, idx + 1);\r\n            const offset = (idx - (total - 1) / 2) * 0.3;\r\n            edge.data = { ...edge.data, curvature: offset };\r\n        }\r\n    }\r\n\r\n    return { nodes, edges: processedEdges };\r\n}\r\n\r\n/** Maps a node type to a Tailwind colour token name for consistent theming. */\r\nexport function getNodeColorToken(type: string): string {\r\n    switch (type) {\r\n        case 'Project': return 'blue';\r\n        case 'Company': return 'teal';\r\n        case 'Person': return 'green';\r\n        case 'Contact': return 'teal';\r\n        case 'Team': return 'purple';\r\n        case 'Sprint': return 'indigo';\r\n        case 'Document': return 'amber';\r\n        case 'Risk': return 'red';\r\n        case 'Action': return 'emerald';\r\n        case 'Fact': return 'sky';\r\n        case 'Decision': return 'orange';\r\n        case 'Question': return 'violet';\r\n        case 'UserStory': return 'pink';\r\n        case 'Email': return 'slate';\r\n        case 'CalendarEvent': return 'cyan';\r\n        case 'Task': return 'emerald';\r\n        default: return 'slate';\r\n    }\r\n}\r\n\r\n// ---------------------------------------------------------------------------\r\n// SIGMA / GRAPHOLOGY DATA CONVERSION\r\n// ---------------------------------------------------------------------------\r\n\r\nimport Graph from 'graphology';\r\nimport pagerank from 'graphology-metrics/centrality/pagerank';\r\n\r\nconst TIER_SIZES: Record<number, number> = { 0: 18, 1: 10, 2: 6 };\r\n\r\n/**\r\n * Converts internal GraphNode/GraphEdge arrays into a Graphology Graph\r\n * with node attributes (x, y, size, color, label) and edge attributes\r\n * (color, size, type) ready for Sigma.js rendering.\r\n *\r\n * When `useImportance` is true, node sizes are scaled by PageRank centrality.\r\n */\r\nexport function toSigmaGraph(nodes: GraphNode[], edges: GraphEdge[], useImportance = false): Graph {\r\n    const graph = new Graph();\r\n\r\n    for (const n of nodes) {\r\n        const type = n.label || 'default';\r\n        const tier = n.data.tier ?? 2;\r\n        const isGroup = !!n.data._isGroup;\r\n        graph.addNode(n.id, {\r\n            label: n.data.label || n.label || n.id,\r\n            size: isGroup ? 22 : (TIER_SIZES[tier] ?? 6),\r\n            color: NODE_COLORS[type] || '#64748b',\r\n            x: Math.random() * 1000,\r\n            y: Math.random() * 1000,\r\n            nodeType: type,\r\n            tier,\r\n            isGroup,\r\n            groupCount: n.data._groupCount || 0,\r\n            createdAt: n.data.created_at || n.data.date || null,\r\n        });\r\n    }\r\n\r\n    for (const e of edges) {\r\n        const style = EDGE_STYLES[e.data?.originalLabel || e.label || ''] || EDGE_STYLES['default'];\r\n        const key = e.id || `${e.source}-${e.target}-${e.data?.originalLabel || e.label || 'rel'}`;\r\n        if (!graph.hasNode(e.source) || !graph.hasNode(e.target)) continue;\r\n        try {\r\n            graph.addEdgeWithKey(key, e.source, e.target, {\r\n                color: style.stroke,\r\n                size: Math.max(0.5, style.width * 0.4),\r\n                relationType: e.data?.originalLabel || e.label,\r\n                type: 'curved',\r\n            });\r\n        } catch {\r\n            // skip duplicate edges\r\n        }\r\n    }\r\n\r\n    if (useImportance && graph.order > 1) {\r\n        try {\r\n            const scores = pagerank(graph);\r\n            const values = Object.values(scores);\r\n            const maxPR = Math.max(...values, 0.001);\r\n            const minPR = Math.min(...values, 0);\r\n            const MIN_SIZE = 4;\r\n            const MAX_SIZE = 30;\r\n            for (const [node, score] of Object.entries(scores)) {\r\n                const normalized = maxPR > minPR ? (score - minPR) / (maxPR - minPR) : 0.5;\r\n                const size = MIN_SIZE + normalized * (MAX_SIZE - MIN_SIZE);\r\n                graph.setNodeAttribute(node, 'size', size);\r\n            }\r\n        } catch {\r\n            // PageRank may fail on disconnected graphs; fall back to tier sizing\r\n        }\r\n    }\r\n\r\n    return graph;\r\n}\r\n","import { useState, useMemo } from 'react';\r\nimport {\r\n  Loader2, Layers, GitBranch, Sparkles, CheckCircle, XCircle,\r\n  Clock, Plus, AlertTriangle, BarChart3, Cpu, Settings, Trash2,\r\n  Wand2, RefreshCw, History, Brain, Search,\r\n  Play, Power, PowerOff, Wrench, Shield, Merge, Download,\r\n  Activity, Zap, Network, Info, FlaskConical, FileText, Eye,\r\n} from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport {\r\n  useOntologySchema, useOntologyStats, useOntologyEntities, useOntologyRelations,\r\n  useOntologySuggestions, useOntologyWorkerStatus, useOntologyCompliance,\r\n  useOntologyApproveSuggestion, useOntologyRejectSuggestion,\r\n  useOntologyAddEntityType, useOntologyAddRelationType,\r\n  useOntologyWorkerTrigger, useOntologyForceSync,\r\n  useOntologyAutoApprove, useOntologyAnalyzeGraph, useOntologyChanges,\r\n  useOntologyDiff, useOntologyCleanup, useOntologyUnused, useOntologyInferRelationships,\r\n  useOntologySyncStatus, useOntologyJobs, useOntologyToggleJob,\r\n  useOntologyExtractFromGraph, useOntologyMerge, useOntologyWorkerLog,\r\n  useOntologyEnrichSuggestion,\r\n  useInferenceRules, useInferenceStats, useRunInferenceRule,\r\n  useEmbeddingsDashboard, useRegenerateEmbeddings,\r\n  useSharedOntology, useToggleEntityShared,\r\n  useOntologyVersions,\r\n  useValidateEntity, useExtractFromText, useEnrichEntity,\r\n} from '../../hooks/useGodMode';\r\nimport { cn } from '../../lib/utils';\r\n\r\ntype Tab = 'entities' | 'relations' | 'graph' | 'suggestions' | 'stats' | 'tools' | 'jobs' | 'changes' | 'inference' | 'embeddings' | 'shared' | 'versions' | 'test';\r\n\r\nimport { NODE_COLORS } from '@/lib/graph-transformer';\r\n\r\nfunction getColor(name: string, fallback?: string): string {\r\n  return NODE_COLORS[name] || fallback || '#64748b';\r\n}\r\n\r\n//  Sync Status Badge \r\n\r\nfunction SyncBadge({ status }: { status: Record<string, unknown> }) {\r\n  const graphConnected = Boolean(status.graphConnected);\r\n  const isListening = Boolean(status.isListening);\r\n  const isSyncing = Boolean(status.syncInProgress);\r\n  const isConnected = graphConnected || isListening;\r\n  const source = status.ontologySource ? String(status.ontologySource) : '';\r\n  const label = isSyncing ? 'Syncing' : isConnected ? (source === 'supabase' ? 'Synced' : 'Connected') : 'Disconnected';\r\n  return (\r\n    <div className={cn(\r\n      'flex items-center gap-1.5 px-2 py-1 rounded-full text-[10px] font-medium',\r\n      isConnected ? 'bg-gm-status-success-bg text-gm-status-success' :\r\n      isSyncing ? 'bg-gm-status-warning-bg text-gm-status-warning' :\r\n      'bg-gm-surface-secondary text-gm-text-tertiary'\r\n    )}>\r\n      <div className={cn('w-1.5 h-1.5 rounded-full', isConnected ? 'bg-gm-status-success' : isSyncing ? 'bg-gm-status-warning animate-pulse' : 'bg-gm-text-tertiary')} />\r\n      {label}\r\n    </div>\r\n  );\r\n}\r\n\r\n//  Schema Version Badge \r\n\r\nfunction VersionBadge({ schema }: { schema: Record<string, unknown> }) {\r\n  const version = schema.version || schema.schema_version || '';\r\n  const entityCount = Object.keys((schema.entityTypes || schema.entities || {}) as Record<string, unknown>).length;\r\n  const relCount = Object.keys((schema.relationTypes || schema.relations || {}) as Record<string, unknown>).length;\r\n  return (\r\n    <div className=\"flex items-center gap-2 text-[10px] text-gm-text-tertiary\">\r\n      {version && <span>v{String(version)}</span>}\r\n      <span>{entityCount}E</span>\r\n      <span>{relCount}R</span>\r\n    </div>\r\n  );\r\n}\r\n\r\n//  Entity Detail Panel \r\n\r\nfunction EntityDetailPanel({ entity, onClose }: { entity: Record<string, unknown>; onClose: () => void }) {\r\n  const name = String(entity.name || entity.type || entity.label || '');\r\n  const desc = String(entity.description || '');\r\n  const color = getColor(name, entity.color ? String(entity.color) : undefined);\r\n  const props = (entity.properties || []) as Array<Record<string, unknown>> | Record<string, unknown>;\r\n  const shared = Boolean(entity.sharedEntity || entity.shared);\r\n  const embeddingTemplate = String(entity.embeddingTemplate || '');\r\n  const count = Number(entity.count || entity.instances || 0);\r\n\r\n  const propsArray = Array.isArray(props)\r\n    ? props\r\n    : Object.entries(props).map(([k, v]) => ({ name: k, ...(typeof v === 'object' && v !== null ? v as Record<string, unknown> : { type: String(v) }) }));\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/40\" onClick={onClose}>\r\n      <div className=\"bg-gm-surface-primary border border-gm-border-primary rounded-2xl shadow-xl w-full max-w-lg max-h-[80vh] overflow-y-auto\" onClick={e => e.stopPropagation()}>\r\n        <div className=\"p-5 border-b border-gm-border-primary\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <div className=\"w-8 h-8 rounded-xl flex items-center justify-center text-white font-bold text-sm\" style={{ backgroundColor: color }}>\r\n              {name.charAt(0)}\r\n            </div>\r\n            <div className=\"flex-1\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <h3 className=\"text-sm font-bold text-gm-text-primary\">{name}</h3>\r\n                {shared && <span className=\"text-[9px] px-1.5 py-0.5 rounded-full bg-blue-600/10 text-gm-interactive-primary font-medium\">Shared</span>}\r\n                {count > 0 && <span className=\"text-[10px] text-gm-text-tertiary\">{count} instances</span>}\r\n              </div>\r\n              {desc && <p className=\"text-[11px] text-gm-text-tertiary mt-0.5\">{desc}</p>}\r\n            </div>\r\n            <button onClick={onClose} className=\"p-1.5 rounded-lg hover:bg-gm-surface-hover transition-colors\">\r\n              <XCircle className=\"w-4 h-4 text-gm-text-tertiary\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {propsArray.length > 0 && (\r\n          <div className=\"p-5 border-b border-gm-border-primary\">\r\n            <h4 className=\"text-[10px] text-gm-text-tertiary uppercase tracking-wider mb-3\">Properties ({propsArray.length})</h4>\r\n            <div className=\"space-y-1.5\">\r\n              {propsArray.map((p, i) => (\r\n                <div key={i} className=\"flex items-center gap-2 text-xs\">\r\n                  <span className=\"font-mono text-gm-text-primary w-32 shrink-0\">{String(p.name || p.key || '')}</span>\r\n                  <span className=\"text-[10px] px-1.5 py-0.5 rounded bg-gm-surface-secondary text-gm-text-tertiary\">{String(p.type || 'string')}</span>\r\n                  {p.required && <span className=\"text-[9px] text-gm-status-danger\">required</span>}\r\n                  {p.searchable && <span className=\"text-[9px] text-gm-interactive-primary\">searchable</span>}\r\n                  {p.description && <span className=\"text-[10px] text-gm-text-tertiary ml-auto truncate max-w-[150px]\">{String(p.description)}</span>}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {embeddingTemplate && (\r\n          <div className=\"p-5\">\r\n            <h4 className=\"text-[10px] text-gm-text-tertiary uppercase tracking-wider mb-2\">Embedding Template</h4>\r\n            <pre className=\"text-[10px] text-gm-text-primary bg-gm-surface-secondary rounded-lg p-3 overflow-x-auto whitespace-pre-wrap\">{embeddingTemplate}</pre>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n//  Inline Graph Visualization (SVG-based, no external deps) \r\n\r\nfunction OntologyGraphView({ entities, relations }: { entities: Array<Record<string, unknown>>; relations: Array<Record<string, unknown>> }) {\r\n  const layout = useMemo(() => {\r\n    const nodeMap: Record<string, { x: number; y: number; color: string }> = {};\r\n    const count = entities.length;\r\n    if (count === 0) return { nodes: nodeMap, width: 600, height: 400 };\r\n\r\n    const cols = Math.ceil(Math.sqrt(count));\r\n    const spacingX = 180;\r\n    const spacingY = 120;\r\n    entities.forEach((e, i) => {\r\n      const name = String(e.name || e.type || e.label || '');\r\n      const row = Math.floor(i / cols);\r\n      const col = i % cols;\r\n      nodeMap[name] = {\r\n        x: 60 + col * spacingX,\r\n        y: 50 + row * spacingY,\r\n        color: getColor(name, e.color ? String(e.color) : undefined),\r\n      };\r\n    });\r\n    const maxCol = Math.min(count, cols);\r\n    const maxRow = Math.ceil(count / cols);\r\n    return { nodes: nodeMap, width: Math.max(600, 60 + maxCol * spacingX + 60), height: Math.max(400, 50 + maxRow * spacingY + 60) };\r\n  }, [entities]);\r\n\r\n  const edges = useMemo(() => {\r\n    return relations.map(r => {\r\n      const from = String(r.from || r.source || r.from_type || '');\r\n      const to = String(r.to || r.target || r.to_type || '');\r\n      const name = String(r.name || r.type || r.label || '');\r\n      if (!layout.nodes[from] || !layout.nodes[to] || from === '*' || to === '*') return null;\r\n      return { from, to, name };\r\n    }).filter(Boolean) as Array<{ from: string; to: string; name: string }>;\r\n  }, [relations, layout]);\r\n\r\n  if (entities.length === 0) {\r\n    return (\r\n      <div className=\"flex items-center justify-center py-16\">\r\n        <div className=\"text-center\">\r\n          <Network className=\"w-10 h-10 mx-auto mb-3 text-gray-600\" />\r\n          <p className=\"text-xs text-gm-text-tertiary\">No entities to visualize</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"w-full overflow-auto bg-gm-surface-secondary rounded-xl border border-gm-border-primary\">\r\n      <svg viewBox={`0 0 ${layout.width} ${layout.height}`} className=\"w-full\" style={{ minHeight: 400 }}>\r\n        <defs>\r\n          <marker id=\"arrowhead\" markerWidth=\"8\" markerHeight=\"6\" refX=\"8\" refY=\"3\" orient=\"auto\">\r\n            <polygon points=\"0 0, 8 3, 0 6\" fill=\"#94a3b8\" />\r\n          </marker>\r\n        </defs>\r\n        {edges.map((edge, i) => {\r\n          const s = layout.nodes[edge.from];\r\n          const t = layout.nodes[edge.to];\r\n          if (!s || !t) return null;\r\n          const dx = t.x - s.x;\r\n          const dy = t.y - s.y;\r\n          const midX = s.x + dx / 2;\r\n          const midY = s.y + dy / 2;\r\n          const curveOffset = edge.from === edge.to ? 40 : 0;\r\n          return (\r\n            <g key={i}>\r\n              {edge.from === edge.to ? (\r\n                <path d={`M ${s.x + 30} ${s.y - 15} C ${s.x + 80} ${s.y - 60}, ${s.x - 20} ${s.y - 60}, ${s.x - 30} ${s.y - 15}`}\r\n                  fill=\"none\" stroke=\"#94a3b8\" strokeWidth=\"1.2\" markerEnd=\"url(#arrowhead)\" strokeDasharray=\"4 2\" />\r\n              ) : (\r\n                <line x1={s.x} y1={s.y} x2={t.x} y2={t.y} stroke=\"#94a3b8\" strokeWidth=\"1.2\" markerEnd=\"url(#arrowhead)\" strokeDasharray=\"4 2\" />\r\n              )}\r\n              <rect x={midX - 30 + curveOffset} y={midY - 8 - (curveOffset ? 40 : 0)} width=\"60\" height=\"14\" rx=\"4\" fill=\"var(--gm-surface-primary)\" fillOpacity=\"0.85\" />\r\n              <text x={midX + curveOffset} y={midY - (curveOffset ? 40 : 0)} textAnchor=\"middle\" fontSize=\"7\" fill=\"#94a3b8\" fontWeight=\"600\">\r\n                {edge.name.length > 12 ? edge.name.slice(0, 12) + '' : edge.name}\r\n              </text>\r\n            </g>\r\n          );\r\n        })}\r\n        {Object.entries(layout.nodes).map(([name, node]) => (\r\n          <g key={name}>\r\n            <rect x={node.x - 45} y={node.y - 18} width=\"90\" height=\"36\" rx=\"10\" fill={node.color + '18'} stroke={node.color + '40'} strokeWidth=\"1.5\" />\r\n            <circle cx={node.x - 30} cy={node.y} r=\"5\" fill={node.color} />\r\n            <text x={node.x + 2} y={node.y + 4} textAnchor=\"middle\" fontSize=\"9\" fill=\"currentColor\" fontWeight=\"600\">\r\n              {name.length > 10 ? name.slice(0, 10) + '' : name}\r\n            </text>\r\n          </g>\r\n        ))}\r\n      </svg>\r\n    </div>\r\n  );\r\n}\r\n\r\n//  Relation Builder Dialog \r\n\r\nfunction RelationBuilderInline({\r\n  entityNames,\r\n  onSave,\r\n  onCancel,\r\n  isPending,\r\n}: {\r\n  entityNames: string[];\r\n  onSave: (data: { name: string; from: string; to: string; description: string }) => void;\r\n  onCancel: () => void;\r\n  isPending: boolean;\r\n}) {\r\n  const [source, setSource] = useState('');\r\n  const [target, setTarget] = useState('');\r\n  const [relName, setRelName] = useState('');\r\n  const [desc, setDesc] = useState('');\r\n\r\n  const formatted = relName.toUpperCase().replace(/\\s+/g, '_');\r\n\r\n  const handleSave = () => {\r\n    if (!source || !target || !relName.trim()) {\r\n      toast.error('Source, target, and name are required');\r\n      return;\r\n    }\r\n    onSave({ name: formatted, from: source, to: target, description: desc });\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border-2 border-gm-interactive-primary/20 space-y-3\">\r\n      {/* Preview */}\r\n      <div className=\"flex items-center justify-center gap-3 py-2\">\r\n        <div className={cn('px-3 py-1.5 rounded-lg text-xs font-bold transition-colors',\r\n          source ? 'text-white' : 'bg-gm-surface-secondary text-gm-text-tertiary')}\r\n          style={source ? { backgroundColor: getColor(source) } : {}}>\r\n          {source || '?'}\r\n        </div>\r\n        <div className=\"flex flex-col items-center\">\r\n          <span className=\"text-[9px] font-mono text-gm-text-tertiary\">{formatted || 'RELATION'}</span>\r\n          <span className=\"text-gm-text-tertiary\"></span>\r\n        </div>\r\n        <div className={cn('px-3 py-1.5 rounded-lg text-xs font-bold transition-colors',\r\n          target ? 'text-white' : 'bg-gm-surface-secondary text-gm-text-tertiary')}\r\n          style={target ? { backgroundColor: getColor(target) } : {}}>\r\n          {target || '?'}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-2 gap-2\">\r\n        <select value={source} onChange={e => setSource(e.target.value)}\r\n          className=\"bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-2 py-1.5 text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus\">\r\n          <option value=\"\">Source entity...</option>\r\n          {entityNames.map(e => <option key={e} value={e}>{e}</option>)}\r\n        </select>\r\n        <select value={target} onChange={e => setTarget(e.target.value)}\r\n          className=\"bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-2 py-1.5 text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus\">\r\n          <option value=\"\">Target entity...</option>\r\n          {entityNames.map(e => <option key={e} value={e}>{e}</option>)}\r\n        </select>\r\n      </div>\r\n\r\n      <input value={relName} onChange={e => setRelName(e.target.value)} placeholder=\"Relation name (e.g. WORKS_ON, BELONGS_TO)\"\r\n        className=\"w-full bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-1.5 text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus\"\r\n        onKeyDown={e => e.key === 'Enter' && handleSave()} />\r\n\r\n      <input value={desc} onChange={e => setDesc(e.target.value)} placeholder=\"Description (optional)\"\r\n        className=\"w-full bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-1.5 text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus\" />\r\n\r\n      <div className=\"flex gap-2 justify-end\">\r\n        <button onClick={onCancel} className=\"px-3 py-1.5 rounded-lg text-xs text-gm-text-tertiary hover:bg-gm-surface-secondary transition-colors\">Cancel</button>\r\n        <button onClick={handleSave} disabled={isPending || !source || !target || !relName.trim()}\r\n          className=\"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover disabled:opacity-50 flex items-center gap-1 transition-colors\">\r\n          {isPending ? <Loader2 className=\"w-3 h-3 animate-spin\" /> : <Plus className=\"w-3 h-3\" />} Create\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n//  Main Component \r\n\r\nexport default function GraphOntology() {\r\n  const [tab, setTab] = useState<Tab>('entities');\r\n  const [search, setSearch] = useState('');\r\n  const [newEntityName, setNewEntityName] = useState('');\r\n  const [showRelBuilder, setShowRelBuilder] = useState(false);\r\n  const [selectedEntity, setSelectedEntity] = useState<Record<string, unknown> | null>(null);\r\n\r\n  // Queries\r\n  const schema = useOntologySchema();\r\n  const stats = useOntologyStats();\r\n  const entitiesQ = useOntologyEntities();\r\n  const relationsQ = useOntologyRelations();\r\n  const suggestionsQ = useOntologySuggestions();\r\n  const workerQ = useOntologyWorkerStatus();\r\n  const complianceQ = useOntologyCompliance();\r\n  const changesQ = useOntologyChanges();\r\n  const diffQ = useOntologyDiff();\r\n  const unusedQ = useOntologyUnused();\r\n  const syncStatusQ = useOntologySyncStatus();\r\n  const jobsQ = useOntologyJobs();\r\n  const workerLogQ = useOntologyWorkerLog();\r\n  const inferenceRulesQ = useInferenceRules();\r\n  const inferenceStatsQ = useInferenceStats();\r\n  const embeddingsDashQ = useEmbeddingsDashboard();\r\n  const sharedQ = useSharedOntology();\r\n  const versionsQ = useOntologyVersions();\r\n\r\n  // Mutations\r\n  const approve = useOntologyApproveSuggestion();\r\n  const reject = useOntologyRejectSuggestion();\r\n  const enrichSuggestion = useOntologyEnrichSuggestion();\r\n  const addEntity = useOntologyAddEntityType();\r\n  const addRelation = useOntologyAddRelationType();\r\n  const triggerWorker = useOntologyWorkerTrigger();\r\n  const forceSync = useOntologyForceSync();\r\n  const autoApprove = useOntologyAutoApprove();\r\n  const analyzeGraph = useOntologyAnalyzeGraph();\r\n  const cleanup = useOntologyCleanup();\r\n  const inferRels = useOntologyInferRelationships();\r\n  const toggleJob = useOntologyToggleJob();\r\n  const extractFromGraph = useOntologyExtractFromGraph();\r\n  const mergeOntology = useOntologyMerge();\r\n  const runInference = useRunInferenceRule();\r\n  const regenEmbeddings = useRegenerateEmbeddings();\r\n  const toggleShared = useToggleEntityShared();\r\n  const validateEntity = useValidateEntity();\r\n  const extractFromText = useExtractFromText();\r\n  const enrichEntity = useEnrichEntity();\r\n\r\n  // Test tab state\r\n  const [validateType, setValidateType] = useState('');\r\n  const [validateJson, setValidateJson] = useState('{\\n  \"name\": \"example\"\\n}');\r\n  const [extractText, setExtractText] = useState('');\r\n  const [enrichType, setEnrichType] = useState('');\r\n  const [enrichJson, setEnrichJson] = useState('{\\n  \"name\": \"example\"\\n}');\r\n\r\n  // Data extraction\r\n  const entities = ((entitiesQ.data as Record<string, unknown>)?.entityTypes || (entitiesQ.data as Record<string, unknown>)?.entities || (entitiesQ.data as Record<string, unknown>)?.types || []) as Array<Record<string, unknown>>;\r\n  const relations = ((relationsQ.data as Record<string, unknown>)?.relationTypes || (relationsQ.data as Record<string, unknown>)?.relations || (relationsQ.data as Record<string, unknown>)?.types || []) as Array<Record<string, unknown>>;\r\n  const suggestions = ((suggestionsQ.data as Record<string, unknown>)?.suggestions || []) as Array<Record<string, unknown>>;\r\n  const statsData = (stats.data || {}) as Record<string, unknown>;\r\n  const worker = (workerQ.data || {}) as Record<string, unknown>;\r\n  const compliance = ((complianceQ.data as Record<string, unknown>)?.compliance || complianceQ.data || {}) as Record<string, unknown>;\r\n  const complianceIssues = (compliance.issues || compliance.violations || []) as Array<Record<string, unknown>>;\r\n  const complianceScore = Number(compliance.score || compliance.compliance_score || 0);\r\n  const changes = ((changesQ.data as Record<string, unknown>)?.changes || changesQ.data || []) as Array<Record<string, unknown>>;\r\n  const diff = (diffQ.data || {}) as Record<string, unknown>;\r\n  const unused = ((unusedQ.data as Record<string, unknown>)?.unused || unusedQ.data || {}) as Record<string, unknown>;\r\n  const unusedEntities = (unused.entities || []) as string[];\r\n  const unusedRelations = (unused.relations || []) as string[];\r\n  const syncStatusData = ((syncStatusQ.data as Record<string, unknown>)?.status || syncStatusQ.data || {}) as Record<string, unknown>;\r\n  const jobs = ((jobsQ.data as Record<string, unknown>)?.jobs || []) as Array<Record<string, unknown>>;\r\n  const workerLog = ((workerLogQ.data as Record<string, unknown>)?.log || []) as Array<Record<string, unknown>>;\r\n  const schemaData = (schema.data || {}) as Record<string, unknown>;\r\n  const inferenceRules = ((inferenceRulesQ.data as Record<string, unknown>)?.rules || []) as Array<Record<string, unknown>>;\r\n  const inferenceCyphers = ((inferenceRulesQ.data as Record<string, unknown>)?.cyphers || []) as Array<Record<string, unknown>>;\r\n  const inferenceStatsData = ((inferenceStatsQ.data as Record<string, unknown>)?.stats || {}) as Record<string, unknown>;\r\n  const availableInferenceRules = ((inferenceStatsQ.data as Record<string, unknown>)?.availableRules || []) as Array<Record<string, unknown>>;\r\n  const embeddingSummary = ((embeddingsDashQ.data as Record<string, unknown>)?.summary || {}) as Record<string, unknown>;\r\n  const embeddingCoverage = ((embeddingsDashQ.data as Record<string, unknown>)?.coverageByType || {}) as Record<string, Record<string, unknown>>;\r\n  const sharedEntities = ((sharedQ.data as Record<string, unknown>)?.sharedEntities || []) as Array<Record<string, unknown>>;\r\n  const crossGraphRelations = ((sharedQ.data as Record<string, unknown>)?.crossGraphRelations || []) as Array<Record<string, unknown>>;\r\n  const versionsData = (versionsQ.data || {}) as Record<string, unknown>;\r\n  const versionHistory = ((versionsData as Record<string, unknown>)?.history || []) as Array<Record<string, unknown>>;\r\n\r\n  // Filtered lists\r\n  const searchLower = search.toLowerCase();\r\n  const filteredEntities = useMemo(() =>\r\n    search ? entities.filter(e => {\r\n      const name = String(e.name || e.type || e.label || '').toLowerCase();\r\n      const desc = String(e.description || '').toLowerCase();\r\n      return name.includes(searchLower) || desc.includes(searchLower);\r\n    }) : entities\r\n  , [entities, searchLower]);\r\n\r\n  const filteredRelations = useMemo(() =>\r\n    search ? relations.filter(r => {\r\n      const name = String(r.name || r.type || r.label || '').toLowerCase();\r\n      const from = String(r.from || r.source || '').toLowerCase();\r\n      const to = String(r.to || r.target || '').toLowerCase();\r\n      return name.includes(searchLower) || from.includes(searchLower) || to.includes(searchLower);\r\n    }) : relations\r\n  , [relations, searchLower]);\r\n\r\n  const entityNames = useMemo(() => entities.map(e => String(e.name || e.type || e.label || '')), [entities]);\r\n\r\n  const pendingSuggestions = suggestions.filter(s => String(s.status) !== 'approved' && String(s.status) !== 'rejected');\r\n\r\n  // Handlers\r\n  const handleAddEntity = () => {\r\n    if (!newEntityName.trim()) return;\r\n    addEntity.mutate({ name: newEntityName.trim() }, {\r\n      onSuccess: () => { toast.success('Entity type added'); setNewEntityName(''); },\r\n      onError: () => toast.error('Failed to add entity type'),\r\n    });\r\n  };\r\n\r\n  const handleAddRelation = (data: { name: string; from: string; to: string; description: string }) => {\r\n    addRelation.mutate(data, {\r\n      onSuccess: () => { toast.success('Relation type added'); setShowRelBuilder(false); },\r\n      onError: () => toast.error('Failed to add relation type'),\r\n    });\r\n  };\r\n\r\n  // Tabs definition\r\n  const tabs: { key: Tab; label: string; icon: typeof Layers; count?: number }[] = [\r\n    { key: 'entities', label: 'Entities', icon: Cpu, count: entities.length },\r\n    { key: 'relations', label: 'Relations', icon: GitBranch, count: relations.length },\r\n    { key: 'graph', label: 'Graph', icon: Network },\r\n    { key: 'suggestions', label: 'AI', icon: Sparkles, count: pendingSuggestions.length },\r\n    { key: 'stats', label: 'Stats', icon: BarChart3 },\r\n    { key: 'tools', label: 'Tools', icon: Wrench },\r\n    { key: 'inference', label: 'Rules', icon: Zap },\r\n    { key: 'embeddings', label: 'Embed', icon: Brain },\r\n    { key: 'shared', label: 'Shared', icon: Layers },\r\n    { key: 'jobs', label: 'Jobs', icon: Settings },\r\n    { key: 'versions', label: 'Versions', icon: History },\r\n    { key: 'changes', label: 'Log', icon: Activity },\r\n    { key: 'test', label: 'Test', icon: FlaskConical },\r\n  ];\r\n\r\n  return (\r\n    <div className=\"h-full flex flex-col\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center gap-2 px-4 py-2 border-b border-gm-border-primary bg-gm-surface-secondary shrink-0\">\r\n        <Layers className=\"w-4 h-4 text-gm-interactive-primary\" />\r\n        <span className=\"text-xs font-semibold text-gm-text-primary\">Ontology</span>\r\n        <VersionBadge schema={schemaData} />\r\n        <div className=\"ml-auto flex items-center gap-2\">\r\n          {Object.keys(syncStatusData).length > 0 && <SyncBadge status={syncStatusData} />}\r\n          <button onClick={() => forceSync.mutate(undefined, { onSuccess: () => toast.success('Sync triggered') })} disabled={forceSync.isPending}\r\n            className=\"p-1 rounded-md hover:bg-gm-surface-hover transition-colors\" title=\"Force sync\">\r\n            {forceSync.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin text-gm-text-tertiary\" /> : <RefreshCw className=\"w-3.5 h-3.5 text-gm-text-tertiary\" />}\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Tabs */}\r\n      <div className=\"flex gap-0.5 px-4 border-b border-gm-border-primary bg-gm-surface-secondary shrink-0\">\r\n        {tabs.map(t => {\r\n          const Icon = t.icon;\r\n          return (\r\n            <button key={t.key} onClick={() => setTab(t.key)}\r\n              className={cn('flex items-center gap-1 px-2.5 py-2 text-[10px] font-medium border-b-2 transition-colors',\r\n                tab === t.key ? 'border-gm-interactive-primary text-gm-interactive-primary' : 'border-transparent text-gm-text-tertiary hover:text-gm-text-primary')}>\r\n              <Icon className=\"w-3 h-3\" /> {t.label}\r\n              {t.count !== undefined && t.count > 0 && (\r\n                <span className=\"text-[9px] px-1 py-0.5 rounded-full bg-gm-surface-secondary text-gm-text-tertiary\">{t.count}</span>\r\n              )}\r\n            </button>\r\n          );\r\n        })}\r\n      </div>\r\n\r\n      {/* Search (for entities/relations tabs) */}\r\n      {(tab === 'entities' || tab === 'relations') && (\r\n        <div className=\"px-4 pt-3 shrink-0\">\r\n          <div className=\"relative\">\r\n            <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gm-text-tertiary\" />\r\n            <input value={search} onChange={e => setSearch(e.target.value)}\r\n              placeholder={`Search ${tab}...`}\r\n              className=\"w-full pl-8 pr-3 py-1.5 bg-gm-surface-secondary border border-gm-border-primary rounded-lg text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus\" />\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Content */}\r\n      <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\r\n\r\n        {/*  Entities Tab  */}\r\n        {tab === 'entities' && (\r\n          <>\r\n            <div className=\"flex gap-2 items-center\">\r\n              <input value={newEntityName} onChange={e => setNewEntityName(e.target.value)} placeholder=\"New entity type...\"\r\n                className=\"flex-1 bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-1.5 text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus\"\r\n                onKeyDown={e => e.key === 'Enter' && handleAddEntity()} />\r\n              <button onClick={handleAddEntity} disabled={addEntity.isPending || !newEntityName.trim()}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover disabled:opacity-50 flex items-center gap-1 transition-colors\">\r\n                <Plus className=\"w-3 h-3\" /> Add\r\n              </button>\r\n            </div>\r\n            {entitiesQ.isLoading ? <Loader2 className=\"w-5 h-5 animate-spin text-gm-interactive-primary mx-auto\" /> : (\r\n              <div className=\"grid grid-cols-3 gap-2\">\r\n                {filteredEntities.map((e, i) => {\r\n                  const name = String(e.name || e.type || e.label || '');\r\n                  const count = Number(e.count || e.instances || 0);\r\n                  const props = (e.properties || []) as Array<Record<string, unknown>> | Record<string, unknown>;\r\n                  const propsArr = Array.isArray(props) ? props : Object.entries(props).map(([k]) => ({ name: k }));\r\n                  const color = getColor(name, e.color ? String(e.color) : undefined);\r\n                  const desc = String(e.description || '');\r\n                  const shared = Boolean(e.sharedEntity || e.shared);\r\n                  return (\r\n                    <div key={i} onClick={() => setSelectedEntity(e)}\r\n                      className=\"bg-[var(--gm-surface-hover)] rounded-xl p-3 border border-gm-border-primary hover:border-blue-600/30 transition-colors cursor-pointer group\">\r\n                      <div className=\"flex items-center gap-2 mb-1.5\">\r\n                        <div className=\"w-6 h-6 rounded-lg flex items-center justify-center text-white text-[9px] font-bold shrink-0\" style={{ backgroundColor: color }}>\r\n                          {name.charAt(0)}\r\n                        </div>\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <div className=\"flex items-center gap-1.5\">\r\n                            <span className=\"text-xs font-semibold text-gm-text-primary truncate\">{name}</span>\r\n                            {shared && <span className=\"text-[8px] px-1 py-0.5 rounded bg-blue-600/10 text-gm-interactive-primary\">S</span>}\r\n                          </div>\r\n                        </div>\r\n                        {count > 0 && <span className=\"text-[10px] text-gm-text-tertiary shrink-0\">{count}</span>}\r\n                      </div>\r\n                      {desc && <p className=\"text-[9px] text-gm-text-tertiary mb-1.5 line-clamp-1\">{desc}</p>}\r\n                      {propsArr.length > 0 && (\r\n                        <div className=\"flex flex-wrap gap-1\">\r\n                          {propsArr.slice(0, 4).map((p, j) => (\r\n                            <span key={j} className=\"text-[8px] px-1 py-0.5 rounded bg-gm-surface-secondary text-gm-text-tertiary\">{String((p as Record<string, unknown>).name || p)}</span>\r\n                          ))}\r\n                          {propsArr.length > 4 && <span className=\"text-[8px] text-gm-text-tertiary\">+{propsArr.length - 4}</span>}\r\n                        </div>\r\n                      )}\r\n                      <Eye className=\"w-3 h-3 text-gm-text-tertiary opacity-0 group-hover:opacity-100 transition-opacity absolute top-2 right-2\" />\r\n                    </div>\r\n                  );\r\n                })}\r\n              </div>\r\n            )}\r\n          </>\r\n        )}\r\n\r\n        {/*  Relations Tab  */}\r\n        {tab === 'relations' && (\r\n          <>\r\n            {showRelBuilder ? (\r\n              <RelationBuilderInline\r\n                entityNames={entityNames}\r\n                onSave={handleAddRelation}\r\n                onCancel={() => setShowRelBuilder(false)}\r\n                isPending={addRelation.isPending}\r\n              />\r\n            ) : (\r\n              <button onClick={() => setShowRelBuilder(true)}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover flex items-center gap-1 transition-colors\">\r\n                <Plus className=\"w-3 h-3\" /> New Relation\r\n              </button>\r\n            )}\r\n            {relationsQ.isLoading ? <Loader2 className=\"w-5 h-5 animate-spin text-gm-interactive-primary mx-auto\" /> : (\r\n              <div className=\"space-y-1.5\">\r\n                {filteredRelations.map((r, i) => {\r\n                  const name = String(r.name || r.type || r.label || '');\r\n                  const count = Number(r.count || r.instances || 0);\r\n                  const from = String(r.from || r.source || r.from_type || '');\r\n                  const to = String(r.to || r.target || r.to_type || '');\r\n                  const desc = String(r.description || '');\r\n                  return (\r\n                    <div key={i} className=\"flex items-center gap-2 bg-[var(--gm-surface-hover)] rounded-lg p-2.5 group\">\r\n                      {from && <span className=\"text-[10px] px-1.5 py-0.5 rounded font-medium\" style={{ backgroundColor: `${getColor(from)}20`, color: getColor(from) }}>{from}</span>}\r\n                      <span className=\"text-xs font-medium text-gm-interactive-primary\"> {name.replace(/_/g, ' ')} </span>\r\n                      {to && <span className=\"text-[10px] px-1.5 py-0.5 rounded font-medium\" style={{ backgroundColor: `${getColor(to)}20`, color: getColor(to) }}>{to}</span>}\r\n                      {desc && <span className=\"text-[9px] text-gm-text-tertiary truncate max-w-[150px] hidden group-hover:block\">{desc}</span>}\r\n                      {count > 0 && <span className=\"text-[10px] text-gm-text-tertiary ml-auto\">{count}</span>}\r\n                    </div>\r\n                  );\r\n                })}\r\n              </div>\r\n            )}\r\n          </>\r\n        )}\r\n\r\n        {/*  Graph Tab  */}\r\n        {tab === 'graph' && (\r\n          <OntologyGraphView entities={entities} relations={relations} />\r\n        )}\r\n\r\n        {/*  AI Suggestions Tab  */}\r\n        {tab === 'suggestions' && (\r\n          <>\r\n            <div className=\"flex flex-wrap gap-2 items-center\">\r\n              <button onClick={() => analyzeGraph.mutate(undefined, { onSuccess: () => toast.success('Graph analysis started') })}\r\n                disabled={analyzeGraph.isPending}\r\n                className=\"px-3 py-1.5 rounded-lg bg-blue-600/10 text-gm-interactive-primary text-xs font-medium hover:bg-blue-600/20 disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                {analyzeGraph.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Brain className=\"w-3.5 h-3.5\" />} Analyze Graph\r\n              </button>\r\n              <button onClick={() => autoApprove.mutate({ minConfidence: 0.8 }, { onSuccess: () => toast.success('High-confidence suggestions auto-approved') })}\r\n                disabled={autoApprove.isPending || pendingSuggestions.length === 0}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-status-success-bg text-gm-status-success text-xs font-medium hover:bg-green-500/20 disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                {autoApprove.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Wand2 className=\"w-3.5 h-3.5\" />} Auto-Approve (80%)\r\n              </button>\r\n              <button onClick={() => inferRels.mutate(undefined, { onSuccess: () => toast.success('Relationship inference started') })}\r\n                disabled={inferRels.isPending}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                {inferRels.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <GitBranch className=\"w-3.5 h-3.5\" />} Infer Relations\r\n              </button>\r\n            </div>\r\n\r\n            {suggestionsQ.isLoading ? <Loader2 className=\"w-5 h-5 animate-spin text-gm-interactive-primary mx-auto\" /> : suggestions.length === 0 ? (\r\n              <div className=\"text-center py-8\">\r\n                <Sparkles className=\"w-10 h-10 mx-auto mb-3 text-gray-600\" />\r\n                <p className=\"text-xs text-gm-text-tertiary\">No AI suggestions pending</p>\r\n                <p className=\"text-[10px] text-gm-text-tertiary mt-1\">Run \"Analyze Graph\" to generate suggestions</p>\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-2\">\r\n                {suggestions.map((s, i) => {\r\n                  const sType = String(s.type || s.suggestion_type || '');\r\n                  const name = String(s.name || s.suggested_name || s.content || '');\r\n                  const reason = String(s.reason || s.explanation || s.description || '');\r\n                  const confidence = Number(s.confidence || 0);\r\n                  const status = String(s.status || 'pending');\r\n                  const enrichment = s.enrichment as Record<string, unknown> | undefined;\r\n                  const isPending = status === 'pending';\r\n                  return (\r\n                    <div key={i} className={cn('bg-[var(--gm-surface-hover)] rounded-xl p-3 border transition-colors',\r\n                      isPending ? 'border-gm-border-primary' : status === 'approved' ? 'border-green-500/20 opacity-60' : 'border-red-500/20 opacity-60')}>\r\n                      <div className=\"flex items-start gap-2\">\r\n                        <Sparkles className=\"w-4 h-4 text-gm-interactive-primary shrink-0 mt-0.5\" />\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <div className=\"flex items-center gap-2 flex-wrap\">\r\n                            <span className=\"text-xs font-semibold text-gm-text-primary\">{name}</span>\r\n                            <span className=\"text-[10px] px-1.5 py-0.5 rounded bg-blue-600/10 text-gm-interactive-primary capitalize\">{sType.replace(/_/g, ' ')}</span>\r\n                            {confidence > 0 && (\r\n                              <span className={cn('text-[10px] font-medium',\r\n                                confidence >= 0.8 ? 'text-gm-status-success' : confidence >= 0.5 ? 'text-gm-status-warning' : 'text-gm-text-tertiary')}>\r\n                                {Math.round(confidence * 100)}%\r\n                              </span>\r\n                            )}\r\n                            {!isPending && <span className={cn('text-[9px] px-1 py-0.5 rounded', status === 'approved' ? 'bg-gm-status-success-bg text-gm-status-success' : 'bg-gm-status-danger-bg text-gm-status-danger')}>{status}</span>}\r\n                          </div>\r\n                          {reason && <p className=\"text-[10px] text-gm-text-tertiary mt-1\">{reason}</p>}\r\n                          {enrichment && (\r\n                            <div className=\"mt-2 p-2 bg-gm-surface-secondary rounded-lg space-y-1\">\r\n                              {enrichment.description && <p className=\"text-[10px] text-gm-text-primary\">{String(enrichment.description)}</p>}\r\n                              {Array.isArray(enrichment.useCases) && enrichment.useCases.length > 0 && (\r\n                                <div className=\"flex flex-wrap gap-1\">\r\n                                  {(enrichment.useCases as string[]).map((uc, j) => (\r\n                                    <span key={j} className=\"text-[9px] px-1 py-0.5 rounded bg-gm-surface-hover text-gm-text-tertiary\">{uc}</span>\r\n                                  ))}\r\n                                </div>\r\n                              )}\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                        {isPending && (\r\n                          <div className=\"flex gap-1 shrink-0\">\r\n                            <button onClick={() => enrichSuggestion.mutate(String(s.id), { onSuccess: () => toast.success('Enriched') })} disabled={enrichSuggestion.isPending}\r\n                              className=\"p-1.5 rounded-lg bg-blue-600/10 text-gm-interactive-primary hover:bg-blue-600/20 transition-colors\" title=\"AI Enrich\">\r\n                              <Brain className=\"w-3.5 h-3.5\" />\r\n                            </button>\r\n                            <button onClick={() => approve.mutate({ id: String(s.id) }, { onSuccess: () => toast.success('Approved') })} disabled={approve.isPending}\r\n                              className=\"p-1.5 rounded-lg bg-gm-status-success-bg text-gm-status-success hover:bg-green-500/20 transition-colors\">\r\n                              <CheckCircle className=\"w-3.5 h-3.5\" />\r\n                            </button>\r\n                            <button onClick={() => reject.mutate({ id: String(s.id) }, { onSuccess: () => toast.success('Rejected') })} disabled={reject.isPending}\r\n                              className=\"p-1.5 rounded-lg bg-gm-status-danger-bg text-gm-status-danger hover:bg-red-500/20 transition-colors\">\r\n                              <XCircle className=\"w-3.5 h-3.5\" />\r\n                            </button>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  );\r\n                })}\r\n              </div>\r\n            )}\r\n          </>\r\n        )}\r\n\r\n        {/*  Stats Tab  */}\r\n        {tab === 'stats' && (\r\n          <div className=\"space-y-4\">\r\n            {stats.isLoading ? <Loader2 className=\"w-5 h-5 animate-spin text-gm-interactive-primary mx-auto\" /> : (\r\n              <>\r\n                <div className=\"grid grid-cols-3 gap-3\">\r\n                  {Object.entries(statsData).filter(([, v]) => typeof v === 'number').slice(0, 9).map(([key, val]) => (\r\n                    <div key={key} className=\"bg-gm-surface-secondary rounded-xl p-3 border border-gm-border-primary\">\r\n                      <p className=\"text-lg font-bold text-gm-text-primary\">{String(val)}</p>\r\n                      <p className=\"text-[10px] text-gm-text-tertiary capitalize\">{key.replace(/_/g, ' ')}</p>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n\r\n                {/* Usage Bar Charts */}\r\n                {entities.length > 0 && (\r\n                  <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n                    <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\">\r\n                      <BarChart3 className=\"w-3.5 h-3.5\" /> Entity Types by Instance Count\r\n                    </h4>\r\n                    <div className=\"space-y-1.5\">\r\n                      {entities.slice(0, 10).map((e) => {\r\n                        const name = String(e.name || e.type || e.label || '?');\r\n                        const count = Number(e.count || e.instances || e.nodeCount || 0);\r\n                        const maxCount = Math.max(...entities.slice(0, 10).map(x => Number(x.count || x.instances || x.nodeCount || 0)), 1);\r\n                        return (\r\n                          <div key={name} className=\"flex items-center gap-2\">\r\n                            <span className=\"text-[10px] text-gm-text-tertiary w-24 truncate text-right\">{name}</span>\r\n                            <div className=\"flex-1 h-4 bg-gm-surface-secondary rounded overflow-hidden\">\r\n                              <div className=\"h-full rounded transition-all\" style={{\r\n                                width: `${Math.max((count / maxCount) * 100, 2)}%`,\r\n                                backgroundColor: getColor(name, '#6366f1'),\r\n                              }} />\r\n                            </div>\r\n                            <span className=\"text-[10px] font-mono text-gm-text-tertiary w-8 text-right\">{count}</span>\r\n                          </div>\r\n                        );\r\n                      })}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {relations.length > 0 && (\r\n                  <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n                    <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\">\r\n                      <GitBranch className=\"w-3.5 h-3.5\" /> Relation Types by Instance Count\r\n                    </h4>\r\n                    <div className=\"space-y-1.5\">\r\n                      {relations.slice(0, 10).map((r) => {\r\n                        const name = String(r.name || r.type || r.label || '?');\r\n                        const count = Number(r.count || r.instances || r.edgeCount || 0);\r\n                        const maxCount = Math.max(...relations.slice(0, 10).map(x => Number(x.count || x.instances || x.edgeCount || 0)), 1);\r\n                        return (\r\n                          <div key={name} className=\"flex items-center gap-2\">\r\n                            <span className=\"text-[10px] text-gm-text-tertiary w-24 truncate text-right\">{name}</span>\r\n                            <div className=\"flex-1 h-4 bg-gm-surface-secondary rounded overflow-hidden\">\r\n                              <div className=\"h-full rounded bg-gm-interactive-primary/70 transition-all\" style={{\r\n                                width: `${Math.max((count / maxCount) * 100, 2)}%`,\r\n                              }} />\r\n                            </div>\r\n                            <span className=\"text-[10px] font-mono text-gm-text-tertiary w-8 text-right\">{count}</span>\r\n                          </div>\r\n                        );\r\n                      })}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Compliance Score */}\r\n                {complianceScore > 0 && (\r\n                  <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary\">\r\n                    <div className=\"flex items-center gap-3 mb-3\">\r\n                      <Shield className=\"w-4 h-4 text-gm-interactive-primary\" />\r\n                      <h4 className=\"text-xs font-semibold text-gm-text-primary\">Compliance Score</h4>\r\n                      <span className={cn('text-sm font-bold ml-auto',\r\n                        complianceScore >= 80 ? 'text-gm-status-success' :\r\n                        complianceScore >= 50 ? 'text-gm-status-warning' : 'text-gm-status-danger')}>\r\n                        {complianceScore}%\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"w-full h-2 bg-gm-surface-secondary rounded-full overflow-hidden\">\r\n                      <div className={cn('h-full rounded-full transition-all',\r\n                        complianceScore >= 80 ? 'bg-gm-status-success' :\r\n                        complianceScore >= 50 ? 'bg-gm-status-warning' : 'bg-gm-status-danger')}\r\n                        style={{ width: `${complianceScore}%` }} />\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {complianceIssues.length > 0 && (\r\n                  <div className=\"bg-[var(--gm-status-warning-bg)] border border-yellow-500/20 rounded-xl p-4\">\r\n                    <h4 className=\"text-xs font-semibold text-gm-status-warning mb-2 flex items-center gap-1.5\">\r\n                      <AlertTriangle className=\"w-3.5 h-3.5\" /> Compliance Issues ({complianceIssues.length})\r\n                    </h4>\r\n                    <div className=\"space-y-1.5\">\r\n                      {complianceIssues.slice(0, 8).map((issue, i) => (\r\n                        <p key={i} className=\"text-xs text-gm-text-primary\">{String(issue.message || issue.description || JSON.stringify(issue))}</p>\r\n                      ))}\r\n                      {complianceIssues.length > 8 && <p className=\"text-[10px] text-gm-text-tertiary\">+{complianceIssues.length - 8} more</p>}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                <button onClick={() => complianceQ.refetch()} disabled={complianceQ.isFetching}\r\n                  className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                  {complianceQ.isFetching ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Shield className=\"w-3.5 h-3.5\" />} Check Compliance\r\n                </button>\r\n              </>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/*  Tools Tab  */}\r\n        {tab === 'tools' && (\r\n          <div className=\"space-y-4\">\r\n            {/* Extract from Graph */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\"><Download className=\"w-3.5 h-3.5\" /> Extract Ontology from Graph</h4>\r\n              <p className=\"text-[10px] text-gm-text-tertiary\">Reverse-engineer the ontology schema from existing graph data to discover entity types and relationships that exist in practice.</p>\r\n              <button onClick={() => extractFromGraph.mutate(undefined, {\r\n                onSuccess: (data: unknown) => {\r\n                  const d = data as Record<string, unknown>;\r\n                  const notInSchema = (d.notInSchema || (d.extracted as Record<string, unknown>)?.notInSchema || []) as string[];\r\n                  toast.success(`Extraction complete${notInSchema.length ? `  ${notInSchema.length} types not in schema` : ''}`);\r\n                },\r\n                onError: () => toast.error('Extraction failed'),\r\n              })} disabled={extractFromGraph.isPending}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                {extractFromGraph.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Download className=\"w-3.5 h-3.5\" />} Extract\r\n              </button>\r\n            </div>\r\n\r\n            {/* Diff */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\"><Activity className=\"w-3.5 h-3.5\" /> Schema vs Graph Diff</h4>\r\n              <p className=\"text-[10px] text-gm-text-tertiary\">Compare the defined ontology schema with what actually exists in the graph database.</p>\r\n              <button onClick={() => diffQ.refetch()} disabled={diffQ.isFetching}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                {diffQ.isFetching ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Activity className=\"w-3.5 h-3.5\" />} Run Diff\r\n              </button>\r\n              {!diffQ.isLoading && Object.keys(diff).length > 0 && (\r\n                <div className=\"space-y-2 text-xs mt-2\">\r\n                  {Object.entries(diff).map(([k, v]) => (\r\n                    <div key={k}>\r\n                      <span className=\"text-gm-text-tertiary capitalize font-medium\">{k.replace(/_/g, ' ')}</span>\r\n                      <pre className=\"text-[10px] text-gm-text-primary mt-1 bg-gm-surface-secondary rounded-lg p-2 overflow-x-auto max-h-40\">{typeof v === 'string' ? v : JSON.stringify(v, null, 2)}</pre>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Merge */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\"><Merge className=\"w-3.5 h-3.5\" /> Merge & Update</h4>\r\n              <p className=\"text-[10px] text-gm-text-tertiary\">Merge extracted ontology back into the schema, adding missing entity and relation types.</p>\r\n              <button onClick={() => {\r\n                extractFromGraph.mutate(undefined, {\r\n                  onSuccess: (data: unknown) => {\r\n                    const d = data as Record<string, unknown>;\r\n                    mergeOntology.mutate({ source: d.extracted || d }, {\r\n                      onSuccess: () => toast.success('Ontology merged successfully'),\r\n                      onError: () => toast.error('Merge failed'),\r\n                    });\r\n                  },\r\n                  onError: () => toast.error('Extract failed before merge'),\r\n                });\r\n              }} disabled={extractFromGraph.isPending || mergeOntology.isPending}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-status-warning-bg text-gm-status-warning text-xs font-medium hover:bg-yellow-500/20 disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                {(extractFromGraph.isPending || mergeOntology.isPending) ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Merge className=\"w-3.5 h-3.5\" />} Extract & Merge\r\n              </button>\r\n            </div>\r\n\r\n            {/* Unused Types */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\"><AlertTriangle className=\"w-3.5 h-3.5 text-gm-status-warning\" /> Unused Types</h4>\r\n              <button onClick={() => unusedQ.refetch()} disabled={unusedQ.isFetching}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors mb-2\">\r\n                {unusedQ.isFetching ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Search className=\"w-3.5 h-3.5\" />} Find Unused\r\n              </button>\r\n              {unusedEntities.length > 0 && (\r\n                <div>\r\n                  <p className=\"text-[10px] text-gm-text-tertiary uppercase tracking-wider mb-1.5\">Entities ({unusedEntities.length})</p>\r\n                  <div className=\"flex flex-wrap gap-1.5 mb-2\">\r\n                    {unusedEntities.map(e => (\r\n                      <span key={e} className=\"text-[10px] px-2 py-0.5 rounded-full bg-gm-status-warning-bg text-gm-status-warning font-medium\">{e}</span>\r\n                    ))}\r\n                  </div>\r\n                  <button onClick={() => cleanup.mutate({ entities: unusedEntities }, { onSuccess: () => toast.success('Unused entities removed') })}\r\n                    disabled={cleanup.isPending}\r\n                    className=\"px-3 py-1.5 rounded-lg bg-gm-status-danger-bg text-gm-status-danger text-xs font-medium hover:bg-red-500/20 disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                    {cleanup.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Trash2 className=\"w-3.5 h-3.5\" />} Remove Entities\r\n                  </button>\r\n                </div>\r\n              )}\r\n              {unusedRelations.length > 0 && (\r\n                <div>\r\n                  <p className=\"text-[10px] text-gm-text-tertiary uppercase tracking-wider mb-1.5\">Relations ({unusedRelations.length})</p>\r\n                  <div className=\"flex flex-wrap gap-1.5 mb-2\">\r\n                    {unusedRelations.map(r => (\r\n                      <span key={r} className=\"text-[10px] px-2 py-0.5 rounded-full bg-gm-status-warning-bg text-gm-status-warning font-medium\">{r}</span>\r\n                    ))}\r\n                  </div>\r\n                  <button onClick={() => cleanup.mutate({ relations: unusedRelations }, { onSuccess: () => toast.success('Unused relations removed') })}\r\n                    disabled={cleanup.isPending}\r\n                    className=\"px-3 py-1.5 rounded-lg bg-gm-status-danger-bg text-gm-status-danger text-xs font-medium hover:bg-red-500/20 disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                    {cleanup.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Trash2 className=\"w-3.5 h-3.5\" />} Remove Relations\r\n                  </button>\r\n                </div>\r\n              )}\r\n              {unusedEntities.length === 0 && unusedRelations.length === 0 && !unusedQ.isFetching && (\r\n                <p className=\"text-xs text-gm-text-tertiary\">All types are in use (or click \"Find Unused\" to check).</p>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/*  Jobs Tab  */}\r\n        {tab === 'jobs' && (\r\n          <div className=\"space-y-4\">\r\n            {/* Worker Status */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary\">\r\n              <div className=\"flex items-center gap-2 mb-3\">\r\n                <Activity className=\"w-4 h-4 text-gm-interactive-primary\" />\r\n                <h4 className=\"text-xs font-semibold text-gm-text-primary\">Background Worker</h4>\r\n                <div className={cn('ml-auto px-2 py-0.5 rounded-full text-[9px] font-medium',\r\n                  worker.status === 'running' || worker.running ? 'bg-gm-status-success-bg text-gm-status-success' : 'bg-gm-surface-secondary text-gm-text-tertiary')}>\r\n                  {String(worker.status || (worker.running ? 'Running' : 'Idle'))}\r\n                </div>\r\n              </div>\r\n              {workerQ.isLoading ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : (\r\n                <div className=\"grid grid-cols-3 gap-3 text-xs\">\r\n                  {worker.lastRun && (\r\n                    <div>\r\n                      <p className=\"text-[10px] text-gm-text-tertiary\">Last Run</p>\r\n                      <p className=\"text-gm-text-primary font-medium\">{new Date(String(worker.lastRun || worker.last_run)).toLocaleString()}</p>\r\n                    </div>\r\n                  )}\r\n                  {worker.nextRun && (\r\n                    <div>\r\n                      <p className=\"text-[10px] text-gm-text-tertiary\">Next Run</p>\r\n                      <p className=\"text-gm-text-primary font-medium\">{new Date(String(worker.nextRun || worker.next_run)).toLocaleString()}</p>\r\n                    </div>\r\n                  )}\r\n                  {(worker.totalRuns || worker.total_runs) && (\r\n                    <div>\r\n                      <p className=\"text-[10px] text-gm-text-tertiary\">Total Runs</p>\r\n                      <p className=\"text-gm-text-primary font-medium\">{String(worker.totalRuns || worker.total_runs)}</p>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Quick Actions */}\r\n            <div className=\"flex flex-wrap gap-2\">\r\n              <button onClick={() => triggerWorker.mutate({ type: 'full_analysis' }, { onSuccess: () => toast.success('Full analysis triggered') })} disabled={triggerWorker.isPending}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                {triggerWorker.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Brain className=\"w-3.5 h-3.5\" />} Full Analysis\r\n              </button>\r\n              <button onClick={() => triggerWorker.mutate({ type: 'inference' }, { onSuccess: () => toast.success('Inference triggered') })} disabled={triggerWorker.isPending}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                <Zap className=\"w-3.5 h-3.5\" /> Inference Rules\r\n              </button>\r\n              <button onClick={() => triggerWorker.mutate({ type: 'dedup' }, { onSuccess: () => toast.success('Dedup triggered') })} disabled={triggerWorker.isPending}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                <Layers className=\"w-3.5 h-3.5\" /> Deduplication\r\n              </button>\r\n              <button onClick={() => triggerWorker.mutate({ type: 'gap_detection' }, { onSuccess: () => toast.success('Gap detection triggered') })} disabled={triggerWorker.isPending}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                <Search className=\"w-3.5 h-3.5\" /> Gap Detection\r\n              </button>\r\n              <button onClick={() => forceSync.mutate(undefined, { onSuccess: () => toast.success('Sync triggered') })} disabled={forceSync.isPending}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                <RefreshCw className=\"w-3.5 h-3.5\" /> Force Sync\r\n              </button>\r\n            </div>\r\n\r\n            {/* Scheduled Jobs */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\"><Clock className=\"w-3.5 h-3.5\" /> Scheduled Jobs</h4>\r\n              {jobsQ.isLoading ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : jobs.length === 0 ? (\r\n                <p className=\"text-xs text-gm-text-tertiary\">No scheduled jobs configured</p>\r\n              ) : (\r\n                <div className=\"space-y-2\">\r\n                  {jobs.map((job, i) => {\r\n                    const name = String(job.name || job.type || job.id || '');\r\n                    const enabled = Boolean(job.enabled ?? job.active ?? true);\r\n                    const interval = String(job.interval || job.cron || job.schedule || '');\r\n                    const lastRun = job.lastRun || job.last_run;\r\n                    const jobStatus = String(job.status || (enabled ? 'active' : 'paused'));\r\n                    const totalRuns = Number(job.stats && (job.stats as Record<string, unknown>).totalRuns) || Number(job.total_runs || 0);\r\n                    return (\r\n                      <div key={i} className=\"flex items-center gap-3 bg-gm-surface-secondary rounded-lg p-2.5\">\r\n                        <button onClick={() => toggleJob.mutate(String(job.id), { onSuccess: () => toast.success(`Job ${enabled ? 'disabled' : 'enabled'}`) })}\r\n                          disabled={toggleJob.isPending}\r\n                          className={cn('p-1 rounded-md transition-colors', enabled ? 'text-gm-status-success hover:bg-green-500/10' : 'text-gm-text-tertiary hover:bg-gm-surface-hover')}>\r\n                          {enabled ? <Power className=\"w-3.5 h-3.5\" /> : <PowerOff className=\"w-3.5 h-3.5\" />}\r\n                        </button>\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <span className=\"text-xs font-medium text-gm-text-primary\">{name}</span>\r\n                            <span className={cn('text-[9px] px-1 py-0.5 rounded',\r\n                              enabled ? 'bg-gm-status-success-bg text-gm-status-success' : 'bg-gm-surface-hover text-gm-text-tertiary')}>\r\n                              {jobStatus}\r\n                            </span>\r\n                          </div>\r\n                          <div className=\"flex gap-3 text-[10px] text-gm-text-tertiary mt-0.5\">\r\n                            {interval && <span>{interval}</span>}\r\n                            {lastRun && <span>Last: {new Date(String(lastRun)).toLocaleString()}</span>}\r\n                            {totalRuns > 0 && <span>{totalRuns} runs</span>}\r\n                          </div>\r\n                        </div>\r\n                        <button onClick={() => triggerWorker.mutate({ type: String(job.type || job.id) }, { onSuccess: () => toast.success('Job triggered') })}\r\n                          disabled={triggerWorker.isPending}\r\n                          className=\"p-1.5 rounded-lg bg-gm-interactive-primary/10 text-gm-interactive-primary hover:bg-gm-interactive-primary/20 transition-colors\" title=\"Run now\">\r\n                          <Play className=\"w-3 h-3\" />\r\n                        </button>\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Execution Log */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\"><History className=\"w-3.5 h-3.5\" /> Execution Log</h4>\r\n              {workerLogQ.isLoading ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : workerLog.length === 0 ? (\r\n                <p className=\"text-xs text-gm-text-tertiary\">No execution history</p>\r\n              ) : (\r\n                <div className=\"space-y-1.5 max-h-60 overflow-y-auto\">\r\n                  {workerLog.slice(0, 20).map((entry, i) => {\r\n                    const jobType = String(entry.jobType || entry.job_type || entry.type || '');\r\n                    const status = String(entry.status || '');\r\n                    const started = entry.startedAt || entry.started_at || entry.created_at;\r\n                    const duration = Number(entry.duration || entry.elapsed_ms || 0);\r\n                    const error = String(entry.error || '');\r\n                    return (\r\n                      <div key={i} className=\"flex items-center gap-2 text-xs\">\r\n                        <div className={cn('w-1.5 h-1.5 rounded-full shrink-0',\r\n                          status === 'completed' ? 'bg-gm-status-success' :\r\n                          status === 'failed' ? 'bg-gm-status-danger' :\r\n                          status === 'started' ? 'bg-gm-status-warning animate-pulse' : 'bg-gm-text-tertiary')} />\r\n                        <span className=\"text-gm-text-primary font-medium w-24 shrink-0 truncate\">{jobType}</span>\r\n                        <span className={cn('text-[10px] w-16 shrink-0',\r\n                          status === 'completed' ? 'text-gm-status-success' : status === 'failed' ? 'text-gm-status-danger' : 'text-gm-text-tertiary')}>\r\n                          {status}\r\n                        </span>\r\n                        {duration > 0 && <span className=\"text-[10px] text-gm-text-tertiary w-16 shrink-0\">{duration > 1000 ? `${(duration / 1000).toFixed(1)}s` : `${duration}ms`}</span>}\r\n                        {started && <span className=\"text-[10px] text-gm-text-tertiary\">{new Date(String(started)).toLocaleString()}</span>}\r\n                        {error && status === 'failed' && <span className=\"text-[10px] text-gm-status-danger truncate max-w-[150px]\" title={error}>{error}</span>}\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/*  Changes/History Tab  */}\r\n        {tab === 'changes' && (\r\n          <div className=\"space-y-4\">\r\n            {/* Sync Status */}\r\n            {!syncStatusQ.isLoading && Object.keys(syncStatusData).length > 0 && (\r\n              <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary\">\r\n                <h4 className=\"text-xs font-semibold text-gm-text-primary mb-2 flex items-center gap-1.5\"><RefreshCw className=\"w-3.5 h-3.5\" /> Sync Status</h4>\r\n                <div className=\"grid grid-cols-2 gap-2 text-xs\">\r\n                  {Object.entries(syncStatusData).map(([k, v]) => (\r\n                    <div key={k} className=\"flex items-center gap-2\">\r\n                      <span className=\"text-gm-text-tertiary capitalize shrink-0\">{k.replace(/_/g, ' ')}</span>\r\n                      <span className=\"text-gm-text-primary text-[10px] truncate\">{v == null ? '' : String(v)}</span>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Change Log */}\r\n            <div>\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary mb-3 flex items-center gap-1.5\"><History className=\"w-3.5 h-3.5\" /> Change Log</h4>\r\n              {changesQ.isLoading ? <Loader2 className=\"w-5 h-5 animate-spin text-gm-interactive-primary mx-auto\" /> : changes.length === 0 ? (\r\n                <div className=\"text-center py-8\">\r\n                  <History className=\"w-10 h-10 mx-auto mb-3 text-gray-600\" />\r\n                  <p className=\"text-xs text-gm-text-tertiary\">No changes recorded</p>\r\n                </div>\r\n              ) : (\r\n                <div className=\"space-y-1.5\">\r\n                  {changes.slice(0, 50).map((c, i) => {\r\n                    const changeType = String(c.change_type || c.action || c.type || '');\r\n                    const targetName = String(c.target_name || c.target || c.entity || '');\r\n                    const reason = String(c.reason || c.description || c.message || '');\r\n                    const source = String(c.source || '');\r\n                    const changedAt = c.changed_at || c.created_at;\r\n                    const isAdd = changeType.includes('added') || changeType === 'add';\r\n                    const isRemove = changeType.includes('removed') || changeType === 'remove';\r\n                    return (\r\n                      <div key={i} className=\"flex items-start gap-2 bg-[var(--gm-surface-hover)] rounded-lg p-2.5 border border-gm-border-primary\">\r\n                        <div className={cn('w-2 h-2 rounded-full mt-1.5 shrink-0',\r\n                          isAdd ? 'bg-gm-status-success' : isRemove ? 'bg-gm-status-danger' : 'bg-gm-status-warning')} />\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <span className=\"text-[10px] px-1.5 py-0.5 rounded bg-gm-surface-secondary text-gm-text-tertiary font-medium\">{changeType.replace(/_/g, ' ')}</span>\r\n                            {targetName && <span className=\"text-xs font-medium text-gm-text-primary\">{targetName}</span>}\r\n                          </div>\r\n                          {reason && <p className=\"text-[10px] text-gm-text-tertiary mt-0.5\">{reason}</p>}\r\n                          <div className=\"flex gap-2 mt-0.5 text-[9px] text-gm-text-tertiary\">\r\n                            {source && <span>{source}</span>}\r\n                            {changedAt && <span>{new Date(String(changedAt)).toLocaleString()}</span>}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n        {/*  Inference Rules Tab  */}\r\n        {tab === 'inference' && (\r\n          <div className=\"space-y-4\">\r\n            {/* Stats */}\r\n            <div className=\"grid grid-cols-4 gap-3\">\r\n              {[\r\n                { label: 'Runs', value: inferenceStatsData.runsCompleted || 0 },\r\n                { label: 'Inferred', value: inferenceStatsData.totalRelationshipsInferred || 0 },\r\n                { label: 'Errors', value: inferenceStatsData.totalErrors || 0 },\r\n                { label: 'Last Run', value: inferenceStatsData.lastRun ? new Date(String(inferenceStatsData.lastRun)).toLocaleDateString() : '' },\r\n              ].map((s, i) => (\r\n                <div key={i} className=\"bg-gm-surface-secondary rounded-xl p-3 border border-gm-border-primary\">\r\n                  <p className=\"text-lg font-bold text-gm-text-primary\">{String(s.value)}</p>\r\n                  <p className=\"text-[10px] text-gm-text-tertiary\">{s.label}</p>\r\n                </div>\r\n              ))}\r\n            </div>\r\n\r\n            {/* Run All */}\r\n            <div className=\"flex gap-2\">\r\n              <button onClick={() => runInference.mutate(undefined, { onSuccess: () => toast.success('All inference rules executed') })}\r\n                disabled={runInference.isPending}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                {runInference.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Zap className=\"w-3.5 h-3.5\" />} Run All Rules\r\n              </button>\r\n            </div>\r\n\r\n            {/* Rules List */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\"><Zap className=\"w-3.5 h-3.5\" /> Defined Rules</h4>\r\n              {inferenceRulesQ.isLoading ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : inferenceRules.length === 0 && inferenceCyphers.length === 0 ? (\r\n                <p className=\"text-xs text-gm-text-tertiary\">No inference rules defined</p>\r\n              ) : (\r\n                <div className=\"space-y-2\">\r\n                  {inferenceRules.map((rule, i) => (\r\n                    <div key={i} className=\"flex items-center gap-3 bg-gm-surface-secondary rounded-lg p-2.5\">\r\n                      <Zap className=\"w-3.5 h-3.5 text-gm-status-warning shrink-0\" />\r\n                      <div className=\"flex-1 min-w-0\">\r\n                        <span className=\"text-xs font-medium text-gm-text-primary\">{String(rule.name || rule.id || '')}</span>\r\n                        {rule.description && <p className=\"text-[10px] text-gm-text-tertiary\">{String(rule.description)}</p>}\r\n                        {rule.type && <span className=\"text-[9px] px-1 py-0.5 rounded bg-gm-surface-hover text-gm-text-tertiary ml-1\">{String(rule.type)}</span>}\r\n                      </div>\r\n                      <button onClick={() => runInference.mutate(String(rule.name || rule.id), { onSuccess: () => toast.success(`Rule \"${rule.name}\" executed`) })}\r\n                        disabled={runInference.isPending}\r\n                        className=\"p-1.5 rounded-lg bg-gm-interactive-primary/10 text-gm-interactive-primary hover:bg-gm-interactive-primary/20 transition-colors\" title=\"Run rule\">\r\n                        <Play className=\"w-3 h-3\" />\r\n                      </button>\r\n                    </div>\r\n                  ))}\r\n                  {inferenceCyphers.map((cypher, i) => (\r\n                    <div key={`c-${i}`} className=\"bg-gm-surface-secondary rounded-lg p-2.5\">\r\n                      <div className=\"flex items-center gap-2 mb-1\">\r\n                        <span className=\"text-[9px] px-1 py-0.5 rounded bg-blue-600/10 text-gm-interactive-primary font-medium\">Cypher</span>\r\n                        <span className=\"text-xs font-medium text-gm-text-primary\">{String(cypher.name || '')}</span>\r\n                      </div>\r\n                      {cypher.description && <p className=\"text-[10px] text-gm-text-tertiary\">{String(cypher.description)}</p>}\r\n                      {cypher.cypher && <pre className=\"text-[9px] text-gm-text-tertiary mt-1 bg-gm-surface-hover rounded p-1.5 overflow-x-auto\">{String(cypher.cypher)}</pre>}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Available (runtime) rules */}\r\n            {availableInferenceRules.length > 0 && (\r\n              <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n                <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\"><Info className=\"w-3.5 h-3.5\" /> Available Runtime Rules</h4>\r\n                <div className=\"space-y-1.5\">\r\n                  {availableInferenceRules.map((r, i) => (\r\n                    <div key={i} className=\"flex items-center gap-2 text-xs\">\r\n                      <span className=\"text-gm-text-primary font-medium\">{String(r.name || '')}</span>\r\n                      {r.description && <span className=\"text-[10px] text-gm-text-tertiary\"> {String(r.description)}</span>}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/*  Embeddings Dashboard Tab  */}\r\n        {tab === 'embeddings' && (\r\n          <div className=\"space-y-4\">\r\n            {embeddingsDashQ.isLoading ? <Loader2 className=\"w-5 h-5 animate-spin text-gm-interactive-primary mx-auto\" /> : (\r\n              <>\r\n                {/* Summary */}\r\n                <div className=\"grid grid-cols-4 gap-3\">\r\n                  {[\r\n                    { label: 'Total Entities', value: embeddingSummary.totalEntities || 0 },\r\n                    { label: 'With Embeddings', value: embeddingSummary.totalWithEmbeddings || 0 },\r\n                    { label: 'Coverage', value: `${embeddingSummary.overallCoverage || 0}%` },\r\n                    { label: 'Model', value: String(embeddingSummary.model || 'N/A') },\r\n                  ].map((s, i) => (\r\n                    <div key={i} className=\"bg-gm-surface-secondary rounded-xl p-3 border border-gm-border-primary\">\r\n                      <p className=\"text-lg font-bold text-gm-text-primary\">{String(s.value)}</p>\r\n                      <p className=\"text-[10px] text-gm-text-tertiary\">{s.label}</p>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n\r\n                {/* Overall Progress Bar */}\r\n                <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary\">\r\n                  <div className=\"flex items-center justify-between mb-2\">\r\n                    <h4 className=\"text-xs font-semibold text-gm-text-primary\">Overall Coverage</h4>\r\n                    <span className={cn('text-sm font-bold',\r\n                      Number(embeddingSummary.overallCoverage || 0) >= 80 ? 'text-gm-status-success' :\r\n                      Number(embeddingSummary.overallCoverage || 0) >= 50 ? 'text-gm-status-warning' : 'text-gm-status-danger')}>\r\n                      {embeddingSummary.overallCoverage || 0}%\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"w-full h-3 bg-gm-surface-secondary rounded-full overflow-hidden\">\r\n                    <div className={cn('h-full rounded-full transition-all',\r\n                      Number(embeddingSummary.overallCoverage || 0) >= 80 ? 'bg-gm-status-success' :\r\n                      Number(embeddingSummary.overallCoverage || 0) >= 50 ? 'bg-gm-status-warning' : 'bg-gm-status-danger')}\r\n                      style={{ width: `${embeddingSummary.overallCoverage || 0}%` }} />\r\n                  </div>\r\n                  <div className=\"flex gap-3 mt-2 text-[10px] text-gm-text-tertiary\">\r\n                    <span>Dimensions: {String(embeddingSummary.dimensions || 1024)}</span>\r\n                    {Number(embeddingSummary.staleCount || 0) > 0 && <span className=\"text-gm-status-warning\">{embeddingSummary.staleCount} stale</span>}\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Per-Type Coverage */}\r\n                <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n                  <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\"><BarChart3 className=\"w-3.5 h-3.5\" /> Coverage by Type</h4>\r\n                  {Object.keys(embeddingCoverage).length === 0 ? (\r\n                    <p className=\"text-xs text-gm-text-tertiary\">No coverage data available</p>\r\n                  ) : (\r\n                    <div className=\"space-y-2\">\r\n                      {Object.entries(embeddingCoverage).map(([type, data]) => {\r\n                        const coverage = Number(data.coverage || 0);\r\n                        const total = Number(data.total || 0);\r\n                        const withEmb = Number(data.withEmbedding || 0);\r\n                        return (\r\n                          <div key={type} className=\"space-y-1\">\r\n                            <div className=\"flex items-center justify-between text-xs\">\r\n                              <div className=\"flex items-center gap-2\">\r\n                                <span className=\"font-medium text-gm-text-primary capitalize\">{type}</span>\r\n                                <span className=\"text-[10px] text-gm-text-tertiary\">{withEmb}/{total}</span>\r\n                              </div>\r\n                              <span className={cn('text-[10px] font-medium',\r\n                                coverage >= 80 ? 'text-gm-status-success' : coverage >= 50 ? 'text-gm-status-warning' : 'text-gm-status-danger')}>\r\n                                {coverage}%\r\n                              </span>\r\n                            </div>\r\n                            <div className=\"w-full h-1.5 bg-gm-surface-secondary rounded-full overflow-hidden\">\r\n                              <div className={cn('h-full rounded-full transition-all',\r\n                                coverage >= 80 ? 'bg-gm-status-success' : coverage >= 50 ? 'bg-gm-status-warning' : 'bg-gm-status-danger')}\r\n                                style={{ width: `${coverage}%` }} />\r\n                            </div>\r\n                          </div>\r\n                        );\r\n                      })}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Regenerate */}\r\n                <div className=\"flex gap-2\">\r\n                  <button onClick={() => regenEmbeddings.mutate(undefined, { onSuccess: () => toast.success('Embedding regeneration queued for all types') })}\r\n                    disabled={regenEmbeddings.isPending}\r\n                    className=\"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                    {regenEmbeddings.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <RefreshCw className=\"w-3.5 h-3.5\" />} Regenerate All\r\n                  </button>\r\n                </div>\r\n              </>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/*  Shared / Cross-Project Tab  */}\r\n        {tab === 'shared' && (\r\n          <div className=\"space-y-4\">\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary mb-1\">Cross-Project Entities</h4>\r\n              <p className=\"text-[10px] text-gm-text-tertiary mb-3\">Shared entity types are visible across all projects. Toggle sharing per entity type.</p>\r\n            </div>\r\n\r\n            {/* All Entities with Share Toggle */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\"><Layers className=\"w-3.5 h-3.5\" /> Entity Types</h4>\r\n              {entitiesQ.isLoading ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : (\r\n                <div className=\"space-y-1.5\">\r\n                  {entities.map((e, i) => {\r\n                    const name = String(e.name || e.type || e.label || '');\r\n                    const isShared = Boolean(e.sharedEntity || e.shared);\r\n                    const color = getColor(name, e.color ? String(e.color) : undefined);\r\n                    return (\r\n                      <div key={i} className=\"flex items-center gap-3 bg-gm-surface-secondary rounded-lg p-2\">\r\n                        <div className=\"w-5 h-5 rounded flex items-center justify-center text-white text-[8px] font-bold\" style={{ backgroundColor: color }}>\r\n                          {name.charAt(0)}\r\n                        </div>\r\n                        <span className=\"text-xs font-medium text-gm-text-primary flex-1\">{name}</span>\r\n                        <button\r\n                          onClick={() => toggleShared.mutate({ name, shared: !isShared }, {\r\n                            onSuccess: () => toast.success(`${name} is now ${!isShared ? 'shared' : 'project-only'}`),\r\n                          })}\r\n                          disabled={toggleShared.isPending}\r\n                          className={cn('px-2 py-0.5 rounded-full text-[9px] font-medium transition-colors',\r\n                            isShared ? 'bg-gm-interactive-primary/10 text-gm-interactive-primary' : 'bg-gm-surface-hover text-gm-text-tertiary hover:bg-gm-surface-secondary')}>\r\n                          {isShared ? 'Shared' : 'Project Only'}\r\n                        </button>\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Cross-Graph Relations */}\r\n            {crossGraphRelations.length > 0 && (\r\n              <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n                <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\"><GitBranch className=\"w-3.5 h-3.5\" /> Cross-Graph Relations</h4>\r\n                <div className=\"space-y-1.5\">\r\n                  {crossGraphRelations.map((r, i) => (\r\n                    <div key={i} className=\"flex items-center gap-2 text-xs\">\r\n                      <span className=\"text-gm-text-primary font-medium\">{String(r.name || r.type || '')}</span>\r\n                      {r.from && <span className=\"text-[10px] text-gm-text-tertiary\">({String(r.from)}  {String(r.to)})</span>}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Shared Entities Summary */}\r\n            {sharedEntities.length > 0 && (\r\n              <div className=\"bg-blue-600/5 rounded-xl p-4 border border-blue-600/10\">\r\n                <h4 className=\"text-xs font-semibold text-gm-interactive-primary mb-2\">{sharedEntities.length} Shared Entity Types</h4>\r\n                <div className=\"flex flex-wrap gap-1.5\">\r\n                  {sharedEntities.map((e, i) => (\r\n                    <span key={i} className=\"text-[10px] px-2 py-0.5 rounded-full bg-gm-interactive-primary/10 text-gm-interactive-primary font-medium\">\r\n                      {String(e.name || '')}\r\n                    </span>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/*  Versions Tab  */}\r\n        {tab === 'versions' && (\r\n          <div className=\"space-y-4\">\r\n            {/* Current Version */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <div className=\"w-10 h-10 rounded-xl bg-gm-interactive-primary/10 flex items-center justify-center\">\r\n                  <History className=\"w-5 h-5 text-gm-interactive-primary\" />\r\n                </div>\r\n                <div>\r\n                  <h4 className=\"text-sm font-bold text-gm-text-primary\">Current Version: {String(versionsData.currentVersion || '')}</h4>\r\n                  <p className=\"text-[10px] text-gm-text-tertiary\">{String(versionsData.totalChanges || 0)} total changes recorded</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Version History */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\"><History className=\"w-3.5 h-3.5\" /> Version History</h4>\r\n              {versionsQ.isLoading ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : versionHistory.length === 0 ? (\r\n                <p className=\"text-xs text-gm-text-tertiary\">No version snapshots recorded</p>\r\n              ) : (\r\n                <div className=\"space-y-2\">\r\n                  {versionHistory.map((v, i) => (\r\n                    <div key={i} className=\"bg-gm-surface-secondary rounded-lg p-3 border border-gm-border-primary\">\r\n                      <div className=\"flex items-center gap-2 mb-1\">\r\n                        <span className=\"text-xs font-bold text-gm-text-primary\">v{String(v.version || '?')}</span>\r\n                        <span className=\"text-[10px] px-1.5 py-0.5 rounded bg-gm-surface-hover text-gm-text-tertiary\">{String(v.changeType || v.change_type || '').replace(/_/g, ' ')}</span>\r\n                        {v.source && <span className=\"text-[9px] text-gm-text-tertiary\">{String(v.source)}</span>}\r\n                      </div>\r\n                      {v.reason && <p className=\"text-[10px] text-gm-text-tertiary\">{String(v.reason)}</p>}\r\n                      <div className=\"flex gap-2 mt-1 text-[9px] text-gm-text-tertiary\">\r\n                        {v.changedBy && <span>by {String(v.changedBy)}</span>}\r\n                        {v.changedAt && <span>{new Date(String(v.changedAt)).toLocaleString()}</span>}\r\n                      </div>\r\n                      {v.diff && Object.keys(v.diff as Record<string, unknown>).length > 0 && (\r\n                        <pre className=\"text-[9px] text-gm-text-tertiary mt-2 bg-gm-surface-hover rounded p-2 overflow-x-auto max-h-20\">{JSON.stringify(v.diff, null, 2)}</pre>\r\n                      )}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/*  Test Tab  */}\r\n        {tab === 'test' && (\r\n          <div className=\"space-y-4\">\r\n\r\n            {/* Validate Entity */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\">\r\n                <Shield className=\"w-3.5 h-3.5\" /> Validate Entity Against Schema\r\n              </h4>\r\n              <p className=\"text-[10px] text-gm-text-tertiary\">Test whether an entity object conforms to its type definition in the ontology schema.</p>\r\n              <div className=\"flex gap-2\">\r\n                <select value={validateType} onChange={e => setValidateType(e.target.value)}\r\n                  className=\"flex-shrink-0 w-40 px-2 py-1.5 text-xs bg-gm-surface-secondary border border-gm-border-primary rounded-lg text-gm-text-primary\">\r\n                  <option value=\"\">Select type...</option>\r\n                  {entities.map(e => {\r\n                    const n = String(e.name || e.type || e.label || '');\r\n                    return <option key={n} value={n}>{n}</option>;\r\n                  })}\r\n                </select>\r\n              </div>\r\n              <textarea value={validateJson} onChange={e => setValidateJson(e.target.value)} rows={5}\r\n                className=\"w-full px-3 py-2 text-xs font-mono bg-gm-surface-secondary border border-gm-border-primary rounded-lg text-gm-text-primary resize-y\"\r\n                placeholder='{\"name\": \"example\", \"description\": \"...\"}'\r\n              />\r\n              <button disabled={!validateType || validateEntity.isPending}\r\n                onClick={() => {\r\n                  try {\r\n                    const parsed = JSON.parse(validateJson);\r\n                    validateEntity.mutate({ type: validateType, entity: parsed });\r\n                  } catch { toast.error('Invalid JSON'); }\r\n                }}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-white text-xs font-medium hover:opacity-90 disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                {validateEntity.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Shield className=\"w-3.5 h-3.5\" />} Validate\r\n              </button>\r\n              {validateEntity.data && (\r\n                <div className={cn('rounded-lg p-3 border text-xs',\r\n                  (validateEntity.data as Record<string, unknown>).valid\r\n                    ? 'bg-gm-status-success/10 border-gm-status-success/30 text-gm-status-success'\r\n                    : 'bg-gm-status-danger/10 border-gm-status-danger/30 text-gm-status-danger')}>\r\n                  <div className=\"flex items-center gap-1.5 font-semibold mb-1\">\r\n                    {(validateEntity.data as Record<string, unknown>).valid\r\n                      ? <><CheckCircle className=\"w-3.5 h-3.5\" /> Valid</>\r\n                      : <><XCircle className=\"w-3.5 h-3.5\" /> Invalid</>}\r\n                  </div>\r\n                  {((validateEntity.data as Record<string, unknown>).errors as string[] || []).length > 0 && (\r\n                    <ul className=\"mt-1 space-y-0.5 text-gm-text-primary\">\r\n                      {((validateEntity.data as Record<string, unknown>).errors as string[]).map((err, i) => (\r\n                        <li key={i} className=\"text-[10px]\">- {err}</li>\r\n                      ))}\r\n                    </ul>\r\n                  )}\r\n                  {((validateEntity.data as Record<string, unknown>).missingRequired as string[] || []).length > 0 && (\r\n                    <p className=\"text-[10px] text-gm-text-primary mt-1\">Missing required: {((validateEntity.data as Record<string, unknown>).missingRequired as string[]).join(', ')}</p>\r\n                  )}\r\n                  {((validateEntity.data as Record<string, unknown>).unknownProperties as string[] || []).length > 0 && (\r\n                    <p className=\"text-[10px] text-gm-text-primary mt-1\">Unknown properties: {((validateEntity.data as Record<string, unknown>).unknownProperties as string[]).join(', ')}</p>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Extract Entities from Text */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\">\r\n                <FileText className=\"w-3.5 h-3.5\" /> Extract Entities from Text (AI)\r\n              </h4>\r\n              <p className=\"text-[10px] text-gm-text-tertiary\">Paste any text and let the AI identify entities and relationships using the current ontology schema.</p>\r\n              <textarea value={extractText} onChange={e => setExtractText(e.target.value)} rows={6}\r\n                className=\"w-full px-3 py-2 text-xs bg-gm-surface-secondary border border-gm-border-primary rounded-lg text-gm-text-primary resize-y\"\r\n                placeholder=\"Paste meeting notes, a document, or any text here...\"\r\n              />\r\n              <button disabled={!extractText.trim() || extractFromText.isPending}\r\n                onClick={() => extractFromText.mutate({\r\n                  text: extractText,\r\n                  existingEntities: entities.map(e => String(e.name || e.type || '')).filter(Boolean),\r\n                })}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-white text-xs font-medium hover:opacity-90 disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                {extractFromText.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Sparkles className=\"w-3.5 h-3.5\" />} Extract\r\n              </button>\r\n              {extractFromText.data && (\r\n                <div className=\"space-y-3\">\r\n                  {((extractFromText.data as Record<string, unknown>).entities as Array<Record<string, unknown>> || []).length > 0 && (\r\n                    <div className=\"bg-gm-surface-secondary rounded-lg p-3 border border-gm-border-primary space-y-2\">\r\n                      <h5 className=\"text-[10px] font-semibold text-gm-text-primary\">Extracted Entities ({((extractFromText.data as Record<string, unknown>).entities as unknown[]).length})</h5>\r\n                      <div className=\"flex flex-wrap gap-1.5\">\r\n                        {((extractFromText.data as Record<string, unknown>).entities as Array<Record<string, unknown>>).map((ent, i) => (\r\n                          <span key={i} className=\"px-2 py-1 rounded-lg text-[10px] font-medium border border-gm-border-primary bg-gm-surface-hover text-gm-text-primary\">\r\n                            <span className=\"inline-block w-2 h-2 rounded-full mr-1\" style={{ backgroundColor: getColor(String(ent.type || ent.entityType || ''), '#6366f1') }} />\r\n                            {String(ent.name || ent.value || '?')}\r\n                            <span className=\"ml-1 text-gm-text-tertiary\">{String(ent.type || ent.entityType || '')}</span>\r\n                          </span>\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                  {((extractFromText.data as Record<string, unknown>).relationships as Array<Record<string, unknown>> || []).length > 0 && (\r\n                    <div className=\"bg-gm-surface-secondary rounded-lg p-3 border border-gm-border-primary space-y-2\">\r\n                      <h5 className=\"text-[10px] font-semibold text-gm-text-primary\">Extracted Relationships ({((extractFromText.data as Record<string, unknown>).relationships as unknown[]).length})</h5>\r\n                      <div className=\"space-y-1\">\r\n                        {((extractFromText.data as Record<string, unknown>).relationships as Array<Record<string, unknown>>).map((rel, i) => (\r\n                          <div key={i} className=\"flex items-center gap-1.5 text-[10px] text-gm-text-primary\">\r\n                            <span className=\"font-medium\">{String(rel.from || rel.source || '?')}</span>\r\n                            <span className=\"px-1.5 py-0.5 rounded bg-gm-interactive-primary/10 text-gm-interactive-primary font-mono text-[9px]\">{String(rel.type || rel.relationship || '?')}</span>\r\n                            <span className=\"font-medium\">{String(rel.to || rel.target || '?')}</span>\r\n                            {rel.confidence && <span className=\"text-gm-text-tertiary\">({Math.round(Number(rel.confidence) * 100)}%)</span>}\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                  {((extractFromText.data as Record<string, unknown>).entities as unknown[] || []).length === 0 &&\r\n                   ((extractFromText.data as Record<string, unknown>).relationships as unknown[] || []).length === 0 && (\r\n                    <p className=\"text-xs text-gm-text-tertiary\">No entities or relationships found in the provided text.</p>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Embedding Preview */}\r\n            <div className=\"bg-[var(--gm-surface-hover)] rounded-xl p-4 border border-gm-border-primary space-y-3\">\r\n              <h4 className=\"text-xs font-semibold text-gm-text-primary flex items-center gap-1.5\">\r\n                <Eye className=\"w-3.5 h-3.5\" /> Embedding Preview\r\n              </h4>\r\n              <p className=\"text-[10px] text-gm-text-tertiary\">Preview the enriched text that would be generated for an entity before converting it to a vector embedding.</p>\r\n              <div className=\"flex gap-2\">\r\n                <select value={enrichType} onChange={e => setEnrichType(e.target.value)}\r\n                  className=\"flex-shrink-0 w-40 px-2 py-1.5 text-xs bg-gm-surface-secondary border border-gm-border-primary rounded-lg text-gm-text-primary\">\r\n                  <option value=\"\">Select type...</option>\r\n                  {entities.map(e => {\r\n                    const n = String(e.name || e.type || e.label || '');\r\n                    return <option key={n} value={n}>{n}</option>;\r\n                  })}\r\n                </select>\r\n              </div>\r\n              <textarea value={enrichJson} onChange={e => setEnrichJson(e.target.value)} rows={4}\r\n                className=\"w-full px-3 py-2 text-xs font-mono bg-gm-surface-secondary border border-gm-border-primary rounded-lg text-gm-text-primary resize-y\"\r\n                placeholder='{\"name\": \"...\", \"description\": \"...\"}'\r\n              />\r\n              <button disabled={!enrichType || enrichEntity.isPending}\r\n                onClick={() => {\r\n                  try {\r\n                    const parsed = JSON.parse(enrichJson);\r\n                    enrichEntity.mutate({ type: enrichType, entity: parsed });\r\n                  } catch { toast.error('Invalid JSON'); }\r\n                }}\r\n                className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary border border-gm-border-primary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n                {enrichEntity.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Eye className=\"w-3.5 h-3.5\" />} Preview Embedding Text\r\n              </button>\r\n              {enrichEntity.data && (enrichEntity.data as Record<string, unknown>).enrichedText && (\r\n                <div className=\"bg-gm-surface-secondary rounded-lg p-3 border border-gm-border-primary\">\r\n                  <h5 className=\"text-[10px] font-semibold text-gm-text-primary mb-2 flex items-center gap-1.5\">\r\n                    <Brain className=\"w-3 h-3\" /> Generated Embedding Text\r\n                  </h5>\r\n                  <pre className=\"text-[10px] text-gm-text-primary whitespace-pre-wrap font-mono leading-relaxed max-h-40 overflow-y-auto\">\r\n                    {String((enrichEntity.data as Record<string, unknown>).enrichedText)}\r\n                  </pre>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Entity Detail Modal */}\r\n      {selectedEntity && (\r\n        <EntityDetailPanel entity={selectedEntity} onClose={() => setSelectedEntity(null)} />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":["__iconNode","FlaskConical","createLucideIcon","GitBranch","Pause","PowerOff","Power","R","ReflectApply","target","receiver","args","ReflectOwnKeys","ProcessEmitWarning","warning","NumberIsNaN","value","EventEmitter","eventsModule","once","defaultMaxListeners","checkListener","listener","arg","n","_getMaxListeners","that","type","i","doError","events","er","err","handler","len","listeners","arrayClone","_addListener","prepend","m","existing","w","onceWrapper","_onceWrap","state","wrapped","list","position","originalListener","spliceOne","keys","key","_listeners","unwrap","evlistener","unwrapListeners","emitter","listenerCount","arr","copy","index","ret","name","resolve","reject","errorListener","resolver","eventTargetAgnosticAddListener","addErrorHandlerIfEventEmitter","flags","wrapListener","assignPolyfill","l","k","assign","getMatchingEdge","graph","source","sourceData","edge","isPlainObject","isEmpty","o","privateProperty","readOnlyProperty","descriptor","validateHints","hints","incrementalIdStartingFromRandomByte","chain","iterables","current","step","emptyIterator","GraphError","message","InvalidArgumentsGraphError","NotFoundGraphError","UsageGraphError","MixedNodeData","attributes","DirectedNodeData","UndirectedNodeData","EdgeData","undirected","outKey","inKey","adj","head","NODE","SOURCE","TARGET","OPPOSITE","findRelevantNodeData","method","mode","nodeOrEdge","nameOrEdge","add1","add2","nodeData","edgeData","arg1","arg2","attachNodeAttributeGetter","Class","data","attachNodeAttributesGetter","attachNodeAttributeChecker","attachNodeAttributeSetter","attachNodeAttributeUpdater","updater","attachNodeAttributeRemover","attachNodeAttributesReplacer","attachNodeAttributesMerger","attachNodeAttributesUpdater","NODE_ATTRIBUTES_METHODS","element","attachNodeAttributesMethods","Graph","attacher","attachEdgeAttributeGetter","attachEdgeAttributesGetter","attachEdgeAttributeChecker","attachEdgeAttributeSetter","attachEdgeAttributeUpdater","attachEdgeAttributeRemover","attachEdgeAttributesReplacer","attachEdgeAttributesMerger","attachEdgeAttributesUpdater","EDGE_ATTRIBUTES_METHODS","attachEdgeAttributesMethods","EDGES_ITERATION","forEachSimple","breakable","object","callback","avoid","shouldBreak","forEachMulti","createIterator","forEachForKeySimple","targetData","forEachForKeyMulti","createIteratorForKey","done","createEdgeArray","size","mask","iterator","forEachEdge","shouldFilter","createEdgeIterator","forEachEdgeForNode","multi","direction","fn","found","createEdgeArrayForNode","edges","createEdgeIteratorForNode","forEachEdgeForPath","createEdgeArrayForPath","createEdgeIteratorForPath","attachEdgeArrayCreator","description","attachForEachEdge","forEachName","mapName","result","length","e","ea","s","t","sa","ta","u","filterName","reduceName","initialValue","accumulator","attachFindEdge","findEdgeName","someName","everyName","attachEdgeIteratorCreator","originalName","attachEdgeIterationMethods","NEIGHBORS_ITERATION","CompositeSetWrapper","set","forEachInObjectOnce","visited","neighborData","forEachNeighbor","createNeighborArrayForNode","neighbors","createDedupedObjectIterator","createNeighborIterator","attachNeighborArrayCreator","node","attachForEachNeighbor","a","attachFindNeighbor","capitalizedSingular","findName","attachNeighborIteratorCreator","iteratorName","attachNeighborIterationMethods","forEachAdjacency","assymetric","disconnectedNodes","neighbor","hasEdges","serializeNode","serialized","serializeEdge","validateSerializedNode","validateSerializedEdge","INSTANCE_ID","TYPES","EMITTER_PROPS","EDGE_ADD_METHODS","verb","DEFAULTS","addNode","unsafeAddNode","addEdge","mustGenerateKey","eventData","isSelfLoop","mergeEdge","asUpdater","alreadyExistingEdgeData","info","oldAttributes","sourceWasAdded","targetWasAdded","dropEdgeFromData","options","NodeDataClass","instancePrefix","edgeId","edgeKeyGenerator","availableEdgeKey","prop","degree","loops","nodes","merge","_sa","_ta","undirectedByDefault","multiIndex","label","tmp","desc","dummy","DirectedGraph","finalOptions","UndirectedGraph","MultiGraph","MultiDirectedGraph","MultiUndirectedGraph","attachStaticFromMethod","instance","isGraph","isLeaf","resolveDefaults","defaults","output","def","MAX_8BIT_INTEGER","MAX_16BIT_INTEGER","MAX_32BIT_INTEGER","MAX_SIGNED_8BIT_INTEGER","MAX_SIGNED_16BIT_INTEGER","MAX_SIGNED_32BIT_INTEGER","exports","maxIndex","TYPE_PRIORITY","array","getter","maxType","maxPriority","p","v","PointerArray","coerceWeight","createNodeValueGetter","nameOrFunction","defaultValue","coerceToDefault","get","returnDefault","createEdgeValueGetter","extremities","getters","typed","require$$0","createEdgeWeightGetter","require$$1","upperBoundPerMethod","NeighborhoodIndex","getNeighbors","upperBound","NeighborhoodPointerArray","NodesPointerArray","ids","j","self","projection","results","_","attr","neighborhood","WeightedNeighborhoodIndex","getEdgeWeight","getEdges","weightGetter","weight","require$$2","abstractPagerank","alpha","maxIterations","tolerance","pagerankAttribute","N","d","normalizedEdgeWeights","danglingNodes","iteration","error","dangleSum","xLast","converged","pagerank","pagerank_1","TIER_CONFIG","NODE_DIMENSIONS","EDGE_STYLES","NODE_COLORS","HIDDEN_EDGE_TYPES","transformGraphData","rawNodes","rawEdges","LABEL_PREFIXES","nodeIdSet","prefixRedirectMap","prefixedIdsToRemove","id","prefix","strippedId","deduplicatedNodes","personToContactMap","contactLinkedPersonIds","nameToContactMap","normalize","contactId","alias","seenPersonNames","processedPersonIds","shouldMerge","targetId","normalizedLabel","nn","tier","dims","getNodeColorToken","validNodeIds","resolveId","processedEdges","styleConfig","MEMBERSHIP_EDGES","teamNodeIds","teamMemberCounts","src","tgt","pairCounts","pairIndex","pairKey","total","idx","offset","TIER_SIZES","toSigmaGraph","useImportance","isGroup","style","scores","values","maxPR","minPR","MIN_SIZE","MAX_SIZE","score","normalized","getColor","fallback","SyncBadge","status","graphConnected","isListening","isSyncing","isConnected","jsxs","cn","jsx","VersionBadge","schema","version","entityCount","relCount","EntityDetailPanel","entity","onClose","color","props","shared","embeddingTemplate","count","propsArray","XCircle","OntologyGraphView","entities","relations","layout","useMemo","nodeMap","cols","spacingX","spacingY","row","col","maxCol","maxRow","r","from","to","Network","dx","dy","midX","midY","curveOffset","RelationBuilderInline","entityNames","onSave","onCancel","isPending","setSource","useState","setTarget","relName","setRelName","setDesc","formatted","handleSave","toast","Loader2","Plus","GraphOntology","tab","setTab","search","setSearch","newEntityName","setNewEntityName","showRelBuilder","setShowRelBuilder","selectedEntity","setSelectedEntity","useOntologySchema","stats","useOntologyStats","entitiesQ","useOntologyEntities","relationsQ","useOntologyRelations","suggestionsQ","useOntologySuggestions","workerQ","useOntologyWorkerStatus","complianceQ","useOntologyCompliance","changesQ","useOntologyChanges","diffQ","useOntologyDiff","unusedQ","useOntologyUnused","syncStatusQ","useOntologySyncStatus","jobsQ","useOntologyJobs","workerLogQ","useOntologyWorkerLog","inferenceRulesQ","useInferenceRules","inferenceStatsQ","useInferenceStats","embeddingsDashQ","useEmbeddingsDashboard","sharedQ","useSharedOntology","versionsQ","useOntologyVersions","approve","useOntologyApproveSuggestion","useOntologyRejectSuggestion","enrichSuggestion","useOntologyEnrichSuggestion","addEntity","useOntologyAddEntityType","addRelation","useOntologyAddRelationType","triggerWorker","useOntologyWorkerTrigger","forceSync","useOntologyForceSync","autoApprove","useOntologyAutoApprove","analyzeGraph","useOntologyAnalyzeGraph","cleanup","useOntologyCleanup","inferRels","useOntologyInferRelationships","toggleJob","useOntologyToggleJob","extractFromGraph","useOntologyExtractFromGraph","mergeOntology","useOntologyMerge","runInference","useRunInferenceRule","regenEmbeddings","useRegenerateEmbeddings","toggleShared","useToggleEntityShared","validateEntity","useValidateEntity","extractFromText","useExtractFromText","enrichEntity","useEnrichEntity","validateType","setValidateType","validateJson","setValidateJson","extractText","setExtractText","enrichType","setEnrichType","enrichJson","setEnrichJson","suggestions","statsData","worker","compliance","complianceIssues","complianceScore","changes","diff","unused","unusedEntities","unusedRelations","syncStatusData","jobs","workerLog","schemaData","inferenceRules","inferenceCyphers","inferenceStatsData","availableInferenceRules","embeddingSummary","embeddingCoverage","sharedEntities","crossGraphRelations","versionsData","versionHistory","searchLower","filteredEntities","filteredRelations","pendingSuggestions","handleAddEntity","handleAddRelation","tabs","Cpu","Sparkles","BarChart3","Wrench","Zap","Brain","Layers","Settings","History","Activity","RefreshCw","Icon","Search","Fragment","propsArr","Eye","Wand2","sType","reason","confidence","enrichment","uc","CheckCircle","val","maxCount","x","Shield","AlertTriangle","issue","Download","notInSchema","Merge","Trash2","Clock","job","enabled","interval","lastRun","jobStatus","totalRuns","Play","entry","jobType","started","duration","c","changeType","targetName","changedAt","isAdd","isRemove","rule","cypher","Info","coverage","withEmb","isShared","parsed","FileText","ent","rel"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12]}
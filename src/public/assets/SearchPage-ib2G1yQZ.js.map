{"version":3,"file":"SearchPage-ib2G1yQZ.js","sources":["../../frontend/src/pages/SearchPage.tsx"],"sourcesContent":["import { useState, useEffect, useMemo, useCallback } from 'react';\r\nimport {\r\n  Search, Filter, Database, RefreshCw, Loader2,\r\n  FileText, Mail, MessageCircle, Users, HelpCircle,\r\n  AlertTriangle, CheckCircle, Zap, X,\r\n  ChevronRight, BarChart3, Clock, Star,\r\n} from 'lucide-react';\r\nimport {\r\n  useSearchFulltext,\r\n  useSearchSuggest,\r\n  useSearchStats,\r\n  useSearchIndex,\r\n  useGlobalSearch,\r\n  type SearchResult,\r\n} from '../hooks/useGodMode';\r\nimport { ErrorState } from '../components/shared/ErrorState';\r\nimport { cn } from '../lib/utils';\r\n\r\nconst TYPE_CONFIG: Record<string, { color: string; icon: typeof FileText; label: string }> = {\r\n  documents:     { color: '#06b6d4', icon: FileText,        label: 'Document' },\r\n  emails:        { color: '#f97316', icon: Mail,             label: 'Email' },\r\n  conversations: { color: '#8b5cf6', icon: MessageCircle,    label: 'Conversation' },\r\n  contacts:      { color: '#ec4899', icon: Users,            label: 'Contact' },\r\n  facts:         { color: '#f59e0b', icon: Star,             label: 'Fact' },\r\n  decisions:     { color: '#a855f7', icon: CheckCircle,      label: 'Decision' },\r\n  risks:         { color: '#ef4444', icon: AlertTriangle,    label: 'Risk' },\r\n  actions:       { color: '#22c55e', icon: Zap,              label: 'Action' },\r\n  questions:     { color: '#3b82f6', icon: HelpCircle,       label: 'Question' },\r\n};\r\n\r\nconst ALL_TYPES = Object.keys(TYPE_CONFIG);\r\n\r\nexport default function SearchPage() {\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [debouncedQuery, setDebouncedQuery] = useState('');\r\n  const [selectedTypes, setSelectedTypes] = useState<string[]>([]);\r\n  const [showFilters, setShowFilters] = useState(false);\r\n  const [showStats, setShowStats] = useState(false);\r\n  const [showSuggestions, setShowSuggestions] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const timer = setTimeout(() => setDebouncedQuery(searchQuery), 300);\r\n    return () => clearTimeout(timer);\r\n  }, [searchQuery]);\r\n\r\n  const { data: suggestions, isFetching: suggestLoading } = useSearchSuggest(debouncedQuery);\r\n  const { data: statsData, isLoading: statsLoading, error: statsError, refetch: refetchStats } = useSearchStats();\r\n  const searchMut = useSearchFulltext();\r\n  const indexMut = useSearchIndex();\r\n\r\n  const results: SearchResult[] = useMemo(() => {\r\n    const raw = searchMut.data as { results?: SearchResult[] } | undefined;\r\n    return raw?.results ?? [];\r\n  }, [searchMut.data]);\r\n\r\n  const totalResults = useMemo(() => {\r\n    const raw = searchMut.data as { total?: number } | undefined;\r\n    return raw?.total ?? results.length;\r\n  }, [searchMut.data, results.length]);\r\n\r\n  const executeSearch = useCallback(() => {\r\n    if (!searchQuery.trim()) return;\r\n    setShowSuggestions(false);\r\n    searchMut.mutate({\r\n      query: searchQuery.trim(),\r\n      types: selectedTypes.length > 0 ? selectedTypes : undefined,\r\n      limit: 50,\r\n    });\r\n  }, [searchQuery, selectedTypes, searchMut]);\r\n\r\n  const handleKeyDown = useCallback((e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter') executeSearch();\r\n    if (e.key === 'Escape') setShowSuggestions(false);\r\n  }, [executeSearch]);\r\n\r\n  const toggleType = useCallback((type: string) => {\r\n    setSelectedTypes(prev =>\r\n      prev.includes(type) ? prev.filter(t => t !== type) : [...prev, type]\r\n    );\r\n  }, []);\r\n\r\n  const applySuggestion = useCallback((text: string) => {\r\n    setSearchQuery(text);\r\n    setShowSuggestions(false);\r\n    searchMut.mutate({\r\n      query: text,\r\n      types: selectedTypes.length > 0 ? selectedTypes : undefined,\r\n      limit: 50,\r\n    });\r\n  }, [selectedTypes, searchMut]);\r\n\r\n  const suggestionItems: string[] = useMemo(() => {\r\n    const raw = suggestions as { suggestions?: string[] } | undefined;\r\n    return raw?.suggestions ?? [];\r\n  }, [suggestions]);\r\n\r\n  const stats = useMemo(() => statsData as Record<string, unknown> | undefined, [statsData]);\r\n\r\n  const handleRebuildIndex = useCallback(() => {\r\n    indexMut.mutate(undefined, { onSuccess: () => refetchStats() });\r\n  }, [indexMut, refetchStats]);\r\n\r\n  return (\r\n    <div className=\"flex flex-col h-[calc(100vh-4rem)]\">\r\n      {/* Search Header */}\r\n      <div className=\"shrink-0 border-b border-gm-border-primary bg-gm-surface-primary sticky top-0 z-20\">\r\n        <div className=\"px-5 py-4\">\r\n          <div className=\"flex items-center gap-3 mb-3\">\r\n            <h1 className=\"text-base font-bold text-gm-text-primary\">Search</h1>\r\n            <span className=\"text-[10px] text-gm-text-tertiary bg-gm-surface-secondary px-2 py-0.5 rounded-full\">\r\n              Full-text\r\n            </span>\r\n          </div>\r\n\r\n          <div className=\"flex items-center gap-2 flex-wrap\">\r\n            {/* Search Input */}\r\n            <div className=\"relative flex-1 min-w-[200px]\">\r\n              <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gm-text-tertiary\" />\r\n              <input\r\n                value={searchQuery}\r\n                onChange={e => { setSearchQuery(e.target.value); setShowSuggestions(true); }}\r\n                onKeyDown={handleKeyDown}\r\n                onFocus={() => { if (debouncedQuery.length >= 2) setShowSuggestions(true); }}\r\n                placeholder=\"Search across all project data...\"\r\n                aria-label=\"Search across all project data\"\r\n                className=\"w-full pl-10 pr-10 py-2.5 bg-gm-surface-secondary border border-gm-border-primary rounded-lg text-sm text-gm-text-primary placeholder:text-gm-text-tertiary focus:outline-none focus:ring-2 focus:ring-gm-border-focus transition-colors\"\r\n              />\r\n              {searchQuery && (\r\n                <button onClick={() => { setSearchQuery(''); setShowSuggestions(false); }}\r\n                  aria-label=\"Clear search\"\r\n                  className=\"absolute right-3 top-1/2 -translate-y-1/2 p-0.5 rounded hover:bg-gm-surface-hover\">\r\n                  <X className=\"w-3.5 h-3.5 text-gm-text-tertiary\" />\r\n                </button>\r\n              )}\r\n\r\n              {/* Suggestions Dropdown */}\r\n              {showSuggestions && debouncedQuery.length >= 2 && (suggestionItems.length > 0 || suggestLoading) && (\r\n                <div className=\"absolute top-full left-0 right-0 mt-1 bg-gm-surface-primary border border-gm-border-primary rounded-lg shadow-lg z-30 overflow-hidden\">\r\n                  {suggestLoading ? (\r\n                    <div className=\"flex items-center gap-2 px-3 py-2.5\">\r\n                      <Loader2 className=\"w-3.5 h-3.5 animate-spin text-gm-text-tertiary\" />\r\n                      <span className=\"text-xs text-gm-text-tertiary\">Loading suggestions...</span>\r\n                    </div>\r\n                  ) : (\r\n                    suggestionItems.map((s, i) => (\r\n                      <button key={i} onClick={() => applySuggestion(s)}\r\n                        className=\"w-full text-left px-3 py-2 text-xs text-gm-text-primary hover:bg-gm-surface-secondary transition-colors flex items-center gap-2\">\r\n                        <Search className=\"w-3 h-3 text-gm-text-tertiary shrink-0\" />\r\n                        <span className=\"truncate\">{s}</span>\r\n                      </button>\r\n                    ))\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            <button onClick={executeSearch} disabled={!searchQuery.trim() || searchMut.isPending}\r\n              className=\"px-4 py-2.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover flex items-center gap-1.5 disabled:opacity-50 transition-colors\">\r\n              {searchMut.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Search className=\"w-3.5 h-3.5\" />}\r\n              Search\r\n            </button>\r\n\r\n            <button onClick={() => setShowFilters(!showFilters)}\r\n              aria-expanded={showFilters}\r\n              className={cn('px-3 py-2.5 rounded-lg text-xs font-medium border flex items-center gap-1.5 transition-colors',\r\n                showFilters\r\n                  ? 'bg-blue-600/10 border-blue-600/30 text-gm-interactive-primary'\r\n                  : 'bg-gm-surface-secondary border-gm-border-primary text-gm-text-tertiary hover:text-gm-text-primary')}>\r\n              <Filter className=\"w-3.5 h-3.5\" />\r\n              Filters\r\n              {selectedTypes.length > 0 && (\r\n                <span className=\"ml-0.5 px-1.5 py-0.5 rounded-full bg-gm-interactive-primary text-gm-text-on-brand text-[9px] leading-none\">\r\n                  {selectedTypes.length}\r\n                </span>\r\n              )}\r\n            </button>\r\n\r\n            <button onClick={() => setShowStats(!showStats)}\r\n              aria-expanded={showStats}\r\n              className={cn('px-3 py-2.5 rounded-lg text-xs font-medium border flex items-center gap-1.5 transition-colors',\r\n                showStats\r\n                  ? 'bg-blue-600/10 border-blue-600/30 text-gm-interactive-primary'\r\n                  : 'bg-gm-surface-secondary border-gm-border-primary text-gm-text-tertiary hover:text-gm-text-primary')}>\r\n              <Database className=\"w-3.5 h-3.5\" />\r\n              Index\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Filters Row */}\r\n        {showFilters && (\r\n          <div className=\"flex items-center gap-1.5 px-5 py-2.5 border-t border-gm-border-primary bg-[var(--gm-surface-hover)] flex-wrap\">\r\n            <span className=\"text-[10px] text-gm-text-tertiary font-medium mr-1\">Types:</span>\r\n            {ALL_TYPES.map(type => {\r\n              const cfg = TYPE_CONFIG[type];\r\n              const active = selectedTypes.length === 0 || selectedTypes.includes(type);\r\n              return (\r\n                <button key={type} onClick={() => toggleType(type)}\r\n                  aria-pressed={active}\r\n                  className={cn('px-2.5 py-1 rounded-md text-[10px] font-medium transition-colors border flex items-center gap-1',\r\n                    active\r\n                      ? 'border-current/20 text-gm-text-primary'\r\n                      : 'border-gm-border-primary text-gray-500 line-through')}\r\n                  style={{\r\n                    backgroundColor: active ? `${cfg.color}15` : undefined,\r\n                    color: active ? cfg.color : undefined,\r\n                  }}>\r\n                  <cfg.icon className=\"w-3 h-3\" />\r\n                  {cfg.label}\r\n                </button>\r\n              );\r\n            })}\r\n            {selectedTypes.length > 0 && (\r\n              <button onClick={() => setSelectedTypes([])}\r\n                className=\"px-2 py-1 rounded-md text-[10px] font-medium text-gm-text-tertiary hover:text-gm-text-primary transition-colors\">\r\n                Clear all\r\n              </button>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Main Content */}\r\n      <div className=\"flex-1 flex overflow-hidden\">\r\n        {/* Results Area */}\r\n        <div className=\"flex-1 overflow-y-auto\">\r\n          {/* Loading State */}\r\n          {searchMut.isPending && (\r\n            <div className=\"flex items-center justify-center py-20\">\r\n              <div className=\"text-center\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-gm-interactive-primary mx-auto mb-3\" />\r\n                <p className=\"text-xs text-gm-text-tertiary\">Searching...</p>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Error State */}\r\n          {searchMut.isError && (\r\n            <div className=\"px-5 py-8\">\r\n              <ErrorState\r\n                message=\"Search failed. Please try again.\"\r\n                onRetry={executeSearch}\r\n              />\r\n            </div>\r\n          )}\r\n\r\n          {/* Results */}\r\n          {searchMut.isSuccess && (\r\n            <div className=\"px-5 py-4\">\r\n              <div className=\"flex items-center justify-between mb-4\">\r\n                <p className=\"text-xs text-gm-text-tertiary\">\r\n                  <span className=\"font-medium text-gm-text-primary\">{totalResults}</span> result{totalResults !== 1 ? 's' : ''} for{' '}\r\n                  <span className=\"font-medium text-gm-text-primary\">\"{searchQuery}\"</span>\r\n                </p>\r\n              </div>\r\n\r\n              {results.length === 0 ? (\r\n                <div className=\"flex flex-col items-center justify-center py-16 text-center\">\r\n                  <Search className=\"h-12 w-12 text-gray-600 mb-4\" />\r\n                  <p className=\"text-sm text-gm-text-tertiary mb-1\">No results found</p>\r\n                  <p className=\"text-xs text-gray-400\">Try different keywords or remove some filters</p>\r\n                </div>\r\n              ) : (\r\n                <div className=\"space-y-2\">\r\n                  {results.map(result => {\r\n                    const typeCfg = TYPE_CONFIG[result.type] ?? TYPE_CONFIG.documents;\r\n                    const Icon = typeCfg?.icon ?? FileText;\r\n                    const color = typeCfg?.color ?? '#64748b';\r\n                    const label = typeCfg?.label ?? result.type;\r\n                    const source = result.metadata?.source as string | undefined;\r\n                    const timestamp = result.metadata?.timestamp as string | undefined;\r\n\r\n                    return (\r\n                      <div key={result.id}\r\n                        className=\"group p-4 rounded-lg border border-gm-border-primary bg-gm-surface-primary hover:bg-gm-surface-secondary transition-colors\">\r\n                        <div className=\"flex items-start gap-3\">\r\n                          <div className=\"shrink-0 mt-0.5 w-8 h-8 rounded-lg flex items-center justify-center\"\r\n                            style={{ backgroundColor: `${color}15` }}>\r\n                            <Icon className=\"w-4 h-4\" style={{ color }} />\r\n                          </div>\r\n                          <div className=\"flex-1 min-w-0\">\r\n                            <div className=\"flex items-center gap-2 mb-1\">\r\n                              <span className=\"text-[10px] font-medium px-2 py-0.5 rounded-full\"\r\n                                style={{ backgroundColor: `${color}15`, color }}>\r\n                                {label}\r\n                              </span>\r\n                              {result.score != null && (\r\n                                <span className=\"text-[10px] text-gm-text-tertiary flex items-center gap-0.5\">\r\n                                  <BarChart3 className=\"w-3 h-3\" />\r\n                                  {(result.score * 100).toFixed(0)}%\r\n                                </span>\r\n                              )}\r\n                              {timestamp && (\r\n                                <span className=\"text-[10px] text-gm-text-tertiary flex items-center gap-0.5\">\r\n                                  <Clock className=\"w-3 h-3\" />\r\n                                  {new Date(timestamp).toLocaleDateString()}\r\n                                </span>\r\n                              )}\r\n                            </div>\r\n                            <h3 className=\"text-sm font-medium text-gm-text-primary truncate group-hover:text-gm-interactive-primary transition-colors\">\r\n                              {result.title}\r\n                            </h3>\r\n                            {result.snippet && (\r\n                              <p className=\"text-xs text-gm-text-tertiary mt-1 line-clamp-2 leading-relaxed\">\r\n                                {result.snippet}\r\n                              </p>\r\n                            )}\r\n                            {source && (\r\n                              <p className=\"text-[10px] text-gray-400 mt-1.5 truncate\">\r\n                                Source: {source}\r\n                              </p>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* Empty / Idle State */}\r\n          {searchMut.isIdle && (\r\n            <div className=\"flex flex-col items-center justify-center h-full text-center px-5\">\r\n              <Search className=\"h-16 w-16 text-gray-600 mb-5\" />\r\n              <p className=\"text-sm font-medium text-gm-text-secondary mb-1\">Search your project</p>\r\n              <p className=\"text-xs text-gray-400 max-w-sm\">\r\n                Search across documents, emails, conversations, contacts, and all extracted insights\r\n              </p>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Stats Sidebar */}\r\n        {showStats && (\r\n          <div className=\"hidden md:block w-72 shrink-0 border-l border-gm-border-primary bg-gm-surface-primary overflow-y-auto\">\r\n            <div className=\"p-4 space-y-4\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <h3 className=\"text-sm font-semibold text-gm-text-primary flex items-center gap-1.5\">\r\n                  <Database className=\"w-4 h-4\" /> Search Index\r\n                </h3>\r\n                <button onClick={() => setShowStats(false)}\r\n                  aria-label=\"Close index panel\"\r\n                  className=\"p-1 rounded hover:bg-gm-surface-secondary\">\r\n                  <X className=\"w-3.5 h-3.5 text-gm-text-tertiary\" />\r\n                </button>\r\n              </div>\r\n\r\n              {statsLoading ? (\r\n                <div className=\"flex items-center justify-center py-8\">\r\n                  <Loader2 className=\"w-5 h-5 animate-spin text-gm-interactive-primary\" />\r\n                </div>\r\n              ) : statsError ? (\r\n                <ErrorState message=\"Failed to load index stats.\" onRetry={() => refetchStats()} />\r\n              ) : stats ? (\r\n                <div className=\"space-y-3\">\r\n                  {Object.entries(stats).filter(([k]) => k !== 'ok').map(([key, value]) => (\r\n                    <div key={key} className=\"flex items-center justify-between py-1.5 border-b border-gm-border-primary last:border-0\">\r\n                      <span className=\"text-[10px] text-gm-text-tertiary capitalize\">{key.replace(/_/g, ' ')}</span>\r\n                      <span className=\"text-xs font-medium text-gm-text-primary\">\r\n                        {typeof value === 'number' ? value.toLocaleString() : String(value ?? '-')}\r\n                      </span>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              ) : (\r\n                <p className=\"text-xs text-gm-text-tertiary text-center py-4\">No stats available</p>\r\n              )}\r\n\r\n              <button onClick={handleRebuildIndex} disabled={indexMut.isPending}\r\n                className=\"w-full px-3 py-2 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover flex items-center justify-center gap-1.5 disabled:opacity-50 transition-colors\">\r\n                {indexMut.isPending\r\n                  ? <><Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> Rebuilding...</>\r\n                  : <><RefreshCw className=\"w-3.5 h-3.5\" /> Rebuild Index</>\r\n                }\r\n              </button>\r\n              {indexMut.isSuccess && (\r\n                <p className=\"text-[10px] text-gm-status-success text-center\">Index rebuilt successfully</p>\r\n              )}\r\n              {indexMut.isError && (\r\n                <p className=\"text-[10px] text-gm-status-danger text-center\">Rebuild failed. Try again.</p>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["TYPE_CONFIG","FileText","Mail","MessageCircle","Users","Star","CheckCircle","AlertTriangle","Zap","HelpCircle","ALL_TYPES","SearchPage","searchQuery","setSearchQuery","useState","debouncedQuery","setDebouncedQuery","selectedTypes","setSelectedTypes","showFilters","setShowFilters","showStats","setShowStats","showSuggestions","setShowSuggestions","useEffect","timer","suggestions","suggestLoading","useSearchSuggest","statsData","statsLoading","statsError","refetchStats","useSearchStats","searchMut","useSearchFulltext","indexMut","useSearchIndex","results","useMemo","totalResults","executeSearch","useCallback","handleKeyDown","e","toggleType","type","prev","t","applySuggestion","text","suggestionItems","stats","handleRebuildIndex","jsxs","jsx","Search","X","Loader2","s","i","cn","Filter","Database","cfg","active","ErrorState","result","typeCfg","Icon","color","label","source","timestamp","BarChart3","Clock","k","key","value","Fragment","RefreshCw"],"mappings":"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"}
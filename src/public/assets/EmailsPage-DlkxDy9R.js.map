{"version":3,"file":"EmailsPage-DlkxDy9R.js","sources":["../../../node_modules/lucide-react/dist/esm/icons/arrow-down-left.js","../../../node_modules/lucide-react/dist/esm/icons/arrow-left-right.js","../../../node_modules/lucide-react/dist/esm/icons/forward.js","../../frontend/src/components/emails/EmailDetailModal.tsx","../../frontend/src/components/emails/EmailComposeModal.tsx","../../frontend/src/pages/EmailsPage.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.564.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M17 7 7 17\", key: \"15tmo1\" }],\n  [\"path\", { d: \"M17 17H7V7\", key: \"1org7z\" }]\n];\nconst ArrowDownLeft = createLucideIcon(\"arrow-down-left\", __iconNode);\n\nexport { __iconNode, ArrowDownLeft as default };\n//# sourceMappingURL=arrow-down-left.js.map\n","/**\n * @license lucide-react v0.564.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M8 3 4 7l4 4\", key: \"9rb6wj\" }],\n  [\"path\", { d: \"M4 7h16\", key: \"6tx8e3\" }],\n  [\"path\", { d: \"m16 21 4-4-4-4\", key: \"siv7j2\" }],\n  [\"path\", { d: \"M20 17H4\", key: \"h6l3hr\" }]\n];\nconst ArrowLeftRight = createLucideIcon(\"arrow-left-right\", __iconNode);\n\nexport { __iconNode, ArrowLeftRight as default };\n//# sourceMappingURL=arrow-left-right.js.map\n","/**\n * @license lucide-react v0.564.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m15 17 5-5-5-5\", key: \"nf172w\" }],\n  [\"path\", { d: \"M4 18v-2a4 4 0 0 1 4-4h12\", key: \"jmiej9\" }]\n];\nconst Forward = createLucideIcon(\"forward\", __iconNode);\n\nexport { __iconNode, Forward as default };\n//# sourceMappingURL=forward.js.map\n","import { useState } from 'react';\r\nimport {\r\n  X, ArrowLeft, Star, Eye, EyeOff, Archive, Trash2, CheckCircle,\r\n  Clock, Sparkles, Loader2, Reply, Forward, ArrowUpRight, ArrowDownLeft,\r\n  ArrowLeftRight, Users, FileText, Brain, Contact, Paperclip,\r\n  AlertTriangle, HelpCircle, Lightbulb, Cpu, Link2,\r\n} from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport { Dialog, DialogContent, DialogTitle } from '../ui/Dialog';\r\nimport { cn, getInitials, resolveAvatarUrl, isValidAvatarUrl } from '../../lib/utils';\r\nimport {\r\n  useDeleteEmail, useMarkEmailResponded, useGenerateEmailResponse,\r\n  useStarEmail, useArchiveEmail, useMarkEmailRead, useEmailThread,\r\n  useCategorizeEmail, useGenerateEmailSummary,\r\n} from '../../hooks/useGodMode';\r\nimport { CommentsPanel } from '../shared/CommentsPanel';\r\n\r\ntype Tab = 'content' | 'analysis' | 'entities' | 'contacts';\r\n\r\nconst directionIcon: Record<string, typeof ArrowUpRight> = {\r\n  inbound: ArrowDownLeft,\r\n  outbound: ArrowUpRight,\r\n  internal: ArrowLeftRight,\r\n};\r\n\r\nconst sentimentConfig: Record<string, { color: string; emoji: string }> = {\r\n  positive: { color: 'bg-green-500/20 text-green-400', emoji: 'üòä' },\r\n  neutral: { color: 'bg-white/10 text-slate-300', emoji: 'üòê' },\r\n  negative: { color: 'bg-red-500/20 text-red-400', emoji: 'üòü' },\r\n  urgent: { color: 'bg-red-500/20 text-red-400', emoji: 'üî•' },\r\n};\r\n\r\ninterface Props {\r\n  email: Record<string, unknown> | null;\r\n  open: boolean;\r\n  onClose: () => void;\r\n  onReply?: (email: Record<string, unknown>) => void;\r\n  onForward?: (email: Record<string, unknown>) => void;\r\n}\r\n\r\nexport default function EmailDetailModal({ email, open, onClose, onReply, onForward }: Props) {\r\n  const [tab, setTab] = useState<Tab>('content');\r\n  const [draftResponse, setDraftResponse] = useState<string | null>(null);\r\n  const [showThread, setShowThread] = useState(false);\r\n\r\n  const deleteEmail = useDeleteEmail();\r\n  const markResponded = useMarkEmailResponded();\r\n  const generateResponse = useGenerateEmailResponse();\r\n  const starEmail = useStarEmail();\r\n  const archiveEmail = useArchiveEmail();\r\n  const markRead = useMarkEmailRead();\r\n  const categorizeEmail = useCategorizeEmail();\r\n  const summarizeEmail = useGenerateEmailSummary();\r\n\r\n  if (!email) return null;\r\n\r\n  const threadId = email.thread_id ? String(email.thread_id) : null;\r\n  const threadQuery = useEmailThread(showThread ? threadId : null);\r\n  const threadEmails = (threadQuery.data as Record<string, unknown>)?.emails as Array<Record<string, unknown>> | undefined;\r\n\r\n  const subject = String(email.subject || 'No subject');\r\n  const from = String(email.from || email.from_name || email.sender || '‚Äî');\r\n  const fromEmail = String(email.from_email || '');\r\n  const to = String(email.to || '');\r\n  const cc = String(email.cc || '');\r\n  const date = email.date ? new Date(String(email.date)).toLocaleString() : '';\r\n  const body = String(email.body || email.body_text || '');\r\n  const isRead = !!email.is_read;\r\n  const isStarred = !!email.is_starred;\r\n  const direction = String(email.direction || '');\r\n  const sentiment = String(email.sentiment || '');\r\n  const intent = String(email.detected_intent || email.ai_category || '');\r\n  const aiSummary = String(email.ai_summary || '');\r\n  const requiresResponse = !!email.requires_response;\r\n\r\n  const extracted = (email.extracted_entities || {}) as Record<string, unknown>;\r\n  const facts = (extracted.facts || []) as Array<Record<string, unknown>>;\r\n  const decisions = (extracted.decisions || []) as Array<Record<string, unknown>>;\r\n  const risks = (extracted.risks || []) as Array<Record<string, unknown>>;\r\n  const actionItems = (extracted.action_items || []) as Array<Record<string, unknown>>;\r\n  const questions = (extracted.questions || []) as Array<Record<string, unknown>>;\r\n  const people = (extracted.people || []) as Array<Record<string, unknown>>;\r\n  const technologies = (extracted.technologies || []) as Array<Record<string, unknown>>;\r\n  const relationships = (extracted.relationships || []) as Array<Record<string, unknown>>;\r\n  const keyTopics = (extracted.key_topics || []) as string[];\r\n  const attachments = (email.attachments || []) as Array<Record<string, unknown>>;\r\n\r\n  const hasAnalysis = facts.length > 0 || decisions.length > 0 || risks.length > 0 || actionItems.length > 0 || questions.length > 0;\r\n  const hasEntities = technologies.length > 0 || relationships.length > 0 || keyTopics.length > 0;\r\n  const hasPeople = people.length > 0;\r\n\r\n  const DirIcon = directionIcon[direction] || null;\r\n  const sentCfg = sentimentConfig[sentiment] || sentimentConfig.neutral;\r\n\r\n  const handleDelete = () => {\r\n    deleteEmail.mutate(String(email.id), {\r\n      onSuccess: () => { toast.success('Email deleted'); onClose(); },\r\n    });\r\n  };\r\n\r\n  const handleGenerateResponse = () => {\r\n    setDraftResponse(null);\r\n    generateResponse.mutate(String(email.id), {\r\n      onSuccess: (data) => { setDraftResponse(data.response || data.draft || 'No response generated.'); toast.success('AI response generated'); },\r\n      onError: () => toast.error('Failed to generate response'),\r\n    });\r\n  };\r\n\r\n  const tabs: { key: Tab; label: string; icon: typeof FileText; count?: number; hidden?: boolean }[] = [\r\n    { key: 'content', label: 'Content', icon: FileText },\r\n    { key: 'analysis', label: 'Analysis', icon: Brain, count: facts.length + actionItems.length + decisions.length + risks.length + questions.length, hidden: !hasAnalysis },\r\n    { key: 'entities', label: 'Entities', icon: Cpu, count: technologies.length + relationships.length + keyTopics.length, hidden: !hasEntities },\r\n    { key: 'contacts', label: 'Contacts', icon: Contact, count: people.length, hidden: !hasPeople },\r\n  ];\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={o => !o && onClose()}>\r\n      <DialogContent className=\"max-w-4xl p-0 overflow-hidden max-h-[90vh] flex flex-col\">\r\n        <DialogTitle className=\"sr-only\">{subject}</DialogTitle>\r\n\r\n        {/* Header */}\r\n        <div className=\"p-5 shrink-0\" style={{ background: 'linear-gradient(to right, rgba(37,99,235,0.25), rgba(37,99,235,0.08))' }}>\r\n          <div className=\"flex items-start gap-3\">\r\n            <button onClick={onClose} className=\"text-slate-400 hover:text-white transition-colors mt-1\">\r\n              <ArrowLeft className=\"w-5 h-5\" />\r\n            </button>\r\n            <div className=\"w-12 h-12 rounded-xl flex items-center justify-center shrink-0\" style={{ backgroundColor: 'rgba(37,99,235,0.15)' }}>\r\n              {DirIcon ? <DirIcon className=\"w-6 h-6 text-blue-400\" /> : <FileText className=\"w-6 h-6 text-blue-400\" />}\r\n            </div>\r\n            <div className=\"flex-1 min-w-0\">\r\n              <h2 className=\"text-lg font-semibold text-white leading-tight\">{subject}</h2>\r\n              <div className=\"mt-1.5 space-y-0.5 text-xs text-slate-300\">\r\n                <div className=\"flex gap-2\">\r\n                  <span className=\"text-slate-400 w-8\">From</span>\r\n                  <span><strong className=\"text-white\">{from}</strong>{fromEmail && ` <${fromEmail}>`}</span>\r\n                </div>\r\n                {to && <div className=\"flex gap-2\"><span className=\"text-slate-400 w-8\">To</span><span>{to}</span></div>}\r\n                {cc && <div className=\"flex gap-2\"><span className=\"text-slate-400 w-8\">CC</span><span>{cc}</span></div>}\r\n                {date && <div className=\"flex gap-2\"><span className=\"text-slate-400 w-8\">Date</span><span>{date}</span></div>}\r\n              </div>\r\n              <div className=\"flex gap-1.5 mt-2 flex-wrap\">\r\n                {intent && <span className=\"text-[10px] px-2 py-0.5 rounded-full bg-blue-500/20 text-blue-400 font-medium capitalize\">{intent.replace(/_/g, ' ')}</span>}\r\n                {sentiment && <span className={cn('text-[10px] px-2 py-0.5 rounded-full font-medium capitalize', sentCfg.color)}>{sentCfg.emoji} {sentiment}</span>}\r\n                {requiresResponse && <span className=\"text-[10px] px-2 py-0.5 rounded-full bg-yellow-500/20 text-yellow-400 font-medium flex items-center gap-1\"><Clock className=\"w-3 h-3\" /> Needs Response</span>}\r\n                {direction && DirIcon && <span className=\"text-[10px] px-2 py-0.5 rounded-full text-slate-300 capitalize flex items-center gap-1\" style={{ backgroundColor: 'rgba(255,255,255,0.1)' }}><DirIcon className=\"w-3 h-3\" /> {direction}</span>}\r\n                {attachments.length > 0 && <span className=\"text-[10px] px-2 py-0.5 rounded-full text-slate-300 flex items-center gap-1\" style={{ backgroundColor: 'rgba(255,255,255,0.1)' }}><Paperclip className=\"w-3 h-3\" /> {attachments.length}</span>}\r\n              </div>\r\n            </div>\r\n            <div className=\"flex items-center gap-1 shrink-0\">\r\n              <button onClick={(e) => { e.stopPropagation(); starEmail.mutate({ id: String(email.id), starred: !isStarred }); }} className=\"p-2 rounded-lg hover:bg-white/10 transition-colors\" title={isStarred ? 'Unstar' : 'Star'}>\r\n                <Star className={cn('w-4 h-4', isStarred ? 'fill-yellow-400 text-yellow-400' : 'text-slate-400 hover:text-yellow-400')} />\r\n              </button>\r\n              <button onClick={() => markRead.mutate({ id: String(email.id), read: !isRead })} className=\"p-2 rounded-lg text-slate-400 hover:bg-white/10 transition-colors\" title={isRead ? 'Mark unread' : 'Mark read'}>\r\n                {isRead ? <EyeOff className=\"w-4 h-4\" /> : <Eye className=\"w-4 h-4\" />}\r\n              </button>\r\n              <button onClick={() => archiveEmail.mutate(String(email.id), { onSuccess: () => { toast.success('Archived'); onClose(); } })} className=\"p-2 rounded-lg text-slate-400 hover:bg-white/10 transition-colors\" title=\"Archive\">\r\n                <Archive className=\"w-4 h-4\" />\r\n              </button>\r\n              <button onClick={handleDelete} className=\"p-2 rounded-lg text-slate-400 hover:bg-red-500/20 transition-colors\" title=\"Delete\">\r\n                <Trash2 className=\"w-4 h-4\" />\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Tabs */}\r\n        <div className=\"flex gap-1 px-5 border-b border-[var(--gm-border-primary)] shrink-0\" style={{ borderColor: 'var(--gm-border-primary)' }}>\r\n          {tabs.filter(t => !t.hidden).map(t => {\r\n            const Icon = t.icon;\r\n            return (\r\n              <button key={t.key} onClick={() => setTab(t.key)}\r\n                className={cn('flex items-center gap-1.5 px-4 py-2.5 text-xs font-medium border-b-2 transition-colors',\r\n                  tab === t.key ? 'border-blue-500 text-blue-400' : 'border-transparent text-slate-400 hover:text-slate-200')}>\r\n                <Icon className=\"w-3.5 h-3.5\" /> {t.label}\r\n                {t.count !== undefined && t.count > 0 && (\r\n                  <span className=\"text-[10px] px-1.5 py-0.5 rounded-full bg-white/10 text-slate-300\">{t.count}</span>\r\n                )}\r\n              </button>\r\n            );\r\n          })}\r\n        </div>\r\n\r\n        {/* Tab Content */}\r\n        <div className=\"flex-1 overflow-y-auto p-5 space-y-4 bg-[var(--gm-surface-primary)]\" style={{ backgroundColor: 'var(--gm-surface-primary)' }}>\r\n          {tab === 'content' && (\r\n            <>\r\n              {aiSummary && (\r\n                <div className=\"bg-blue-600/5 border-l-[3px] border-gm-interactive-primary rounded-r-lg p-4\">\r\n                  <div className=\"text-[10px] uppercase tracking-wider text-gm-interactive-primary font-semibold mb-1.5 flex items-center gap-1.5\">\r\n                    <Sparkles className=\"w-3.5 h-3.5\" /> AI Summary\r\n                  </div>\r\n                  <p className=\"text-sm text-gm-text-primary leading-relaxed\">{aiSummary}</p>\r\n                </div>\r\n              )}\r\n\r\n              <div className=\"bg-gm-surface-secondary rounded-xl p-5\">\r\n                <pre className=\"text-sm text-gm-text-primary whitespace-pre-wrap font-sans leading-relaxed\">{body}</pre>\r\n              </div>\r\n\r\n              {attachments.length > 0 && (\r\n                <div>\r\n                  <h4 className=\"text-xs font-semibold text-gm-text-tertiary uppercase tracking-wider mb-2 flex items-center gap-1.5\">\r\n                    <Paperclip className=\"w-3.5 h-3.5\" /> Attachments ({attachments.length})\r\n                  </h4>\r\n                  <div className=\"flex flex-wrap gap-2\">\r\n                    {attachments.map((att, i) => (\r\n                      <div key={i} className=\"flex items-center gap-2 bg-gm-surface-secondary rounded-lg px-3 py-2 border border-gm-border-primary\">\r\n                        <Paperclip className=\"w-4 h-4 text-gm-interactive-primary\" />\r\n                        <span className=\"text-xs text-gm-text-primary\">{String(att.filename || att.name || `Attachment ${i + 1}`)}</span>\r\n                        {att.size && <span className=\"text-[10px] text-gm-text-tertiary\">{formatBytes(Number(att.size))}</span>}\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {threadId && (\r\n                <div className=\"border-t border-gm-border-primary pt-4\">\r\n                  <button onClick={() => setShowThread(!showThread)} className=\"text-xs text-gm-interactive-primary hover:underline font-medium\">\r\n                    {showThread ? 'Hide thread' : 'Show thread'}\r\n                  </button>\r\n                  {showThread && threadQuery.isLoading && <Loader2 className=\"w-4 h-4 animate-spin text-gm-interactive-primary mt-2\" />}\r\n                  {showThread && threadEmails && threadEmails.length > 0 && (\r\n                    <div className=\"space-y-2 mt-3 ml-4 border-l-2 border-blue-600/20 pl-4\">\r\n                      {threadEmails.filter(te => String(te.id) !== String(email.id)).map((te, i) => (\r\n                        <div key={i} className=\"bg-[var(--gm-surface-hover)] rounded-lg p-3\">\r\n                          <div className=\"flex items-center justify-between mb-1\">\r\n                            <span className=\"text-xs font-medium text-gm-text-primary\">{String(te.from || te.from_name || te.sender || '‚Äî')}</span>\r\n                            {te.date && <span className=\"text-[10px] text-gm-text-tertiary\">{new Date(String(te.date)).toLocaleString()}</span>}\r\n                          </div>\r\n                          <p className=\"text-xs text-gm-text-tertiary line-clamp-3\">{String(te.body || te.body_text || te.ai_summary || '')}</p>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n\r\n              {/* Actions */}\r\n              <div className=\"border-t border-gm-border-primary pt-4 flex flex-wrap gap-2\">\r\n                {onReply && (\r\n                  <button onClick={() => onReply(email)} className=\"px-3 py-1.5 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-xs font-medium hover:bg-gm-interactive-primary-hover flex items-center gap-1.5 transition-colors\">\r\n                    <Reply className=\"w-3.5 h-3.5\" /> Reply\r\n                  </button>\r\n                )}\r\n                {onForward && (\r\n                  <button onClick={() => onForward(email)} className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover flex items-center gap-1.5 transition-colors border border-gm-border-primary\">\r\n                    <Forward className=\"w-3.5 h-3.5\" /> Forward\r\n                  </button>\r\n                )}\r\n                {requiresResponse && (\r\n                  <button onClick={() => markResponded.mutate(String(email.id), { onSuccess: () => toast.success('Marked as responded') })} disabled={markResponded.isPending}\r\n                    className=\"px-3 py-1.5 rounded-lg bg-gm-status-success-bg text-gm-status-success text-xs font-medium hover:bg-green-500/20 flex items-center gap-1.5\">\r\n                    <CheckCircle className=\"w-3.5 h-3.5\" /> Mark Responded\r\n                  </button>\r\n                )}\r\n                <button onClick={handleGenerateResponse} disabled={generateResponse.isPending}\r\n                  className=\"px-3 py-1.5 rounded-lg bg-blue-600/10 text-gm-interactive-primary text-xs font-medium hover:bg-blue-600/20 flex items-center gap-1.5 transition-colors\">\r\n                  {generateResponse.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Sparkles className=\"w-3.5 h-3.5\" />}\r\n                  Generate AI Response\r\n                </button>\r\n                <button\r\n                  onClick={() => categorizeEmail.mutate(String(email.id), { onSuccess: (r) => toast.success(`Categorized: ${r?.category ?? 'done'}`) })}\r\n                  disabled={categorizeEmail.isPending}\r\n                  className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover flex items-center gap-1.5 transition-colors border border-gm-border-primary\"\r\n                >\r\n                  {categorizeEmail.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Brain className=\"w-3.5 h-3.5\" />}\r\n                  AI Categorize\r\n                </button>\r\n                <button\r\n                  onClick={() => summarizeEmail.mutate(String(email.id), { onSuccess: () => toast.success('Summary generated') })}\r\n                  disabled={summarizeEmail.isPending}\r\n                  className=\"px-3 py-1.5 rounded-lg bg-gm-surface-secondary text-gm-text-primary text-xs font-medium hover:bg-gm-surface-hover flex items-center gap-1.5 transition-colors border border-gm-border-primary\"\r\n                >\r\n                  {summarizeEmail.isPending ? <Loader2 className=\"w-3.5 h-3.5 animate-spin\" /> : <Brain className=\"w-3.5 h-3.5\" />}\r\n                  AI Summarize\r\n                </button>\r\n              </div>\r\n\r\n              {draftResponse && (\r\n                <div className=\"bg-gm-surface-primary border border-gm-border-primary rounded-xl p-4\">\r\n                  <h4 className=\"text-xs font-semibold text-gm-text-tertiary uppercase tracking-wider mb-2\">Draft Response</h4>\r\n                  <pre className=\"text-sm text-gm-text-primary whitespace-pre-wrap font-sans leading-relaxed\">{draftResponse}</pre>\r\n                </div>\r\n              )}\r\n            </>\r\n          )}\r\n\r\n          {tab === 'analysis' && (\r\n            <div className=\"space-y-5\">\r\n              {facts.length > 0 && (\r\n                <AnalysisSection title=\"Facts\" icon={Lightbulb} color=\"text-gm-interactive-primary\" count={facts.length}>\r\n                  {facts.map((f, i) => (\r\n                    <div key={i} className=\"bg-[var(--gm-surface-hover)] rounded-lg p-3\">\r\n                      <p className=\"text-xs text-gm-text-primary\">{String(f.content)}</p>\r\n                      <div className=\"flex gap-2 mt-1.5\">\r\n                        {f.category && <span className=\"text-[10px] px-1.5 py-0.5 rounded bg-gm-surface-secondary text-gm-text-tertiary capitalize\">{String(f.category)}</span>}\r\n                        {f.confidence && <span className=\"text-[10px] text-gm-text-tertiary capitalize\">{String(f.confidence)} confidence</span>}\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </AnalysisSection>\r\n              )}\r\n\r\n              {actionItems.length > 0 && (\r\n                <AnalysisSection title=\"Action Items\" icon={CheckCircle} color=\"text-gm-status-success\" count={actionItems.length}>\r\n                  {actionItems.map((a, i) => (\r\n                    <div key={i} className=\"bg-[var(--gm-surface-hover)] rounded-lg p-3\">\r\n                      <p className=\"text-xs text-gm-text-primary flex items-start gap-1.5\">\r\n                        <span className=\"text-gm-status-success mt-0.5\">‚òê</span> {String(a.task)}\r\n                      </p>\r\n                      <div className=\"flex gap-2 mt-1.5 flex-wrap\">\r\n                        {a.owner && <span className=\"text-[10px] px-1.5 py-0.5 rounded bg-gm-surface-secondary text-gm-text-tertiary\">Owner: {String(a.owner)}</span>}\r\n                        {a.deadline && <span className=\"text-[10px] px-1.5 py-0.5 rounded bg-gm-surface-secondary text-gm-text-tertiary\">Due: {String(a.deadline)}</span>}\r\n                        {a.priority && <span className={cn('text-[10px] px-1.5 py-0.5 rounded capitalize',\r\n                          a.priority === 'critical' || a.priority === 'high' ? 'bg-gm-status-danger-bg text-gm-status-danger' :\r\n                          a.priority === 'medium' ? 'bg-gm-status-warning-bg text-gm-status-warning' : 'bg-gm-surface-secondary text-gm-text-tertiary'\r\n                        )}>{String(a.priority)}</span>}\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </AnalysisSection>\r\n              )}\r\n\r\n              {decisions.length > 0 && (\r\n                <AnalysisSection title=\"Decisions\" icon={Lightbulb} color=\"text-gm-interactive-primary\" count={decisions.length}>\r\n                  {decisions.map((d, i) => (\r\n                    <div key={i} className=\"bg-[var(--gm-surface-hover)] rounded-lg p-3\">\r\n                      <p className=\"text-xs text-gm-text-primary\">{String(d.content)}</p>\r\n                      <div className=\"flex gap-2 mt-1.5\">\r\n                        {d.owner && <span className=\"text-[10px] px-1.5 py-0.5 rounded bg-gm-surface-secondary text-gm-text-tertiary\">By: {String(d.owner)}</span>}\r\n                        {d.status && <span className=\"text-[10px] px-1.5 py-0.5 rounded bg-blue-600/10 text-gm-interactive-primary capitalize\">{String(d.status)}</span>}\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </AnalysisSection>\r\n              )}\r\n\r\n              {risks.length > 0 && (\r\n                <AnalysisSection title=\"Risks\" icon={AlertTriangle} color=\"text-gm-status-danger\" count={risks.length}>\r\n                  {risks.map((r, i) => (\r\n                    <div key={i} className=\"bg-[var(--gm-surface-hover)] rounded-lg p-3\">\r\n                      <p className=\"text-xs text-gm-text-primary\">{String(r.content)}</p>\r\n                      <div className=\"flex gap-2 mt-1.5\">\r\n                        {r.impact && <span className=\"text-[10px] px-1.5 py-0.5 rounded bg-gm-status-danger-bg text-gm-status-danger\">Impact: {String(r.impact)}</span>}\r\n                        {r.likelihood && <span className=\"text-[10px] px-1.5 py-0.5 rounded bg-gm-status-warning-bg text-gm-status-warning\">Likelihood: {String(r.likelihood)}</span>}\r\n                      </div>\r\n                      {r.mitigation && <p className=\"text-[10px] text-gm-text-tertiary mt-1.5 italic\">Mitigation: {String(r.mitigation)}</p>}\r\n                    </div>\r\n                  ))}\r\n                </AnalysisSection>\r\n              )}\r\n\r\n              {questions.length > 0 && (\r\n                <AnalysisSection title=\"Questions\" icon={HelpCircle} color=\"text-gm-status-warning\" count={questions.length}>\r\n                  {questions.map((q, i) => (\r\n                    <div key={i} className=\"bg-[var(--gm-surface-hover)] rounded-lg p-3\">\r\n                      <p className=\"text-xs text-gm-text-primary flex items-start gap-1.5\">\r\n                        <HelpCircle className=\"w-3.5 h-3.5 text-gm-status-warning shrink-0 mt-0.5\" /> {String(q.content)}\r\n                      </p>\r\n                      {q.assignee && <span className=\"text-[10px] text-gm-text-tertiary ml-5\">Assigned to: {String(q.assignee)}</span>}\r\n                    </div>\r\n                  ))}\r\n                </AnalysisSection>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {tab === 'entities' && (\r\n            <div className=\"space-y-5\">\r\n              {technologies.length > 0 && (\r\n                <AnalysisSection title=\"Technologies\" icon={Cpu} color=\"text-gm-interactive-primary\" count={technologies.length}>\r\n                  <div className=\"flex flex-wrap gap-2\">\r\n                    {technologies.map((t, i) => (\r\n                      <span key={i} className=\"text-xs px-3 py-1.5 rounded-lg bg-blue-600/10 text-gm-interactive-primary font-medium\">\r\n                        {String(t.name)}\r\n                        {t.category && <span className=\"text-[10px] text-blue-500 ml-1.5 capitalize\">({String(t.category)})</span>}\r\n                      </span>\r\n                    ))}\r\n                  </div>\r\n                </AnalysisSection>\r\n              )}\r\n\r\n              {keyTopics.length > 0 && (\r\n                <AnalysisSection title=\"Key Topics\" icon={FileText} color=\"text-gm-text-primary\" count={keyTopics.length}>\r\n                  <div className=\"flex flex-wrap gap-2\">\r\n                    {keyTopics.map((t, i) => (\r\n                      <span key={i} className=\"text-xs px-3 py-1.5 rounded-lg bg-gm-surface-secondary text-gm-text-primary border border-gm-border-primary\">{t}</span>\r\n                    ))}\r\n                  </div>\r\n                </AnalysisSection>\r\n              )}\r\n\r\n              {relationships.length > 0 && (\r\n                <AnalysisSection title=\"Relationships\" icon={Link2} color=\"text-gm-interactive-primary\" count={relationships.length}>\r\n                  {relationships.map((r, i) => (\r\n                    <div key={i} className=\"flex items-center gap-2 bg-[var(--gm-surface-hover)] rounded-lg p-3\">\r\n                      <span className=\"text-xs font-medium text-gm-text-primary\">{String(r.from)}</span>\r\n                      <span className=\"text-[10px] px-2 py-0.5 rounded bg-blue-600/10 text-gm-interactive-primary\">{String(r.type || '').replace(/_/g, ' ')}</span>\r\n                      <span className=\"text-xs font-medium text-gm-text-primary\">{String(r.to)}</span>\r\n                    </div>\r\n                  ))}\r\n                </AnalysisSection>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {tab === 'contacts' && (\r\n            <div className=\"space-y-3\">\r\n              {people.map((p, i) => {\r\n                const name = String(p.name || 'Unknown');\r\n                const avatarSrc = resolveAvatarUrl(p as any);\r\n                return (\r\n                  <div key={i} className=\"flex items-center gap-3 bg-[var(--gm-surface-hover)] rounded-xl p-4\">\r\n                    <div className=\"w-10 h-10 rounded-full bg-blue-600/20 flex items-center justify-center text-sm font-bold text-gm-interactive-primary shrink-0 overflow-hidden\">\r\n                      {isValidAvatarUrl(avatarSrc) ? (\r\n                        <img src={avatarSrc} alt={name} className=\"w-full h-full object-cover\" onError={(e) => { (e.target as HTMLImageElement).style.display = 'none'; (e.target as HTMLImageElement).nextElementSibling && ((e.target as HTMLImageElement).nextElementSibling as HTMLElement).classList.remove('hidden'); }} />\r\n                      ) : null}\r\n                      <span className={isValidAvatarUrl(avatarSrc) ? 'hidden' : ''}>{getInitials(name)}</span>\r\n                    </div>\r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <p className=\"text-sm font-medium text-gm-text-primary\">{name}</p>\r\n                      <div className=\"flex flex-wrap gap-2 mt-0.5\">\r\n                        {p.role && <span className=\"text-[10px] text-gm-text-tertiary\">{String(p.role)}</span>}\r\n                        {p.organization && <span className=\"text-[10px] text-gm-text-tertiary\">at {String(p.organization)}</span>}\r\n                      </div>\r\n                      {p.email && <p className=\"text-[10px] text-gm-text-tertiary mt-0.5\">{String(p.email)}</p>}\r\n                      {p.phone && <p className=\"text-[10px] text-gm-text-tertiary\">{String(p.phone)}</p>}\r\n                    </div>\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          )}\r\n\r\n          {/* Comments */}\r\n          {email?.id && (\r\n            <div className=\"mt-4\">\r\n              <CommentsPanel targetType=\"email\" targetId={email.id} />\r\n            </div>\r\n          )}\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nfunction AnalysisSection({ title, icon: Icon, color, count, children }: {\r\n  title: string; icon: typeof FileText; color: string; count: number; children: React.ReactNode;\r\n}) {\r\n  return (\r\n    <div>\r\n      <h3 className={cn('text-xs font-semibold uppercase tracking-wider mb-3 flex items-center gap-2', color)}>\r\n        <Icon className=\"w-4 h-4\" /> {title}\r\n        <span className=\"text-[10px] px-2 py-0.5 rounded-full bg-gm-surface-secondary text-gm-text-tertiary ml-auto\">{count}</span>\r\n      </h3>\r\n      <div className=\"space-y-2\">{children}</div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction formatBytes(bytes: number): string {\r\n  if (bytes === 0) return '0 B';\r\n  const k = 1024;\r\n  const sizes = ['B', 'KB', 'MB'];\r\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];\r\n}\r\n","import { useState, useRef, useCallback } from 'react';\r\nimport {\r\n  X, Send, Loader2, Paperclip, ChevronDown, ChevronUp, Sparkles,\r\n} from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport { Dialog, DialogContent, DialogTitle } from '../ui/Dialog';\r\nimport { cn } from '../../lib/utils';\r\nimport { useSendEmail, useImportEmail } from '../../hooks/useGodMode';\r\nimport { apiClient } from '../../lib/api-client';\r\n\r\ntype Mode = 'compose' | 'reply' | 'forward';\r\ntype InputTab = 'compose' | 'paste' | 'upload';\r\n\r\ninterface Props {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  mode?: Mode;\r\n  replyTo?: Record<string, unknown> | null;\r\n}\r\n\r\nexport default function EmailComposeModal({ open, onClose, mode = 'compose', replyTo }: Props) {\r\n  const isReply = mode === 'reply' && !!replyTo;\r\n  const isForward = mode === 'forward' && !!replyTo;\r\n\r\n  const [inputTab, setInputTab] = useState<InputTab>(isReply || isForward ? 'compose' : 'compose');\r\n  const [to, setTo] = useState(isReply ? String(replyTo?.from_email || replyTo?.from || '') : '');\r\n  const [cc, setCc] = useState('');\r\n  const [subject, setSubject] = useState(\r\n    isReply ? `Re: ${String(replyTo?.subject || '')}` :\r\n    isForward ? `Fwd: ${String(replyTo?.subject || '')}` : ''\r\n  );\r\n  const [body, setBody] = useState(\r\n    isForward ? `\\n\\n---------- Forwarded message ----------\\nFrom: ${String(replyTo?.from || replyTo?.from_name || '')}\\nDate: ${replyTo?.date ? new Date(String(replyTo.date)).toLocaleString() : ''}\\nSubject: ${String(replyTo?.subject || '')}\\n\\n${String(replyTo?.body || replyTo?.body_text || '')}` :\r\n    isReply ? `\\n\\n> On ${replyTo?.date ? new Date(String(replyTo.date)).toLocaleString() : ''}, ${String(replyTo?.from || replyTo?.from_name || '')} wrote:\\n> ${String(replyTo?.body || replyTo?.body_text || '').split('\\n').join('\\n> ')}` : ''\r\n  );\r\n  const [pasteContent, setPasteContent] = useState('');\r\n  const [showCc, setShowCc] = useState(false);\r\n  const [sending, setSending] = useState(false);\r\n  const [fileName, setFileName] = useState('');\r\n  const fileRef = useRef<HTMLInputElement>(null);\r\n  const fileObjRef = useRef<File | null>(null);\r\n  const [aiDraft, setAiDraft] = useState('');\r\n  const [generatingDraft, setGeneratingDraft] = useState(false);\r\n\r\n  const sendEmail = useSendEmail();\r\n  const importEmail = useImportEmail();\r\n\r\n  const handleClose = () => {\r\n    setTo(''); setCc(''); setSubject(''); setBody(''); setPasteContent('');\r\n    setFileName(''); fileObjRef.current = null; setAiDraft('');\r\n    onClose();\r\n  };\r\n\r\n  const handleSend = async () => {\r\n    if (inputTab === 'compose') {\r\n      if (!to.trim() || !body.trim()) {\r\n        toast.error('To and Body are required');\r\n        return;\r\n      }\r\n      const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n      const emails = to.split(',').map(e => e.trim()).filter(Boolean);\r\n      const invalid = emails.filter(e => !emailRegex.test(e));\r\n      if (invalid.length > 0) {\r\n        toast.error(`Invalid email address: ${invalid[0]}`);\r\n        return;\r\n      }\r\n      setSending(true);\r\n      try {\r\n        await sendEmail.mutateAsync({\r\n          to: to.split(',').map(e => e.trim()).filter(Boolean),\r\n          cc: cc ? cc.split(',').map(e => e.trim()).filter(Boolean) : undefined,\r\n          subject,\r\n          body,\r\n          replyToId: isReply ? String(replyTo?.id || '') : undefined,\r\n        });\r\n        toast.success(isReply ? 'Reply sent' : isForward ? 'Email forwarded' : 'Email sent');\r\n        handleClose();\r\n      } catch {\r\n        toast.error('Failed to send email');\r\n      } finally {\r\n        setSending(false);\r\n      }\r\n    } else if (inputTab === 'paste') {\r\n      if (pasteContent.trim().length < 10) {\r\n        toast.error('Please paste email content (min 10 chars)');\r\n        return;\r\n      }\r\n      setSending(true);\r\n      try {\r\n        await importEmail.mutateAsync({ emailText: pasteContent });\r\n        toast.success('Email imported and analyzed');\r\n        handleClose();\r\n      } catch {\r\n        toast.error('Failed to import email');\r\n      } finally {\r\n        setSending(false);\r\n      }\r\n    } else if (inputTab === 'upload') {\r\n      const file = fileObjRef.current;\r\n      if (!file) {\r\n        toast.error('Please select a file');\r\n        return;\r\n      }\r\n      setSending(true);\r\n      try {\r\n        const base64 = await fileToBase64(file);\r\n        const isMsg = file.name.toLowerCase().endsWith('.msg');\r\n        await importEmail.mutateAsync(\r\n          isMsg ? { msgBase64: base64, filename: file.name } : { emlBase64: base64, filename: file.name }\r\n        );\r\n        toast.success('Email file imported and analyzed');\r\n        handleClose();\r\n      } catch {\r\n        toast.error('Failed to import email file');\r\n      } finally {\r\n        setSending(false);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleInsertAiDraft = useCallback(() => {\r\n    if (aiDraft) {\r\n      setBody(aiDraft);\r\n      setAiDraft('');\r\n    }\r\n  }, [aiDraft]);\r\n\r\n  const handleGenerateDraft = async () => {\r\n    if (!replyTo?.id) return;\r\n    setGeneratingDraft(true);\r\n    try {\r\n      const data = await apiClient.post<{ ok?: boolean; draft?: string; response?: string }>(`/api/emails/${replyTo.id}/response`, {});\r\n      if (data.ok || data.draft) {\r\n        setAiDraft(data.draft || data.response || '');\r\n        toast.success('AI draft generated');\r\n      } else {\r\n        toast.error('Failed to generate draft');\r\n      }\r\n    } catch {\r\n      toast.error('Failed to generate draft');\r\n    } finally {\r\n      setGeneratingDraft(false);\r\n    }\r\n  };\r\n\r\n  const handleFileDrop = useCallback((e: React.DragEvent) => {\r\n    e.preventDefault();\r\n    const file = e.dataTransfer.files[0];\r\n    if (file && (file.name.endsWith('.eml') || file.name.endsWith('.msg'))) {\r\n      fileObjRef.current = file;\r\n      setFileName(file.name);\r\n    }\r\n  }, []);\r\n\r\n  const title = isReply ? 'Reply' : isForward ? 'Forward' : 'Compose Email';\r\n  const sendLabel = inputTab === 'compose' ? (isReply ? 'Send Reply' : isForward ? 'Forward' : 'Send') : 'Import & Analyze';\r\n\r\n  const inputTabs: { key: InputTab; label: string }[] = isReply || isForward\r\n    ? [{ key: 'compose', label: 'Compose' }]\r\n    : [\r\n        { key: 'compose', label: 'Compose' },\r\n        { key: 'paste', label: 'Paste Text' },\r\n        { key: 'upload', label: 'Upload .eml/.msg' },\r\n      ];\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={o => !o && handleClose()}>\r\n      <DialogContent className=\"max-w-2xl p-0 overflow-hidden max-h-[90vh] flex flex-col\">\r\n        <DialogTitle className=\"sr-only\">{title}</DialogTitle>\r\n\r\n        {/* Header */}\r\n        <div className=\"px-5 py-4 shrink-0\" style={{ background: 'linear-gradient(to right, rgba(37,99,235,0.25), rgba(37,99,235,0.08))' }}>\r\n          <div className=\"flex items-center justify-between\">\r\n            <h2 className=\"text-base font-semibold text-white\">{title}</h2>\r\n            <button onClick={handleClose} className=\"w-8 h-8 rounded-lg flex items-center justify-center text-slate-400 hover:bg-white/10 transition-colors\">\r\n              <X className=\"w-4 h-4\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Input tabs */}\r\n        {inputTabs.length > 1 && (\r\n          <div className=\"flex px-5 border-b border-[var(--gm-border-primary)] shrink-0\" style={{ borderColor: 'var(--gm-border-primary)' }}>\r\n            {inputTabs.map(t => (\r\n              <button key={t.key} onClick={() => setInputTab(t.key)}\r\n                className={cn('px-4 py-2.5 text-xs font-medium border-b-2 transition-colors',\r\n                  inputTab === t.key ? 'border-blue-500 text-blue-400' : 'border-transparent text-slate-400 hover:text-slate-200')}>\r\n                {t.label}\r\n              </button>\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        {/* Body */}\r\n        <div className=\"flex-1 overflow-y-auto p-5 space-y-4 bg-[var(--gm-surface-primary)]\" style={{ backgroundColor: 'var(--gm-surface-primary)' }}>\r\n          {inputTab === 'compose' && (\r\n            <>\r\n              <div className=\"space-y-3\">\r\n                <div>\r\n                  <label className=\"text-[10px] font-semibold text-gm-text-tertiary uppercase tracking-wider\">To *</label>\r\n                  <input value={to} onChange={e => setTo(e.target.value)} placeholder=\"recipient@example.com (comma-separated)\"\r\n                    className=\"mt-1 w-full bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-2 text-sm text-gm-text-primary placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-gm-border-focus\" />\r\n                </div>\r\n\r\n                <div className=\"flex items-center justify-between\">\r\n                  <button onClick={() => setShowCc(!showCc)} className=\"text-[10px] text-gm-interactive-primary hover:underline flex items-center gap-1\">\r\n                    {showCc ? <ChevronUp className=\"w-3 h-3\" /> : <ChevronDown className=\"w-3 h-3\" />} CC\r\n                  </button>\r\n                </div>\r\n                {showCc && (\r\n                  <div>\r\n                    <label className=\"text-[10px] font-semibold text-gm-text-tertiary uppercase tracking-wider\">CC</label>\r\n                    <input value={cc} onChange={e => setCc(e.target.value)} placeholder=\"cc@example.com\"\r\n                      className=\"mt-1 w-full bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-2 text-sm text-gm-text-primary placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-gm-border-focus\" />\r\n                  </div>\r\n                )}\r\n\r\n                <div>\r\n                  <label className=\"text-[10px] font-semibold text-gm-text-tertiary uppercase tracking-wider\">Subject</label>\r\n                  <input value={subject} onChange={e => setSubject(e.target.value)} placeholder=\"Email subject\"\r\n                    className=\"mt-1 w-full bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-2 text-sm text-gm-text-primary placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-gm-border-focus\" />\r\n                </div>\r\n\r\n                <div>\r\n                  <div className=\"flex items-center justify-between mb-1\">\r\n                    <label className=\"text-[10px] font-semibold text-gm-text-tertiary uppercase tracking-wider\">Body *</label>\r\n                    {isReply && replyTo?.id && (\r\n                      <button onClick={handleGenerateDraft} disabled={generatingDraft}\r\n                        className=\"text-[10px] text-gm-interactive-primary hover:underline flex items-center gap-1 disabled:opacity-50\">\r\n                        {generatingDraft ? <Loader2 className=\"w-3 h-3 animate-spin\" /> : <Sparkles className=\"w-3 h-3\" />} Generate AI Draft\r\n                      </button>\r\n                    )}\r\n                  </div>\r\n                  <textarea value={body} onChange={e => setBody(e.target.value)} placeholder=\"Write your message...\"\r\n                    rows={10}\r\n                    className=\"w-full bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-2 text-sm text-gm-text-primary placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-gm-border-focus resize-y leading-relaxed\" />\r\n                </div>\r\n\r\n                {aiDraft && (\r\n                  <div className=\"bg-blue-600/5 border border-blue-600/20 rounded-lg p-3\">\r\n                    <div className=\"flex items-center justify-between mb-2\">\r\n                      <span className=\"text-[10px] uppercase tracking-wider text-gm-interactive-primary font-semibold flex items-center gap-1\"><Sparkles className=\"w-3 h-3\" /> AI Draft</span>\r\n                      <button onClick={handleInsertAiDraft} className=\"text-[10px] px-2 py-0.5 rounded bg-gm-interactive-primary text-gm-text-on-brand hover:bg-gm-interactive-primary-hover\">\r\n                        Use this draft\r\n                      </button>\r\n                    </div>\r\n                    <pre className=\"text-xs text-gm-text-primary whitespace-pre-wrap font-sans\">{aiDraft}</pre>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </>\r\n          )}\r\n\r\n          {inputTab === 'paste' && (\r\n            <div>\r\n              <label className=\"text-xs font-medium text-gm-text-primary mb-2 block\">Paste email content:</label>\r\n              <textarea value={pasteContent} onChange={e => setPasteContent(e.target.value)}\r\n                placeholder={`Paste the full email content here...\\n\\nInclude headers if available:\\nFrom: sender@example.com\\nTo: recipient@example.com\\nSubject: Meeting notes\\nDate: Jan 31, 2026\\n\\nEmail body text...`}\r\n                rows={12}\r\n                className=\"w-full bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-4 py-3 text-sm text-gm-text-primary placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-gm-border-focus resize-y font-mono leading-relaxed\" />\r\n              <p className=\"text-[10px] text-gm-text-tertiary mt-1.5\">Include headers (From, To, Subject, Date) for better parsing. AI will analyze and extract entities.</p>\r\n            </div>\r\n          )}\r\n\r\n          {inputTab === 'upload' && (\r\n            <div>\r\n              <div className=\"border-2 border-dashed border-gm-border-primary rounded-xl p-12 text-center hover:border-blue-600/30 transition-colors cursor-pointer bg-[var(--gm-surface-hover)]\"\r\n                onClick={() => fileRef.current?.click()}\r\n                onDragOver={e => e.preventDefault()}\r\n                onDrop={handleFileDrop}>\r\n                <Paperclip className=\"w-12 h-12 mx-auto mb-3 text-gray-600\" />\r\n                <p className=\"text-sm font-medium text-gm-interactive-primary\">Drop email file here</p>\r\n                <p className=\"text-xs text-gm-text-tertiary mt-1\">or click to browse &middot; .eml, .msg</p>\r\n                <input ref={fileRef} type=\"file\" className=\"hidden\" accept=\".eml,.msg\" onChange={e => {\r\n                  if (e.target.files?.[0]) {\r\n                    fileObjRef.current = e.target.files[0];\r\n                    setFileName(e.target.files[0].name);\r\n                  }\r\n                }} />\r\n              </div>\r\n              {fileName && (\r\n                <div className=\"flex items-center gap-3 mt-4 p-3 bg-gm-surface-secondary rounded-lg border border-gm-border-primary\">\r\n                  <div className=\"w-10 h-10 rounded-lg bg-blue-600/10 flex items-center justify-center\">\r\n                    <Paperclip className=\"w-5 h-5 text-gm-interactive-primary\" />\r\n                  </div>\r\n                  <span className=\"text-sm font-medium text-gm-text-primary flex-1 truncate\">{fileName}</span>\r\n                  <button onClick={() => { fileObjRef.current = null; setFileName(''); }} className=\"text-gm-text-tertiary hover:text-gm-status-danger text-lg\">&times;</button>\r\n                </div>\r\n              )}\r\n              <p className=\"text-[10px] text-gm-text-tertiary mt-3\">Email will be parsed, analyzed with AI, and entities extracted automatically.</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Footer */}\r\n        <div className=\"flex items-center justify-end gap-2 px-5 py-3 border-t border-[var(--gm-border-primary)] shrink-0\" style={{ borderColor: 'var(--gm-border-primary)', backgroundColor: 'var(--gm-surface-secondary)' }}>\r\n          <button onClick={handleClose} className=\"px-4 py-2 rounded-lg text-slate-300 text-sm font-medium hover:bg-white/10 border border-white/20 transition-colors\">\r\n            Cancel\r\n          </button>\r\n          <button onClick={handleSend} disabled={sending}\r\n            className=\"px-4 py-2 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-sm font-medium hover:bg-gm-interactive-primary-hover disabled:opacity-50 flex items-center gap-1.5 transition-colors\">\r\n            {sending ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : <Send className=\"w-4 h-4\" />}\r\n            {sendLabel}\r\n          </button>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nasync function fileToBase64(file: File): Promise<string> {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.onload = () => resolve((reader.result as string).split(',')[1]);\r\n    reader.onerror = reject;\r\n    reader.readAsDataURL(file);\r\n  });\r\n}\r\n","import { useState, useMemo } from 'react';\nimport {\n  Mail, Loader2, Search, Clock, Star, Plus,\n  ArrowUpRight, ArrowDownLeft, ArrowLeftRight,\n  Sparkles, BarChart3, Eye, EyeOff, Archive,\n} from 'lucide-react';\nimport { toast } from 'sonner';\nimport {\n  useEmails, useEmailStats, useStarEmail, useMarkEmailRead,\n} from '../hooks/useGodMode';\nimport { EmailsSkeleton } from '../components/shared/PageSkeleton';\nimport { cn } from '../lib/utils';\nimport EmailDetailModal from '../components/emails/EmailDetailModal';\nimport EmailComposeModal from '../components/emails/EmailComposeModal';\nimport { ErrorState } from '../components/shared/ErrorState';\n\nconst sentimentColor: Record<string, string> = {\n  positive: 'bg-gm-status-success-bg text-gm-status-success',\n  neutral: 'bg-gm-surface-secondary text-gm-text-tertiary',\n  negative: 'bg-gm-status-danger-bg text-gm-status-danger',\n  urgent: 'bg-gm-status-danger-bg text-gm-status-danger',\n};\n\nconst directionIcon: Record<string, typeof ArrowUpRight> = {\n  inbound: ArrowDownLeft,\n  outbound: ArrowUpRight,\n  internal: ArrowLeftRight,\n};\n\ntype ComposeMode = { open: boolean; mode: 'compose' | 'reply' | 'forward'; replyTo: Record<string, unknown> | null };\n\nexport default function EmailsPage() {\n  const [filter, setFilter] = useState<'' | 'needs_response' | 'starred' | 'unread'>('');\n  const [directionFilter, setDirectionFilter] = useState('');\n  const [search, setSearch] = useState('');\n  const [selectedEmail, setSelectedEmail] = useState<Record<string, unknown> | null>(null);\n  const [compose, setCompose] = useState<ComposeMode>({ open: false, mode: 'compose', replyTo: null });\n\n  const emails = useEmails({ requires_response: filter === 'needs_response' ? true : undefined });\n  const emailStats = useEmailStats();\n  const starEmail = useStarEmail();\n  const markRead = useMarkEmailRead();\n\n  const emailList = useMemo(() => {\n    const raw = (emails.data ?? []) as Array<Record<string, unknown>>;\n    if (Array.isArray(raw)) return raw;\n    const obj = raw as Record<string, unknown>;\n    return (obj.emails ?? []) as Array<Record<string, unknown>>;\n  }, [emails.data]);\n\n  const filtered = useMemo(() => {\n    return emailList.filter(e => {\n      if (search && !JSON.stringify(e).toLowerCase().includes(search.toLowerCase())) return false;\n      if (directionFilter && String(e.direction || '') !== directionFilter) return false;\n      if (filter === 'starred' && !e.is_starred) return false;\n      if (filter === 'unread' && e.is_read) return false;\n      return true;\n    });\n  }, [emailList, search, directionFilter, filter]);\n\n  const stats = emailStats.data as Record<string, unknown> | undefined;\n\n  const handleStar = (e: React.MouseEvent, id: string, currentlyStarred: boolean) => {\n    e.stopPropagation();\n    starEmail.mutate({ id, starred: !currentlyStarred });\n  };\n\n  const handleSelectEmail = (email: Record<string, unknown>) => {\n    setSelectedEmail(email);\n    if (!email.is_read) markRead.mutate({ id: String(email.id), read: true });\n  };\n\n  const statCards = [\n    { label: 'Total', value: stats?.total ?? 0, color: 'text-gm-text-primary', icon: Mail },\n    { label: 'Unread', value: stats?.unread ?? 0, color: 'text-gm-interactive-primary', icon: Eye },\n    { label: 'Starred', value: stats?.starred ?? 0, color: 'text-yellow-500', icon: Star },\n    { label: 'Needs Response', value: stats?.needing_response ?? 0, color: 'text-gm-status-warning', icon: Clock },\n  ];\n\n  return (\n    <div className=\"p-6 space-y-4\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gm-text-primary\">Emails</h1>\n          <p className=\"text-xs text-gm-text-tertiary mt-0.5\">{filtered.length} email{filtered.length !== 1 ? 's' : ''}</p>\n        </div>\n        <button onClick={() => setCompose({ open: true, mode: 'compose', replyTo: null })}\n          className=\"px-4 py-2 rounded-lg bg-gm-interactive-primary text-gm-text-on-brand text-sm font-medium hover:bg-gm-interactive-primary-hover flex items-center gap-2 transition-colors\">\n          <Plus className=\"w-4 h-4\" /> Add Email\n        </button>\n      </div>\n\n      {/* Stats */}\n      {stats && (\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\n          {statCards.map(s => {\n            const Icon = s.icon;\n            return (\n              <div key={s.label} className=\"bg-gm-surface-primary border border-gm-border-primary rounded-xl px-4 py-3 flex items-center gap-3 hover:border-blue-600/20 transition-colors cursor-pointer\"\n                role=\"button\" tabIndex={0}\n                onClick={() => {\n                  if (s.label === 'Unread') setFilter(filter === 'unread' ? '' : 'unread');\n                  else if (s.label === 'Starred') setFilter(filter === 'starred' ? '' : 'starred');\n                  else if (s.label === 'Needs Response') setFilter(filter === 'needs_response' ? '' : 'needs_response');\n                  else setFilter('');\n                }}>\n                <div className={cn('w-9 h-9 rounded-lg flex items-center justify-center',\n                  s.label === 'Total' ? 'bg-gm-surface-secondary' :\n                  s.label === 'Unread' ? 'bg-blue-600/10' :\n                  s.label === 'Starred' ? 'bg-yellow-500/10' : 'bg-yellow-500/10')}>\n                  <Icon className={cn('w-4.5 h-4.5', s.color)} />\n                </div>\n                <div>\n                  <span className={cn('text-xl font-bold', s.color)}>{String(s.value)}</span>\n                  <p className=\"text-[10px] text-gm-text-tertiary uppercase tracking-wider\">{s.label}</p>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      )}\n\n      {/* Filters */}\n      <div className=\"flex items-center gap-2 flex-wrap\">\n        <div className=\"relative flex-1 max-w-sm\">\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gm-text-tertiary\" />\n          <input value={search} onChange={e => setSearch(e.target.value)} placeholder=\"Search emails...\"\n            aria-label=\"Search emails\"\n            className=\"w-full pl-9 pr-3 py-2 bg-gm-surface-secondary border border-gm-border-primary rounded-lg text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus\" />\n        </div>\n\n        {[\n          { key: 'needs_response', label: 'Needs Response', icon: Clock, activeColor: 'bg-gm-status-warning-bg border-yellow-500/30 text-gm-status-warning' },\n          { key: 'starred', label: 'Starred', icon: Star, activeColor: 'bg-yellow-500/10 border-yellow-500/30 text-yellow-500' },\n          { key: 'unread', label: 'Unread', icon: Eye, activeColor: 'bg-blue-600/10 border-blue-600/30 text-gm-interactive-primary' },\n        ].map(f => {\n          const FIcon = f.icon;\n          const isActive = filter === f.key;\n          return (\n            <button key={f.key} onClick={() => setFilter(isActive ? '' : f.key as typeof filter)}\n              aria-pressed={isActive}\n              className={cn('px-2.5 py-2 rounded-lg text-xs font-medium transition-colors border flex items-center gap-1.5',\n                isActive ? f.activeColor : 'bg-gm-surface-secondary border-gm-border-primary text-gm-text-tertiary hover:text-gm-text-primary')}>\n              <FIcon className=\"w-3.5 h-3.5\" /> {f.label}\n            </button>\n          );\n        })}\n\n        <select value={directionFilter} onChange={e => setDirectionFilter(e.target.value)}\n          aria-label=\"Filter by direction\"\n          className=\"bg-gm-surface-secondary border border-gm-border-primary rounded-lg px-3 py-2 text-xs text-gm-text-primary focus:outline-none focus:ring-2 focus:ring-gm-border-focus\">\n          <option value=\"\">All directions</option>\n          <option value=\"inbound\">Inbound</option>\n          <option value=\"outbound\">Outbound</option>\n          <option value=\"internal\">Internal</option>\n        </select>\n      </div>\n\n      {/* Email List */}\n      {emails.error ? (\n        <ErrorState message=\"Failed to load emails.\" onRetry={() => emails.refetch()} />\n      ) : emails.isLoading ? (\n        <EmailsSkeleton />\n      ) : filtered.length === 0 ? (\n        <div className=\"rounded-xl border border-gm-border-primary bg-gm-surface-primary p-8 text-center text-gm-text-tertiary\">\n          <Mail className=\"h-12 w-12 mx-auto mb-4 text-gray-500\" />\n          {emailList.length === 0 ? \"No emails imported yet. Click 'Add Email' to get started.\" : 'No emails match your filters.'}\n        </div>\n      ) : (\n        <div className=\"space-y-1.5\">\n          {filtered.map((email) => {\n            const isStarred = !!email.is_starred;\n            const isRead = !!email.is_read;\n            const hasDraft = !!email.response_drafted || !!email.draft_response;\n            const isResponded = !!email.response_sent;\n            const hasAi = !!email.ai_summary;\n            const DirIcon = directionIcon[String(email.direction || '')] || null;\n            const subject = String(email.subject || 'No subject');\n            const from = String(email.from || email.from_name || email.sender || '');\n            const date = email.date ? new Date(String(email.date)).toLocaleDateString() : '';\n            const preview = String(email.ai_summary || email.body_text || email.body || '').substring(0, 120);\n\n            return (\n              <div key={String(email.id)}\n                className={cn(\n                  'bg-gm-surface-primary border border-gm-border-primary rounded-xl p-3.5 hover:border-blue-600/30 transition-all cursor-pointer group',\n                  !isRead && 'border-l-[3px] border-l-gm-interactive-primary',\n                )}\n                onClick={() => handleSelectEmail(email)}>\n                <div className=\"flex items-center gap-3\">\n                  {/* Star */}\n                  <button onClick={(e) => handleStar(e, String(email.id), isStarred)} className=\"flex-shrink-0\">\n                    <Star className={cn('w-4 h-4 transition-colors', isStarred ? 'fill-yellow-400 text-yellow-400' : 'text-gray-600 hover:text-yellow-400')} />\n                  </button>\n\n                  {/* Direction icon */}\n                  {DirIcon ? (\n                    <DirIcon className={cn('w-5 h-5 flex-shrink-0', isRead ? 'text-gm-text-tertiary' : 'text-gm-interactive-primary')} />\n                  ) : (\n                    <Mail className={cn('w-5 h-5 flex-shrink-0', isRead ? 'text-gm-text-tertiary' : 'text-gm-interactive-primary')} />\n                  )}\n\n                  {/* Content */}\n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-center gap-2\">\n                      <p className={cn('text-sm truncate transition-colors group-hover:text-gm-interactive-primary',\n                        isRead ? 'text-gm-text-primary' : 'text-gm-text-primary font-semibold')}>\n                        {subject}\n                      </p>\n                    </div>\n                    <div className=\"flex items-center gap-2 mt-0.5\">\n                      <span className=\"text-[10px] text-gm-text-tertiary truncate max-w-[200px]\">{from}</span>\n                      {date && <span className=\"text-[10px] text-gm-text-tertiary\">{date}</span>}\n                    </div>\n                    {preview && (\n                      <p className=\"text-[10px] text-gray-400 mt-0.5 truncate\">{preview}</p>\n                    )}\n                  </div>\n\n                  {/* Badges */}\n                  <div className=\"flex items-center gap-1.5 flex-shrink-0 flex-wrap justify-end\">\n                    {email.requires_response && !isResponded && (\n                      <span className=\"text-[10px] px-2 py-0.5 rounded-full bg-gm-status-warning-bg text-gm-status-warning font-medium flex items-center gap-1\">\n                        <Clock className=\"w-3 h-3\" /> Needs Response\n                      </span>\n                    )}\n                    {isResponded && (\n                      <span className=\"text-[10px] px-2 py-0.5 rounded-full bg-gm-status-success-bg text-gm-status-success font-medium\">Responded</span>\n                    )}\n                    {hasDraft && !isResponded && (\n                      <span className=\"text-[10px] px-2 py-0.5 rounded-full bg-blue-600/10 text-gm-interactive-primary font-medium\">Draft</span>\n                    )}\n                    {email.sentiment && (\n                      <span className={cn('text-[10px] px-2 py-0.5 rounded-full font-medium capitalize', sentimentColor[String(email.sentiment)] || sentimentColor.neutral)}>\n                        {String(email.sentiment)}\n                      </span>\n                    )}\n                    {email.ai_category && (\n                      <span className=\"text-[10px] px-2 py-0.5 rounded-full bg-blue-600/10 text-gm-interactive-primary font-medium capitalize\">\n                        {String(email.ai_category)}\n                      </span>\n                    )}\n                    {hasAi && (\n                      <Sparkles className=\"w-3.5 h-3.5 text-blue-500\" />\n                    )}\n                  </div>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      )}\n\n      {/* Detail Modal */}\n      <EmailDetailModal\n        email={selectedEmail}\n        open={!!selectedEmail}\n        onClose={() => setSelectedEmail(null)}\n        onReply={(email) => { setSelectedEmail(null); setCompose({ open: true, mode: 'reply', replyTo: email }); }}\n        onForward={(email) => { setSelectedEmail(null); setCompose({ open: true, mode: 'forward', replyTo: email }); }}\n      />\n\n      {/* Compose Modal */}\n      <EmailComposeModal\n        open={compose.open}\n        onClose={() => setCompose({ open: false, mode: 'compose', replyTo: null })}\n        mode={compose.mode}\n        replyTo={compose.replyTo}\n      />\n    </div>\n  );\n}\n"],"names":["__iconNode","ArrowDownLeft","createLucideIcon","ArrowLeftRight","Forward","directionIcon","ArrowUpRight","sentimentConfig","EmailDetailModal","email","open","onClose","onReply","onForward","tab","setTab","useState","draftResponse","setDraftResponse","showThread","setShowThread","deleteEmail","useDeleteEmail","markResponded","useMarkEmailResponded","generateResponse","useGenerateEmailResponse","starEmail","useStarEmail","archiveEmail","useArchiveEmail","markRead","useMarkEmailRead","categorizeEmail","useCategorizeEmail","summarizeEmail","useGenerateEmailSummary","threadId","threadQuery","useEmailThread","threadEmails","subject","from","fromEmail","to","cc","date","body","isRead","isStarred","direction","sentiment","intent","aiSummary","requiresResponse","extracted","facts","decisions","risks","actionItems","questions","people","technologies","relationships","keyTopics","attachments","hasAnalysis","hasEntities","hasPeople","DirIcon","sentCfg","handleDelete","toast","handleGenerateResponse","data","tabs","FileText","Brain","Cpu","Contact","jsx","Dialog","o","jsxs","DialogContent","DialogTitle","ArrowLeft","cn","Clock","Paperclip","e","Star","EyeOff","Eye","Archive","Trash2","Icon","Fragment","Sparkles","att","i","formatBytes","Loader2","te","Reply","CheckCircle","r","AnalysisSection","Lightbulb","f","a","d","AlertTriangle","HelpCircle","q","Link2","p","name","avatarSrc","resolveAvatarUrl","isValidAvatarUrl","getInitials","CommentsPanel","title","color","count","children","bytes","k","sizes","EmailComposeModal","mode","replyTo","isReply","isForward","inputTab","setInputTab","setTo","setCc","setSubject","setBody","pasteContent","setPasteContent","showCc","setShowCc","sending","setSending","fileName","setFileName","fileRef","useRef","fileObjRef","aiDraft","setAiDraft","generatingDraft","setGeneratingDraft","sendEmail","useSendEmail","importEmail","useImportEmail","handleClose","handleSend","emailRegex","invalid","file","base64","fileToBase64","isMsg","handleInsertAiDraft","useCallback","handleGenerateDraft","apiClient","handleFileDrop","sendLabel","inputTabs","X","t","ChevronUp","ChevronDown","Send","resolve","reject","reader","sentimentColor","EmailsPage","filter","setFilter","directionFilter","setDirectionFilter","search","setSearch","selectedEmail","setSelectedEmail","compose","setCompose","emails","useEmails","emailStats","useEmailStats","emailList","useMemo","raw","filtered","stats","handleStar","id","currentlyStarred","handleSelectEmail","statCards","Mail","Plus","Search","FIcon","isActive","ErrorState","EmailsSkeleton","hasDraft","isResponded","hasAi","preview"],"mappings":"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","x_google_ignoreList":[0,1,2]}
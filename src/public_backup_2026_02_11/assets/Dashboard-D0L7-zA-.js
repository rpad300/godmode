const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/main-v_cFye9p.js","assets/modulepreload-polyfill-B5Qt9EMX.js","assets/main-Cr-TCRi2.css"])))=>i.map(i=>d[i]);
import{c as e,a as T,_ as j,d as q,r as D,h as L}from"./main-v_cFye9p.js";import"./modulepreload-polyfill-B5Qt9EMX.js";const B={dashboard:'<rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect>',questions:'<circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12.01" y2="17"></line>',risks:'<path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line>',actions:'<polyline points="9 11 12 14 22 4"></polyline><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>',decisions:'<circle cx="12" cy="12" r="10"></circle><path d="M22 12h-4"></path><path d="M6 12H2"></path><path d="M12 6V2"></path><path d="M12 22v-4"></path>',facts:'<path d="M12 2a6 6 0 0 1 6 6c0 7-6 9-6 9s-6-2-6-9a6 6 0 0 1 6-6z"></path><path d="M12 18v2"></path>',settings:'<circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>',user:'<path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle>',bell:'<path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path><path d="M13.73 21a2 2 0 0 1-3.46 0"></path>',search:'<circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>',plus:'<line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line>',check:'<polyline points="20 6 9 17 4 12"></polyline>',alert:'<circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line>',info:'<circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line>',close:'<line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line>',"arrow-right":'<line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline>',"arrow-left":'<line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline>',"chevron-down":'<polyline points="6 9 12 15 18 9"></polyline>',"chevron-up":'<polyline points="18 15 12 9 6 15"></polyline>',timeline:'<circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>',graph:'<circle cx="12" cy="12" r="3"></circle><path d="M19 5a2 2 0 0 0-2 2v0"></path><path d="M5 19a2 2 0 0 0 2 2v0"></path>',team:'<path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path>',documents:'<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline>',email:'<path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline>'};function U(i,t={}){const l=t.size||24,o=t.strokeWidth||2,r=t.color||"currentColor",s=e("div",{className:`sota-icon ${t.className||""}`,style:`display: inline-flex; align-items: center; justify-content: center; width: ${l}px; height: ${l}px;`});return s.innerHTML=`
    <svg 
      xmlns="http://www.w3.org/2000/svg" 
      width="${l}" 
      height="${l}" 
      viewBox="0 0 24 24" 
      fill="none" 
      stroke="${r}" 
      stroke-width="${o}" 
      stroke-linecap="round" 
      stroke-linejoin="round"
    >
      ${B[i]||""}
    </svg>
  `,s.firstElementChild}function V(i={}){const t=e("div",{className:"dashboard"}),l=e("div",{className:"dashboard-row"}),o=e("div",{id:"dashboard-stats-grid",className:"stats-grid"});l.appendChild(o);const r=e("div",{id:"dashboard-insights",className:"dashboard-insights-row"}),s=e("div",{id:"dashboard-overdue",className:"dashboard-overdue-section"}),h=e("div",{id:"dashboard-alerts",className:"dashboard-alerts-section"}),n=e("div",{id:"dashboard-briefing",className:"dashboard-briefing-section"}),c=e("div",{id:"dashboard-golden-hours",className:"dashboard-golden-hours-section"}),g=e("div",{className:"dashboard-charts-row"}),u=e("div",{id:"questions-chart",className:"chart-container"}),d=e("div",{id:"facts-chart",className:"chart-container"}),p=e("div",{id:"trends-chart",className:"chart-container"});g.appendChild(u),g.appendChild(d),g.appendChild(p);const v=e("div",{className:"dashboard-bottom-row"}),b=e("div",{id:"dashboard-health",className:"dashboard-health-card"}),y=e("div",{id:"risk-summary-container",className:"dashboard-risk-summary-card"});return v.appendChild(b),v.appendChild(y),t.appendChild(l),t.appendChild(r),t.appendChild(s),t.appendChild(h),t.appendChild(n),t.appendChild(c),t.appendChild(g),t.appendChild(v),_(t,i),t}async function _(i,t){const l=i.querySelector("#dashboard-health"),o=i.querySelector("#dashboard-briefing"),r=i.querySelector("#dashboard-stats-grid"),s=i.querySelector("#dashboard-overdue"),h=i.querySelector("#dashboard-alerts"),n=i.querySelector("#dashboard-insights"),c=i.querySelector("#risk-summary-container"),g=i.querySelector("#dashboard-golden-hours"),u=T.getState().currentProject,d=T.getState().currentProjectId;if(!u&&!d){if(r){r.innerHTML=`
        <div class="no-project-state">
          <svg class="no-project-icon" width="80" height="80" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>
          </svg>
          <h2 class="no-project-title">No Project Selected</h2>
          <p class="no-project-desc">
            Select a project from the dropdown in the header to view your dashboard, or create a new project to get started.
          </p>
          <div class="no-project-actions">
            <button class="btn btn-primary create-project-btn no-project-btn">
              <svg width="18" height="18" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
              </svg>
              Create New Project
            </button>
          </div>
        </div>
      `;const p=r.querySelector(".create-project-btn");p&&p.addEventListener("click",async()=>{const{showProjectModal:v}=await j(async()=>{const{showProjectModal:b}=await import("./main-v_cFye9p.js").then(y=>y.$);return{showProjectModal:b}},__vite__mapDeps([0,1,2]));v({mode:"create",onSave:()=>{window.dispatchEvent(new CustomEvent("godmode:project-created"))}})})}l&&(l.innerHTML=""),o&&(o.innerHTML=""),s&&(s.innerHTML=""),h&&(h.innerHTML=""),n&&(n.innerHTML=""),c&&(c.innerHTML=""),g&&(g.innerHTML="");return}r&&(r.innerHTML='<div class="loading-placeholder">Loading dashboard...</div>'),o&&!o.hasChildNodes()&&j(async()=>{const{createBriefingPanel:p}=await import("./main-v_cFye9p.js").then(v=>v.a1);return{createBriefingPanel:p}},__vite__mapDeps([0,1,2])).then(({createBriefingPanel:p})=>{const v=p();o.appendChild(v)}).catch(p=>console.error("Failed to load BriefingPanel:",p));try{const{dashboard:p,health:v,insights:b,alerts:y}=await q.loadAll();if(!i.isConnected){console.log("[Dashboard] Component unmounted during load, aborting render.");return}if(l&&v&&P(l,v),r&&p&&F(r,p,t.onStatClick),s&&p&&p.overdueActions>0&&Y(s,p.overdueActions),h&&y.length>0&&O(h,y,t.onAlertClick),n&&b.length>0&&R(n,b,t.onInsightAction),p&&(W(p),Q(p),Z(p).catch(x=>console.error("Failed to render trends chart:",x))),c&&!c.hasChildNodes()&&D.getAll().then(x=>{G(c,x)}).catch(x=>console.error("Failed to load Risk Summary:",x)),g&&!g.hasChildNodes()){const x=d||u?.id;x&&K(g,x)}}catch(p){i.isConnected&&(console.error("Failed to load dashboard:",p),r&&(r.innerHTML='<div class="error-message">Failed to load dashboard data</div>'))}}function P(i,t){if(i.innerHTML="",!t||typeof t.status!="string"){const b=e("div",{className:"health-indicator unknown"}),y=e("div",{className:"health-gauge"}),x=e("span",{className:"score-value"},["--"]),C=e("span",{className:"score-label"},["Health"]);y.appendChild(x),y.appendChild(C);const k=e("p",{className:"health-status"},["Health data unavailable"]);b.appendChild(y),b.appendChild(k),i.appendChild(b);return}const l=t.status.toLowerCase().replace(/\s+/g,"-"),o=t.score??0,r=t.color||"#888",s=t.factors||[],h=e("div",{className:`health-indicator ${l}`}),n=e("div",{className:"health-gauge"}),c=e("div",{className:"health-score",style:`--score: ${o}%`});c.appendChild(e("span",{className:"score-value"},[String(o)])),c.appendChild(e("span",{className:"score-label"},["Health"]));const g=e("div",{className:"health-bar"}),u=e("div",{className:"health-fill",style:`--fill-width: ${o}%; --fill-color: ${r}`});g.appendChild(u),n.appendChild(c),n.appendChild(g);const d=e("div",{className:"health-status"}),p=e("span",{className:"status-text",style:`--status-color: ${r}`},[t.status]);d.appendChild(p);const v=e("div",{className:"health-factors"});s.slice(0,3).forEach(b=>{const y=e("div",{className:`factor ${b.type}`}),x=b.type==="positive"?"check":"alert",C=U(x,{size:14,className:"factor-icon"}),k=e("span",{className:"factor-text"},[b.factor]);y.appendChild(C),y.appendChild(k),v.appendChild(y)}),h.appendChild(n),h.appendChild(d),h.appendChild(v),i.appendChild(h)}function F(i,t,l){t.documents;const o=t.questionsByPriority||{resolved:0},r=t.risksByImpact||{high:0},s=t.factsVerifiedCount??0,h=[{id:"facts",label:"Facts",value:t.totalFacts??0,sub:s>0?`${s} verified`:void 0,icon:"üí°"},{id:"questions",label:"Questions",value:t.totalQuestions??0,sub:`${o.resolved} resolved`,icon:"‚ùì"},{id:"decisions",label:"Decisions",value:t.totalDecisions??0,icon:"üéØ"},{id:"risks",label:"Risks",value:t.totalRisks??0,sub:`${r.high} high`,icon:"‚ö†Ô∏è"},{id:"actions",label:"Actions",value:t.totalActions??0,sub:`${t.overdueActions??0} overdue`,icon:"‚úÖ"}];i.innerHTML="",h.forEach(n=>{const c=e("div",{className:"stat-card","data-stat-id":n.id}),g=e("div",{className:"stat-value"},[String(n.value)]),u=e("div",{className:"stat-label"},[n.label]);if(c.appendChild(g),c.appendChild(u),n.sub){const d=e("div",{className:"stat-sub"},[n.sub]);c.appendChild(d)}l&&(c.classList.add("clickable"),c.addEventListener("click",()=>l(n.id))),i.appendChild(c)})}function O(i,t,l){i.innerHTML="";const o=e("div",{className:"alerts-header"});o.appendChild(e("h3",{},["Alerts"])),o.appendChild(e("span",{className:"alerts-count"},[String(t.length)])),i.appendChild(o);const r=e("div",{className:"alerts-list"});t.slice(0,5).forEach((s,h)=>{const n=e("div",{className:`alert-item ${s.severity}`,"data-alert-index":String(h)}),c=e("span",{className:"alert-icon"},[J(s.severity)]),g=e("div",{className:"alert-content"});g.appendChild(e("div",{className:"alert-title"},[s.title])),g.appendChild(e("div",{className:"alert-message"},[s.message])),n.appendChild(c),n.appendChild(g),l&&n.addEventListener("click",()=>l(s)),r.appendChild(n)}),i.appendChild(r)}function R(i,t,l){i.innerHTML="",t.slice(0,4).forEach((o,r)=>{const s=e("div",{className:`insight-item ${o.type}`,"data-insight-index":String(r)}),h=e("span",{className:"insight-icon"},[o.icon]),n=e("div",{className:"insight-content"});n.appendChild(e("div",{className:"insight-title"},[o.title])),n.appendChild(e("div",{className:"insight-message"},[o.message])),s.appendChild(h),s.appendChild(n),i.appendChild(s)})}function G(i,t){const l=(a,m)=>{const f=["low","medium","high","critical"].indexOf(a?.toLowerCase()||"low"),$=["low","medium","high"].indexOf(m?.toLowerCase()||"low"),N=f+$;return N>=4?"critical":N>=3?"high":N>=2?"medium":"low"},o=t.filter(a=>a.status!=="mitigated"&&a.status!=="closed"),r={critical:0,high:0,medium:0,low:0};o.forEach(a=>{const m=l(a.impact,a.likelihood);r[m]++});const s=o.length,h=t.length-o.length,n=a=>s>0?Math.round(a/s*100):0;let c="",g=0;const u={critical:"#ef4444",high:"#f97316",medium:"#eab308",low:"#22c55e"};["critical","high","medium","low"].forEach(a=>{const f=n(r[a])/100*360;f>0&&(c+=`${u[a]} ${g}deg ${g+f}deg, `,g+=f)}),c?c=c.slice(0,-2):c="var(--color-border) 0deg 360deg",i.innerHTML="";const d=e("div",{className:"risk-summary"}),p=e("div",{className:"risk-summary-header"});p.appendChild(e("h4",{},["Risk Overview"])),p.appendChild(e("span",{className:"risk-total"},[`${s} active`])),d.appendChild(p);const v=e("div",{className:"risk-summary-content"}),b=e("div",{className:"risk-donut-container"}),y=e("div",{className:"risk-donut",style:`--donut-conic: conic-gradient(${c})`}),x=e("div",{className:"risk-donut-center"});x.appendChild(e("span",{className:"donut-value"},[String(s)])),x.appendChild(e("span",{className:"donut-label"},["Risks"])),y.appendChild(x),b.appendChild(y),v.appendChild(b);const C=e("div",{className:"risk-bars"});if([{id:"critical",icon:"üî¥",label:"Critical"},{id:"high",icon:"üü†",label:"High"},{id:"medium",icon:"üü°",label:"Medium"},{id:"low",icon:"üü¢",label:"Low"}].forEach(a=>{const m=r[a.id],f=e("div",{className:`risk-bar-item ${a.id}`});f.appendChild(e("span",{className:"bar-icon"},[a.icon])),f.appendChild(e("span",{className:"bar-label"},[a.label]));const $=e("div",{className:"bar-track"});$.appendChild(e("div",{className:"bar-fill",style:`--bar-width: ${n(m)}%`})),f.appendChild($),f.appendChild(e("span",{className:"bar-count"},[String(m)])),C.appendChild(f)}),v.appendChild(C),d.appendChild(v),h>0){const a=e("div",{className:"risk-mitigated"});a.appendChild(e("span",{className:"mitigated-icon"},["‚úì"])),a.appendChild(e("span",{},[`${h} risk${h!==1?"s":""} mitigated`])),d.appendChild(a)}i.appendChild(d)}function Q(i){const t=document.getElementById("facts-chart");if(!t)return;t.innerHTML="";const l=i.factsByCategory||{},o=["technical","process","policy","people","timeline","general"],r=o.reduce((h,n)=>h+(l[n]??0),0);if(r===0){t.appendChild(e("div",{className:"empty-chart"},["No facts yet"]));return}t.appendChild(e("div",{className:"facts-chart-title"},["Facts by category"]));const s=e("div",{className:"priority-bars"});o.forEach(h=>{const n=l[h]??0,c=r>0?n/r*100:0,g=e("div",{className:"priority-bar"});g.appendChild(e("div",{className:"bar-label"},[h]));const u=e("div",{className:"bar-track"}),d=e("div",{className:"bar-fill",style:`--bar-width: ${c}%`});u.appendChild(d),g.appendChild(u),g.appendChild(e("div",{className:"bar-value"},[String(n)])),s.appendChild(g)}),t.appendChild(s)}function W(i){const t=document.getElementById("questions-chart");if(!t)return;t.innerHTML="";const{critical:l,high:o,medium:r,resolved:s}=i.questionsByPriority||{critical:0,high:0,medium:0,resolved:0},h=l+o+r+s;if(h===0){t.appendChild(e("div",{className:"empty-chart"},["No questions yet"]));return}const n=e("div",{className:"priority-bars"});[{label:"Critical",value:l,class:"critical"},{label:"High",value:o,class:"high"},{label:"Medium",value:r,class:"medium"},{label:"Resolved",value:s,class:"resolved"}].forEach(g=>{const u=e("div",{className:"priority-bar"});u.appendChild(e("div",{className:"bar-label"},[g.label]));const d=e("div",{className:"bar-track"}),p=e("div",{className:`bar-fill ${g.class}`,style:`--bar-width: ${h>0?g.value/h*100:0}%`});d.appendChild(p),u.appendChild(d),u.appendChild(e("div",{className:"bar-value"},[String(g.value)])),n.appendChild(u)}),t.appendChild(n)}async function Z(i){const t=document.getElementById("trends-chart");if(t){t.innerHTML="",t.appendChild(e("div",{className:"loading"},["Loading trends..."]));try{const l=await q.getTrends(7);if(t.innerHTML="",!l||!l.history||l.history.length===0){t.appendChild(e("div",{className:"empty-chart"},["No trend data available yet"]));return}const o=l.history,r=[],s={facts:[],questions:[],risks:[],actions:[]};o.forEach(d=>{const p=new Date(d.date);r.push(p.toLocaleDateString(void 0,{weekday:"short"})),s.facts.push(d.facts||0),s.questions.push(d.questions||0),s.risks.push(d.risks||0),s.actions.push(d.actions||0)});const h=Math.max(...s.facts,...s.questions,...s.risks,...s.actions,1),n=e("div",{className:"trends-chart"}),c=e("div",{className:"trends-legend"});[{cls:"facts",label:"Facts"},{cls:"questions",label:"Questions"},{cls:"risks",label:"Risks"},{cls:"actions",label:"Actions"}].forEach(d=>{const p=e("span",{className:"legend-item"});p.appendChild(e("span",{className:`legend-dot ${d.cls}`})),p.appendChild(document.createTextNode(d.label)),c.appendChild(p)}),n.appendChild(c);const u=e("div",{className:"trends-bars"});r.forEach((d,p)=>{const v=e("div",{className:"trend-column"}),b=e("div",{className:"trend-bars-group"});[{cls:"facts",val:s.facts[p]},{cls:"questions",val:s.questions[p]},{cls:"risks",val:s.risks[p]},{cls:"actions",val:s.actions[p]}].forEach(x=>{const C=e("div",{className:`trend-bar ${x.cls}`,style:`--trend-height: ${x.val/h*100}%`,title:`${x.cls.charAt(0).toUpperCase()+x.cls.slice(1)}: ${x.val}`});b.appendChild(C)}),v.appendChild(b),v.appendChild(e("div",{className:"trend-label"},[d])),u.appendChild(v)}),n.appendChild(u),t.appendChild(n)}catch(l){console.error("Failed to load trends:",l),t.innerHTML="",t.appendChild(e("div",{className:"error"},["Failed to load trend data"]))}}}function Y(i,t){if(t===0){i.innerHTML="";return}i.innerHTML=`
    <div class="overdue-alert">
      <div class="overdue-icon">‚ö†Ô∏è</div>
      <div class="overdue-content">
        <strong>${t} Overdue Action${t!==1?"s":""}</strong>
        <span>Action items past their due date require immediate attention</span>
      </div>
      <button class="btn btn-sm btn-warning" id="view-overdue-btn">View Actions</button>
    </div>
  `;const l=i.querySelector("#view-overdue-btn");l&&l.addEventListener("click",()=>{window.dispatchEvent(new CustomEvent("godmode:navigate",{detail:{tab:"sot",view:"actions",filter:"overdue"}}))})}function J(i){switch(i){case"critical":return"üî¥";case"high":return"üü†";case"warning":return"üü°";default:return"‚ö™"}}function E(i){try{const t=new Date,o=new Intl.DateTimeFormat("en-GB",{timeZone:i,hour:"2-digit",minute:"2-digit",hour12:!1}).format(t),r=parseInt(o.split(":")[0],10),s=r>=8&&r<18;return{localTime:o,localHour:r,isOnline:s}}catch{return{localTime:"--:--",localHour:12,isOnline:!1}}}function S(i){if(i.length===0)return[];const t=[],l=new Date;for(let o=0;o<24;o++){let r=0,s=0;for(const h of i)try{const n=new Intl.DateTimeFormat("en-US",{timeZone:h.timezone,hour:"numeric",hour12:!1}),c=parseInt(n.format(l),10),g=l.getUTCHours();let u=c-g;u>12&&(u-=24),u<-12&&(u+=24);const d=(o+u+24)%24;d>=9&&d<=17?(r++,d>=10&&d<=12||d>=14&&d<=16?s+=10:s+=7):d>=8&&d<=18&&(r++,s+=4)}catch{}r>0&&t.push({time:`${o.toString().padStart(2,"0")}:00 UTC`,score:s,available:r})}return t.sort((o,r)=>r.available!==o.available?r.available-o.available:r.score-o.score),t.slice(0,3)}async function K(i,t){try{const[l,o]=await Promise.all([L.get(`/api/projects/${t}/members`).catch(()=>({data:{members:[]}})),L.get("/api/contacts").catch(()=>({data:{contacts:[]}}))]),r=l.data?.members||[],s=o.data?.contacts||[],h=new Set,n=r.map(a=>{const m=a.linked_contact,f=a.timezone||m?.timezone;if(!f)return null;const $=E(f),N=a.avatar_url||m?.avatar_url||m?.photo_url,A=a.user_role||m?.role||(a.role==="owner"?"Owner":a.role==="admin"?"Admin":void 0),M=a.linked_contact_id||m?.id;return M&&h.add(M),{name:a.display_name||a.username||a.email||"Unknown",timezone:f,type:"member",avatarUrl:N,role:A,linkedContactId:M,...$}}).filter(a=>a!==null),c=s.filter(a=>a.timezone).map(a=>{const m=E(a.timezone||"UTC"),f=a.id;return{name:a.name,timezone:a.timezone||"UTC",type:"contact",avatarUrl:a.avatarUrl||a.photoUrl||a.photo_url||a.avatar_url,role:a.role,contactId:f,...m}});if(n.length===0&&c.length===0){i.innerHTML="";return}const g=z(n),u=z(c),d=c.filter(a=>!a.contactId||!h.has(a.contactId)),p=[...n,...d],v=z(p),b=S(p),y=n.filter(a=>a.isOnline).length,x=c.filter(a=>a.isOnline).length,C=d.filter(a=>a.isOnline).length,k=y+C;i.innerHTML=`
      <style>
        .golden-hours-section {
          background: var(--bg-primary);
          border-radius: 16px;
          padding: 24px;
          border: 1px solid var(--border-color);
          margin-bottom: 24px;
        }
        
        .golden-hours-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          margin-bottom: 24px;
        }
        
        .golden-hours-header h3 {
          margin: 0;
          font-size: 18px;
          font-weight: 600;
          color: var(--text-primary);
          display: flex;
          align-items: center;
          gap: 10px;
        }
        
        .golden-hours-header h3 svg {
          color: #f59e0b;
        }
        
        .golden-hours-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
          gap: 20px;
        }
        
        .golden-card {
          background: linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(248,250,252,0.9) 100%);
          border: 1px solid var(--border-color);
          border-radius: 12px;
          padding: 20px;
        }
        
        [data-theme="dark"] .golden-card {
          background: linear-gradient(135deg, rgba(30,41,59,0.9) 0%, rgba(30,41,59,0.6) 100%);
        }
        
        .golden-card h4 {
          margin: 0 0 16px 0;
          font-size: 14px;
          font-weight: 600;
          color: var(--text-secondary);
          display: flex;
          align-items: center;
          gap: 8px;
        }
        
        .golden-card h4 .count {
          background: var(--bg-secondary);
          padding: 2px 8px;
          border-radius: 10px;
          font-size: 12px;
        }
        
        .timezone-bars {
          display: flex;
          flex-direction: column;
          gap: 8px;
          margin-bottom: 16px;
        }
        
        .timezone-row {
          display: flex;
          align-items: center;
          gap: 10px;
        }
        
        .tz-name {
          width: 100px;
          font-size: 12px;
          color: var(--text-secondary);
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }
        
        .tz-bar-container {
          flex: 1;
          height: 24px;
          background: var(--bg-secondary);
          border-radius: 4px;
          position: relative;
          overflow: hidden;
        }
        
        .tz-bar {
          position: absolute;
          height: 100%;
          border-radius: 2px;
        }
        
        .tz-bar.work-hours {
          background: linear-gradient(90deg, #10b981, #34d399);
          opacity: 0.6;
        }
        
        .tz-bar.golden {
          background: linear-gradient(90deg, #f59e0b, #fbbf24);
          opacity: 0.9;
        }
        
        .hour-labels {
          display: flex;
          justify-content: space-between;
          padding: 0 110px 0 0;
          margin-bottom: 4px;
        }
        
        .hour-label {
          font-size: 10px;
          color: var(--text-muted);
          width: 20px;
          text-align: center;
        }
        
        .golden-summary {
          display: flex;
          align-items: center;
          gap: 12px;
          padding: 12px;
          background: linear-gradient(135deg, rgba(245,158,11,0.1) 0%, rgba(251,191,36,0.05) 100%);
          border-radius: 8px;
          border: 1px solid rgba(245,158,11,0.2);
        }
        
        .golden-icon {
          width: 40px;
          height: 40px;
          background: linear-gradient(135deg, #f59e0b, #d97706);
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;
          font-size: 18px;
        }
        
        .golden-text {
          flex: 1;
        }
        
        .golden-text .label {
          font-size: 12px;
          color: var(--text-secondary);
        }
        
        .golden-text .hours {
          font-size: 16px;
          font-weight: 700;
          color: #d97706;
        }
        
        .no-overlap {
          color: var(--text-muted);
          font-size: 13px;
          font-style: italic;
        }
        
        .participants-row {
          display: flex;
          align-items: center;
          gap: 4px;
          margin-top: 12px;
        }
        
        .participant-avatar {
          width: 24px;
          height: 24px;
          border-radius: 50%;
          background: linear-gradient(135deg, #667eea, #764ba2);
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;
          font-size: 10px;
          font-weight: 600;
          border: 2px solid var(--bg-primary);
          margin-left: -8px;
        }
        
        .participant-avatar:first-child {
          margin-left: 0;
        }
        
        .participant-avatar img {
          width: 100%;
          height: 100%;
          border-radius: 50%;
          object-fit: cover;
        }
        
        .participant-avatar.more {
          background: var(--bg-secondary);
          color: var(--text-secondary);
        }
        
        .online-status-bar {
          display: flex;
          align-items: center;
          gap: 16px;
          padding: 16px;
          background: linear-gradient(135deg, rgba(16,185,129,0.1) 0%, rgba(52,211,153,0.05) 100%);
          border-radius: 12px;
          border: 1px solid rgba(16,185,129,0.2);
          margin-bottom: 20px;
        }
        
        .online-indicator {
          display: flex;
          align-items: center;
          gap: 8px;
        }
        
        .online-dot {
          width: 10px;
          height: 10px;
          border-radius: 50%;
          background: #10b981;
          box-shadow: 0 0 8px rgba(16,185,129,0.6);
          animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
          0%, 100% { transform: scale(1); opacity: 1; }
          50% { transform: scale(1.2); opacity: 0.7; }
        }
        
        .online-count {
          font-size: 14px;
          font-weight: 600;
          color: #059669;
        }
        
        .people-list {
          display: flex;
          flex-wrap: wrap;
          gap: 12px;
          margin-top: 16px;
        }
        
        .person-chip {
          display: flex;
          align-items: center;
          gap: 8px;
          padding: 8px 12px;
          background: var(--bg-secondary);
          border-radius: 20px;
          border: 1px solid var(--border-color);
          transition: all 0.2s ease;
        }
        
        .person-chip.online {
          background: linear-gradient(135deg, rgba(16,185,129,0.1) 0%, rgba(16,185,129,0.05) 100%);
          border-color: rgba(16,185,129,0.3);
        }
        
        .person-chip.offline {
          opacity: 0.6;
        }
        
        .person-avatar-small {
          width: 28px;
          height: 28px;
          border-radius: 50%;
          background: linear-gradient(135deg, #667eea, #764ba2);
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;
          font-size: 11px;
          font-weight: 600;
          position: relative;
        }
        
        .person-avatar-small img {
          width: 100%;
          height: 100%;
          border-radius: 50%;
          object-fit: cover;
        }
        
        .person-avatar-small .status-dot {
          position: absolute;
          bottom: -2px;
          right: -2px;
          width: 10px;
          height: 10px;
          border-radius: 50%;
          border: 2px solid var(--bg-primary);
        }
        
        .person-avatar-small .status-dot.online {
          background: #10b981;
        }
        
        .person-avatar-small .status-dot.offline {
          background: #9ca3af;
        }
        
        .person-info {
          display: flex;
          flex-direction: column;
        }
        
        .person-name {
          font-size: 13px;
          font-weight: 500;
          color: var(--text-primary);
        }
        
        .person-time {
          font-size: 11px;
          color: var(--text-secondary);
        }
        
        .person-role {
          font-size: 10px;
          color: #e11d48;
          font-weight: 500;
          margin-top: 2px;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
          max-width: 120px;
        }
        
        .meeting-suggestions {
          margin-top: 20px;
          padding: 16px;
          background: linear-gradient(135deg, rgba(99,102,241,0.1) 0%, rgba(139,92,246,0.05) 100%);
          border-radius: 12px;
          border: 1px solid rgba(99,102,241,0.2);
        }
        
        .meeting-suggestions h5 {
          margin: 0 0 12px 0;
          font-size: 14px;
          font-weight: 600;
          color: var(--text-primary);
          display: flex;
          align-items: center;
          gap: 8px;
        }
        
        .meeting-suggestions h5 svg {
          color: #6366f1;
        }
        
        .suggestion-list {
          display: flex;
          flex-wrap: wrap;
          gap: 10px;
        }
        
        .suggestion-pill {
          display: flex;
          align-items: center;
          gap: 8px;
          padding: 8px 14px;
          background: white;
          border-radius: 20px;
          border: 1px solid rgba(99,102,241,0.3);
          font-size: 13px;
          cursor: pointer;
          transition: all 0.2s ease;
        }
        
        [data-theme="dark"] .suggestion-pill {
          background: rgba(30,41,59,0.8);
        }
        
        .suggestion-pill:hover {
          transform: translateY(-2px);
          box-shadow: 0 4px 12px rgba(99,102,241,0.2);
        }
        
        .suggestion-pill .time {
          font-weight: 600;
          color: #6366f1;
        }
        
        .suggestion-pill .availability {
          font-size: 11px;
          color: var(--text-secondary);
          padding: 2px 6px;
          background: rgba(16,185,129,0.1);
          border-radius: 8px;
          color: #059669;
        }
      </style>
      
      <div class="golden-hours-section">
        <div class="golden-hours-header">
          <h3>
            <svg width="24" height="24" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/>
            </svg>
            Golden Hours
          </h3>
          <span class="golden-header-time">
            ${new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"})} your time
          </span>
        </div>
        
        <div class="golden-hours-grid">
          <!-- Team Members Section -->
          ${n.length>0?`
            <div class="golden-card">
              <h4>
                <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"/>
                </svg>
                Team Members
                <span class="count">${n.length}</span>
                ${y>0?`<span class="online-badge">‚óè ${y} online</span>`:""}
              </h4>
              
              <!-- Team People List -->
              <div class="people-list">
                ${n.map(a=>{const m=a.name.split(" ").map(f=>f[0]).join("").substring(0,2).toUpperCase();return`
                    <div class="person-chip ${a.isOnline?"online":"offline"}">
                      <div class="person-avatar-small">
                        ${a.avatarUrl?`<img src="${w(a.avatarUrl)}" alt="${w(a.name)}">`:m}
                        <span class="status-dot ${a.isOnline?"online":"offline"}"></span>
                      </div>
                      <div class="person-info">
                        <span class="person-name">${w(a.name)}</span>
                        ${a.role?`<span class="person-role">${w(a.role)}</span>`:""}
                        <span class="person-time">${a.localTime||"--:--"} ${a.timezone.split("/").pop()?.replace(/_/g," ")||""}</span>
                      </div>
                    </div>
                  `}).join("")}
              </div>
              
              ${I(n,g)}
              ${H(g,n)}
              
              <!-- Team Meeting Suggestions -->
              ${(()=>{const a=S(n);return a.length>0?`
                  <div class="meeting-suggestions">
                    <h5>
                      <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                      </svg>
                      Best Times for Team
                    </h5>
                    <div class="suggestion-list">
                      ${a.map((m,f)=>`
                        <div class="suggestion-pill">
                          <span class="suggestion-star" style="--suggestion-star-color: ${f===0?"#f59e0b":"var(--text-muted)"};">${f===0?"‚≠ê":"üïê"}</span>
                          <span class="time">${m.time}</span>
                          <span class="availability">${m.available}/${n.length}</span>
                        </div>
                      `).join("")}
                    </div>
                  </div>
                `:""})()}
            </div>
          `:""}
          
          <!-- Contacts Section -->
          ${c.length>0?`
            <div class="golden-card">
              <h4>
                <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"/>
                </svg>
                Contacts
                <span class="count">${c.length}</span>
                ${x>0?`<span class="online-badge">‚óè ${x} online</span>`:""}
              </h4>
              
              <!-- Contacts People List -->
              <div class="people-list">
                ${c.map(a=>{const m=a.name.split(" ").map(f=>f[0]).join("").substring(0,2).toUpperCase();return`
                    <div class="person-chip ${a.isOnline?"online":"offline"}">
                      <div class="person-avatar-small">
                        ${a.avatarUrl?`<img src="${w(a.avatarUrl)}" alt="${w(a.name)}">`:m}
                        <span class="status-dot ${a.isOnline?"online":"offline"}"></span>
                      </div>
                      <div class="person-info">
                        <span class="person-name">${w(a.name)}</span>
                        ${a.role?`<span class="person-role">${w(a.role)}</span>`:""}
                        <span class="person-time">${a.localTime||"--:--"} ${a.timezone.split("/").pop()?.replace(/_/g," ")||""}</span>
                      </div>
                    </div>
                  `}).join("")}
              </div>
              
              ${I(c,u)}
              ${H(u,c)}
              
              <!-- Contacts Meeting Suggestions -->
              ${(()=>{const a=S(c);return a.length>0?`
                  <div class="meeting-suggestions">
                    <h5>
                      <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                      </svg>
                      Best Times for Contacts
                    </h5>
                    <div class="suggestion-list">
                      ${a.map((m,f)=>`
                        <div class="suggestion-pill">
                          <span class="suggestion-star" style="--suggestion-star-color: ${f===0?"#f59e0b":"var(--text-muted)"};">${f===0?"‚≠ê":"üïê"}</span>
                          <span class="time">${m.time}</span>
                          <span class="availability">${m.available}/${c.length}</span>
                        </div>
                      `).join("")}
                    </div>
                  </div>
                `:""})()}
            </div>
          `:""}
        </div>
        
        <!-- Combined Section (only if both exist) -->
        ${n.length>0&&c.length>0?`
          <div class="golden-card golden-card-mt">
            <h4>
              <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
              Combined: Team + Contacts
              <span class="count">${p.length}</span>
              <span class="online-badge">‚óè ${k} online</span>
            </h4>
            ${H(v,p)}
            
            <!-- Combined Meeting Suggestions -->
            ${b.length>0?`
              <div class="meeting-suggestions">
                <h5>
                  <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                  </svg>
                  Best Times for Everyone
                </h5>
                <div class="suggestion-list">
                  ${b.map((a,m)=>`
                    <div class="suggestion-pill">
                      <span class="suggestion-star" style="--suggestion-star-color: ${m===0?"#f59e0b":"var(--text-muted)"};">${m===0?"‚≠ê":"üïê"}</span>
                      <span class="time">${a.time}</span>
                      <span class="availability">${a.available}/${p.length}</span>
                    </div>
                  `).join("")}
                </div>
              </div>
            `:""}
          </div>
        `:""}
      </div>
    `}catch(l){console.error("Failed to load golden hours:",l)}}function z(i){if(i.length===0)return null;const t=[...new Set(i.map(n=>n.timezone))];if(t.length===1)return{start:8,end:18};const l=new Date,o=[];for(const n of t)try{const c=new Intl.DateTimeFormat("en-US",{timeZone:n,hour:"numeric",hour12:!1}),g=parseInt(c.format(l),10),u=l.getUTCHours();let d=g-u;d>12&&(d-=24),d<-12&&(d+=24),o.push(d)}catch{o.push(0)}let r=0,s=24;for(const n of o){const c=(8-n+24)%24,g=(18-n+24)%24;c<g&&(r=Math.max(r,c),s=Math.min(s,g))}if(r>=s)return null;const h=o[0];return{start:(r+h+24)%24,end:(s+h+24)%24}}function I(i,t){const l=new Map;for(const s of i)l.set(s.timezone,(l.get(s.timezone)||0)+1);const o=[...l.keys()].slice(0,5);if(o.length===0)return'<div class="no-overlap">No timezone data available</div>';const r=new Date;return`
    <div class="hour-labels">
      ${[0,6,12,18,24].map(s=>`<span class="hour-label">${s}</span>`).join("")}
    </div>
    <div class="timezone-bars">
      ${o.map(s=>{let h=0;try{const v=new Intl.DateTimeFormat("en-US",{timeZone:s,hour:"numeric",hour12:!1}),b=parseInt(v.format(r),10),y=r.getUTCHours();h=b-y,h>12&&(h-=24),h<-12&&(h+=24)}catch{}const n=9,c=18,g=n/24*100,u=(c-n)/24*100,d=s.split("/").pop()?.replace(/_/g," ")||s,p=l.get(s)||1;return`
          <div class="timezone-row">
            <span class="tz-name" title="${s}">${d} ${p>1?`(${p})`:""}</span>
            <div class="tz-bar-container">
              <div class="tz-bar work-hours" style="--tz-left: ${g}%; --tz-width: ${u}%;"></div>
              ${t?`<div class="tz-bar golden" style="--tz-left: ${t.start/24*100}%; --tz-width: ${(t.end-t.start)/24*100}%;"></div>`:""}
            </div>
          </div>
        `}).join("")}
    </div>
  `}function H(i,t){if(!i)return`
      <div class="golden-summary golden-summary-warning">
        <div class="golden-icon">‚ö†</div>
        <div class="golden-text">
          <div class="label">No overlap found</div>
          <div class="hours">Timezones too far apart</div>
        </div>
      </div>
    `;const l=n=>`${n.toString().padStart(2,"0")}:00`,o=i.end-i.start,r=5,s=t.slice(0,r),h=t.length-r;return`
    <div class="golden-summary">
      <div class="golden-icon">‚òÄÔ∏è</div>
      <div class="golden-text">
        <div class="label">Golden Hours</div>
        <div class="hours">${l(i.start)} - ${l(i.end)} (${o}h overlap)</div>
      </div>
    </div>
    <div class="participants-row">
      ${s.map(n=>{const c=n.name.split(" ").map(g=>g[0]).join("").substring(0,2).toUpperCase();return`
          <div class="participant-avatar" title="${w(n.name)}">
            ${n.avatarUrl?`<img src="${w(n.avatarUrl)}" alt="${w(n.name)}">`:c}
          </div>
        `}).join("")}
      ${h>0?`<div class="participant-avatar more">+${h}</div>`:""}
    </div>
  `}function w(i){return i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function te(i,t={}){const l=document.querySelector(i);if(!l)return console.warn(`Dashboard: Container not found: ${i}`),null;const o=V(t);return l.appendChild(o),o}export{V as createDashboard,V as default,te as mountDashboard};
//# sourceMappingURL=Dashboard-D0L7-zA-.js.map

{"version":3,"file":"TimelinePage-Yuu0vyeb.js","sources":["../../frontend/src/pages/TimelinePage.ts"],"sourcesContent":["/**\r\n * TimelinePanel - SOTA Timeline Component\r\n * \r\n * Features:\r\n * - Sticky date headers\r\n * - \"Today\" line marker\r\n * - Density toggle (compact, comfortable, spacious)\r\n * - Rich event cards with avatars, icons, status badges\r\n * - Relative time formatting with tooltip\r\n * - In-timeline search\r\n * - Keyboard navigation (J/K, Enter, /, Esc)\r\n * - Type filters with counts\r\n * - Skeleton loading\r\n * - Empty states with illustrations\r\n * - Export options\r\n */\r\n\r\nimport { createElement, on } from '@lib/dom';\r\nimport { getTimeline, TimelineEvent, TimelineData } from '@services/graph';\r\nimport { formatRelativeTime, formatDate, formatDateTime } from '@lib/format';\r\n\r\n// ============================================\r\n// TYPES\r\n// ============================================\r\n\r\nexport interface TimelinePanelProps {\r\n  onEventClick?: (event: TimelineEvent) => void;\r\n  containerElement?: HTMLElement;\r\n}\r\n\r\ninterface EventTypeConfig {\r\n  label: string;\r\n  icon: string;\r\n  color: string;\r\n}\r\n\r\ntype Density = 'compact' | 'comfortable' | 'spacious';\r\n\r\n// ============================================\r\n// CONSTANTS\r\n// ============================================\r\n\r\nconst EVENT_TYPES: Record<string, EventTypeConfig> = {\r\n  document: { label: 'Documents', icon: 'üìÑ', color: '#1abc9c' },\r\n  transcript: { label: 'Transcripts', icon: 'üéôÔ∏è', color: '#8b5cf6' },\r\n  email: { label: 'Emails', icon: 'üìß', color: '#6366f1' },\r\n  conversation: { label: 'Conversations', icon: 'üí¨', color: '#ec4899' },\r\n  chat_session: { label: 'Chat Sessions', icon: 'ü§ñ', color: '#0ea5e9' },\r\n  fact: { label: 'Facts', icon: 'üìå', color: '#3b82f6' },\r\n  question: { label: 'Questions', icon: '‚ùì', color: '#f59e0b' },\r\n  question_answered: { label: 'Answered', icon: '‚úÖ', color: '#10b981' },\r\n  decision: { label: 'Decisions', icon: 'üìã', color: '#3498db' },\r\n  risk: { label: 'Risks', icon: '‚ö†Ô∏è', color: '#f39c12' },\r\n  action: { label: 'Actions', icon: 'üìå', color: '#9b59b6' },\r\n  action_completed: { label: 'Completed', icon: '‚úÖ', color: '#2ecc71' },\r\n  deadline: { label: 'Deadlines', icon: 'üìÖ', color: '#9b59b6' },\r\n};\r\n\r\nconst DAY_PERIODS = [\r\n  { label: 'Last 7 days', days: 7 },\r\n  { label: 'Last 14 days', days: 14 },\r\n  { label: 'Last 30 days', days: 30 },\r\n  { label: 'Last 90 days', days: 90 },\r\n  { label: 'All time', days: 365 },\r\n];\r\n\r\n// ============================================\r\n// STATE\r\n// ============================================\r\n\r\nlet currentDays = 30;\r\nlet currentDensity: Density = 'comfortable';\r\nlet currentTypeFilters: string[] = [];\r\nlet currentSearch = '';\r\nlet allEvents: TimelineEvent[] = [];\r\nlet focusedEventIndex = -1;\r\n\r\n// ============================================\r\n// MAIN COMPONENT\r\n// ============================================\r\n\r\n/**\r\n * Create SOTA Timeline Panel\r\n */\r\nexport function createTimelinePanel(props: TimelinePanelProps = {}): HTMLElement {\r\n  const panel = createElement('div', { className: 'timeline-panel sot-panel' });\r\n\r\n  panel.innerHTML = `\r\n    <div class=\"panel-header\">\r\n      <div class=\"panel-title\">\r\n        <h2>Timeline</h2>\r\n        <span class=\"panel-count\" id=\"timeline-count\">0</span>\r\n      </div>\r\n      <div class=\"panel-actions\">\r\n        <div class=\"timeline-search-wrapper\">\r\n          <input type=\"text\" id=\"timeline-search\" class=\"timeline-search\" placeholder=\"Search events...\" />\r\n        </div>\r\n        <select id=\"timeline-period\" class=\"filter-select\">\r\n          ${DAY_PERIODS.map(p => `<option value=\"${p.days}\" ${p.days === currentDays ? 'selected' : ''}>${p.label}</option>`).join('')}\r\n        </select>\r\n        <div class=\"density-toggle\" title=\"View density\">\r\n          <button class=\"density-btn ${currentDensity === 'compact' ? 'active' : ''}\" data-density=\"compact\" title=\"Compact\">‚îÅ</button>\r\n          <button class=\"density-btn ${currentDensity === 'comfortable' ? 'active' : ''}\" data-density=\"comfortable\" title=\"Comfortable\">‚â°</button>\r\n          <button class=\"density-btn ${currentDensity === 'spacious' ? 'active' : ''}\" data-density=\"spacious\" title=\"Spacious\">‚ò∞</button>\r\n        </div>\r\n        <div class=\"timeline-actions-menu\">\r\n          <button class=\"btn btn-secondary btn-sm timeline-export-btn\" title=\"Export\">üì•</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"timeline-filters\" id=\"timeline-type-filters\">\r\n      <button class=\"filter-chip active\" data-type=\"\">All</button>\r\n    </div>\r\n    <div class=\"timeline-content\" id=\"timeline-content\">\r\n      ${renderSkeletons()}\r\n    </div>\r\n    <div class=\"timeline-footer hidden\" id=\"timeline-footer\">\r\n      <button class=\"btn btn-secondary btn-sm\" id=\"timeline-load-more\">Load more</button>\r\n    </div>\r\n  `;\r\n\r\n  bindEvents(panel, props);\r\n  loadTimeline(panel, props);\r\n\r\n  return panel;\r\n}\r\n\r\n// ============================================\r\n// EVENT BINDING\r\n// ============================================\r\n\r\nfunction bindEvents(panel: HTMLElement, props: TimelinePanelProps): void {\r\n  // Period selector\r\n  const periodSelect = panel.querySelector('#timeline-period') as HTMLSelectElement;\r\n  on(periodSelect, 'change', () => {\r\n    currentDays = parseInt(periodSelect.value);\r\n    loadTimeline(panel, props);\r\n  });\r\n\r\n  // Density toggle\r\n  const densityBtns = panel.querySelectorAll('.density-btn');\r\n  densityBtns.forEach(btn => {\r\n    on(btn as HTMLElement, 'click', () => {\r\n      densityBtns.forEach(b => b.classList.remove('active'));\r\n      btn.classList.add('active');\r\n      currentDensity = btn.getAttribute('data-density') as Density;\r\n      updateDensity(panel);\r\n    });\r\n  });\r\n\r\n  // Search\r\n  const searchInput = panel.querySelector('#timeline-search') as HTMLInputElement;\r\n  let searchTimeout: ReturnType<typeof setTimeout>;\r\n  on(searchInput, 'input', () => {\r\n    clearTimeout(searchTimeout);\r\n    searchTimeout = setTimeout(() => {\r\n      currentSearch = searchInput.value.toLowerCase();\r\n      renderFilteredEvents(panel, props);\r\n    }, 200);\r\n  });\r\n\r\n  // Export\r\n  const exportBtn = panel.querySelector('.timeline-export-btn');\r\n  if (exportBtn) {\r\n    on(exportBtn as HTMLElement, 'click', () => showExportMenu(panel));\r\n  }\r\n\r\n  // Keyboard navigation\r\n  on(panel, 'keydown', (e: KeyboardEvent) => {\r\n    const content = panel.querySelector('#timeline-content');\r\n    if (!content) return;\r\n\r\n    if (e.key === 'j' || e.key === 'ArrowDown') {\r\n      e.preventDefault();\r\n      navigateEvents(panel, 1, props);\r\n    } else if (e.key === 'k' || e.key === 'ArrowUp') {\r\n      e.preventDefault();\r\n      navigateEvents(panel, -1, props);\r\n    } else if (e.key === 'Enter') {\r\n      e.preventDefault();\r\n      selectFocusedEvent(panel, props);\r\n    } else if (e.key === '/') {\r\n      e.preventDefault();\r\n      searchInput.focus();\r\n    } else if (e.key === 'Escape') {\r\n      searchInput.blur();\r\n      focusedEventIndex = -1;\r\n      clearEventFocus(panel);\r\n    }\r\n  });\r\n\r\n  // Make panel focusable for keyboard events\r\n  panel.setAttribute('tabindex', '0');\r\n}\r\n\r\n// ============================================\r\n// DATA LOADING\r\n// ============================================\r\n\r\nasync function loadTimeline(panel: HTMLElement, props: TimelinePanelProps): Promise<void> {\r\n  const content = panel.querySelector('#timeline-content') as HTMLElement;\r\n  content.innerHTML = renderSkeletons();\r\n\r\n  try {\r\n    const endDate = new Date();\r\n    const startDate = new Date();\r\n    startDate.setDate(startDate.getDate() - currentDays);\r\n\r\n    const data: TimelineData = await getTimeline({\r\n      startDate: startDate.toISOString().split('T')[0],\r\n      endDate: endDate.toISOString().split('T')[0],\r\n      limit: 500,\r\n    });\r\n\r\n    allEvents = data.events || [];\r\n    updateTypeCounts(panel, allEvents);\r\n    renderFilteredEvents(panel, props);\r\n    updateCount(panel, allEvents.length);\r\n  } catch (error) {\r\n    console.error('Failed to load timeline:', error);\r\n    content.innerHTML = renderError();\r\n  }\r\n}\r\n\r\n// ============================================\r\n// RENDERING\r\n// ============================================\r\n\r\nfunction renderFilteredEvents(panel: HTMLElement, props: TimelinePanelProps): void {\r\n  let filtered = [...allEvents];\r\n\r\n  // Apply type filter\r\n  if (currentTypeFilters.length > 0) {\r\n    filtered = filtered.filter(e => currentTypeFilters.includes(e.type));\r\n  }\r\n\r\n  // Apply search filter\r\n  if (currentSearch) {\r\n    filtered = filtered.filter(e => {\r\n      const title = (e.title || '').toLowerCase();\r\n      const content = (e.content || e.description || '').toLowerCase();\r\n      const owner = (e.owner || e.user || e.actor || '').toLowerCase();\r\n      return title.includes(currentSearch) || content.includes(currentSearch) || owner.includes(currentSearch);\r\n    });\r\n  }\r\n\r\n  const content = panel.querySelector('#timeline-content') as HTMLElement;\r\n\r\n  if (filtered.length === 0) {\r\n    content.innerHTML = renderEmptyState();\r\n    return;\r\n  }\r\n\r\n  // Group by date\r\n  const grouped = groupByDate(filtered);\r\n  const today = new Date().toISOString().split('T')[0];\r\n\r\n  content.innerHTML = `\r\n    <div class=\"timeline-list density-${currentDensity}\">\r\n      ${Object.entries(grouped).map(([date, events]) => `\r\n        <div class=\"timeline-day\" data-date=\"${date}\">\r\n          <div class=\"timeline-date-header sticky\">\r\n            <span class=\"date-label\">${formatDateLabel(date)}</span>\r\n            <span class=\"event-count\">${events.length} event${events.length === 1 ? '' : 's'}</span>\r\n          </div>\r\n          ${date === today ? '<div class=\"today-marker\"><span>Today</span></div>' : ''}\r\n          <div class=\"timeline-day-events\">\r\n            ${events.map((event, idx) => renderEventCard(event, idx)).join('')}\r\n          </div>\r\n        </div>\r\n      `).join('')}\r\n    </div>\r\n  `;\r\n\r\n  bindEventCardClicks(panel, filtered, props);\r\n  focusedEventIndex = -1;\r\n}\r\n\r\nfunction renderEventCard(event: TimelineEvent, index: number): string {\r\n  const config = EVENT_TYPES[event.type] || { label: event.type, icon: 'üìé', color: '#888' };\r\n  const icon = event.icon || config.icon;\r\n  const color = event.color || config.color;\r\n  const owner = event.owner || event.user || event.actor;\r\n  const initials = owner ? getInitials(owner) : '';\r\n  const statusBadge = event.status ? `<span class=\"status-badge status-${event.status}\">${event.status}</span>` : '';\r\n  const time = event.date ? formatTime(event.date) : '';\r\n  const relativeTime = event.date ? formatRelativeTime(event.date) : '';\r\n  const fullDateTime = event.date ? formatDateTime(event.date) : '';\r\n\r\n  return `\r\n    <div class=\"timeline-event\" data-id=\"${event.id}\" data-index=\"${index}\" tabindex=\"0\">\r\n      <div class=\"event-avatar\" style=\"--event-color: ${color}\">\r\n        ${initials || icon}\r\n      </div>\r\n      <div class=\"event-body\">\r\n        <div class=\"event-header\">\r\n          <span class=\"event-type-badge\" style=\"--event-color: ${color}\">\r\n            <span class=\"type-icon\">${icon}</span>\r\n            ${config.label}\r\n          </span>\r\n          ${statusBadge}\r\n          <span class=\"event-time\" title=\"${fullDateTime}\">${relativeTime}</span>\r\n        </div>\r\n        <div class=\"event-title\">${escapeHtml(event.title)}</div>\r\n        ${event.content || event.description ? `<div class=\"event-content\">${escapeHtml(truncate(event.content || event.description || '', 150))}</div>` : ''}\r\n        ${owner ? `<div class=\"event-owner\"><span class=\"owner-name\">by ${escapeHtml(owner)}</span></div>` : ''}\r\n      </div>\r\n      <div class=\"event-meta\">\r\n        <span class=\"meta-time\">${time}</span>\r\n      </div>\r\n    </div>\r\n  `;\r\n}\r\n\r\nfunction renderSkeletons(): string {\r\n  const skeletonCount = 8;\r\n  return `\r\n    <div class=\"timeline-skeletons\">\r\n      ${Array(skeletonCount).fill(0).map(() => `\r\n        <div class=\"skeleton-event\">\r\n          <div class=\"skeleton-avatar shimmer\"></div>\r\n          <div class=\"skeleton-body\">\r\n            <div class=\"skeleton-line short shimmer\"></div>\r\n            <div class=\"skeleton-line long shimmer\"></div>\r\n            <div class=\"skeleton-line medium shimmer\"></div>\r\n          </div>\r\n        </div>\r\n      `).join('')}\r\n    </div>\r\n  `;\r\n}\r\n\r\nfunction renderEmptyState(): string {\r\n  return `\r\n    <div class=\"timeline-empty\">\r\n      <div class=\"empty-illustration\">\r\n        <svg width=\"120\" height=\"120\" viewBox=\"0 0 120 120\" fill=\"none\">\r\n          <circle cx=\"60\" cy=\"60\" r=\"50\" fill=\"var(--bg-card)\" stroke=\"var(--border)\" stroke-width=\"2\"/>\r\n          <path d=\"M60 30V60L80 75\" stroke=\"var(--accent)\" stroke-width=\"4\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\r\n          <circle cx=\"60\" cy=\"60\" r=\"6\" fill=\"var(--accent)\"/>\r\n        </svg>\r\n      </div>\r\n      <h3>No events found</h3>\r\n      <p>Try adjusting your filters or date range</p>\r\n      <div class=\"empty-actions\">\r\n        <button class=\"btn btn-primary btn-sm\" id=\"empty-clear-filters\">Clear Filters</button>\r\n      </div>\r\n    </div>\r\n  `;\r\n}\r\n\r\nfunction renderError(): string {\r\n  return `\r\n    <div class=\"timeline-error\">\r\n      <div class=\"error-icon\">‚ö†Ô∏è</div>\r\n      <h3>Failed to load timeline</h3>\r\n      <p>Please try again later</p>\r\n      <button class=\"btn btn-primary btn-sm\" id=\"timeline-retry\">Retry</button>\r\n    </div>\r\n  `;\r\n}\r\n\r\n// ============================================\r\n// TYPE FILTERS\r\n// ============================================\r\n\r\nfunction updateTypeCounts(panel: HTMLElement, events: TimelineEvent[]): void {\r\n  const counts: Record<string, number> = {};\r\n  events.forEach(e => {\r\n    counts[e.type] = (counts[e.type] || 0) + 1;\r\n  });\r\n\r\n  const container = panel.querySelector('#timeline-type-filters') as HTMLElement;\r\n  const typesWithEvents = Object.keys(counts).filter(type => counts[type] > 0);\r\n\r\n  container.innerHTML = `\r\n    <button class=\"filter-chip ${currentTypeFilters.length === 0 ? 'active' : ''}\" data-type=\"\">All (${events.length})</button>\r\n    ${typesWithEvents.map(type => {\r\n    const config = EVENT_TYPES[type] || { label: type, icon: 'üìé', color: '#888' };\r\n    const isActive = currentTypeFilters.includes(type);\r\n    return `\r\n        <button class=\"filter-chip ${isActive ? 'active' : ''}\" data-type=\"${type}\" style=\"--chip-color: ${config.color}\">\r\n          ${config.icon} ${config.label} (${counts[type]})\r\n        </button>\r\n      `;\r\n  }).join('')}\r\n  `;\r\n\r\n  // Bind filter clicks\r\n  const chips = container.querySelectorAll('.filter-chip');\r\n  chips.forEach(chip => {\r\n    on(chip as HTMLElement, 'click', () => {\r\n      const type = chip.getAttribute('data-type') || '';\r\n      if (!type) {\r\n        currentTypeFilters = [];\r\n        chips.forEach(c => c.classList.remove('active'));\r\n        chip.classList.add('active');\r\n      } else {\r\n        const allChip = container.querySelector('[data-type=\"\"]');\r\n        allChip?.classList.remove('active');\r\n\r\n        if (currentTypeFilters.includes(type)) {\r\n          currentTypeFilters = currentTypeFilters.filter(t => t !== type);\r\n          chip.classList.remove('active');\r\n        } else {\r\n          currentTypeFilters.push(type);\r\n          chip.classList.add('active');\r\n        }\r\n\r\n        if (currentTypeFilters.length === 0) {\r\n          allChip?.classList.add('active');\r\n        }\r\n      }\r\n      renderFilteredEvents(panel, {});\r\n    });\r\n  });\r\n}\r\n\r\n// ============================================\r\n// NAVIGATION & INTERACTION\r\n// ============================================\r\n\r\nfunction bindEventCardClicks(panel: HTMLElement, events: TimelineEvent[], props: TimelinePanelProps): void {\r\n  const cards = panel.querySelectorAll('.timeline-event');\r\n  cards.forEach(card => {\r\n    on(card as HTMLElement, 'click', () => {\r\n      const id = card.getAttribute('data-id');\r\n      const event = events.find(e => String(e.id) === id);\r\n      if (event && props.onEventClick) {\r\n        props.onEventClick(event);\r\n      }\r\n    });\r\n  });\r\n\r\n  // Clear filters button in empty state\r\n  const clearBtn = panel.querySelector('#empty-clear-filters');\r\n  if (clearBtn) {\r\n    on(clearBtn as HTMLElement, 'click', () => {\r\n      currentTypeFilters = [];\r\n      currentSearch = '';\r\n      const searchInput = panel.querySelector('#timeline-search') as HTMLInputElement;\r\n      if (searchInput) searchInput.value = '';\r\n      updateTypeCounts(panel, allEvents);\r\n      renderFilteredEvents(panel, props);\r\n    });\r\n  }\r\n\r\n  // Retry button in error state\r\n  const retryBtn = panel.querySelector('#timeline-retry');\r\n  if (retryBtn) {\r\n    on(retryBtn as HTMLElement, 'click', () => loadTimeline(panel, props));\r\n  }\r\n}\r\n\r\nfunction navigateEvents(panel: HTMLElement, direction: number, props: TimelinePanelProps): void {\r\n  const cards = panel.querySelectorAll('.timeline-event');\r\n  if (cards.length === 0) return;\r\n\r\n  clearEventFocus(panel);\r\n  focusedEventIndex = Math.max(0, Math.min(cards.length - 1, focusedEventIndex + direction));\r\n\r\n  const targetCard = cards[focusedEventIndex] as HTMLElement;\r\n  if (targetCard) {\r\n    targetCard.classList.add('focused');\r\n    targetCard.scrollIntoView({ behavior: 'smooth', block: 'nearest' });\r\n    targetCard.focus();\r\n  }\r\n}\r\n\r\nfunction selectFocusedEvent(panel: HTMLElement, props: TimelinePanelProps): void {\r\n  const cards = panel.querySelectorAll('.timeline-event');\r\n  if (focusedEventIndex >= 0 && focusedEventIndex < cards.length) {\r\n    const card = cards[focusedEventIndex] as HTMLElement;\r\n    card.click();\r\n  }\r\n}\r\n\r\nfunction clearEventFocus(panel: HTMLElement): void {\r\n  panel.querySelectorAll('.timeline-event.focused').forEach(el => el.classList.remove('focused'));\r\n}\r\n\r\nfunction updateDensity(panel: HTMLElement): void {\r\n  const list = panel.querySelector('.timeline-list');\r\n  if (list) {\r\n    list.className = `timeline-list density-${currentDensity}`;\r\n  }\r\n}\r\n\r\nfunction updateCount(panel: HTMLElement, count: number): void {\r\n  const countEl = panel.querySelector('#timeline-count');\r\n  if (countEl) countEl.textContent = String(count);\r\n}\r\n\r\n// ============================================\r\n// EXPORT MENU\r\n// ============================================\r\n\r\nfunction showExportMenu(panel: HTMLElement): void {\r\n  const existing = panel.querySelector('.export-menu');\r\n  if (existing) {\r\n    existing.remove();\r\n    return;\r\n  }\r\n\r\n  const menu = createElement('div', { className: 'export-menu dropdown-menu' });\r\n  menu.innerHTML = `\r\n    <button class=\"dropdown-item\" data-format=\"csv\">üìä Export CSV</button>\r\n    <button class=\"dropdown-item\" data-format=\"json\">üì¶ Export JSON</button>\r\n  `;\r\n\r\n  const exportBtn = panel.querySelector('.timeline-export-btn');\r\n  if (exportBtn) {\r\n    exportBtn.appendChild(menu);\r\n  }\r\n\r\n  menu.querySelectorAll('.dropdown-item').forEach(item => {\r\n    on(item as HTMLElement, 'click', () => {\r\n      const format = item.getAttribute('data-format');\r\n      exportTimeline(format || 'csv');\r\n      menu.remove();\r\n    });\r\n  });\r\n\r\n  // Close on outside click\r\n  setTimeout(() => {\r\n    const closeHandler = (e: Event) => {\r\n      if (!menu.contains(e.target as Node)) {\r\n        menu.remove();\r\n        document.removeEventListener('click', closeHandler);\r\n      }\r\n    };\r\n    document.addEventListener('click', closeHandler);\r\n  }, 0);\r\n}\r\n\r\nfunction exportTimeline(format: string): void {\r\n  const data = allEvents.map(e => ({\r\n    date: e.date,\r\n    type: e.type,\r\n    title: e.title,\r\n    content: e.content || e.description,\r\n    owner: e.owner || e.user || e.actor,\r\n    status: e.status,\r\n  }));\r\n\r\n  let content: string;\r\n  let filename: string;\r\n  let mimeType: string;\r\n\r\n  if (format === 'csv') {\r\n    const headers = ['Date', 'Type', 'Title', 'Content', 'Owner', 'Status'];\r\n    const rows = data.map(d => [\r\n      d.date, d.type, `\"${(d.title || '').replace(/\"/g, '\"\"')}\"`,\r\n      `\"${(d.content || '').replace(/\"/g, '\"\"')}\"`,\r\n      `\"${(d.owner || '').replace(/\"/g, '\"\"')}\"`, d.status || ''\r\n    ].join(','));\r\n    content = [headers.join(','), ...rows].join('\\n');\r\n    filename = `timeline-${new Date().toISOString().split('T')[0]}.csv`;\r\n    mimeType = 'text/csv';\r\n  } else {\r\n    content = JSON.stringify(data, null, 2);\r\n    filename = `timeline-${new Date().toISOString().split('T')[0]}.json`;\r\n    mimeType = 'application/json';\r\n  }\r\n\r\n  const blob = new Blob([content], { type: mimeType });\r\n  const url = URL.createObjectURL(blob);\r\n  const a = document.createElement('a');\r\n  a.href = url;\r\n  a.download = filename;\r\n  a.click();\r\n  URL.revokeObjectURL(url);\r\n}\r\n\r\n// ============================================\r\n// UTILITIES\r\n// ============================================\r\n\r\nfunction groupByDate(events: TimelineEvent[]): Record<string, TimelineEvent[]> {\r\n  const grouped: Record<string, TimelineEvent[]> = {};\r\n\r\n  events.forEach(event => {\r\n    const date = event.date ? event.date.split('T')[0] : 'unknown';\r\n    if (!grouped[date]) grouped[date] = [];\r\n    grouped[date].push(event);\r\n  });\r\n\r\n  // Sort by date descending\r\n  return Object.fromEntries(\r\n    Object.entries(grouped).sort(([a], [b]) => b.localeCompare(a))\r\n  );\r\n}\r\n\r\nfunction formatDateLabel(dateStr: string): string {\r\n  const date = new Date(dateStr + 'T00:00:00');\r\n  const today = new Date();\r\n  const yesterday = new Date(today);\r\n  yesterday.setDate(yesterday.getDate() - 1);\r\n  const thisWeekStart = new Date(today);\r\n  thisWeekStart.setDate(today.getDate() - today.getDay());\r\n\r\n  const todayStr = today.toISOString().split('T')[0];\r\n  const yesterdayStr = yesterday.toISOString().split('T')[0];\r\n\r\n  if (dateStr === todayStr) return 'Today';\r\n  if (dateStr === yesterdayStr) return 'Yesterday';\r\n  if (date >= thisWeekStart) return 'This week - ' + formatDate(date, { weekday: 'long' });\r\n\r\n  return formatDate(date, { weekday: 'short', month: 'short', day: 'numeric' });\r\n}\r\n\r\nfunction formatTime(dateStr: string): string {\r\n  const date = new Date(dateStr);\r\n  return date.toLocaleTimeString(undefined, { hour: '2-digit', minute: '2-digit' });\r\n}\r\n\r\nfunction getInitials(name: string): string {\r\n  return name\r\n    .split(/\\s+/)\r\n    .map(part => part.charAt(0).toUpperCase())\r\n    .slice(0, 2)\r\n    .join('');\r\n}\r\n\r\nfunction truncate(text: string, maxLength: number): string {\r\n  if (text.length <= maxLength) return text;\r\n  return text.slice(0, maxLength - 3) + '...';\r\n}\r\n\r\nfunction escapeHtml(text: string): string {\r\n  const div = document.createElement('div');\r\n  div.textContent = text;\r\n  return div.innerHTML;\r\n}\r\n\r\nexport default createTimelinePanel;\r\n"],"names":["EVENT_TYPES","DAY_PERIODS","currentDays","currentDensity","currentTypeFilters","currentSearch","allEvents","focusedEventIndex","createTimelinePanel","props","panel","createElement","p","renderSkeletons","bindEvents","loadTimeline","periodSelect","on","densityBtns","btn","b","updateDensity","searchInput","searchTimeout","renderFilteredEvents","exportBtn","showExportMenu","e","navigateEvents","selectFocusedEvent","clearEventFocus","content","endDate","startDate","getTimeline","updateTypeCounts","updateCount","error","renderError","filtered","title","owner","renderEmptyState","grouped","groupByDate","today","date","events","formatDateLabel","event","idx","renderEventCard","bindEventCardClicks","index","config","icon","color","initials","getInitials","statusBadge","time","formatTime","relativeTime","formatRelativeTime","fullDateTime","formatDateTime","escapeHtml","truncate","counts","container","typesWithEvents","type","chips","chip","c","allChip","t","card","id","clearBtn","retryBtn","direction","cards","targetCard","el","list","count","countEl","existing","menu","item","format","exportTimeline","closeHandler","data","filename","mimeType","headers","rows","d","blob","url","a","dateStr","yesterday","thisWeekStart","todayStr","yesterdayStr","formatDate","name","part","text","maxLength","div"],"mappings":"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"}
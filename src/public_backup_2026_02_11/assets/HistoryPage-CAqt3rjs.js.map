{"version":3,"file":"HistoryPage-CAqt3rjs.js","sources":["../../frontend/src/pages/HistoryPage.ts"],"sourcesContent":["/**\r\n * History Panel Component\r\n * Display processing history timeline\r\n */\r\n\r\nimport { createElement, on } from '@lib/dom';\r\nimport { http, fetchWithProject } from '@services/api';\r\nimport { formatRelativeTime, formatDate } from '@lib/format';\r\nimport { toast } from '@services/toast';\r\n\r\nexport interface HistoryEntry {\r\n  id: string;\r\n  action: 'create' | 'update' | 'delete' | 'restore' | 'process' | 'upload';\r\n  entityType: string;\r\n  entityId: string;\r\n  entityName?: string;\r\n  changes?: Record<string, { old: unknown; new: unknown }>;\r\n  actor: {\r\n    id: string;\r\n    name: string;\r\n    email?: string;\r\n  };\r\n  timestamp: string;\r\n  metadata?: Record<string, unknown>;\r\n}\r\n\r\nexport interface HistoryPanelProps {\r\n  onRestore?: (entry: HistoryEntry) => void;\r\n  onExport?: () => void;\r\n}\r\n\r\nlet entries: HistoryEntry[] = [];\r\nlet page = 1;\r\nlet hasMore = true;\r\nlet loading = false;\r\nlet currentFilters = {\r\n  action: '' as string,\r\n  entityType: '' as string,\r\n  dateFrom: '' as string,\r\n  dateTo: '' as string,\r\n};\r\n\r\n/**\r\n * Create history panel\r\n */\r\nexport function createHistoryPanel(props: HistoryPanelProps = {}): HTMLElement {\r\n  const panel = createElement('div', { className: 'history-panel' });\r\n\r\n  panel.innerHTML = `\r\n    <div class=\"history-filters\">\r\n      <select id=\"history-action-filter\" class=\"filter-select\">\r\n        <option value=\"\">All Actions</option>\r\n        <option value=\"create\">Created</option>\r\n        <option value=\"update\">Updated</option>\r\n        <option value=\"delete\">Deleted</option>\r\n        <option value=\"restore\">Restored</option>\r\n        <option value=\"process\">Processed</option>\r\n        <option value=\"upload\">Uploaded</option>\r\n      </select>\r\n      <select id=\"history-entity-filter\" class=\"filter-select\">\r\n        <option value=\"\">All Types</option>\r\n        <option value=\"document\">Documents</option>\r\n        <option value=\"fact\">Facts</option>\r\n        <option value=\"question\">Questions</option>\r\n        <option value=\"risk\">Risks</option>\r\n        <option value=\"action\">Actions</option>\r\n        <option value=\"decision\">Decisions</option>\r\n        <option value=\"contact\">Contacts</option>\r\n        <option value=\"email\">Emails</option>\r\n      </select>\r\n      <input type=\"date\" id=\"history-date-from\" class=\"filter-date\" placeholder=\"From\">\r\n      <input type=\"date\" id=\"history-date-to\" class=\"filter-date\" placeholder=\"To\">\r\n      <button class=\"btn btn-sm\" id=\"history-clear-filters\">Clear</button>\r\n    </div>\r\n    <div class=\"history-content\" id=\"history-content\">\r\n      <div class=\"loading\">Loading history...</div>\r\n    </div>\r\n  `;\r\n\r\n  // Bind filter events\r\n  bindFilters(panel, props);\r\n\r\n  // Initial load\r\n  loadHistory(panel, props);\r\n\r\n  return panel;\r\n}\r\n\r\n/**\r\n * Bind filter event handlers\r\n */\r\nfunction bindFilters(panel: HTMLElement, props: HistoryPanelProps): void {\r\n  const actionFilter = panel.querySelector('#history-action-filter') as HTMLSelectElement;\r\n  const entityFilter = panel.querySelector('#history-entity-filter') as HTMLSelectElement;\r\n  const dateFromInput = panel.querySelector('#history-date-from') as HTMLInputElement;\r\n  const dateToInput = panel.querySelector('#history-date-to') as HTMLInputElement;\r\n  const clearBtn = panel.querySelector('#history-clear-filters') as HTMLButtonElement;\r\n\r\n  const applyFilters = () => {\r\n    currentFilters = {\r\n      action: actionFilter.value,\r\n      entityType: entityFilter.value,\r\n      dateFrom: dateFromInput.value,\r\n      dateTo: dateToInput.value,\r\n    };\r\n    entries = [];\r\n    page = 1;\r\n    hasMore = true;\r\n    loadHistory(panel, props);\r\n  };\r\n\r\n  on(actionFilter, 'change', applyFilters);\r\n  on(entityFilter, 'change', applyFilters);\r\n  on(dateFromInput, 'change', applyFilters);\r\n  on(dateToInput, 'change', applyFilters);\r\n\r\n  on(clearBtn, 'click', () => {\r\n    actionFilter.value = '';\r\n    entityFilter.value = '';\r\n    dateFromInput.value = '';\r\n    dateToInput.value = '';\r\n    applyFilters();\r\n  });\r\n}\r\n\r\n/**\r\n * Load history entries\r\n */\r\nasync function loadHistory(panel: HTMLElement, props: HistoryPanelProps): Promise<void> {\r\n  if (loading) return;\r\n\r\n  const content = panel.querySelector('#history-content') as HTMLElement;\r\n\r\n  if (page === 1) {\r\n    content.innerHTML = '<div class=\"loading\">Loading history...</div>';\r\n  }\r\n\r\n  loading = true;\r\n\r\n  try {\r\n    const params = new URLSearchParams({ page: String(page), limit: '30' });\r\n    if (currentFilters.action) params.set('action', currentFilters.action);\r\n    if (currentFilters.entityType) params.set('entityType', currentFilters.entityType);\r\n    if (currentFilters.dateFrom) params.set('dateFrom', currentFilters.dateFrom);\r\n    if (currentFilters.dateTo) params.set('dateTo', currentFilters.dateTo);\r\n\r\n    const response = await http.get<{ entries: HistoryEntry[]; hasMore: boolean }>(\r\n      `/api/history?${params}`\r\n    );\r\n\r\n    entries = page === 1 ? response.data.entries : [...entries, ...response.data.entries];\r\n    hasMore = response.data.hasMore;\r\n    page++;\r\n\r\n    renderHistory(content, props);\r\n  } catch {\r\n    if (page === 1) {\r\n      content.innerHTML = '<div class=\"error\">Failed to load history</div>';\r\n    }\r\n  } finally {\r\n    loading = false;\r\n  }\r\n}\r\n\r\n/**\r\n * Render history timeline\r\n */\r\nfunction renderHistory(container: HTMLElement, props: HistoryPanelProps): void {\r\n  if (entries.length === 0) {\r\n    container.innerHTML = `\r\n      <div class=\"empty-state\">\r\n        <span class=\"empty-icon\">üìú</span>\r\n        <p>No history entries found</p>\r\n        <span class=\"empty-hint\">Processing and editing activity will appear here</span>\r\n      </div>\r\n    `;\r\n    return;\r\n  }\r\n\r\n  // Group by date\r\n  const grouped = groupByDate(entries);\r\n\r\n  container.innerHTML = `\r\n    <div class=\"history-timeline\">\r\n      ${Object.entries(grouped).map(([date, items]) => `\r\n        <div class=\"history-date-group\">\r\n          <div class=\"history-date-header\">${date}</div>\r\n          <div class=\"history-items\">\r\n            ${items.map(entry => renderEntry(entry, props)).join('')}\r\n          </div>\r\n        </div>\r\n      `).join('')}\r\n    </div>\r\n    ${hasMore ? `\r\n      <div class=\"history-load-more\">\r\n        <button class=\"btn btn-secondary\" id=\"load-more-history\">Load More</button>\r\n      </div>\r\n    ` : `\r\n      <div class=\"history-end\">\r\n        <span>End of history</span>\r\n      </div>\r\n    `}\r\n  `;\r\n\r\n  // Bind load more\r\n  const loadMoreBtn = container.querySelector('#load-more-history');\r\n  if (loadMoreBtn) {\r\n    on(loadMoreBtn as HTMLElement, 'click', async () => {\r\n      const panel = container.closest('.history-panel') as HTMLElement;\r\n      await loadHistory(panel, props);\r\n    });\r\n  }\r\n\r\n  // Bind expand buttons\r\n  container.querySelectorAll('[data-action=\"expand\"]').forEach(btn => {\r\n    on(btn as HTMLElement, 'click', () => {\r\n      const changesEl = btn.closest('.history-entry')?.querySelector('.history-changes');\r\n      if (changesEl) {\r\n        changesEl.classList.toggle('expanded');\r\n        btn.textContent = changesEl.classList.contains('expanded') ? 'Hide details' : 'Show details';\r\n      }\r\n    });\r\n  });\r\n\r\n  // Bind restore buttons\r\n  if (props.onRestore) {\r\n    container.querySelectorAll('[data-action=\"restore\"]').forEach(btn => {\r\n      on(btn as HTMLElement, 'click', () => {\r\n        const entryId = btn.getAttribute('data-entry-id');\r\n        const entry = entries.find(e => e.id === entryId);\r\n        if (entry && props.onRestore) {\r\n          props.onRestore(entry);\r\n        }\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * Render single entry\r\n */\r\nfunction renderEntry(entry: HistoryEntry, props: HistoryPanelProps): string {\r\n  const actionIcons: Record<string, string> = {\r\n    create: '‚ûï',\r\n    update: '‚úèÔ∏è',\r\n    delete: 'üóëÔ∏è',\r\n    restore: '‚Ü©Ô∏è',\r\n    process: '‚öôÔ∏è',\r\n    upload: 'üì§',\r\n  };\r\n\r\n  const actionColors: Record<string, string> = {\r\n    create: 'success',\r\n    update: 'info',\r\n    delete: 'danger',\r\n    restore: 'warning',\r\n    process: 'info',\r\n    upload: 'success',\r\n  };\r\n\r\n  const hasChanges = entry.changes && Object.keys(entry.changes).length > 0;\r\n\r\n  return `\r\n    <div class=\"history-entry ${actionColors[entry.action] || 'info'}\" data-entry-id=\"${entry.id}\">\r\n      <div class=\"history-icon\">${actionIcons[entry.action] || 'üìù'}</div>\r\n      <div class=\"history-content\">\r\n        <div class=\"history-summary\">\r\n          <strong>${escapeHtml(entry.actor.name)}</strong>\r\n          ${getActionVerb(entry.action)}\r\n          <span class=\"entity-type\">${entry.entityType}</span>\r\n          ${entry.entityName ? `\"${escapeHtml(entry.entityName)}\"` : ''}\r\n        </div>\r\n        <div class=\"history-time\">${formatRelativeTime(entry.timestamp)}</div>\r\n        \r\n        ${hasChanges ? `\r\n          <div class=\"history-changes\">\r\n            ${Object.entries(entry.changes!).slice(0, 5).map(([field, change]) => `\r\n              <div class=\"change-item\">\r\n                <span class=\"change-field\">${formatFieldName(field)}:</span>\r\n                <span class=\"change-old\">${formatValue(change.old)}</span>\r\n                <span class=\"change-arrow\">‚Üí</span>\r\n                <span class=\"change-new\">${formatValue(change.new)}</span>\r\n              </div>\r\n            `).join('')}\r\n            ${Object.keys(entry.changes!).length > 5 ? `<div class=\"change-more\">+${Object.keys(entry.changes!).length - 5} more changes</div>` : ''}\r\n          </div>\r\n          <button class=\"btn-link\" data-action=\"expand\">Show details</button>\r\n        ` : ''}\r\n        \r\n        ${entry.action === 'delete' && props.onRestore ? `\r\n          <button class=\"btn btn-sm btn-secondary\" data-action=\"restore\" data-entry-id=\"${entry.id}\">\r\n            Restore\r\n          </button>\r\n        ` : ''}\r\n      </div>\r\n    </div>\r\n  `;\r\n}\r\n\r\n/**\r\n * Get action verb\r\n */\r\nfunction getActionVerb(action: string): string {\r\n  const verbs: Record<string, string> = {\r\n    create: 'created',\r\n    update: 'updated',\r\n    delete: 'deleted',\r\n    restore: 'restored',\r\n    process: 'processed',\r\n    upload: 'uploaded',\r\n  };\r\n  return verbs[action] || action;\r\n}\r\n\r\n/**\r\n * Group entries by date\r\n */\r\nfunction groupByDate(items: HistoryEntry[]): Record<string, HistoryEntry[]> {\r\n  const groups: Record<string, HistoryEntry[]> = {};\r\n  const today = new Date().toDateString();\r\n  const yesterday = new Date(Date.now() - 86400000).toDateString();\r\n\r\n  items.forEach(item => {\r\n    const itemDate = new Date(item.timestamp);\r\n    let dateLabel: string;\r\n\r\n    if (itemDate.toDateString() === today) {\r\n      dateLabel = 'Today';\r\n    } else if (itemDate.toDateString() === yesterday) {\r\n      dateLabel = 'Yesterday';\r\n    } else {\r\n      dateLabel = itemDate.toLocaleDateString(undefined, {\r\n        weekday: 'long',\r\n        month: 'long',\r\n        day: 'numeric'\r\n      });\r\n    }\r\n\r\n    if (!groups[dateLabel]) {\r\n      groups[dateLabel] = [];\r\n    }\r\n    groups[dateLabel].push(item);\r\n  });\r\n\r\n  return groups;\r\n}\r\n\r\n/**\r\n * Format field name\r\n */\r\nfunction formatFieldName(field: string): string {\r\n  return field\r\n    .replace(/_/g, ' ')\r\n    .replace(/([A-Z])/g, ' $1')\r\n    .replace(/^./, str => str.toUpperCase());\r\n}\r\n\r\n/**\r\n * Format value for display\r\n */\r\nfunction formatValue(value: unknown): string {\r\n  if (value === null || value === undefined) return '(empty)';\r\n  if (typeof value === 'boolean') return value ? 'Yes' : 'No';\r\n  if (typeof value === 'object') {\r\n    const str = JSON.stringify(value);\r\n    return str.length > 50 ? str.substring(0, 47) + '...' : str;\r\n  }\r\n  const str = String(value);\r\n  return str.length > 50 ? str.substring(0, 47) + '...' : str;\r\n}\r\n\r\n/**\r\n * Escape HTML\r\n */\r\nfunction escapeHtml(text: string): string {\r\n  const div = document.createElement('div');\r\n  div.textContent = text;\r\n  return div.innerHTML;\r\n}\r\n\r\n/**\r\n * Export history\r\n */\r\nexport async function exportHistory(format: 'json' | 'csv' = 'json'): Promise<void> {\r\n  try {\r\n    const params = new URLSearchParams({ format, limit: '1000' });\r\n    if (currentFilters.action) params.set('action', currentFilters.action);\r\n    if (currentFilters.entityType) params.set('entityType', currentFilters.entityType);\r\n    if (currentFilters.dateFrom) params.set('dateFrom', currentFilters.dateFrom);\r\n    if (currentFilters.dateTo) params.set('dateTo', currentFilters.dateTo);\r\n\r\n    const response = await fetchWithProject(`/api/history/export?${params}`);\r\n    const blob = await response.blob();\r\n\r\n    const url = URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = `history-export.${format}`;\r\n    document.body.appendChild(a);\r\n    a.click();\r\n    document.body.removeChild(a);\r\n    URL.revokeObjectURL(url);\r\n\r\n    toast.success('History exported successfully');\r\n  } catch {\r\n    toast.error('Failed to export history');\r\n  }\r\n}\r\n\r\nexport default createHistoryPanel;\r\n"],"names":["entries","page","hasMore","loading","currentFilters","createHistoryPanel","props","panel","createElement","bindFilters","loadHistory","actionFilter","entityFilter","dateFromInput","dateToInput","clearBtn","applyFilters","on","content","params","response","http","renderHistory","container","grouped","groupByDate","date","items","entry","renderEntry","loadMoreBtn","btn","changesEl","entryId","e","actionIcons","actionColors","hasChanges","escapeHtml","getActionVerb","formatRelativeTime","field","change","formatFieldName","formatValue","action","groups","today","yesterday","item","itemDate","dateLabel","str","value","text","div","exportHistory","format","blob","fetchWithProject","url","a","toast"],"mappings":"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"}
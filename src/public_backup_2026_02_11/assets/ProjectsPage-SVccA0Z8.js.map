{"version":3,"file":"ProjectsPage-SVccA0Z8.js","sources":["../../frontend/src/pages/ProjectsPage.ts"],"sourcesContent":["/**\r\n * Projects full-page view: list of projects + inline create/edit form (no modal).\r\n * Mounted when user opens the Projects tab.\r\n */\r\n\r\nimport { projects } from '@services';\r\nimport { showProjectModal, type ProjectData } from '@components/modals/ProjectModal';\r\nimport { appStore } from '@stores/app';\r\n\r\nexport interface ProjectsPageOptions {\r\n  onBack?: () => void;\r\n}\r\n\r\n/**\r\n * Mount projects list and inline form into the given container.\r\n */\r\nexport function initProjectsPage(container: HTMLElement, options: ProjectsPageOptions = {}): void {\r\n  container.innerHTML = '';\r\n  const listEl = document.createElement('div');\r\n  listEl.className = 'projects-page-list';\r\n  const formContainer = document.createElement('div');\r\n  formContainer.className = 'projects-page-form-container hidden';\r\n  formContainer.setAttribute('aria-hidden', 'true');\r\n\r\n  function showList(): void {\r\n    formContainer.classList.add('hidden');\r\n    formContainer.setAttribute('aria-hidden', 'true');\r\n    formContainer.innerHTML = '';\r\n    listEl.classList.remove('hidden');\r\n    listEl.removeAttribute('aria-hidden');\r\n    renderList();\r\n  }\r\n\r\n  function showForm(mode: 'create' | 'edit', project?: ProjectData): void {\r\n    listEl.classList.add('hidden');\r\n    listEl.setAttribute('aria-hidden', 'true');\r\n    formContainer.classList.remove('hidden');\r\n    formContainer.setAttribute('aria-hidden', 'false');\r\n    showProjectModal({\r\n      mode,\r\n      project,\r\n      inlineContainer: formContainer,\r\n      onCancel: showList,\r\n      onSave: () => {\r\n        renderList();\r\n        showList();\r\n        window.dispatchEvent(new CustomEvent('godmode:projects-changed'));\r\n      },\r\n      onDelete: () => {\r\n        renderList();\r\n        showList();\r\n        window.dispatchEvent(new CustomEvent('godmode:projects-changed'));\r\n      },\r\n    });\r\n  }\r\n\r\n  function renderList(): void {\r\n    projects.getAll().then((projectList) => {\r\n      const currentId = appStore.getState().currentProjectId;\r\n      listEl.innerHTML = `\r\n        <div class=\"tab-header\" style=\"margin-bottom: 1.5rem;\">\r\n          <h1>Projects</h1>\r\n          <div class=\"tab-actions\">\r\n            <button type=\"button\" class=\"btn btn-primary\" id=\"projects-new-btn\">\r\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\"/><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"/></svg>\r\n              New Project\r\n            </button>\r\n            ${options.onBack ? `<button type=\"button\" class=\"btn btn-secondary\" id=\"projects-back-btn\">Back to Dashboard</button>` : ''}\r\n          </div>\r\n        </div>\r\n        <div class=\"projects-list\" role=\"list\">\r\n          ${projectList.length === 0\r\n          ? '<div class=\"gm-empty-state gm-p-6\"><p class=\"gm-empty-state-desc\">No projects yet. Create one to get started.</p></div>'\r\n          : projectList\r\n            .map(\r\n              (p) => `\r\n            <div class=\"project-list-item card\" data-project-id=\"${p.id}\" role=\"listitem\">\r\n              <div class=\"project-list-item-main\">\r\n                <div class=\"project-list-item-info\">\r\n                  <h3 class=\"project-list-item-name\">${escapeHtml(p.name)}${p.isDefault ? ' <span class=\"project-badge-default\">default</span>' : ''}</h3>\r\n                  <p class=\"project-list-item-meta\">${p.id}</p>\r\n                </div>\r\n                <div class=\"project-list-item-actions\">\r\n                  ${currentId === p.id ? '<span class=\"project-current-badge\">Current</span>' : ''}\r\n                  <button type=\"button\" class=\"btn btn-secondary btn-sm project-edit-btn\" data-project-id=\"${p.id}\" aria-label=\"Edit project\">Edit</button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          `\r\n            )\r\n            .join('')}\r\n        </div>\r\n      `;\r\n\r\n      const newBtn = listEl.querySelector('#projects-new-btn');\r\n      if (newBtn) {\r\n        newBtn.addEventListener('click', () => showForm('create'));\r\n      }\r\n      const backBtn = listEl.querySelector('#projects-back-btn');\r\n      if (backBtn && options.onBack) {\r\n        backBtn.addEventListener('click', options.onBack);\r\n      }\r\n      listEl.querySelectorAll('.project-edit-btn').forEach((btn) => {\r\n        btn.addEventListener('click', () => {\r\n          const id = (btn as HTMLElement).dataset.projectId;\r\n          const project = projectList.find((p) => p.id === id);\r\n          if (project) {\r\n            showForm('edit', { id: project.id, name: project.name } as ProjectData);\r\n          }\r\n        });\r\n      });\r\n    });\r\n  }\r\n\r\n  container.appendChild(listEl);\r\n  container.appendChild(formContainer);\r\n\r\n  const win = window as unknown as { __godmodeProjectsOpen?: string };\r\n  const openAction = win.__godmodeProjectsOpen;\r\n  if (openAction) {\r\n    delete win.__godmodeProjectsOpen;\r\n    if (openAction === 'create') {\r\n      showForm('create');\r\n      return;\r\n    }\r\n    if (openAction.startsWith('edit:')) {\r\n      const id = openAction.slice(5);\r\n      projects.getAll().then((projectList) => {\r\n        const project = projectList.find((p) => p.id === id);\r\n        if (project) showForm('edit', { id: project.id, name: project.name } as ProjectData);\r\n        else renderList();\r\n      });\r\n      return;\r\n    }\r\n  }\r\n\r\n  renderList();\r\n}\r\n\r\nfunction escapeHtml(text: string): string {\r\n  const div = document.createElement('div');\r\n  div.textContent = text;\r\n  return div.innerHTML;\r\n}\r\n"],"names":["initProjectsPage","container","options","listEl","formContainer","showList","renderList","showForm","mode","project","showProjectModal","projects","projectList","currentId","appStore","p","escapeHtml","newBtn","backBtn","btn","id","win","openAction","text","div"],"mappings":"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"}
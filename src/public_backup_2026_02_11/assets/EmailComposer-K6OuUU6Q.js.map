{"version":3,"file":"EmailComposer-K6OuUU6Q.js","sources":["../../frontend/src/components/EmailComposer.ts"],"sourcesContent":["/**\n * Email Composer Component - SOTA UI\n * Multi-mode email input: paste, upload .eml/.msg, manual entry\n */\n\nimport { createElement, on } from '@lib/dom';\nimport { http } from '@services/api';\nimport { toast } from '@services/toast';\nimport { getSprints } from '@services/sprints';\nimport { getActions } from '@services/actions';\n\nexport interface EmailComposerProps {\n  onSave?: (email: unknown) => void;\n  onClose?: () => void;\n}\n\ntype InputMode = 'paste' | 'upload' | 'manual';\nlet currentMode: InputMode = 'paste';\nlet composerContainer: HTMLElement | null = null;\n\n/**\n * Show email composer\n */\nexport function showEmailComposer(props: EmailComposerProps = {}): void {\n  const existing = document.getElementById('email-composer-overlay');\n  if (existing) existing.remove();\n\n  const overlay = createElement('div', {\n    id: 'email-composer-overlay',\n    className: 'composer-overlay'\n  });\n\n  const dialog = createEmailComposer(props);\n  overlay.appendChild(dialog);\n  document.body.appendChild(overlay);\n\n  on(overlay, 'click', (e) => {\n    if (e.target === overlay) {\n      closeEmailComposer();\n      props.onClose?.();\n    }\n  });\n\n  requestAnimationFrame(() => overlay.classList.add('visible'));\n  composerContainer = dialog;\n}\n\n/**\n * Close email composer\n */\nexport function closeEmailComposer(): void {\n  const overlay = document.getElementById('email-composer-overlay');\n  if (overlay) {\n    overlay.classList.remove('visible');\n    setTimeout(() => overlay.remove(), 200);\n  }\n  composerContainer = null;\n}\n\n/**\n * Create email composer\n */\nexport function createEmailComposer(props: EmailComposerProps = {}): HTMLElement {\n  const container = createElement('div', { className: 'composer-modal' });\n\n  container.innerHTML = `\n    <style>\n      .composer-overlay {\n        position: fixed;\n        inset: 0;\n        background: rgba(0, 0, 0, 0.5);\n        backdrop-filter: blur(8px);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        z-index: 10000;\n        opacity: 0;\n        transition: opacity 0.2s ease;\n      }\n      .composer-overlay.visible { opacity: 1; }\n      .composer-overlay.visible .composer-modal {\n        transform: translateY(0) scale(1);\n        opacity: 1;\n      }\n      .composer-modal {\n        width: 640px;\n        max-width: 95vw;\n        max-height: 85vh;\n        background: var(--bg-primary);\n        border-radius: 16px;\n        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);\n        display: flex;\n        flex-direction: column;\n        overflow: hidden;\n        transform: translateY(20px) scale(0.98);\n        opacity: 0;\n        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n      }\n      \n      .composer-header {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        padding: 20px 24px;\n        border-bottom: 1px solid var(--border-color);\n      }\n      .composer-header h2 {\n        margin: 0;\n        font-size: 18px;\n        font-weight: 600;\n        color: var(--text-primary);\n      }\n      .composer-close {\n        width: 32px;\n        height: 32px;\n        border: none;\n        background: var(--bg-secondary);\n        border-radius: 8px;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        color: var(--text-secondary);\n        transition: all 0.15s ease;\n      }\n      .composer-close:hover {\n        background: var(--bg-tertiary);\n        color: var(--text-primary);\n      }\n      \n      .composer-tabs {\n        display: flex;\n        padding: 0 24px;\n        border-bottom: 1px solid var(--border-color);\n        background: var(--bg-secondary);\n      }\n      .composer-tab {\n        padding: 14px 20px;\n        font-size: 14px;\n        font-weight: 500;\n        color: var(--text-secondary);\n        background: none;\n        border: none;\n        cursor: pointer;\n        position: relative;\n        transition: color 0.15s ease;\n      }\n      .composer-tab:hover { color: var(--text-primary); }\n      .composer-tab.active { color: var(--primary); }\n      .composer-tab.active::after {\n        content: '';\n        position: absolute;\n        bottom: 0;\n        left: 0;\n        right: 0;\n        height: 2px;\n        background: var(--primary);\n        border-radius: 2px 2px 0 0;\n      }\n      \n      .composer-body {\n        flex: 1;\n        padding: 24px;\n        overflow-y: auto;\n      }\n      \n      /* Paste Mode */\n      .paste-section label {\n        display: block;\n        font-size: 14px;\n        font-weight: 500;\n        color: var(--text-primary);\n        margin-bottom: 12px;\n      }\n      .paste-section textarea {\n        width: 100%;\n        min-height: 280px;\n        padding: 16px;\n        border: 1px solid var(--border-color);\n        border-radius: 12px;\n        background: var(--bg-secondary);\n        color: var(--text-primary);\n        font-family: 'SF Mono', Monaco, monospace;\n        font-size: 13px;\n        line-height: 1.6;\n        resize: vertical;\n        transition: border-color 0.15s ease, box-shadow 0.15s ease;\n      }\n      .paste-section textarea:focus {\n        outline: none;\n        border-color: var(--primary);\n        box-shadow: 0 0 0 3px rgba(var(--primary-rgb), 0.1);\n      }\n      .paste-section textarea::placeholder { color: var(--text-tertiary); }\n      .paste-hint {\n        margin-top: 12px;\n        font-size: 13px;\n        color: var(--text-tertiary);\n      }\n      \n      /* Upload Mode */\n      .upload-section .dropzone {\n        border: 2px dashed var(--border-color);\n        border-radius: 16px;\n        padding: 60px 40px;\n        text-align: center;\n        cursor: pointer;\n        transition: all 0.2s ease;\n        background: var(--bg-secondary);\n      }\n      .upload-section .dropzone:hover,\n      .upload-section .dropzone.dragover {\n        border-color: var(--primary);\n        background: rgba(var(--primary-rgb), 0.03);\n      }\n      .dropzone-icon { font-size: 48px; margin-bottom: 16px; }\n      .dropzone-title {\n        font-size: 16px;\n        font-weight: 500;\n        color: var(--text-primary);\n        margin-bottom: 8px;\n      }\n      .dropzone-hint { font-size: 13px; color: var(--text-tertiary); }\n      \n      .selected-file {\n        display: none;\n        align-items: center;\n        gap: 16px;\n        margin-top: 20px;\n        padding: 16px;\n        background: var(--bg-secondary);\n        border-radius: 12px;\n        border: 1px solid var(--border-color);\n      }\n      .selected-file.visible { display: flex; }\n      .file-icon {\n        width: 48px;\n        height: 48px;\n        background: linear-gradient(135deg, #3b82f6, #60a5fa);\n        border-radius: 12px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        font-size: 24px;\n      }\n      .file-info { flex: 1; min-width: 0; }\n      .file-name {\n        font-size: 14px;\n        font-weight: 500;\n        color: var(--text-primary);\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n      .file-size { font-size: 12px; color: var(--text-tertiary); margin-top: 2px; }\n      .file-remove {\n        width: 32px;\n        height: 32px;\n        border: none;\n        background: transparent;\n        border-radius: 8px;\n        cursor: pointer;\n        color: var(--text-tertiary);\n        font-size: 18px;\n        transition: all 0.15s ease;\n      }\n      .file-remove:hover {\n        background: rgba(239, 68, 68, 0.1);\n        color: #ef4444;\n      }\n      \n      /* Manual Mode */\n      .manual-form {\n        display: flex;\n        flex-direction: column;\n        gap: 20px;\n      }\n      .form-row {\n        display: flex;\n        gap: 16px;\n      }\n      .form-row > .form-group { flex: 1; }\n      .form-group label {\n        display: block;\n        font-size: 13px;\n        font-weight: 500;\n        color: var(--text-secondary);\n        margin-bottom: 8px;\n      }\n      .form-group label .required { color: var(--primary); }\n      .form-group input,\n      .form-group textarea {\n        width: 100%;\n        padding: 12px 14px;\n        border: 1px solid var(--border-color);\n        border-radius: 10px;\n        background: var(--bg-secondary);\n        color: var(--text-primary);\n        font-size: 14px;\n        transition: border-color 0.15s ease, box-shadow 0.15s ease;\n      }\n      .form-group input:focus,\n      .form-group textarea:focus {\n        outline: none;\n        border-color: var(--primary);\n        box-shadow: 0 0 0 3px rgba(var(--primary-rgb), 0.1);\n      }\n      .form-group textarea {\n        min-height: 120px;\n        resize: vertical;\n      }\n      .form-group input::placeholder,\n      .form-group textarea::placeholder { color: var(--text-tertiary); }\n      \n      .composer-footer {\n        display: flex;\n        justify-content: flex-end;\n        gap: 12px;\n        padding: 16px 24px;\n        border-top: 1px solid var(--border-color);\n        background: var(--bg-secondary);\n      }\n      .composer-footer .btn {\n        padding: 10px 20px;\n        border-radius: 10px;\n        font-size: 14px;\n        font-weight: 500;\n        cursor: pointer;\n        transition: all 0.15s ease;\n        border: none;\n      }\n      .composer-footer .btn-secondary {\n        background: var(--bg-primary);\n        color: var(--text-primary);\n        border: 1px solid var(--border-color);\n      }\n      .composer-footer .btn-secondary:hover { background: var(--bg-tertiary); }\n      .composer-footer .btn-primary {\n        background: var(--primary);\n        color: white;\n      }\n      .composer-footer .btn-primary:hover:not(:disabled) {\n        opacity: 0.9;\n        transform: translateY(-1px);\n      }\n      .composer-footer .btn-primary:disabled {\n        opacity: 0.5;\n        cursor: not-allowed;\n      }\n    </style>\n    \n    <div class=\"composer-header\">\n      <h2>Add Email</h2>\n      <button class=\"composer-close\" id=\"close-btn\">\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n          <path d=\"M18 6L6 18M6 6l12 12\"/>\n        </svg>\n      </button>\n    </div>\n    \n    <div class=\"composer-tabs\">\n      <button class=\"composer-tab active\" data-mode=\"paste\">Paste Text</button>\n      <button class=\"composer-tab\" data-mode=\"upload\">Upload .eml/.msg</button>\n      <button class=\"composer-tab\" data-mode=\"manual\">Manual Entry</button>\n    </div>\n    \n    <div class=\"composer-body\" id=\"composer-body\">\n      ${renderPasteMode()}\n    </div>\n    \n    <div class=\"composer-association\" style=\"padding: 12px 24px; border-top: 1px solid var(--border-color); display: flex; flex-wrap: wrap; gap: 12px; align-items: center;\">\n      <span style=\"font-size: 13px; font-weight: 500; color: var(--text-secondary);\">Associate with (optional)</span>\n      <select id=\"email-sprint-select\" class=\"form-select\" style=\"min-width: 140px;\"><option value=\"\">No sprint</option></select>\n      <select id=\"email-action-select\" class=\"form-select\" style=\"min-width: 180px;\"><option value=\"\">No task</option></select>\n    </div>\n    \n    <div class=\"composer-footer\">\n      <button class=\"btn btn-secondary\" id=\"cancel-btn\">Cancel</button>\n      <button class=\"btn btn-primary\" id=\"save-btn\" disabled>Add Email</button>\n    </div>\n  `;\n\n  // Bind tabs\n  container.querySelectorAll('.composer-tab').forEach(tab => {\n    on(tab as HTMLElement, 'click', () => {\n      container.querySelectorAll('.composer-tab').forEach(t => t.classList.remove('active'));\n      tab.classList.add('active');\n      currentMode = tab.getAttribute('data-mode') as InputMode;\n      renderMode(container);\n    });\n  });\n\n  on(container.querySelector('#close-btn') as HTMLElement, 'click', () => {\n    closeEmailComposer();\n    props.onClose?.();\n  });\n\n  on(container.querySelector('#cancel-btn') as HTMLElement, 'click', () => {\n    closeEmailComposer();\n    props.onClose?.();\n  });\n\n  on(container.querySelector('#save-btn') as HTMLElement, 'click', () => saveEmail(container, props));\n\n  bindPasteMode(container);\n  initEmailSprintTask(container);\n\n  return container;\n}\n\nasync function initEmailSprintTask(container: HTMLElement): Promise<void> {\n  const sprintSelect = container.querySelector('#email-sprint-select') as HTMLSelectElement;\n  const actionSelect = container.querySelector('#email-action-select') as HTMLSelectElement;\n  if (!sprintSelect || !actionSelect) return;\n  try {\n    const sprints = await getSprints();\n    sprints.forEach(s => {\n      const opt = document.createElement('option');\n      opt.value = s.id;\n      opt.textContent = s.name;\n      sprintSelect.appendChild(opt);\n    });\n    on(sprintSelect, 'change', async () => {\n      const sprintId = sprintSelect.value || '';\n      actionSelect.innerHTML = '<option value=\"\">No task</option>';\n      if (!sprintId) return;\n      try {\n        const actions = await getActions(undefined, sprintId);\n        actions.forEach(a => {\n          const opt = document.createElement('option');\n          opt.value = String(a.id);\n          opt.textContent = (a.content || a.task || String(a.id)).slice(0, 60) + ((a.content || a.task || '').length > 60 ? 'â€¦' : '');\n          actionSelect.appendChild(opt);\n        });\n      } catch {\n        // ignore\n      }\n    });\n  } catch {\n    // ignore\n  }\n}\n\nfunction renderMode(container: HTMLElement): void {\n  const body = container.querySelector('#composer-body') as HTMLElement;\n\n  switch (currentMode) {\n    case 'paste':\n      body.innerHTML = renderPasteMode();\n      bindPasteMode(container);\n      break;\n    case 'upload':\n      body.innerHTML = renderUploadMode();\n      bindUploadMode(container);\n      break;\n    case 'manual':\n      body.innerHTML = renderManualMode();\n      bindManualMode(container);\n      break;\n  }\n}\n\nfunction renderPasteMode(): string {\n  return `\n    <div class=\"paste-section\">\n      <label>Paste email content:</label>\n      <textarea id=\"email-paste\" placeholder=\"Paste the full email content here...\n\nInclude headers if available:\nFrom: sender@example.com\nTo: recipient@example.com\nSubject: Meeting notes\nDate: Jan 31, 2026\n\nEmail body text...\"></textarea>\n      <p class=\"paste-hint\">Include headers (From, To, Subject, Date) for better parsing.</p>\n    </div>\n  `;\n}\n\nfunction bindPasteMode(container: HTMLElement): void {\n  const textarea = container.querySelector('#email-paste') as HTMLTextAreaElement;\n  const saveBtn = container.querySelector('#save-btn') as HTMLButtonElement;\n\n  if (textarea) {\n    on(textarea, 'input', () => {\n      saveBtn.disabled = textarea.value.trim().length < 10;\n    });\n  }\n}\n\nfunction renderUploadMode(): string {\n  return `\n    <div class=\"upload-section\">\n      <div class=\"dropzone\" id=\"file-dropzone\">\n        <div class=\"dropzone-icon\">ðŸ“§</div>\n        <p class=\"dropzone-title\">Drop email file here</p>\n        <p class=\"dropzone-hint\">or click to browse â€¢ .eml, .msg</p>\n        <input type=\"file\" id=\"file-input\" accept=\".eml,.msg\" hidden>\n      </div>\n      <div class=\"selected-file\" id=\"selected-file\">\n        <div class=\"file-icon\">ðŸ“§</div>\n        <div class=\"file-info\">\n          <div class=\"file-name\" id=\"file-name\"></div>\n          <div class=\"file-size\" id=\"file-size\"></div>\n        </div>\n        <button class=\"file-remove\" id=\"file-remove\">Ã—</button>\n      </div>\n    </div>\n  `;\n}\n\nfunction bindUploadMode(container: HTMLElement): void {\n  const dropzone = container.querySelector('#file-dropzone') as HTMLElement;\n  const input = container.querySelector('#file-input') as HTMLInputElement;\n  const selectedFile = container.querySelector('#selected-file') as HTMLElement;\n  const saveBtn = container.querySelector('#save-btn') as HTMLButtonElement;\n\n  on(dropzone, 'click', () => input.click());\n  on(dropzone, 'dragover', (e) => { e.preventDefault(); dropzone.classList.add('dragover'); });\n  on(dropzone, 'dragleave', () => dropzone.classList.remove('dragover'));\n  on(dropzone, 'drop', (e) => {\n    e.preventDefault();\n    dropzone.classList.remove('dragover');\n    if (e.dataTransfer?.files[0]) handleFileSelect(e.dataTransfer.files[0], container);\n  });\n  on(input, 'change', () => { if (input.files?.[0]) handleFileSelect(input.files[0], container); });\n  on(container.querySelector('#file-remove') as HTMLElement, 'click', () => {\n    selectedFile.classList.remove('visible');\n    (container as any)._emlFile = null;\n    saveBtn.disabled = true;\n  });\n}\n\nfunction handleFileSelect(file: File, container: HTMLElement): void {\n  const selectedFile = container.querySelector('#selected-file') as HTMLElement;\n  const saveBtn = container.querySelector('#save-btn') as HTMLButtonElement;\n\n  container.querySelector('#file-name')!.textContent = file.name;\n  container.querySelector('#file-size')!.textContent = formatFileSize(file.size);\n  selectedFile.classList.add('visible');\n\n  (container as any)._emlFile = file;\n  saveBtn.disabled = false;\n}\n\nfunction renderManualMode(): string {\n  return `\n    <form class=\"manual-form\" id=\"manual-form\">\n      <div class=\"form-row\">\n        <div class=\"form-group\">\n          <label>From <span class=\"required\">*</span></label>\n          <input type=\"email\" name=\"from\" placeholder=\"sender@example.com\" required>\n        </div>\n        <div class=\"form-group\">\n          <label>Date</label>\n          <input type=\"datetime-local\" name=\"date\">\n        </div>\n      </div>\n      <div class=\"form-group\">\n        <label>To <span class=\"required\">*</span></label>\n        <input type=\"text\" name=\"to\" placeholder=\"recipient@example.com (comma-separated)\" required>\n      </div>\n      <div class=\"form-group\">\n        <label>CC</label>\n        <input type=\"text\" name=\"cc\" placeholder=\"cc@example.com (comma-separated)\">\n      </div>\n      <div class=\"form-group\">\n        <label>Subject</label>\n        <input type=\"text\" name=\"subject\" placeholder=\"Email subject\">\n      </div>\n      <div class=\"form-group\">\n        <label>Body <span class=\"required\">*</span></label>\n        <textarea name=\"body\" placeholder=\"Email content...\" required></textarea>\n      </div>\n    </form>\n  `;\n}\n\nfunction bindManualMode(container: HTMLElement): void {\n  const form = container.querySelector('#manual-form') as HTMLFormElement;\n  const saveBtn = container.querySelector('#save-btn') as HTMLButtonElement;\n\n  const checkValidity = () => {\n    const from = form.querySelector('[name=\"from\"]') as HTMLInputElement;\n    const to = form.querySelector('[name=\"to\"]') as HTMLInputElement;\n    const body = form.querySelector('[name=\"body\"]') as HTMLTextAreaElement;\n    saveBtn.disabled = !from.value || !to.value || !body.value;\n  };\n\n  form.querySelectorAll('input, textarea').forEach(el => {\n    on(el as HTMLElement, 'input', checkValidity);\n  });\n}\n\nasync function fileToBase64(file: File): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onload = () => {\n      const base64 = (reader.result as string).split(',')[1];\n      resolve(base64);\n    };\n    reader.onerror = reject;\n    reader.readAsDataURL(file);\n  });\n}\n\nasync function saveEmail(container: HTMLElement, props: EmailComposerProps): Promise<void> {\n  const saveBtn = container.querySelector('#save-btn') as HTMLButtonElement;\n  saveBtn.disabled = true;\n  saveBtn.textContent = 'Processing...';\n\n  try {\n    let data: Record<string, unknown>;\n\n    switch (currentMode) {\n      case 'paste': {\n        const text = (container.querySelector('#email-paste') as HTMLTextAreaElement).value;\n        data = { emailText: text };\n        break;\n      }\n      case 'upload': {\n        const file = (container as any)._emlFile as File;\n        if (!file) throw new Error('No file selected');\n\n        const base64 = await fileToBase64(file);\n        if (file.name.toLowerCase().endsWith('.msg')) {\n          data = { msgBase64: base64, filename: file.name };\n        } else {\n          data = { emlBase64: base64, filename: file.name };\n        }\n        break;\n      }\n      case 'manual': {\n        const form = container.querySelector('#manual-form') as HTMLFormElement;\n        const formData = new FormData(form);\n        data = {\n          from: formData.get('from'),\n          to: (formData.get('to') as string).split(',').map(e => e.trim()),\n          cc: formData.get('cc') ? (formData.get('cc') as string).split(',').map(e => e.trim()) : undefined,\n          subject: formData.get('subject'),\n          body: formData.get('body'),\n          date: formData.get('date') || undefined,\n        };\n        break;\n      }\n    }\n\n    const sprintId = (container.querySelector('#email-sprint-select') as HTMLSelectElement)?.value || '';\n    const actionId = (container.querySelector('#email-action-select') as HTMLSelectElement)?.value || '';\n    if (sprintId) data.sprint_id = sprintId;\n    if (actionId) data.action_id = actionId;\n\n    const result = await http.post('/api/emails', data);\n    toast.success('Email added successfully');\n    props.onSave?.(result);\n    closeEmailComposer();\n  } catch (err) {\n    toast.error('Failed to add email');\n    console.error('[EmailComposer] Error:', err);\n  } finally {\n    saveBtn.disabled = false;\n    saveBtn.textContent = 'Add Email';\n  }\n}\n\nfunction formatFileSize(bytes: number): string {\n  if (bytes < 1024) return `${bytes} B`;\n  if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;\n  return `${(bytes / (1024 * 1024)).toFixed(1)} MB`;\n}\n\nexport default showEmailComposer;\n"],"names":["currentMode","showEmailComposer","props","existing","overlay","createElement","dialog","createEmailComposer","on","e","closeEmailComposer","container","renderPasteMode","tab","renderMode","saveEmail","bindPasteMode","initEmailSprintTask","sprintSelect","actionSelect","getSprints","s","opt","sprintId","getActions","a","body","renderUploadMode","bindUploadMode","renderManualMode","bindManualMode","textarea","saveBtn","dropzone","input","selectedFile","handleFileSelect","file","formatFileSize","form","checkValidity","from","to","el","fileToBase64","resolve","reject","reader","base64","data","formData","actionId","result","http","toast","err","bytes"],"mappings":"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"}
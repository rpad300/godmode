{"version":3,"file":"TeamsPage-BWparXHF.js","sources":["../../frontend/src/pages/TeamsPage.ts"],"sourcesContent":["/**\r\n * Teams Panel Component\r\n * Team list with members management\r\n */\r\n\r\nimport { createElement, on } from '@lib/dom';\r\nimport { teamsService, Team } from '@services/contacts';\r\nimport { showTeamModal } from '@components/modals/TeamModal';\r\nimport { toast } from '@services/toast';\r\n\r\nexport interface TeamsPanelProps {\r\n  onTeamClick?: (team: Team) => void;\r\n}\r\n\r\n/**\r\n * Create teams panel\r\n */\r\nexport function createTeamsPanel(props: TeamsPanelProps = {}): HTMLElement {\r\n  const panel = createElement('div', { className: 'teams-panel' });\r\n\r\n  panel.innerHTML = `\r\n    <div class=\"panel-header\">\r\n      <div class=\"panel-title\">\r\n        <h2>Teams</h2>\r\n        <span class=\"panel-count\" id=\"teams-count\">0</span>\r\n      </div>\r\n      <div class=\"panel-actions\">\r\n        <button class=\"btn btn-primary btn-sm\" id=\"add-team-btn\">+ Add Team</button>\r\n      </div>\r\n    </div>\r\n    <div class=\"panel-content\" id=\"teams-content\">\r\n      <div class=\"loading\">Loading teams...</div>\r\n    </div>\r\n  `;\r\n\r\n  // Bind events\r\n  const addBtn = panel.querySelector('#add-team-btn');\r\n  if (addBtn) {\r\n    on(addBtn as HTMLElement, 'click', () => {\r\n      showTeamModal({\r\n        mode: 'create',\r\n        onSave: () => loadTeams(panel, props),\r\n      });\r\n    });\r\n  }\r\n\r\n  // Initial load\r\n  loadTeams(panel, props);\r\n\r\n  return panel;\r\n}\r\n\r\n/**\r\n * Load teams\r\n */\r\nasync function loadTeams(panel: HTMLElement, props: TeamsPanelProps): Promise<void> {\r\n  const content = panel.querySelector('#teams-content') as HTMLElement;\r\n  content.innerHTML = '<div class=\"loading\">Loading...</div>';\r\n\r\n  try {\r\n    const teams = await teamsService.getAll();\r\n    renderTeams(content, teams, props);\r\n    updateCount(panel, teams.length);\r\n  } catch {\r\n    content.innerHTML = '<div class=\"error\">Failed to load teams</div>';\r\n  }\r\n}\r\n\r\n/**\r\n * Render teams\r\n */\r\nfunction renderTeams(container: HTMLElement, teams: Team[], props: TeamsPanelProps): void {\r\n  if (teams.length === 0) {\r\n    container.innerHTML = `\r\n      <div class=\"empty-state\">\r\n        <p>No teams yet</p>\r\n        <button class=\"btn btn-primary\" id=\"empty-add-btn\">Create Team</button>\r\n      </div>\r\n    `;\r\n    const addBtn = container.querySelector('#empty-add-btn');\r\n    if (addBtn) {\r\n      on(addBtn as HTMLElement, 'click', () => {\r\n        showTeamModal({ mode: 'create' });\r\n      });\r\n    }\r\n    return;\r\n  }\r\n\r\n  container.innerHTML = `\r\n    <div class=\"teams-grid\">\r\n      ${teams.map(team => createTeamCard(team)).join('')}\r\n    </div>\r\n  `;\r\n\r\n  // Bind click events\r\n  container.querySelectorAll('.team-card').forEach(card => {\r\n    on(card as HTMLElement, 'click', () => {\r\n      const id = card.getAttribute('data-id');\r\n      const team = teams.find(t => String(t.id) === id);\r\n      if (team) {\r\n        if (props.onTeamClick) {\r\n          props.onTeamClick(team);\r\n        } else {\r\n          showTeamModal({\r\n            mode: 'edit',\r\n            team,\r\n            onSave: () => loadTeams(card.closest('.teams-panel') as HTMLElement, props),\r\n          });\r\n        }\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\n/**\r\n * Create team card HTML\r\n */\r\nfunction createTeamCard(team: Team): string {\r\n  const memberCount = team.memberCount || 0;\r\n  const leadMember = team.memberDetails?.find(m => m.isLead);\r\n\r\n  return `\r\n    <div class=\"team-card\" data-id=\"${team.id}\">\r\n      <div class=\"team-header\">\r\n        <div class=\"team-color\" style=\"--team-color: ${team.color || '#6366f1'}\"></div>\r\n        <div class=\"team-name\">${escapeHtml(team.name)}</div>\r\n        ${team.team_type ? `<span class=\"team-type\">${team.team_type}</span>` : ''}\r\n      </div>\r\n      ${team.description ? `<div class=\"team-description\">${escapeHtml(team.description)}</div>` : ''}\r\n      <div class=\"team-stats\">\r\n        <span class=\"member-count\">${memberCount} member${memberCount !== 1 ? 's' : ''}</span>\r\n        ${leadMember ? `<span class=\"team-lead\">Lead: ${escapeHtml(leadMember.name)}</span>` : ''}\r\n      </div>\r\n      ${team.memberDetails && team.memberDetails.length > 0 ? `\r\n        <div class=\"team-members-preview\">\r\n          ${team.memberDetails.slice(0, 5).map(member => `\r\n            <div class=\"member-avatar\" title=\"${escapeHtml(member.name)}\">\r\n              ${getInitials(member.name)}\r\n            </div>\r\n          `).join('')}\r\n          ${team.memberDetails.length > 5 ? `<div class=\"more-members\">+${team.memberDetails.length - 5}</div>` : ''}\r\n        </div>\r\n      ` : ''}\r\n    </div>\r\n  `;\r\n}\r\n\r\n/**\r\n * Update count\r\n */\r\nfunction updateCount(panel: HTMLElement, count: number): void {\r\n  const countEl = panel.querySelector('#teams-count');\r\n  if (countEl) countEl.textContent = String(count);\r\n}\r\n\r\n/**\r\n * Get initials\r\n */\r\nfunction getInitials(name: string): string {\r\n  return name\r\n    .split(' ')\r\n    .map(n => n[0])\r\n    .join('')\r\n    .toUpperCase()\r\n    .slice(0, 2);\r\n}\r\n\r\n/**\r\n * Escape HTML\r\n */\r\nfunction escapeHtml(text: string): string {\r\n  const div = document.createElement('div');\r\n  div.textContent = text;\r\n  return div.innerHTML;\r\n}\r\n\r\nexport default createTeamsPanel;\r\n"],"names":["createTeamsPanel","props","panel","createElement","addBtn","on","showTeamModal","loadTeams","content","teams","teamsService","renderTeams","updateCount","container","team","createTeamCard","card","id","t","memberCount","leadMember","m","escapeHtml","member","getInitials","count","countEl","name","n","text","div"],"mappings":"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"}
{"version":3,"mappings":";qIAoBA,IAAIA,EAA8B,YAC9BC,EAA0B,MAC1BC,EAA0B,OAC1BC,EAA4B,OAC5BC,EAAgB,GAChBC,MAAqC,IACrCC,EAA2B,GAKxB,SAASC,EAAqBC,EAA6B,GAAiB,CACjF,MAAMC,EAAQC,EAAc,MAAO,CAAE,UAAW,0BAA2B,EAE3E,OAAAD,EAAM,UAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA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","names":["currentStatus","currentType","currentSort","currentViewMode","currentSearch","selectedDocuments","allDocuments","createDocumentsPanel","props","panel","createElement","bindPanelEvents","loadDocuments","showFileUploadModal","__vitePreload","n","searchInput","searchTimeout","newSearch","e","renderFilteredDocuments","chip","c","btn","b","grid","bulkDelete","bulkExport","bulkReprocess","updateSelection","result","documentsService","statuses","err","filtered","a","renderDocumentsGrid","documents","doc","index","createDocumentCard","card","id","d","target","ke","cards","currentIndex","toast","http","iconClass","getIconClass","icon","getDocumentIcon","isSelected","factsCount","decisionsCount","risksCount","entitiesLabel","escapeHtml","formatFileSize","formatRelativeTime","filename","count","checkbox","showLoadingOverlay","message","overlay","hideLoadingOverlay","setBulkButtonsDisabled","disabled","ids","response","fetchWithProject","blob","url","text","div"],"ignoreList":[],"sources":["../../frontend/src/pages/DocumentsPage.ts"],"sourcesContent":["/**\r\n * Documents Panel Component - Clean Minimal Design\r\n * Document list with elegant search, filters, and cards\r\n */\r\n\r\nimport { createElement } from '@lib/dom';\r\nimport { documentsService, Document } from '@services/documents';\r\nimport { toast } from '@services/toast';\r\nimport { formatRelativeTime, formatFileSize } from '@lib/format';\r\nimport { http, fetchWithProject } from '@services/api';\r\n\r\nexport interface DocumentsPanelProps {\r\n  onDocumentClick?: (document: Document) => void;\r\n}\r\n\r\ntype StatusFilter = 'processed' | 'pending' | 'failed' | 'deleted' | 'all';\r\ntype TypeFilter = 'all' | 'documents' | 'transcripts' | 'emails' | 'images';\r\ntype SortOption = 'date' | 'name' | 'size';\r\ntype ViewMode = 'grid' | 'list';\r\n\r\nlet currentStatus: StatusFilter = 'processed';\r\nlet currentType: TypeFilter = 'all';\r\nlet currentSort: SortOption = 'date';\r\nlet currentViewMode: ViewMode = 'grid';\r\nlet currentSearch = '';\r\nlet selectedDocuments: Set<string> = new Set();\r\nlet allDocuments: Document[] = [];\r\n\r\n/**\r\n * Create documents panel - Clean Minimal\r\n */\r\nexport function createDocumentsPanel(props: DocumentsPanelProps = {}): HTMLElement {\r\n  const panel = createElement('div', { className: 'documents-panel-minimal' });\r\n\r\n  panel.innerHTML = `\r\n    <style>\r\n      .documents-panel-minimal {\r\n        display: flex;\r\n        flex-direction: column;\r\n        height: 100%;\r\n        background: var(--bg-primary);\r\n        padding: 32px;\r\n      }\r\n\r\n      /* Header - Minimal */\r\n      .docs-header-minimal {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: space-between;\r\n        margin-bottom: 32px;\r\n      }\r\n      .docs-title-section {\r\n        display: flex;\r\n        align-items: baseline;\r\n        gap: 16px;\r\n      }\r\n      .docs-title-section h1 {\r\n        margin: 0;\r\n        font-size: 32px;\r\n        font-weight: 700;\r\n        color: var(--text-primary);\r\n      }\r\n      .docs-total-count {\r\n        font-size: 16px;\r\n        color: var(--text-tertiary);\r\n        font-weight: 400;\r\n      }\r\n      .docs-header-actions {\r\n        display: flex;\r\n        gap: 12px;\r\n        align-items: center;\r\n      }\r\n      \r\n      /* View Mode Toggle */\r\n      .view-mode-toggle {\r\n        display: flex;\r\n        background: var(--bg-secondary);\r\n        border-radius: 8px;\r\n        padding: 4px;\r\n        gap: 2px;\r\n      }\r\n      .view-mode-btn {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        width: 36px;\r\n        height: 32px;\r\n        border: none;\r\n        background: transparent;\r\n        border-radius: 6px;\r\n        cursor: pointer;\r\n        color: var(--text-tertiary);\r\n        transition: all 0.15s ease;\r\n      }\r\n      .view-mode-btn:hover {\r\n        color: var(--text-primary);\r\n        background: var(--bg-tertiary);\r\n      }\r\n      .view-mode-btn.active {\r\n        background: var(--primary);\r\n        color: white;\r\n      }\r\n      .view-mode-btn svg {\r\n        width: 18px;\r\n        height: 18px;\r\n      }\r\n\r\n      .btn-minimal {\r\n        display: inline-flex;\r\n        align-items: center;\r\n        gap: 8px;\r\n        padding: 10px 20px;\r\n        border-radius: 10px;\r\n        font-size: 14px;\r\n        font-weight: 500;\r\n        cursor: pointer;\r\n        transition: all 0.15s ease;\r\n        border: none;\r\n      }\r\n      .btn-minimal.primary {\r\n        background: var(--primary);\r\n        color: white;\r\n      }\r\n      .btn-minimal.primary:hover {\r\n        opacity: 0.9;\r\n        transform: translateY(-1px);\r\n      }\r\n      .btn-minimal.secondary {\r\n        background: var(--bg-secondary);\r\n        color: var(--text-primary);\r\n        border: 1px solid var(--border-color);\r\n      }\r\n      .btn-minimal.secondary:hover {\r\n        background: var(--bg-tertiary);\r\n      }\r\n      .btn-minimal svg {\r\n        width: 16px;\r\n        height: 16px;\r\n      }\r\n\r\n      /* Search and Filters - Single Line */\r\n      .docs-controls {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 16px;\r\n        margin-bottom: 24px;\r\n        flex-wrap: wrap;\r\n      }\r\n      .docs-search-minimal {\r\n        flex: 1;\r\n        min-width: 280px;\r\n        max-width: 400px;\r\n        position: relative;\r\n      }\r\n      .docs-search-minimal input {\r\n        width: 100%;\r\n        padding: 12px 16px 12px 44px;\r\n        border: 1px solid var(--border-color);\r\n        border-radius: 12px;\r\n        font-size: 14px;\r\n        background: var(--bg-secondary);\r\n        color: var(--text-primary);\r\n        transition: all 0.15s ease;\r\n      }\r\n      .docs-search-minimal input:focus {\r\n        outline: none;\r\n        border-color: var(--primary);\r\n        box-shadow: 0 0 0 3px rgba(var(--primary-rgb), 0.1);\r\n      }\r\n      .docs-search-minimal input::placeholder {\r\n        color: var(--text-tertiary);\r\n      }\r\n      .docs-search-minimal svg {\r\n        position: absolute;\r\n        left: 14px;\r\n        top: 50%;\r\n        transform: translateY(-50%);\r\n        color: var(--text-tertiary);\r\n        width: 18px;\r\n        height: 18px;\r\n      }\r\n\r\n      /* Filter Chips */\r\n      .docs-filters {\r\n        display: flex;\r\n        gap: 8px;\r\n        flex-wrap: wrap;\r\n      }\r\n      .filter-chip-minimal {\r\n        padding: 8px 16px;\r\n        border-radius: 20px;\r\n        font-size: 13px;\r\n        font-weight: 500;\r\n        background: var(--bg-secondary);\r\n        color: var(--text-secondary);\r\n        border: 1px solid transparent;\r\n        cursor: pointer;\r\n        transition: all 0.15s ease;\r\n      }\r\n      .filter-chip-minimal:hover {\r\n        background: var(--bg-tertiary);\r\n        color: var(--text-primary);\r\n      }\r\n      .filter-chip-minimal.active {\r\n        background: var(--primary);\r\n        color: white;\r\n      }\r\n\r\n      /* Divider with status */\r\n      .docs-status-bar {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 12px;\r\n        padding: 16px 0;\r\n        border-bottom: 1px solid var(--border-color);\r\n        margin-bottom: 24px;\r\n      }\r\n      .status-chip {\r\n        padding: 6px 14px;\r\n        border-radius: 8px;\r\n        font-size: 12px;\r\n        font-weight: 600;\r\n        cursor: pointer;\r\n        transition: all 0.15s ease;\r\n        background: transparent;\r\n        border: none;\r\n        color: var(--text-secondary);\r\n      }\r\n      .status-chip:hover {\r\n        background: var(--bg-tertiary);\r\n      }\r\n      .status-chip.active {\r\n        background: var(--bg-tertiary);\r\n        color: var(--text-primary);\r\n      }\r\n      .status-chip.active.processed { color: #10b981; background: rgba(16, 185, 129, 0.1); }\r\n      .status-chip.active.pending { color: #f59e0b; background: rgba(245, 158, 11, 0.1); }\r\n      .status-chip.active.failed { color: #ef4444; background: rgba(239, 68, 68, 0.1); }\r\n      .status-chip.active.deleted { color: #6b7280; background: rgba(107, 114, 128, 0.1); }\r\n      .status-chip .chip-count {\r\n        margin-left: 6px;\r\n        padding: 2px 6px;\r\n        font-size: 10px;\r\n        background: rgba(0,0,0,0.05);\r\n        border-radius: 6px;\r\n      }\r\n      [data-theme=\"dark\"] .status-chip .chip-count {\r\n        background: rgba(255,255,255,0.1);\r\n      }\r\n      .status-chip.active .chip-count {\r\n        background: rgba(0,0,0,0.1);\r\n      }\r\n      .docs-sort-minimal {\r\n        margin-left: auto;\r\n        padding: 8px 12px;\r\n        border: 1px solid var(--border-color);\r\n        border-radius: 8px;\r\n        background: var(--bg-secondary);\r\n        font-size: 13px;\r\n        color: var(--text-primary);\r\n        cursor: pointer;\r\n      }\r\n\r\n      /* Documents Grid - Larger Cards */\r\n      .docs-content-minimal {\r\n        flex: 1;\r\n        overflow-y: auto;\r\n      }\r\n      .docs-grid-minimal {\r\n        display: grid;\r\n        grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));\r\n        gap: 20px;\r\n      }\r\n      \r\n      /* List View Mode */\r\n      .docs-grid-minimal.list-view {\r\n        display: flex;\r\n        flex-direction: column;\r\n        gap: 8px;\r\n      }\r\n      .docs-grid-minimal.list-view .doc-card-minimal {\r\n        flex-direction: row;\r\n        align-items: center;\r\n        padding: 12px 20px;\r\n        gap: 16px;\r\n        border-radius: 12px;\r\n      }\r\n      .docs-grid-minimal.list-view .doc-card-header {\r\n        flex-shrink: 0;\r\n        gap: 12px;\r\n      }\r\n      .docs-grid-minimal.list-view .doc-card-header .doc-icon {\r\n        width: 40px;\r\n        height: 40px;\r\n        font-size: 18px;\r\n        border-radius: 8px;\r\n      }\r\n      .docs-grid-minimal.list-view .doc-info {\r\n        flex: 1;\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 24px;\r\n        min-width: 0;\r\n      }\r\n      .docs-grid-minimal.list-view .doc-filename {\r\n        flex: 1;\r\n        min-width: 0;\r\n        margin: 0;\r\n      }\r\n      .docs-grid-minimal.list-view .doc-meta {\r\n        display: flex;\r\n        gap: 16px;\r\n        color: var(--text-tertiary);\r\n        font-size: 13px;\r\n        flex-shrink: 0;\r\n      }\r\n      .docs-grid-minimal.list-view .doc-status-badge {\r\n        margin: 0;\r\n        flex-shrink: 0;\r\n      }\r\n      .docs-grid-minimal.list-view .doc-summary-section,\r\n      .docs-grid-minimal.list-view .doc-entities-mini,\r\n      .docs-grid-minimal.list-view .doc-card-hover {\r\n        display: none;\r\n      }\r\n\r\n      /* Document Card - Clean Design */\r\n      .doc-card-minimal {\r\n        background: var(--bg-secondary);\r\n        border-radius: 16px;\r\n        border: 1px solid var(--border-color);\r\n        padding: 20px;\r\n        cursor: pointer;\r\n        transition: all 0.2s ease;\r\n        position: relative;\r\n        display: flex;\r\n        flex-direction: column;\r\n        gap: 16px;\r\n      }\r\n      .doc-card-minimal:hover {\r\n        border-color: rgba(var(--primary-rgb), 0.4);\r\n        box-shadow: 0 8px 24px rgba(0,0,0,0.08);\r\n        transform: translateY(-2px);\r\n      }\r\n      .doc-card-minimal.selected {\r\n        border-color: var(--primary);\r\n        background: rgba(var(--primary-rgb), 0.02);\r\n      }\r\n\r\n      /* Card Header */\r\n      .doc-card-top {\r\n        display: flex;\r\n        align-items: flex-start;\r\n        gap: 16px;\r\n      }\r\n      .doc-icon-minimal {\r\n        width: 52px;\r\n        height: 52px;\r\n        border-radius: 14px;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        font-size: 24px;\r\n        flex-shrink: 0;\r\n      }\r\n      .doc-icon-minimal.pdf { background: linear-gradient(135deg, #fef2f2, #fee2e2); }\r\n      .doc-icon-minimal.doc { background: linear-gradient(135deg, #eff6ff, #dbeafe); }\r\n      .doc-icon-minimal.img { background: linear-gradient(135deg, #f0fdf4, #dcfce7); }\r\n      .doc-icon-minimal.txt { background: linear-gradient(135deg, #fefce8, #fef9c3); }\r\n      .doc-icon-minimal.default { background: linear-gradient(135deg, #f5f5f5, #e5e5e5); }\r\n      [data-theme=\"dark\"] .doc-icon-minimal.pdf { background: linear-gradient(135deg, rgba(239,68,68,0.15), rgba(239,68,68,0.1)); }\r\n      [data-theme=\"dark\"] .doc-icon-minimal.doc { background: linear-gradient(135deg, rgba(59,130,246,0.15), rgba(59,130,246,0.1)); }\r\n      [data-theme=\"dark\"] .doc-icon-minimal.img { background: linear-gradient(135deg, rgba(34,197,94,0.15), rgba(34,197,94,0.1)); }\r\n      [data-theme=\"dark\"] .doc-icon-minimal.txt { background: linear-gradient(135deg, rgba(234,179,8,0.15), rgba(234,179,8,0.1)); }\r\n      [data-theme=\"dark\"] .doc-icon-minimal.default { background: linear-gradient(135deg, rgba(107,114,128,0.15), rgba(107,114,128,0.1)); }\r\n\r\n      .doc-info-minimal {\r\n        flex: 1;\r\n        min-width: 0;\r\n      }\r\n      .doc-filename-minimal {\r\n        font-size: 15px;\r\n        font-weight: 600;\r\n        color: var(--text-primary);\r\n        margin-bottom: 6px;\r\n        white-space: nowrap;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n      }\r\n      .doc-meta-minimal {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 8px;\r\n        font-size: 13px;\r\n        color: var(--text-tertiary);\r\n      }\r\n      .doc-meta-minimal .sep {\r\n        color: var(--border-color);\r\n      }\r\n      .doc-status-badge {\r\n        padding: 4px 10px;\r\n        font-size: 11px;\r\n        font-weight: 600;\r\n        border-radius: 6px;\r\n        text-transform: capitalize;\r\n      }\r\n      .doc-status-badge.processed { background: rgba(16, 185, 129, 0.1); color: #10b981; }\r\n      .doc-status-badge.pending { background: rgba(245, 158, 11, 0.1); color: #f59e0b; }\r\n      .doc-status-badge.failed { background: rgba(239, 68, 68, 0.1); color: #ef4444; }\r\n      .doc-status-badge.deleted { background: rgba(107, 114, 128, 0.1); color: #6b7280; }\r\n\r\n      /* Card Summary */\r\n      .doc-summary-minimal {\r\n        font-size: 14px;\r\n        line-height: 1.6;\r\n        color: var(--text-secondary);\r\n        display: -webkit-box;\r\n        -webkit-line-clamp: 2;\r\n        -webkit-box-orient: vertical;\r\n        overflow: hidden;\r\n      }\r\n\r\n      /* Card Footer */\r\n      .doc-card-footer {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: space-between;\r\n        padding-top: 16px;\r\n        border-top: 1px solid var(--border-color);\r\n      }\r\n      .doc-entities {\r\n        display: flex;\r\n        gap: 16px;\r\n      }\r\n      .doc-entity-item {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 6px;\r\n        font-size: 13px;\r\n        color: var(--text-secondary);\r\n      }\r\n      .doc-entity-item .icon {\r\n        width: 20px;\r\n        height: 20px;\r\n        border-radius: 6px;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        font-size: 11px;\r\n      }\r\n      .doc-entity-item.facts .icon { background: rgba(59, 130, 246, 0.1); color: #3b82f6; }\r\n      .doc-entity-item.decisions .icon { background: rgba(16, 185, 129, 0.1); color: #10b981; }\r\n      .doc-entity-item.risks .icon { background: rgba(239, 68, 68, 0.1); color: #ef4444; }\r\n\r\n      .doc-actions-minimal {\r\n        display: flex;\r\n        gap: 4px;\r\n        opacity: 0;\r\n        transition: opacity 0.15s ease;\r\n      }\r\n      .doc-card-minimal:hover .doc-actions-minimal {\r\n        opacity: 1;\r\n      }\r\n      .doc-action-btn {\r\n        width: 32px;\r\n        height: 32px;\r\n        border-radius: 8px;\r\n        background: var(--bg-primary);\r\n        border: 1px solid var(--border-color);\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        cursor: pointer;\r\n        transition: all 0.15s ease;\r\n        color: var(--text-secondary);\r\n        font-size: 14px;\r\n      }\r\n      .doc-action-btn:hover {\r\n        background: var(--primary);\r\n        border-color: var(--primary);\r\n        color: white;\r\n      }\r\n      .doc-action-btn.favorite.active {\r\n        color: #f59e0b;\r\n      }\r\n      .doc-action-btn.favorite:hover {\r\n        background: #f59e0b;\r\n        border-color: #f59e0b;\r\n        color: white;\r\n      }\r\n\r\n      /* Selection */\r\n      .doc-select-checkbox {\r\n        position: absolute;\r\n        top: 16px;\r\n        left: 16px;\r\n        width: 22px;\r\n        height: 22px;\r\n        border-radius: 6px;\r\n        border: 2px solid var(--border-color);\r\n        background: var(--bg-primary);\r\n        cursor: pointer;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        opacity: 0;\r\n        transition: all 0.15s ease;\r\n        font-size: 12px;\r\n        color: white;\r\n      }\r\n      .doc-card-minimal:hover .doc-select-checkbox,\r\n      .doc-card-minimal.selected .doc-select-checkbox {\r\n        opacity: 1;\r\n      }\r\n      .doc-card-minimal.selected .doc-select-checkbox {\r\n        background: var(--primary);\r\n        border-color: var(--primary);\r\n      }\r\n\r\n      /* Selection Bar */\r\n      .selection-bar-minimal {\r\n        position: fixed;\r\n        bottom: 32px;\r\n        left: 50%;\r\n        transform: translateX(-50%);\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 16px;\r\n        padding: 16px 24px;\r\n        background: #1e293b;\r\n        border-radius: 16px;\r\n        box-shadow: 0 12px 40px rgba(0,0,0,0.25);\r\n        z-index: 100;\r\n        animation: slideUp 0.25s ease;\r\n      }\r\n      @keyframes slideUp {\r\n        from { transform: translateX(-50%) translateY(100px); opacity: 0; }\r\n        to { transform: translateX(-50%) translateY(0); opacity: 1; }\r\n      }\r\n      .selection-bar-minimal.hidden { display: none; }\r\n      .selection-count-minimal {\r\n        color: white;\r\n        font-weight: 600;\r\n        padding-right: 16px;\r\n        border-right: 1px solid rgba(255,255,255,0.2);\r\n      }\r\n      .selection-count-minimal span { color: #60a5fa; }\r\n      .selection-bar-minimal .btn-minimal {\r\n        padding: 8px 16px;\r\n        font-size: 13px;\r\n      }\r\n      .selection-bar-minimal .btn-minimal.secondary {\r\n        background: rgba(255,255,255,0.1);\r\n        color: white;\r\n        border-color: transparent;\r\n      }\r\n      .selection-bar-minimal .btn-minimal.secondary:hover {\r\n        background: rgba(255,255,255,0.2);\r\n      }\r\n      .selection-bar-minimal .btn-minimal.danger {\r\n        background: #ef4444;\r\n        color: white;\r\n        border: none;\r\n      }\r\n\r\n      /* Empty State */\r\n      .docs-empty-minimal {\r\n        display: flex;\r\n        flex-direction: column;\r\n        align-items: center;\r\n        justify-content: center;\r\n        padding: 80px 40px;\r\n        text-align: center;\r\n        grid-column: 1 / -1;\r\n      }\r\n      .docs-empty-minimal .empty-icon {\r\n        width: 80px;\r\n        height: 80px;\r\n        border-radius: 24px;\r\n        background: var(--bg-tertiary);\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        font-size: 36px;\r\n        margin-bottom: 24px;\r\n      }\r\n      .docs-empty-minimal h3 {\r\n        margin: 0 0 8px 0;\r\n        font-size: 20px;\r\n        font-weight: 600;\r\n        color: var(--text-primary);\r\n      }\r\n      .docs-empty-minimal p {\r\n        margin: 0 0 24px 0;\r\n        color: var(--text-secondary);\r\n      }\r\n\r\n      /* Loading */\r\n      .docs-loading {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        padding: 60px;\r\n        grid-column: 1 / -1;\r\n        color: var(--text-secondary);\r\n        gap: 12px;\r\n      }\r\n      .docs-loading::after {\r\n        content: '';\r\n        width: 20px;\r\n        height: 20px;\r\n        border: 2px solid var(--border-color);\r\n        border-top-color: var(--primary);\r\n        border-radius: 50%;\r\n        animation: spin 0.8s linear infinite;\r\n      }\r\n      @keyframes spin {\r\n        to { transform: rotate(360deg); }\r\n      }\r\n      \r\n      /* Accessibility: Screen reader only content */\r\n      .visually-hidden {\r\n        position: absolute;\r\n        width: 1px;\r\n        height: 1px;\r\n        padding: 0;\r\n        margin: -1px;\r\n        overflow: hidden;\r\n        clip: rect(0, 0, 0, 0);\r\n        white-space: nowrap;\r\n        border: 0;\r\n      }\r\n      \r\n      /* Focus styles for keyboard navigation */\r\n      .doc-card-minimal:focus {\r\n        outline: 2px solid var(--primary);\r\n        outline-offset: 2px;\r\n      }\r\n      .doc-card-minimal:focus-visible {\r\n        outline: 2px solid var(--primary);\r\n        outline-offset: 2px;\r\n      }\r\n    </style>\r\n    \r\n    <!-- Header -->\r\n    <div class=\"docs-header-minimal\">\r\n      <div class=\"docs-title-section\">\r\n        <h1>Files</h1>\r\n        <span class=\"docs-total-count\"><span id=\"total-count\">0</span> documents</span>\r\n      </div>\r\n      <div class=\"docs-header-actions\">\r\n        <!-- View Mode Toggle -->\r\n        <div class=\"view-mode-toggle\">\r\n          <button class=\"view-mode-btn active\" data-view=\"grid\" title=\"Grid view\">\r\n            <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n              <rect x=\"3\" y=\"3\" width=\"7\" height=\"7\"/>\r\n              <rect x=\"14\" y=\"3\" width=\"7\" height=\"7\"/>\r\n              <rect x=\"3\" y=\"14\" width=\"7\" height=\"7\"/>\r\n              <rect x=\"14\" y=\"14\" width=\"7\" height=\"7\"/>\r\n            </svg>\r\n          </button>\r\n          <button class=\"view-mode-btn\" data-view=\"list\" title=\"List view\">\r\n            <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n              <line x1=\"8\" y1=\"6\" x2=\"21\" y2=\"6\"/>\r\n              <line x1=\"8\" y1=\"12\" x2=\"21\" y2=\"12\"/>\r\n              <line x1=\"8\" y1=\"18\" x2=\"21\" y2=\"18\"/>\r\n              <line x1=\"3\" y1=\"6\" x2=\"3.01\" y2=\"6\"/>\r\n              <line x1=\"3\" y1=\"12\" x2=\"3.01\" y2=\"12\"/>\r\n              <line x1=\"3\" y1=\"18\" x2=\"3.01\" y2=\"18\"/>\r\n            </svg>\r\n          </button>\r\n        </div>\r\n        <button class=\"btn-minimal primary\" id=\"upload-btn\">\r\n          <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\r\n            <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\"/>\r\n            <polyline points=\"17 8 12 3 7 8\"/>\r\n            <line x1=\"12\" y1=\"3\" x2=\"12\" y2=\"15\"/>\r\n          </svg>\r\n          Upload\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Controls -->\r\n    <div class=\"docs-controls\" role=\"search\">\r\n      <div class=\"docs-search-minimal\">\r\n        <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" aria-hidden=\"true\">\r\n          <circle cx=\"11\" cy=\"11\" r=\"8\"/>\r\n          <path d=\"m21 21-4.3-4.3\"/>\r\n        </svg>\r\n        <input type=\"text\" id=\"docs-search-input\" placeholder=\"Search files...\" \r\n               aria-label=\"Search files\" autocomplete=\"off\">\r\n      </div>\r\n      <div class=\"docs-filters\" role=\"tablist\" aria-label=\"Filter by document type\">\r\n        <button class=\"filter-chip-minimal active\" data-type=\"all\" role=\"tab\" aria-selected=\"true\">All</button>\r\n        <button class=\"filter-chip-minimal\" data-type=\"documents\" role=\"tab\" aria-selected=\"false\">Documents</button>\r\n        <button class=\"filter-chip-minimal\" data-type=\"transcripts\" role=\"tab\" aria-selected=\"false\">Transcripts</button>\r\n        <button class=\"filter-chip-minimal\" data-type=\"emails\" role=\"tab\" aria-selected=\"false\">Emails</button>\r\n        <button class=\"filter-chip-minimal\" data-type=\"images\" role=\"tab\" aria-selected=\"false\">Images</button>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Status Bar -->\r\n    <div class=\"docs-status-bar\" role=\"tablist\" aria-label=\"Filter by status\">\r\n      <button class=\"status-chip active processed\" data-status=\"processed\" role=\"tab\" aria-selected=\"true\">\r\n        Processed <span class=\"chip-count\" id=\"count-processed\" aria-label=\"count\">0</span>\r\n      </button>\r\n      <button class=\"status-chip pending\" data-status=\"pending\" role=\"tab\" aria-selected=\"false\">\r\n        Pending <span class=\"chip-count\" id=\"count-pending\" aria-label=\"count\">0</span>\r\n      </button>\r\n      <button class=\"status-chip failed\" data-status=\"failed\" role=\"tab\" aria-selected=\"false\">\r\n        Failed <span class=\"chip-count\" id=\"count-failed\" aria-label=\"count\">0</span>\r\n      </button>\r\n      <button class=\"status-chip deleted\" data-status=\"deleted\" role=\"tab\" aria-selected=\"false\">\r\n        Deleted <span class=\"chip-count\" id=\"count-deleted\" aria-label=\"count\">0</span>\r\n      </button>\r\n      <label for=\"sort-select\" class=\"visually-hidden\">Sort order</label>\r\n      <select class=\"docs-sort-minimal\" id=\"sort-select\" aria-label=\"Sort files\">\r\n        <option value=\"date\">Newest first</option>\r\n        <option value=\"name\">Name A-Z</option>\r\n        <option value=\"size\">Largest first</option>\r\n      </select>\r\n    </div>\r\n\r\n    <!-- Content -->\r\n    <div class=\"docs-content-minimal\" role=\"main\">\r\n      <div class=\"docs-grid-minimal\" id=\"docs-grid\" role=\"list\" aria-label=\"Document list\" tabindex=\"0\">\r\n        <div class=\"docs-loading\" aria-live=\"polite\">Loading files</div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Selection Bar -->\r\n    <div class=\"selection-bar-minimal hidden\" id=\"selection-bar\" role=\"toolbar\" aria-label=\"Bulk actions\">\r\n      <span class=\"selection-count-minimal\" aria-live=\"polite\"><span id=\"selected-count\">0</span> selected</span>\r\n      <button class=\"btn-minimal secondary\" id=\"bulk-export-btn\" aria-label=\"Export selected files\">Export</button>\r\n      <button class=\"btn-minimal secondary\" id=\"bulk-reprocess-btn\" aria-label=\"Reprocess selected files\">Reprocess</button>\r\n      <button class=\"btn-minimal danger\" id=\"bulk-delete-btn\" aria-label=\"Delete selected files\">Delete</button>\r\n      <button class=\"btn-minimal secondary\" id=\"cancel-selection-btn\" aria-label=\"Cancel selection\">Cancel</button>\r\n    </div>\r\n  `;\r\n\r\n  // Bind events\r\n  bindPanelEvents(panel, props);\r\n\r\n  // Initial load\r\n  loadDocuments(panel, props);\r\n\r\n  return panel;\r\n}\r\n\r\n/**\r\n * Bind panel events\r\n */\r\nfunction bindPanelEvents(panel: HTMLElement, props: DocumentsPanelProps): void {\r\n  // Upload button\r\n  panel.querySelector('#upload-btn')?.addEventListener('click', async () => {\r\n    const { showFileUploadModal } = await import('@components/modals/FileUploadModal');\r\n    showFileUploadModal({ onComplete: () => loadDocuments(panel, props) });\r\n  });\r\n\r\n  // Search with server-side filtering and 500ms debounce\r\n  const searchInput = panel.querySelector('#docs-search-input') as HTMLInputElement;\r\n  let searchTimeout: ReturnType<typeof setTimeout>;\r\n  searchInput?.addEventListener('input', () => {\r\n    clearTimeout(searchTimeout);\r\n    searchTimeout = setTimeout(() => {\r\n      const newSearch = searchInput.value.trim();\r\n      if (newSearch !== currentSearch) {\r\n        currentSearch = newSearch;\r\n        // Trigger server-side search if query is 2+ chars or empty\r\n        if (currentSearch.length >= 2 || currentSearch.length === 0) {\r\n          loadDocuments(panel, props);\r\n        }\r\n      }\r\n    }, 500); // Increased debounce for better UX\r\n  });\r\n\r\n  // Sort select\r\n  panel.querySelector('#sort-select')?.addEventListener('change', (e) => {\r\n    currentSort = (e.target as HTMLSelectElement).value as SortOption;\r\n    renderFilteredDocuments(panel, props);\r\n  });\r\n\r\n  // Type filters\r\n  panel.querySelectorAll('.filter-chip-minimal').forEach(chip => {\r\n    chip.addEventListener('click', () => {\r\n      panel.querySelectorAll('.filter-chip-minimal').forEach(c => c.classList.remove('active'));\r\n      chip.classList.add('active');\r\n      currentType = chip.getAttribute('data-type') as TypeFilter;\r\n      renderFilteredDocuments(panel, props);\r\n    });\r\n  });\r\n\r\n  // Status chips\r\n  panel.querySelectorAll('.status-chip').forEach(chip => {\r\n    chip.addEventListener('click', () => {\r\n      panel.querySelectorAll('.status-chip').forEach(c => c.classList.remove('active'));\r\n      chip.classList.add('active');\r\n      currentStatus = chip.getAttribute('data-status') as StatusFilter;\r\n      loadDocuments(panel, props);\r\n    });\r\n  });\r\n\r\n  // View mode toggle\r\n  panel.querySelectorAll('.view-mode-btn').forEach(btn => {\r\n    btn.addEventListener('click', () => {\r\n      panel.querySelectorAll('.view-mode-btn').forEach(b => b.classList.remove('active'));\r\n      btn.classList.add('active');\r\n      currentViewMode = btn.getAttribute('data-view') as ViewMode;\r\n\r\n      const grid = panel.querySelector('#docs-grid');\r\n      if (grid) {\r\n        if (currentViewMode === 'list') {\r\n          grid.classList.add('list-view');\r\n        } else {\r\n          grid.classList.remove('list-view');\r\n        }\r\n      }\r\n    });\r\n  });\r\n\r\n  // Bulk actions\r\n  panel.querySelector('#bulk-delete-btn')?.addEventListener('click', () => bulkDelete(panel, props));\r\n  panel.querySelector('#bulk-export-btn')?.addEventListener('click', () => bulkExport());\r\n  panel.querySelector('#bulk-reprocess-btn')?.addEventListener('click', () => bulkReprocess(panel, props));\r\n  panel.querySelector('#cancel-selection-btn')?.addEventListener('click', () => {\r\n    selectedDocuments.clear();\r\n    updateSelection(panel);\r\n  });\r\n}\r\n\r\n/**\r\n * Load documents\r\n */\r\nasync function loadDocuments(panel: HTMLElement, props: DocumentsPanelProps): Promise<void> {\r\n  const grid = panel.querySelector('#docs-grid') as HTMLElement;\r\n  grid.innerHTML = '<div class=\"docs-loading\" aria-live=\"polite\">Loading files</div>';\r\n\r\n  try {\r\n    // Use server-side filtering for better performance\r\n    const result = await documentsService.getAll({\r\n      status: currentStatus === 'all' ? undefined : currentStatus,\r\n      type: currentType === 'all' ? undefined : currentType,\r\n      search: currentSearch || undefined,\r\n      sort: currentSort === 'date' ? 'created_at' : currentSort === 'name' ? 'filename' : undefined,\r\n      order: currentSort === 'date' ? 'desc' : 'asc',\r\n      limit: 100 // Load more items for better UX\r\n    });\r\n\r\n    allDocuments = result.documents || [];\r\n\r\n    console.log('%c[DocumentsPanel] Load result:', 'color: green; font-weight: bold', {\r\n      total: result.total,\r\n      docsCount: allDocuments.length,\r\n      firstDoc: allDocuments[0],\r\n      currentStatus,\r\n      currentType\r\n    });\r\n\r\n    // Update counts\r\n    const statuses = result.statuses || {};\r\n    panel.querySelector('#total-count')!.textContent = String(result.total || allDocuments.length);\r\n    panel.querySelector('#count-processed')!.textContent = String(statuses.processed || 0);\r\n    panel.querySelector('#count-pending')!.textContent = String((statuses.pending || 0) + (statuses.processing || 0));\r\n    panel.querySelector('#count-failed')!.textContent = String(statuses.failed || 0);\r\n    panel.querySelector('#count-deleted')!.textContent = String(statuses.deleted || 0);\r\n\r\n    renderFilteredDocuments(panel, props);\r\n  } catch (err) {\r\n    console.error('[DocumentsPanel] Failed to load:', err);\r\n    grid.innerHTML = '<div class=\"docs-empty-minimal\"><div class=\"empty-icon\">!</div><h3>Failed to load files</h3><p>Please try again</p></div>';\r\n  }\r\n}\r\n\r\n/**\r\n * Render filtered documents\r\n * Note: Server-side filtering is used for status, type, and search.\r\n * This function now handles only local sorting for size (server doesn't support size sort).\r\n */\r\nfunction renderFilteredDocuments(panel: HTMLElement, props: DocumentsPanelProps): void {\r\n  let filtered = [...allDocuments];\r\n\r\n  // Only need to handle size sorting locally (server handles date and name)\r\n  if (currentSort === 'size') {\r\n    filtered.sort((a, b) => (b.size || 0) - (a.size || 0));\r\n  }\r\n\r\n  renderDocumentsGrid(panel, filtered, props);\r\n}\r\n\r\n/**\r\n * Get document type from filename\r\n */\r\nfunction getDocType(filename: string): string {\r\n  const ext = filename.split('.').pop()?.toLowerCase();\r\n  if (['pdf', 'doc', 'docx', 'txt', 'md', 'rtf'].includes(ext || '')) return 'document';\r\n  if (['jpg', 'jpeg', 'png', 'gif', 'webp', 'bmp'].includes(ext || '')) return 'image';\r\n  if (['eml', 'msg'].includes(ext || '')) return 'email';\r\n  return 'document';\r\n}\r\n\r\n/**\r\n * Render documents grid\r\n */\r\nfunction renderDocumentsGrid(panel: HTMLElement, documents: Document[], props: DocumentsPanelProps): void {\r\n  const grid = panel.querySelector('#docs-grid') as HTMLElement;\r\n\r\n  if (documents.length === 0) {\r\n    grid.innerHTML = `\r\n      <div class=\"docs-empty-minimal\">\r\n        <div class=\"empty-icon\">üìÅ</div>\r\n        <h3>No files found</h3>\r\n        <p>Upload files to get started</p>\r\n        <button class=\"btn-minimal primary\" id=\"empty-upload-btn\">Upload Files</button>\r\n      </div>\r\n    `;\r\n\r\n    grid.querySelector('#empty-upload-btn')?.addEventListener('click', async () => {\r\n      const { showFileUploadModal } = await import('@components/modals/FileUploadModal');\r\n      showFileUploadModal({ onComplete: () => loadDocuments(panel, props) });\r\n    });\r\n    return;\r\n  }\r\n\r\n  // Add data-index for potential virtual scrolling\r\n  grid.innerHTML = documents.map((doc, index) => createDocumentCard(doc, index)).join('');\r\n\r\n  // Add total count and scroll height data for virtual scrolling\r\n  grid.setAttribute('data-total', String(documents.length));\r\n\r\n  // Bind card events\r\n  grid.querySelectorAll('.doc-card-minimal').forEach(card => {\r\n    const id = card.getAttribute('data-id')!;\r\n    const doc = documents.find(d => String(d.id) === id);\r\n\r\n    // Click to preview\r\n    card.addEventListener('click', (e) => {\r\n      const target = e.target as HTMLElement;\r\n      if (target.closest('.doc-select-checkbox') || target.closest('.doc-action-btn')) return;\r\n\r\n      if (doc && props.onDocumentClick) {\r\n        props.onDocumentClick(doc);\r\n      }\r\n    });\r\n\r\n    // Keyboard navigation\r\n    (card as HTMLElement).addEventListener('keydown', (e: Event) => {\r\n      const ke = e as KeyboardEvent;\r\n      const cards = Array.from(grid.querySelectorAll('.doc-card-minimal'));\r\n      const currentIndex = cards.indexOf(card);\r\n\r\n      switch (ke.key) {\r\n        case 'Enter':\r\n        case ' ':\r\n          e.preventDefault();\r\n          if (doc && props.onDocumentClick) {\r\n            props.onDocumentClick(doc);\r\n          }\r\n          break;\r\n        case 'ArrowDown':\r\n        case 'ArrowRight':\r\n          e.preventDefault();\r\n          if (currentIndex < cards.length - 1) {\r\n            (cards[currentIndex + 1] as HTMLElement).focus();\r\n          }\r\n          break;\r\n        case 'ArrowUp':\r\n        case 'ArrowLeft':\r\n          e.preventDefault();\r\n          if (currentIndex > 0) {\r\n            (cards[currentIndex - 1] as HTMLElement).focus();\r\n          }\r\n          break;\r\n        case 's':\r\n          e.preventDefault();\r\n          // Toggle selection\r\n          if (selectedDocuments.has(id)) {\r\n            selectedDocuments.delete(id);\r\n          } else {\r\n            selectedDocuments.add(id);\r\n          }\r\n          updateSelection(panel);\r\n          break;\r\n        case 'Delete':\r\n        case 'Backspace':\r\n          e.preventDefault();\r\n          if (doc && confirm(`Delete \"${doc.filename}\"?`)) {\r\n            documentsService.delete(id, { softDelete: true }).then(() => {\r\n              toast.success('File deleted');\r\n              loadDocuments(panel, props);\r\n            }).catch(() => toast.error('Failed to delete'));\r\n          }\r\n          break;\r\n      }\r\n    });\r\n\r\n    // Checkbox for selection\r\n    card.querySelector('.doc-select-checkbox')?.addEventListener('click', (e) => {\r\n      e.stopPropagation();\r\n      if (selectedDocuments.has(id)) {\r\n        selectedDocuments.delete(id);\r\n      } else {\r\n        selectedDocuments.add(id);\r\n      }\r\n      updateSelection(panel);\r\n    });\r\n\r\n    // Favorite toggle\r\n    card.querySelector('.doc-action-btn.favorite')?.addEventListener('click', async (e) => {\r\n      e.stopPropagation();\r\n      try {\r\n        await http.post(`/api/documents/${id}/favorite`);\r\n        (e.target as HTMLElement).classList.toggle('active');\r\n        toast.success('Updated favorites');\r\n      } catch {\r\n        toast.error('Failed to update favorite');\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\n/**\r\n * Create document card HTML\r\n */\r\nfunction createDocumentCard(doc: Document, index = 0): string {\r\n  const iconClass = getIconClass(doc.filename || '');\r\n  const icon = getDocumentIcon(doc.filename || '');\r\n  const isSelected = selectedDocuments.has(doc.id);\r\n  const factsCount = doc.facts_count || 0;\r\n  const decisionsCount = (doc as any).decisions_count || 0;\r\n  const risksCount = (doc as any).risks_count || 0;\r\n\r\n  const entitiesLabel = [\r\n    factsCount > 0 ? `${factsCount} facts` : '',\r\n    decisionsCount > 0 ? `${decisionsCount} decisions` : '',\r\n    risksCount > 0 ? `${risksCount} risks` : ''\r\n  ].filter(Boolean).join(', ') || 'No entities';\r\n\r\n  return `\r\n    <div class=\"doc-card-minimal ${isSelected ? 'selected' : ''}\" \r\n         data-id=\"${doc.id}\"\r\n         data-index=\"${index}\"\r\n         role=\"listitem\"\r\n         tabindex=\"0\"\r\n         aria-label=\"${escapeHtml(doc.filename || 'Untitled')}. Status: ${doc.status}. ${entitiesLabel}\">\r\n      <div class=\"doc-select-checkbox\" role=\"checkbox\" aria-checked=\"${isSelected}\" aria-label=\"Select document\">${isSelected ? '‚úì' : ''}</div>\r\n      \r\n      <div class=\"doc-card-top\">\r\n        <div class=\"doc-icon-minimal ${iconClass}\" aria-hidden=\"true\">${icon}</div>\r\n        <div class=\"doc-info-minimal\">\r\n          <div class=\"doc-filename-minimal\">${escapeHtml(doc.filename || 'Untitled')}</div>\r\n          <div class=\"doc-meta-minimal\">\r\n            <span>${formatFileSize((doc as any).file_size || doc.size || 0)}</span>\r\n            <span class=\"sep\" aria-hidden=\"true\">‚Ä¢</span>\r\n            <span>${formatRelativeTime(doc.created_at)}</span>\r\n          </div>\r\n        </div>\r\n        <span class=\"doc-status-badge ${doc.status}\" aria-label=\"Status: ${doc.status}\">${doc.status}</span>\r\n      </div>\r\n      \r\n      ${doc.summary ? `<div class=\"doc-summary-minimal\">${escapeHtml(doc.summary)}</div>` : ''}\r\n      \r\n      <div class=\"doc-card-footer\">\r\n        <div class=\"doc-entities\" aria-label=\"Extracted entities\">\r\n          ${factsCount > 0 ? `<span class=\"doc-entity-item facts\"><span class=\"icon\" aria-hidden=\"true\">üìã</span> ${factsCount} facts</span>` : ''}\r\n          ${decisionsCount > 0 ? `<span class=\"doc-entity-item decisions\"><span class=\"icon\" aria-hidden=\"true\">‚úì</span> ${decisionsCount}</span>` : ''}\r\n          ${risksCount > 0 ? `<span class=\"doc-entity-item risks\"><span class=\"icon\" aria-hidden=\"true\">‚ö†</span> ${risksCount}</span>` : ''}\r\n          ${factsCount === 0 && decisionsCount === 0 && risksCount === 0 ? '<span class=\"doc-entity-item text-muted\">No entities</span>' : ''}\r\n        </div>\r\n        <div class=\"doc-actions-minimal\">\r\n          <button class=\"doc-action-btn favorite ${(doc as any).is_favorite ? 'active' : ''}\" \r\n                  title=\"Favorite\" aria-label=\"${(doc as any).is_favorite ? 'Remove from favorites' : 'Add to favorites'}\"\r\n                  aria-pressed=\"${(doc as any).is_favorite ? 'true' : 'false'}\">‚òÖ</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  `;\r\n}\r\n\r\n/**\r\n * Get icon class based on file type\r\n */\r\nfunction getIconClass(filename: string): string {\r\n  const ext = filename.split('.').pop()?.toLowerCase();\r\n  switch (ext) {\r\n    case 'pdf': return 'pdf';\r\n    case 'doc':\r\n    case 'docx': return 'doc';\r\n    case 'jpg':\r\n    case 'jpeg':\r\n    case 'png':\r\n    case 'gif': return 'img';\r\n    case 'txt':\r\n    case 'md': return 'txt';\r\n    default: return 'default';\r\n  }\r\n}\r\n\r\n/**\r\n * Update selection state\r\n */\r\nfunction updateSelection(panel: HTMLElement): void {\r\n  const count = selectedDocuments.size;\r\n  const selectionBar = panel.querySelector('#selection-bar') as HTMLElement;\r\n\r\n  selectionBar.classList.toggle('hidden', count === 0);\r\n  panel.querySelector('#selected-count')!.textContent = String(count);\r\n\r\n  // Update card states\r\n  panel.querySelectorAll('.doc-card-minimal').forEach(card => {\r\n    const id = card.getAttribute('data-id')!;\r\n    const isSelected = selectedDocuments.has(id);\r\n    card.classList.toggle('selected', isSelected);\r\n    const checkbox = card.querySelector('.doc-select-checkbox');\r\n    if (checkbox) checkbox.textContent = isSelected ? '‚úì' : '';\r\n  });\r\n}\r\n\r\n/**\r\n * Show loading overlay on panel\r\n */\r\nfunction showLoadingOverlay(panel: HTMLElement, message: string): HTMLElement {\r\n  const overlay = document.createElement('div');\r\n  overlay.className = 'bulk-loading-overlay';\r\n  overlay.innerHTML = `\r\n    <div class=\"bulk-loading-content\">\r\n      <div class=\"bulk-loading-spinner\"></div>\r\n      <div class=\"bulk-loading-message\">${message}</div>\r\n      <div class=\"bulk-loading-progress\" id=\"bulk-progress\"></div>\r\n    </div>\r\n  `;\r\n  const content = overlay.querySelector('.bulk-loading-content') as HTMLElement;\r\n  panel.classList.add('position-relative');\r\n  panel.appendChild(overlay);\r\n  return overlay;\r\n}\r\n\r\n/**\r\n * Hide loading overlay\r\n */\r\nfunction hideLoadingOverlay(overlay: HTMLElement): void {\r\n  overlay?.remove();\r\n}\r\n\r\n/**\r\n * Disable bulk action buttons\r\n */\r\nfunction setBulkButtonsDisabled(panel: HTMLElement, disabled: boolean): void {\r\n  const buttons = panel.querySelectorAll('#bulk-delete-btn, #bulk-export-btn, #bulk-reprocess-btn');\r\n  buttons.forEach(btn => {\r\n    (btn as HTMLButtonElement).disabled = disabled;\r\n  });\r\n}\r\n\r\n/**\r\n * Bulk delete\r\n */\r\nasync function bulkDelete(panel: HTMLElement, props: DocumentsPanelProps): Promise<void> {\r\n  const count = selectedDocuments.size;\r\n  if (!confirm(`Delete ${count} files? This action can be undone from the Deleted tab.`)) return;\r\n\r\n  const overlay = showLoadingOverlay(panel, `Deleting ${count} files...`);\r\n  setBulkButtonsDisabled(panel, true);\r\n\r\n  try {\r\n    const ids = Array.from(selectedDocuments);\r\n    const response = await http.post<{ success: boolean; deleted: number; errors: Array<{ id: string; error: string }> }>(\r\n      '/api/documents/bulk/delete',\r\n      { ids }\r\n    );\r\n\r\n    const result = response.data;\r\n    if (result.errors && result.errors.length > 0) {\r\n      toast.warning(`Deleted ${result.deleted} files, ${result.errors.length} failed`);\r\n    } else {\r\n      toast.success(`Deleted ${result.deleted} files`);\r\n    }\r\n\r\n    selectedDocuments.clear();\r\n    loadDocuments(panel, props);\r\n  } catch (err) {\r\n    console.error('[BulkDelete] Error:', err);\r\n    toast.error('Failed to delete files');\r\n  } finally {\r\n    hideLoadingOverlay(overlay);\r\n    setBulkButtonsDisabled(panel, false);\r\n  }\r\n}\r\n\r\n/**\r\n * Bulk export\r\n */\r\nasync function bulkExport(): Promise<void> {\r\n  const count = selectedDocuments.size;\r\n  toast.info(`Preparing export of ${count} files...`);\r\n\r\n  try {\r\n    const ids = Array.from(selectedDocuments);\r\n\r\n    // Trigger download via form submission (for ZIP file)\r\n    const response = await fetchWithProject('/api/documents/bulk/export', {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({ ids, format: 'original' })\r\n    });\r\n\r\n    if (!response.ok) throw new Error('Export failed');\r\n\r\n    // Create download link\r\n    const blob = await response.blob();\r\n    const url = window.URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = `documents-export-${new Date().toISOString().split('T')[0]}.zip`;\r\n    document.body.appendChild(a);\r\n    a.click();\r\n    document.body.removeChild(a);\r\n    window.URL.revokeObjectURL(url);\r\n\r\n    toast.success(`Exported ${count} files`);\r\n  } catch (err) {\r\n    console.error('[BulkExport] Error:', err);\r\n    toast.error('Failed to export files');\r\n  }\r\n}\r\n\r\n/**\r\n * Bulk reprocess\r\n */\r\nasync function bulkReprocess(panel: HTMLElement, props: DocumentsPanelProps): Promise<void> {\r\n  const count = selectedDocuments.size;\r\n  if (!confirm(`Reprocess ${count} files? This will use AI tokens.`)) return;\r\n\r\n  const overlay = showLoadingOverlay(panel, `Queuing ${count} files for reprocessing...`);\r\n  setBulkButtonsDisabled(panel, true);\r\n\r\n  try {\r\n    const ids = Array.from(selectedDocuments);\r\n    const response = await http.post<{ success: boolean; queued: string[]; failed: Array<{ id: string; error: string }> }>(\r\n      '/api/documents/bulk/reprocess',\r\n      { ids }\r\n    );\r\n\r\n    const result = response.data;\r\n    if (result.failed && result.failed.length > 0) {\r\n      toast.warning(`Queued ${result.queued?.length || 0} files, ${result.failed.length} failed`);\r\n    } else {\r\n      toast.success(`Queued ${result.queued?.length || count} files for reprocessing`);\r\n    }\r\n\r\n    selectedDocuments.clear();\r\n    updateSelection(panel);\r\n\r\n    // Reload after a short delay to show updated statuses\r\n    setTimeout(() => loadDocuments(panel, props), 1000);\r\n  } catch (err) {\r\n    console.error('[BulkReprocess] Error:', err);\r\n    toast.error('Failed to queue files for reprocessing');\r\n  } finally {\r\n    hideLoadingOverlay(overlay);\r\n    setBulkButtonsDisabled(panel, false);\r\n  }\r\n}\r\n\r\n/**\r\n * Get document icon\r\n */\r\nfunction getDocumentIcon(filename: string): string {\r\n  const ext = filename.split('.').pop()?.toLowerCase();\r\n  switch (ext) {\r\n    case 'pdf': return 'üìÑ';\r\n    case 'doc':\r\n    case 'docx': return 'üìù';\r\n    case 'xls':\r\n    case 'xlsx': return 'üìä';\r\n    case 'ppt':\r\n    case 'pptx': return 'üìΩÔ∏è';\r\n    case 'txt':\r\n    case 'md': return 'üìÉ';\r\n    case 'jpg':\r\n    case 'jpeg':\r\n    case 'png':\r\n    case 'gif': return 'üñºÔ∏è';\r\n    default: return 'üìÅ';\r\n  }\r\n}\r\n\r\n/**\r\n * Escape HTML\r\n */\r\nfunction escapeHtml(text: string): string {\r\n  const div = document.createElement('div');\r\n  div.textContent = text;\r\n  return div.innerHTML;\r\n}\r\n\r\nexport default createDocumentsPanel;\r\n"],"file":"DocumentsPage-0jCpkTn7.js"}